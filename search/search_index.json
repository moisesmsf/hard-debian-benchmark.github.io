{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Hardening + Debian + CIS Benchmarks","text":"<p>This project simplifies the application of the CIS Benchmarks for the Debian Linux OS.</p> <p>In short, it brings the Audit and Recommendation sections of all security settings contained in the latest version to the most recent release of Debian Linux available in the CIS Benchmarks.</p> <p>In Tags it is possible to find the recommended security configurations based on several aspects, such as the mapping between a recommendation and the CIS Critical Security Controls (CIS Controls) version, Safeguard and Implementation Group (IG) and the mapping between a recommendation and the MITRE ATT&amp;CK tactics, techniques, and mitigations.</p> <p>For full documentation visit: CIS Benchmark Debian Linux.</p>"},{"location":"tags/","title":"Tags","text":""},{"location":"tags/#103-disable-autorun-and-autoplay-for-removable-media","title":"10.3 Disable Autorun and Autoplay for Removable Media","text":"<ul> <li>1.1.10 Disable USB Storage</li> <li>1.1.9 Disable Automounting</li> <li>1.8.6 Ensure GDM automatic mounting of removable media is disabled</li> <li>1.8.8 Ensure GDM autorun-never is enabled</li> <li>1.8.9 Ensure GDM autorun-never is not overridden</li> </ul>"},{"location":"tags/#105-enable-anti-exploitation-features","title":"10.5 Enable Anti-Exploitation Features","text":"<ul> <li>1.5.1 Ensure address space layout randomization (ASLR) is enabled</li> </ul>"},{"location":"tags/#310-encrypt-sensitive-data-in-transit","title":"3.10 Encrypt Sensitive Data in Transit","text":"<ul> <li>5.2.13 Ensure only strong Ciphers are used</li> <li>5.2.14 Ensure only strong MAC algorithms are used</li> <li>5.2.15 Ensure only strong Key Exchange algorithms are used</li> </ul>"},{"location":"tags/#311-encrypt-sensitive-data-at-rest","title":"3.11 Encrypt Sensitive Data at Rest","text":"<ul> <li>5.4.4 Ensure password hashing algorithm is up to date with the latest standards</li> <li>6.2.1 Ensure accounts in /etc/passwd use shadowed passwords</li> </ul>"},{"location":"tags/#314-log-sensitive-data-access","title":"3.14 Log Sensitive Data Access","text":"<ul> <li>1.3.1 Ensure AIDE is installed</li> <li>1.5.2 Ensure prelink is not installed</li> </ul>"},{"location":"tags/#33-configure-data-access-control-lists","title":"3.3 Configure Data Access Control Lists","text":"<ul> <li>1.1.2.1 Ensure /tmp is a separate partition</li> <li>1.1.2.2 Ensure nodev option set on /tmp partition</li> <li>1.1.2.3 Ensure noexec option set on /tmp partition</li> <li>1.1.2.4 Ensure nosuid option set on /tmp partition</li> <li>1.1.3.1 Ensure separate partition exists for /var</li> <li>1.1.3.2 Ensure nodev option set on /var partition</li> <li>1.1.3.3 Ensure nosuid option set on /var partition</li> <li>1.1.4.1 Ensure separate partition exists for /var/tmp</li> <li>1.1.4.2 Ensure noexec option set on /var/tmp partition</li> <li>1.1.4.3 Ensure nosuid option set on /var/tmp partition</li> <li>1.1.4.4 Ensure nodev option set on /var/tmp partition</li> <li>1.1.5.2 Ensure nodev option set on /var/log partition</li> <li>1.1.5.3 Ensure noexec option set on /var/log partition</li> <li>1.1.5.4 Ensure nosuid option set on /var/log partition</li> <li>1.1.6.2 Ensure noexec option set on /var/log/audit partition</li> <li>1.1.6.3 Ensure nodev option set on /var/log/audit partition</li> <li>1.1.6.4 Ensure nosuid option set on /var/log/audit partition</li> <li>1.1.7.1 Ensure separate partition exists for /home</li> <li>1.1.7.2 Ensure nodev option set on /home partition</li> <li>1.1.7.3 Ensure nosuid option set on /home partition</li> <li>1.1.8.1 Ensure nodev option set on /dev/shm partition</li> <li>1.1.8.2 Ensure noexec option set on /dev/shm partition</li> <li>1.1.8.3 Ensure nosuid option set on /dev/shm partition</li> <li>1.4.2 Ensure permissions on bootloader config are configured</li> <li>1.6.1.1 Ensure AppArmor is installed</li> <li>1.6.1.2 Ensure AppArmor is enabled in the bootloader configuration</li> <li>1.6.1.3 Ensure all AppArmor Profiles are in enforce or complain mode</li> <li>1.6.1.4 Ensure all AppArmor Profiles are enforcing</li> <li>1.7.4 Ensure permissions on /etc/motd are configured</li> <li>1.7.5 Ensure permissions on /etc/issue are configured</li> <li>1.7.6 Ensure permissions on /etc/issue.net are configured</li> <li>4.1.3.20 Ensure the audit configuration is immutable</li> <li>4.1.4.1 Ensure audit log files are mode 0640 or less permissive</li> <li>4.1.4.10 Ensure audit tools belong to group root</li> <li>4.1.4.2 Ensure only authorized users own audit log files</li> <li>4.1.4.3 Ensure only authorized groups are assigned ownership of audit log files</li> <li>4.1.4.4 Ensure the audit log directory is 0750 or more restrictive</li> <li>4.1.4.5 Ensure audit configuration files are 640 or more restrictive</li> <li>4.1.4.6 Ensure audit configuration files are owned by root</li> <li>4.1.4.7 Ensure audit configuration files belong to group root</li> <li>4.1.4.8 Ensure audit tools are 755 or more restrictive</li> <li>4.1.4.9 Ensure audit tools are owned by root</li> <li>4.2.3 Ensure all logfiles have appropriate permissions and ownership</li> <li>4.2.1.7 Ensure journald default file permissions configured</li> <li>4.2.2.4 Ensure rsyslog default file permissions are configured</li> <li>5.1.2 Ensure permissions on /etc/crontab are configured</li> <li>5.1.3 Ensure permissions on /etc/cron.hourly are configured</li> <li>5.1.4 Ensure permissions on /etc/cron.daily are configured</li> <li>5.1.5 Ensure permissions on /etc/cron.weekly are configured</li> <li>5.1.6 Ensure permissions on /etc/cron.monthly are configured</li> <li>5.1.7 Ensure permissions on /etc/cron.d are configured</li> <li>5.1.8 Ensure cron is restricted to authorized users</li> <li>5.1.9 Ensure at is restricted to authorized users</li> <li>5.2.1 Ensure permissions on /etc/ssh/sshd_config are configured</li> <li>5.2.2 Ensure permissions on SSH private host key files are configured</li> <li>5.2.3 Ensure permissions on SSH public host key files are configured</li> <li>5.2.4 Ensure SSH access is limited</li> <li>5.3.7 Ensure access to the su command is restricted</li> <li>5.5.2 Ensure system accounts are secured</li> <li>5.5.3 Ensure default group for the root account is GID 0</li> <li>5.5.4 Ensure default user umask is 027 or more restrictive</li> <li>6.1.1 Ensure permissions on /etc/passwd are configured</li> <li>6.1.10 Ensure no unowned files or directories exist</li> <li>6.1.11 Ensure no ungrouped files or directories exist</li> <li>6.1.12 Audit SUID executables</li> <li>6.1.13 Audit SGID executables</li> <li>6.1.2 Ensure permissions on /etc/passwd- are configured</li> <li>6.1.3 Ensure permissions on /etc/group are configured</li> <li>6.1.4 Ensure permissions on /etc/group- are configured</li> <li>6.1.5 Ensure permissions on /etc/shadow are configured</li> <li>6.1.6 Ensure permissions on /etc/shadow- are configured</li> <li>6.1.7 Ensure permissions on /etc/gshadow are configured</li> <li>E6.1.8 Ensure permissions on /etc/gshadow- are configured</li> <li>6.1.9 Ensure no world writable files exist</li> <li>6.2.11 Ensure local interactive user home directories exist</li> <li>6.2.12 Ensure local interactive users own their home directories</li> <li>6.2.13 Ensure local interactive user home directories are mode 750 or more restrictive</li> <li>6.2.14 Ensure no local interactive user has .netrc files</li> <li>6.2.15 Ensure no local interactive user has .forward files</li> <li>6.2.16 Ensue no local interactive user has .rhosts files</li> <li>6.2.17 Ensure local interactive user dot files are not group or world writable</li> <li>6.2.4 Ensure shadow group is empty</li> <li>6.2.5 Ensure no duplicate UIDs exist</li> </ul>"},{"location":"tags/#41-establish-and-maintain-a-secure-configuration-process","title":"4.1 Establish and Maintain a Secure Configuration Process","text":"<ul> <li>4.1.4.11 Ensure cryptographic mechanisms are used to protect the integrity of audit tool</li> <li>5.2.10 Ensure SSH PermitUserEnvironment is disabled</li> <li>5.2.11 Ensure SSH IgnoreRhosts is enabled</li> <li>5.2.16 Ensure SSH AllowTcpForwarding is disabled</li> <li>5.2.17 Ensure SSH warning banner is configured</li> <li>5.2.19 Ensure SSH MaxStartups is configured</li> <li>5.2.21 Ensure SSH LoginGraceTime is set to one minute or less</li> <li>5.2.6 Ensure SSH PAM is enabled</li> <li>5.2.8 Ensure SSH HostbasedAuthentication is disabled</li> <li>5.2.9 Ensure SSH PermitEmptyPasswords is disabled</li> </ul>"},{"location":"tags/#43-configure-automatic-session-locking-on-enterprise-assets","title":"4.3 Configure Automatic Session Locking on Enterprise Assets","text":"<ul> <li>1.8.4 Ensure GDM screen locks when the user is idle</li> <li>1.8.5 Ensure GDM screen locks cannot be overridden</li> <li>5.5.5 Ensure default user shell timeout is 900 seconds or less</li> </ul>"},{"location":"tags/#44-implement-and-manage-a-firewall-on-servers","title":"4.4 Implement and Manage a Firewall on Servers","text":"<ul> <li>3.5.1.1 Ensure ufw is installed</li> <li>3.5.1.2 Ensure iptables-persistent is not installed with ufw</li> <li>3.5.1.3 Ensure ufw service is enabled</li> <li>3.5.1.4 Ensure ufw loopback traffic is configured</li> <li>3.5.1.5 Ensure ufw outbound connections are configured</li> <li>3.5.1.6 Ensure ufw firewall rules exist for all open ports</li> <li>3.5.1.7 Ensure ufw default deny firewall policy</li> <li>3.5.2.1 Ensure nftables is installed</li> <li>3.5.2.10 Ensure nftables rules are permanent</li> <li>3.5.2.2 Ensure ufw is uninstalled or disabled with nftables</li> <li>3.5.2.3 Ensure iptables are flushed with nftables</li> <li>3.5.2.4 Ensure a nftables table exists</li> <li>3.5.2.5 Ensure nftables base chains exist</li> <li>3.5.2.6 Ensure nftables loopback traffic is configured</li> <li>3.5.2.7 Ensure nftables outbound and established connections are configured</li> <li>3.5.2.8 Ensure nftables default deny firewall policy</li> <li>3.5.2.9 Ensure nftables service is enabled</li> <li>3.5.3.1.1 Ensure iptables packages are installed</li> <li>3.5.3.1.2 Ensure nftables is not installed with iptables</li> <li>3.5.3.1.3 Ensure ufw is uninstalled or disabled with iptables</li> <li>3.5.3.2.1 Ensure iptables default deny firewall policy</li> <li>3.5.3.2.2 Ensure iptables loopback traffic is configured</li> <li>3.5.3.2.4 Ensure iptables firewall rules exist for all open ports</li> <li>3.5.3.3.1 Ensure ip6tables default deny firewall policy</li> <li>3.5.3.3.2 Ensure ip6tables loopback traffic is configured</li> <li>3.5.3.3.3 Ensure ip6tables outbound and established connections are configured</li> <li>3.5.3.3.4 Ensure ip6tables firewall rules exist for all open ports</li> </ul>"},{"location":"tags/#45-implement-and-manage-a-firewall-on-end-user-devices","title":"4.5 Implement and Manage a Firewall on End-User Devices","text":"<ul> <li>3.5.1.1 Ensure ufw is installed</li> <li>3.5.1.2 Ensure iptables-persistent is not installed with ufw</li> <li>3.5.1.3 Ensure ufw service is enabled</li> <li>3.5.1.4 Ensure ufw loopback traffic is configured</li> <li>3.5.1.5 Ensure ufw outbound connections are configured</li> <li>3.5.1.7 Ensure ufw default deny firewall policy</li> <li>3.5.2.1 Ensure nftables is installed</li> <li>3.5.2.10 Ensure nftables rules are permanent</li> <li>3.5.2.2 Ensure ufw is uninstalled or disabled with nftables</li> <li>3.5.2.3 Ensure iptables are flushed with nftables</li> <li>3.5.2.4 Ensure a nftables table exists</li> <li>3.5.2.5 Ensure nftables base chains exist</li> <li>3.5.2.6 Ensure nftables loopback traffic is configured</li> <li>3.5.2.7 Ensure nftables outbound and established connections are configured</li> <li>3.5.2.8 Ensure nftables default deny firewall policy</li> <li>3.5.2.9 Ensure nftables service is enabled</li> <li>3.5.3.1.1 Ensure iptables packages are installed</li> <li>3.5.3.1.2 Ensure nftables is not installed with iptables</li> <li>3.5.3.1.3 Ensure ufw is uninstalled or disabled with iptables</li> <li>3.5.3.2.1 Ensure iptables default deny firewall policy</li> <li>3.5.3.2.2 Ensure iptables loopback traffic is configured</li> <li>3.5.3.2.4 Ensure iptables firewall rules exist for all open ports</li> <li>3.5.3.3.1 Ensure ip6tables default deny firewall policy</li> <li>3.5.3.3.2 Ensure ip6tables loopback traffic is configured</li> <li>3.5.3.3.3 Ensure ip6tables outbound and established connections are configured</li> <li>3.5.3.3.4 Ensure ip6tables firewall rules exist for all open ports</li> </ul>"},{"location":"tags/#48-uninstall-or-disable-unnecessary-services-on-enterprise-assets-and-software","title":"4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","text":"<ul> <li>1.1.1.1 Ensure mounting of cramfs filesystems is disabled</li> <li>1.1.1.2 Ensure mounting of squashfs filesystems is disabled</li> <li>1.1.1.3 Ensure mounting of udf filesystems is disabled</li> <li>1.5.3 Ensure Automatic Error Reporting is not enabled</li> <li>1.5.4 Ensure core dumps are restricted</li> <li>1.8.1 Ensure GNOME Display Manager is removed</li> <li>1.8.10 Ensure XDCMP is not enabled</li> <li>2.4 Ensure nonessential services are removed or masked</li> <li>2.2.1 Ensure X Window System is not installed</li> <li>2.2.10 Ensure IMAP and POP3 server are not installed</li> <li>2.2.11 Ensure Samba is not installed</li> <li>2.2.12 Ensure HTTP Proxy Server is not installed</li> <li>2.2.13 Ensure SNMP Server is not installed</li> <li>2.2.14 Ensure NIS Server is not installed</li> <li>2.2.15 Ensure mail transfer agent is configured for local-only mode</li> <li>2.2.16 Ensure rsync service is either not installed or masked</li> <li>2.2.2 Ensure Avahi Server is not installed</li> <li>2.2.3 Ensure CUPS is not installed</li> <li>2.2.4 Ensure DHCP Server is not installed</li> <li>2.2.5 Ensure LDAP server is not installed</li> <li>2.2.6 Ensure NFS is not installed</li> <li>2.2.7 Ensure DNS Server is not installed</li> <li>2.2.8 Ensure FTP Server is not installed</li> <li>2.2.9 Ensure HTTP server is not installed</li> <li>2.3.1 Ensure NIS Client is not installed</li> <li>2.3.2 Ensure rsh client is not installed</li> <li>2.3.3 Ensure talk client is not installed</li> <li>2.3.4 Ensure telnet client is not installed</li> <li>2.3.5 Ensure LDAP client is not installed</li> <li>2.3.6 Ensure RPC is not installed</li> <li>3.1.1 Ensure system is checked to determine if IPv6 is enabled</li> <li>3.1.2 Ensure wireless interfaces are disabled</li> <li>3.1.3 Ensure DCCP is disabled</li> <li>3.1.4 Ensure SCTP is disabled</li> <li>3.2.1 Ensure packet redirect sending is disabled</li> <li>3.2.2 Ensure IP forwarding is disabled</li> <li>3.3.1 Ensure source routed packets are not accepted</li> <li>3.3.2 Ensure ICMP redirects are not accepted</li> <li>3.3.3 Ensure secure ICMP redirects are not accepted</li> <li>3.3.5 Ensure broadcast ICMP requests are ignored</li> <li>3.3.6 Ensure bogus ICMP responses are ignored</li> <li>3.3.7 Ensure Reverse Path Filtering is enabled</li> <li>3.3.8 Ensure TCP SYN Cookies is enabled</li> <li>3.3.9 Ensure IPv6 router advertisements are not accepted</li> <li>4.2.1.1.4 Ensure journald is not configured to recieve logs from a remote client</li> <li>4.2.2.7 Ensure rsyslog is not configured to receive logs from a remote client</li> <li>5.2.12 Ensure SSH X11 forwarding is disabled</li> </ul>"},{"location":"tags/#52-use-unique-passwords","title":"5.2 Use Unique Passwords","text":"<ul> <li>1.4.1 Ensure bootloader password is set</li> <li>1.4.3 Ensure authentication required for single user mode</li> <li>5.4.1 Ensure password creation requirements are configured</li> <li>5.4.3 Ensure password reuse is limited</li> <li>5.5.1.1 Ensure minimum days between password changes is configured</li> <li>5.5.1.2 Ensure password expiration is 365 days or less</li> <li>5.5.1.3 Ensure password expiration warning days is 7 or more</li> <li>5.5.1.4 Ensure inactive password lock is 30 days or less</li> <li>5.5.1.5 Ensure all users last password change date is in the past</li> <li>6.2.2 Ensure /etc/shadow password fields are not empty</li> </ul>"},{"location":"tags/#54-restrict-administrator-privileges-to-dedicated-administrator-accounts","title":"5.4 Restrict Administrator Privileges to Dedicated Administrator Accounts","text":"<ul> <li>5.2.7 Ensure SSH root login is disabled</li> <li>5.3.1 Ensure sudo is installed</li> <li>5.3.2 Ensure sudo commands use pty</li> <li>5.3.4 Ensure users must provide password for privilege escalation</li> <li>5.3.5 Ensure re-authentication for privilege escalation is not disabled globally</li> <li>5.3.6 Ensure sudo authentication timeout is configured correctly</li> </ul>"},{"location":"tags/#62-establish-an-access-revoking-process","title":"6.2 Establish an Access Revoking Process","text":"<ul> <li>5.4.2 Ensure lockout for failed password attempts is configured</li> </ul>"},{"location":"tags/#73-perform-automated-operating-system-patch-management","title":"7.3 Perform Automated Operating System Patch Management","text":"<ul> <li>1.9 Ensure updates, patches, and additional security software are installed</li> <li>1.2.1 Ensure package manager repositories are configured</li> <li>1.2.2 Ensure GPG keys are configured</li> </ul>"},{"location":"tags/#82-collect-audit-logs","title":"8.2 Collect Audit Logs","text":"<ul> <li>4.1.1.2 Ensure auditd service is enabled and active</li> <li>4.1.1.3 Ensure auditing for processes that start prior to auditd is enabled</li> <li>4.1.1.4 Ensure audit_backlog_limit is sufficient</li> <li>4.1.2.3 Ensure system is disabled when audit logs are full</li> <li>4.1.3.15 Ensure successful and unsuccessful attempts to use the chcon command are recorded</li> <li>4.1.3.16 Ensure successful and unsuccessful attempts to use the setfacl command are recorded</li> <li>4.1.3.17 Ensure successful and unsuccessful attempts to use the chacl command are recorde</li> <li>4.1.3.18 Ensure successful and unsuccessful attempts to use the usermod command are recorded</li> <li>4.2.1.2 Ensure journald service is enabled</li> <li>4.2.1.3 Ensure journald is configured to compress large log files</li> <li>4.2.1.4 Ensure journald is configured to write logfiles to persistent disk</li> <li>4.2.1.5 Ensure journald is not configured to send logs to rsyslog</li> <li>4.2.1.6 Ensure journald log rotation is configured per site policy</li> <li>4.2.1.7 Ensure journald default file permissions configured</li> <li>4.2.1.1.1 Ensure systemd-journal-remote is installed</li> <li>4.2.1.1.2 Ensure systemd-journal-remote is configured</li> <li>4.2.1.1.3 Ensure systemd-journal-remote is enabled</li> <li>4.2.1.1.4 Ensure journald is not configured to recieve logs from a remote client</li> <li>4.2.2.1 Ensure rsyslog is installed</li> <li>4.2.2.2 Ensure rsyslog service is enabled</li> <li>4.2.2.3 Ensure journald is configured to send logs to rsyslog</li> <li>4.2.2.4 Ensure rsyslog default file permissions are configured</li> <li>4.2.2.5 Ensure logging is configured</li> <li>4.2.2.6 Ensure rsyslog is configured to send logs to a remote log host</li> <li>4.2.2.7 Ensure rsyslog is not configured to receive logs from a remote client</li> <li>5.2.5 Ensure SSH LogLevel is appropriate</li> </ul>"},{"location":"tags/#83-ensure-adequate-audit-log-storage","title":"8.3 Ensure Adequate Audit Log Storage","text":"<ul> <li>1.1.5.1 Ensure separate partition exists for /var/log</li> <li>1.1.6.1 Ensure separate partition exists for /var/log/audit</li> <li>4.1.2.1 Ensure audit log storage size is configured</li> <li>4.1.2.2 Ensure audit logs are not automatically deleted</li> <li>4.2.1.3 Ensure journald is configured to compress large log files</li> </ul>"},{"location":"tags/#84-standardize-time-synchronization","title":"8.4 Standardize Time Synchronization","text":"<ul> <li>2.1.1.1 Ensure a single time synchronization daemon is in use</li> <li>2.1.2.1 Ensure chrony is configured with authorized timeserver</li> <li>2.1.2.2 Ensure chrony is running as user _chrony</li> <li>2.1.2.3 Ensure chrony is enabled and running</li> <li>2.1.3.1 Ensure systemd-timesyncd configured with authorized timeserver</li> <li>2.1.3.2 Ensure systemd-timesyncd is enabled and running</li> <li>2.1.4.1 Ensure ntp access control is configured</li> <li>2.1.4.2 Ensure ntp is configured with authorized timeserver</li> <li>2.1.4.3 Ensure ntp is running as user ntp</li> <li>Ensure mounting of cramfs filesystems is disabled</li> </ul>"},{"location":"tags/#85-collect-detailed-audit-logs","title":"8.5 Collect Detailed Audit Logs","text":"<ul> <li>1.3.2 Ensure filesystem integrity is regularly checked</li> <li>3.3.4 Ensure suspicious packets are logged</li> <li>4.1.1.1 Ensure auditd is installed</li> <li>4.1.3.1 Ensure changes to system administration scope (sudoers) is collected</li> <li>4.1.3.10 Ensure successful file system mounts are collected</li> <li>4.1.3.11 Ensure session initiation information is collected</li> <li>4.1.3.12 Ensure login and logout events are collected</li> <li>4.1.3.13 Ensure file deletion events by users are collected</li> <li>4.1.3.14 Ensure events that modify the system's Mandatory Access Controls are collected</li> <li>4.1.3.19 Ensure kernel module loading unloading and modification is collected</li> <li>4.1.3.2 Ensure actions as another user are always logged</li> <li>4.1.3.20 Ensure the audit configuration is immutable</li> <li>4.1.3.21 Ensure the running and on disk configuration is the same</li> <li>4.1.3.3 Ensure events that modify the sudo log file are collected</li> <li>4.1.3.4 Ensure events that modify date and time information are collected</li> <li>4.1.3.5 Ensure events that modify the system's network environment are collected</li> <li>4.1.3.6 Ensure use of privileged commands are collected</li> <li>4.1.3.7 Ensure unsuccessful file access attempts are collected</li> <li>4.1.3.8 Ensure events that modify user/group information are collected</li> <li>4.1.3.9 Ensure discretionary access control permission modification events are collected</li> <li>5.2.18 Ensure SSH MaxAuthTries is set to 4 or less</li> <li>5.3.3 Ensure sudo log file exists</li> </ul>"},{"location":"tags/#89-centralize-audit-logs","title":"8.9 Centralize Audit Logs","text":"<ul> <li>4.2.1.5 Ensure journald is not configured to send logs to rsyslog</li> <li>4.2.2.3 Ensure journald is configured to send logs to rsyslog</li> </ul>"},{"location":"tags/#access-authentication-and-authorization","title":"Access, Authentication and Authorization","text":"<ul> <li>5.1.1 Ensure cron daemon is enabled and running</li> <li>5.1.2 Ensure permissions on /etc/crontab are configured</li> <li>5.1.3 Ensure permissions on /etc/cron.hourly are configured</li> <li>5.1.4 Ensure permissions on /etc/cron.daily are configured</li> <li>5.1.5 Ensure permissions on /etc/cron.weekly are configured</li> <li>5.1.6 Ensure permissions on /etc/cron.monthly are configured</li> <li>5.1.7 Ensure permissions on /etc/cron.d are configured</li> <li>5.1.8 Ensure cron is restricted to authorized users</li> <li>5.1.9 Ensure at is restricted to authorized users</li> <li>5.2.1 Ensure permissions on /etc/ssh/sshd_config are configured</li> <li>5.2.10 Ensure SSH PermitUserEnvironment is disabled</li> <li>5.2.11 Ensure SSH IgnoreRhosts is enabled</li> <li>5.2.12 Ensure SSH X11 forwarding is disabled</li> <li>5.2.13 Ensure only strong Ciphers are used</li> <li>5.2.14 Ensure only strong MAC algorithms are used</li> <li>5.2.15 Ensure only strong Key Exchange algorithms are used</li> <li>5.2.16 Ensure SSH AllowTcpForwarding is disabled</li> <li>5.2.17 Ensure SSH warning banner is configured</li> <li>5.2.18 Ensure SSH MaxAuthTries is set to 4 or less</li> <li>5.2.19 Ensure SSH MaxStartups is configured</li> <li>5.2.2 Ensure permissions on SSH private host key files are configured</li> <li>5.2.20 Ensure SSH MaxSessions is set to 10 or less</li> <li>5.2.21 Ensure SSH LoginGraceTime is set to one minute or less</li> <li>5.2.22 Ensure SSH Idle Timeout Interval is configured</li> <li>5.2.3 Ensure permissions on SSH public host key files are configured</li> <li>5.2.4 Ensure SSH access is limited</li> <li>5.2.5 Ensure SSH LogLevel is appropriate</li> <li>5.2.6 Ensure SSH PAM is enabled</li> <li>5.2.7 Ensure SSH root login is disabled</li> <li>5.2.8 Ensure SSH HostbasedAuthentication is disabled</li> <li>5.2.9 Ensure SSH PermitEmptyPasswords is disabled</li> <li>5.3.1 Ensure sudo is installed</li> <li>5.3.2 Ensure sudo commands use pty</li> <li>5.3.3 Ensure sudo log file exists</li> <li>5.3.4 Ensure users must provide password for privilege escalation</li> <li>5.3.5 Ensure re-authentication for privilege escalation is not disabled globally</li> <li>5.3.6 Ensure sudo authentication timeout is configured correctly</li> <li>5.3.7 Ensure access to the su command is restricted</li> <li>5.4.1 Ensure password creation requirements are configured</li> <li>5.4.2 Ensure lockout for failed password attempts is configured</li> <li>5.4.3 Ensure password reuse is limited</li> <li>5.4.4 Ensure password hashing algorithm is up to date with the latest standards</li> <li>5.5.2 Ensure system accounts are secured</li> <li>5.5.3 Ensure default group for the root account is GID 0</li> <li>5.5.4 Ensure default user umask is 027 or more restrictive</li> <li>5.5.5 Ensure default user shell timeout is 900 seconds or less</li> <li>5.5.1.1 Ensure minimum days between password changes is configured</li> <li>5.5.1.2 Ensure password expiration is 365 days or less</li> <li>5.5.1.3 Ensure password expiration warning days is 7 or more</li> <li>5.5.1.4 Ensure inactive password lock is 30 days or less</li> <li>5.5.1.5 Ensure all users last password change date is in the past</li> </ul>"},{"location":"tags/#additional-process-hardening","title":"Additional Process Hardening","text":"<ul> <li>1.5.1 Ensure address space layout randomization (ASLR) is enabled</li> <li>1.5.2 Ensure prelink is not installed</li> <li>1.5.3 Ensure Automatic Error Reporting is not enabled</li> <li>1.5.4 Ensure core dumps are restricted</li> </ul>"},{"location":"tags/#automated","title":"Automated","text":"<ul> <li>1.1.10 Disable USB Storage</li> <li>1.1.9 Disable Automounting</li> <li>1.1.1.1 Ensure mounting of cramfs filesystems is disabled</li> <li>1.1.1.2 Ensure mounting of squashfs filesystems is disabled</li> <li>1.1.1.3 Ensure mounting of udf filesystems is disabled</li> <li>1.1.2.1 Ensure /tmp is a separate partition</li> <li>1.1.2.2 Ensure nodev option set on /tmp partition</li> <li>1.1.2.3 Ensure noexec option set on /tmp partition</li> <li>1.1.2.4 Ensure nosuid option set on /tmp partition</li> <li>1.1.3.1 Ensure separate partition exists for /var</li> <li>1.1.3.2 Ensure nodev option set on /var partition</li> <li>1.1.3.3 Ensure nosuid option set on /var partition</li> <li>1.1.4.1 Ensure separate partition exists for /var/tmp</li> <li>1.1.4.2 Ensure noexec option set on /var/tmp partition</li> <li>1.1.4.3 Ensure nosuid option set on /var/tmp partition</li> <li>1.1.4.4 Ensure nodev option set on /var/tmp partition</li> <li>1.1.5.1 Ensure separate partition exists for /var/log</li> <li>1.1.5.2 Ensure nodev option set on /var/log partition</li> <li>1.1.5.3 Ensure noexec option set on /var/log partition</li> <li>1.1.5.4 Ensure nosuid option set on /var/log partition</li> <li>1.1.6.1 Ensure separate partition exists for /var/log/audit</li> <li>1.1.6.2 Ensure noexec option set on /var/log/audit partition</li> <li>1.1.6.3 Ensure nodev option set on /var/log/audit partition</li> <li>1.1.6.4 Ensure nosuid option set on /var/log/audit partition</li> <li>1.1.7.1 Ensure separate partition exists for /home</li> <li>1.1.7.2 Ensure nodev option set on /home partition</li> <li>1.1.7.3 Ensure nosuid option set on /home partition</li> <li>1.1.8.1 Ensure nodev option set on /dev/shm partition</li> <li>1.1.8.2 Ensure noexec option set on /dev/shm partition</li> <li>1.1.8.3 Ensure nosuid option set on /dev/shm partition</li> <li>1.3.1 Ensure AIDE is installed</li> <li>1.3.2 Ensure filesystem integrity is regularly checked</li> <li>1.4.1 Ensure bootloader password is set</li> <li>1.4.2 Ensure permissions on bootloader config are configured</li> <li>1.4.3 Ensure authentication required for single user mode</li> <li>1.5.1 Ensure address space layout randomization (ASLR) is enabled</li> <li>1.5.2 Ensure prelink is not installed</li> <li>1.5.3 Ensure Automatic Error Reporting is not enabled</li> <li>1.5.4 Ensure core dumps are restricted</li> <li>1.6.1.1 Ensure AppArmor is installed</li> <li>1.6.1.2 Ensure AppArmor is enabled in the bootloader configuration</li> <li>1.6.1.3 Ensure all AppArmor Profiles are in enforce or complain mode</li> <li>1.6.1.4 Ensure all AppArmor Profiles are enforcing</li> <li>1.7.1 Ensure message of the day is configured properly</li> <li>1.7.2 Ensure local login warning banner is configured properly</li> <li>1.7.3 Ensure remote login warning banner is configured properly</li> <li>1.7.4 Ensure permissions on /etc/motd are configured</li> <li>1.7.5 Ensure permissions on /etc/issue are configured</li> <li>1.7.6 Ensure permissions on /etc/issue.net are configured</li> <li>1.8.1 Ensure GNOME Display Manager is removed</li> <li>1.8.10 Ensure XDCMP is not enabled</li> <li>1.8.2 Ensure GDM login banner is configured</li> <li>1.8.3 Ensure GDM disable-user-list option is enabled</li> <li>1.8.4 Ensure GDM screen locks when the user is idle</li> <li>1.8.5 Ensure GDM screen locks cannot be overridden</li> <li>1.8.6 Ensure GDM automatic mounting of removable media is disabled</li> <li>1.8.7 Ensure GDM disabling automatic mounting of removable media is not overridden</li> <li>1.8.8 Ensure GDM autorun-never is enabled</li> <li>1.8.9 Ensure GDM autorun-never is not overridden</li> <li>2.1.1.1 Ensure a single time synchronization daemon is in use</li> <li>2.1.2.2 Ensure chrony is running as user _chrony</li> <li>2.1.2.3 Ensure chrony is enabled and running</li> <li>2.1.3.2 Ensure systemd-timesyncd is enabled and running</li> <li>2.1.4.1 Ensure ntp access control is configured</li> <li>2.1.4.3 Ensure ntp is running as user ntp</li> <li>Ensure mounting of cramfs filesystems is disabled</li> <li>2.2.1 Ensure X Window System is not installed</li> <li>2.2.10 Ensure IMAP and POP3 server are not installed</li> <li>2.2.11 Ensure Samba is not installed</li> <li>2.2.12 Ensure HTTP Proxy Server is not installed</li> <li>2.2.13 Ensure SNMP Server is not installed</li> <li>2.2.14 Ensure NIS Server is not installed</li> <li>2.2.15 Ensure mail transfer agent is configured for local-only mode</li> <li>2.2.16 Ensure rsync service is either not installed or masked</li> <li>2.2.2 Ensure Avahi Server is not installed</li> <li>2.2.3 Ensure CUPS is not installed</li> <li>2.2.4 Ensure DHCP Server is not installed</li> <li>2.2.5 Ensure LDAP server is not installed</li> <li>2.2.6 Ensure NFS is not installed</li> <li>2.2.7 Ensure DNS Server is not installed</li> <li>2.2.8 Ensure FTP Server is not installed</li> <li>2.2.9 Ensure HTTP server is not installed</li> <li>2.3.1 Ensure NIS Client is not installed</li> <li>2.3.2 Ensure rsh client is not installed</li> <li>2.3.3 Ensure talk client is not installed</li> <li>2.3.4 Ensure telnet client is not installed</li> <li>2.3.5 Ensure LDAP client is not installed</li> <li>2.3.6 Ensure RPC is not installed</li> <li>3.1.2 Ensure wireless interfaces are disabled</li> <li>3.1.3 Ensure DCCP is disabled</li> <li>3.1.4 Ensure SCTP is disabled</li> <li>3.1.5 Ensure RDS is disabled</li> <li>3.1.6 Ensure TIPC is disabled</li> <li>3.2.1 Ensure packet redirect sending is disabled</li> <li>3.2.2 Ensure IP forwarding is disabled</li> <li>3.3.1 Ensure source routed packets are not accepted</li> <li>3.3.2 Ensure ICMP redirects are not accepted</li> <li>3.3.3 Ensure secure ICMP redirects are not accepted</li> <li>3.3.4 Ensure suspicious packets are logged</li> <li>3.3.5 Ensure broadcast ICMP requests are ignored</li> <li>3.3.6 Ensure bogus ICMP responses are ignored</li> <li>3.3.7 Ensure Reverse Path Filtering is enabled</li> <li>3.3.8 Ensure TCP SYN Cookies is enabled</li> <li>3.3.9 Ensure IPv6 router advertisements are not accepted</li> <li>3.5.1.1 Ensure ufw is installed</li> <li>3.5.1.2 Ensure iptables-persistent is not installed with ufw</li> <li>3.5.1.3 Ensure ufw service is enabled</li> <li>3.5.1.4 Ensure ufw loopback traffic is configured</li> <li>3.5.1.6 Ensure ufw firewall rules exist for all open ports</li> <li>3.5.1.7 Ensure ufw default deny firewall policy</li> <li>3.5.2.1 Ensure nftables is installed</li> <li>3.5.2.10 Ensure nftables rules are permanent</li> <li>3.5.2.2 Ensure ufw is uninstalled or disabled with nftables</li> <li>3.5.2.4 Ensure a nftables table exists</li> <li>3.5.2.5 Ensure nftables base chains exist</li> <li>3.5.2.6 Ensure nftables loopback traffic is configured</li> <li>3.5.2.8 Ensure nftables default deny firewall policy</li> <li>3.5.2.9 Ensure nftables service is enabled</li> <li>3.5.3.1.1 Ensure iptables packages are installed</li> <li>3.5.3.1.2 Ensure nftables is not installed with iptables</li> <li>3.5.3.1.3 Ensure ufw is uninstalled or disabled with iptables</li> <li>3.5.3.2.1 Ensure iptables default deny firewall policy</li> <li>3.5.3.2.2 Ensure iptables loopback traffic is configured</li> <li>3.5.3.2.4 Ensure iptables firewall rules exist for all open ports</li> <li>3.5.3.3.1 Ensure ip6tables default deny firewall policy</li> <li>3.5.3.3.2 Ensure ip6tables loopback traffic is configured</li> <li>3.5.3.3.4 Ensure ip6tables firewall rules exist for all open ports</li> <li>4.1.1.1 Ensure auditd is installed</li> <li>4.1.1.2 Ensure auditd service is enabled and active</li> <li>4.1.1.3 Ensure auditing for processes that start prior to auditd is enabled</li> <li>4.1.1.4 Ensure audit_backlog_limit is sufficient</li> <li>4.1.2.1 Ensure audit log storage size is configured</li> <li>4.1.2.2 Ensure audit logs are not automatically deleted</li> <li>4.1.2.3 Ensure system is disabled when audit logs are full</li> <li>4.1.3.1 Ensure changes to system administration scope (sudoers) is collected</li> <li>4.1.3.10 Ensure successful file system mounts are collected</li> <li>4.1.3.11 Ensure session initiation information is collected</li> <li>4.1.3.12 Ensure login and logout events are collected</li> <li>4.1.3.13 Ensure file deletion events by users are collected</li> <li>4.1.3.14 Ensure events that modify the system's Mandatory Access Controls are collected</li> <li>4.1.3.15 Ensure successful and unsuccessful attempts to use the chcon command are recorded</li> <li>4.1.3.16 Ensure successful and unsuccessful attempts to use the setfacl command are recorded</li> <li>4.1.3.17 Ensure successful and unsuccessful attempts to use the chacl command are recorde</li> <li>4.1.3.18 Ensure successful and unsuccessful attempts to use the usermod command are recorded</li> <li>4.1.3.19 Ensure kernel module loading unloading and modification is collected</li> <li>4.1.3.2 Ensure actions as another user are always logged</li> <li>4.1.3.20 Ensure the audit configuration is immutable</li> <li>4.1.3.3 Ensure events that modify the sudo log file are collected</li> <li>4.1.3.4 Ensure events that modify date and time information are collected</li> <li>4.1.3.5 Ensure events that modify the system's network environment are collected</li> <li>4.1.3.6 Ensure use of privileged commands are collected</li> <li>4.1.3.7 Ensure unsuccessful file access attempts are collected</li> <li>4.1.3.8 Ensure events that modify user/group information are collected</li> <li>4.1.3.9 Ensure discretionary access control permission modification events are collected</li> <li>4.1.4.1 Ensure audit log files are mode 0640 or less permissive</li> <li>4.1.4.10 Ensure audit tools belong to group root</li> <li>4.1.4.11 Ensure cryptographic mechanisms are used to protect the integrity of audit tool</li> <li>4.1.4.2 Ensure only authorized users own audit log files</li> <li>4.1.4.3 Ensure only authorized groups are assigned ownership of audit log files</li> <li>4.1.4.4 Ensure the audit log directory is 0750 or more restrictive</li> <li>4.1.4.5 Ensure audit configuration files are 640 or more restrictive</li> <li>4.1.4.6 Ensure audit configuration files are owned by root</li> <li>4.1.4.7 Ensure audit configuration files belong to group root</li> <li>4.1.4.8 Ensure audit tools are 755 or more restrictive</li> <li>4.1.4.9 Ensure audit tools are owned by root</li> <li>4.2.3 Ensure all logfiles have appropriate permissions and ownership</li> <li>4.2.1.2 Ensure journald service is enabled</li> <li>4.2.1.3 Ensure journald is configured to compress large log files</li> <li>4.2.1.4 Ensure journald is configured to write logfiles to persistent disk</li> <li>4.2.1.1.1 Ensure systemd-journal-remote is installed</li> <li>4.2.1.1.4 Ensure journald is not configured to recieve logs from a remote client</li> <li>4.2.2.1 Ensure rsyslog is installed</li> <li>4.2.2.2 Ensure rsyslog service is enabled</li> <li>4.2.2.4 Ensure rsyslog default file permissions are configured</li> <li>4.2.2.7 Ensure rsyslog is not configured to receive logs from a remote client</li> <li>5.1.1 Ensure cron daemon is enabled and running</li> <li>5.1.2 Ensure permissions on /etc/crontab are configured</li> <li>5.1.3 Ensure permissions on /etc/cron.hourly are configured</li> <li>5.1.4 Ensure permissions on /etc/cron.daily are configured</li> <li>5.1.5 Ensure permissions on /etc/cron.weekly are configured</li> <li>5.1.6 Ensure permissions on /etc/cron.monthly are configured</li> <li>5.1.7 Ensure permissions on /etc/cron.d are configured</li> <li>5.1.8 Ensure cron is restricted to authorized users</li> <li>5.1.9 Ensure at is restricted to authorized users</li> <li>5.2.1 Ensure permissions on /etc/ssh/sshd_config are configured</li> <li>5.2.10 Ensure SSH PermitUserEnvironment is disabled</li> <li>5.2.11 Ensure SSH IgnoreRhosts is enabled</li> <li>5.2.12 Ensure SSH X11 forwarding is disabled</li> <li>5.2.13 Ensure only strong Ciphers are used</li> <li>5.2.14 Ensure only strong MAC algorithms are used</li> <li>5.2.15 Ensure only strong Key Exchange algorithms are used</li> <li>5.2.16 Ensure SSH AllowTcpForwarding is disabled</li> <li>5.2.17 Ensure SSH warning banner is configured</li> <li>5.2.18 Ensure SSH MaxAuthTries is set to 4 or less</li> <li>5.2.19 Ensure SSH MaxStartups is configured</li> <li>5.2.2 Ensure permissions on SSH private host key files are configured</li> <li>5.2.20 Ensure SSH MaxSessions is set to 10 or less</li> <li>5.2.21 Ensure SSH LoginGraceTime is set to one minute or less</li> <li>5.2.22 Ensure SSH Idle Timeout Interval is configured</li> <li>5.2.3 Ensure permissions on SSH public host key files are configured</li> <li>5.2.4 Ensure SSH access is limited</li> <li>5.2.5 Ensure SSH LogLevel is appropriate</li> <li>5.2.6 Ensure SSH PAM is enabled</li> <li>5.2.7 Ensure SSH root login is disabled</li> <li>5.2.8 Ensure SSH HostbasedAuthentication is disabled</li> <li>5.2.9 Ensure SSH PermitEmptyPasswords is disabled</li> <li>5.3.1 Ensure sudo is installed</li> <li>5.3.2 Ensure sudo commands use pty</li> <li>5.3.3 Ensure sudo log file exists</li> <li>5.3.4 Ensure users must provide password for privilege escalation</li> <li>5.3.5 Ensure re-authentication for privilege escalation is not disabled globally</li> <li>5.3.6 Ensure sudo authentication timeout is configured correctly</li> <li>5.3.7 Ensure access to the su command is restricted</li> <li>5.4.1 Ensure password creation requirements are configured</li> <li>5.4.2 Ensure lockout for failed password attempts is configured</li> <li>5.4.3 Ensure password reuse is limited</li> <li>5.4.4 Ensure password hashing algorithm is up to date with the latest standards</li> <li>5.5.2 Ensure system accounts are secured</li> <li>5.5.3 Ensure default group for the root account is GID 0</li> <li>5.5.4 Ensure default user umask is 027 or more restrictive</li> <li>5.5.5 Ensure default user shell timeout is 900 seconds or less</li> <li>5.5.1.1 Ensure minimum days between password changes is configured</li> <li>5.5.1.2 Ensure password expiration is 365 days or less</li> <li>5.5.1.3 Ensure password expiration warning days is 7 or more</li> <li>5.5.1.4 Ensure inactive password lock is 30 days or less</li> <li>5.5.1.5 Ensure all users last password change date is in the past</li> <li>6.1.1 Ensure permissions on /etc/passwd are configured</li> <li>6.1.10 Ensure no unowned files or directories exist</li> <li>6.1.11 Ensure no ungrouped files or directories exist</li> <li>6.1.2 Ensure permissions on /etc/passwd- are configured</li> <li>6.1.3 Ensure permissions on /etc/group are configured</li> <li>6.1.4 Ensure permissions on /etc/group- are configured</li> <li>6.1.5 Ensure permissions on /etc/shadow are configured</li> <li>6.1.6 Ensure permissions on /etc/shadow- are configured</li> <li>6.1.7 Ensure permissions on /etc/gshadow are configured</li> <li>E6.1.8 Ensure permissions on /etc/gshadow- are configured</li> <li>6.1.9 Ensure no world writable files exist</li> <li>6.2.1 Ensure accounts in /etc/passwd use shadowed passwords</li> <li>6.2.10 Ensure root is the only UID 0 account</li> <li>6.2.11 Ensure local interactive user home directories exist</li> <li>6.2.12 Ensure local interactive users own their home directories</li> <li>6.2.13 Ensure local interactive user home directories are mode 750 or more restrictive</li> <li>6.2.14 Ensure no local interactive user has .netrc files</li> <li>6.2.15 Ensure no local interactive user has .forward files</li> <li>6.2.16 Ensue no local interactive user has .rhosts files</li> <li>6.2.17 Ensure local interactive user dot files are not group or world writable</li> <li>6.2.2 Ensure /etc/shadow password fields are not empty</li> <li>6.2.3 Ensure all groups in /etc/passwd exist in /etc/group</li> <li>6.2.4 Ensure shadow group is empty</li> <li>6.2.5 Ensure no duplicate UIDs exist</li> <li>6.2.6 Ensure no duplicate GIDs exist</li> <li>6.2.7 Ensure no duplicate user names exist</li> <li>6.2.8 Ensure no duplicate group names exist</li> <li>6.2.9 Ensure root PATH Integrity</li> </ul>"},{"location":"tags/#command-line-warning-banners","title":"Command Line Warning Banners","text":"<ul> <li>1.7.1 Ensure message of the day is configured properly</li> <li>1.7.2 Ensure local login warning banner is configured properly</li> <li>1.7.3 Ensure remote login warning banner is configured properly</li> <li>1.7.4 Ensure permissions on /etc/motd are configured</li> <li>1.7.5 Ensure permissions on /etc/issue are configured</li> <li>1.7.6 Ensure permissions on /etc/issue.net are configured</li> </ul>"},{"location":"tags/#configure-devshm","title":"Configure /dev/shm","text":"<ul> <li>1.1.8.1 Ensure nodev option set on /dev/shm partition</li> <li>1.1.8.2 Ensure noexec option set on /dev/shm partition</li> <li>1.1.8.3 Ensure nosuid option set on /dev/shm partition</li> </ul>"},{"location":"tags/#configure-home","title":"Configure /home","text":"<ul> <li>1.1.7.1 Ensure separate partition exists for /home</li> <li>1.1.7.2 Ensure nodev option set on /home partition</li> <li>1.1.7.3 Ensure nosuid option set on /home partition</li> </ul>"},{"location":"tags/#configure-tmp","title":"Configure /tmp","text":"<ul> <li>1.1.2.1 Ensure /tmp is a separate partition</li> <li>1.1.2.2 Ensure nodev option set on /tmp partition</li> <li>1.1.2.3 Ensure noexec option set on /tmp partition</li> <li>1.1.2.4 Ensure nosuid option set on /tmp partition</li> </ul>"},{"location":"tags/#configure-var","title":"Configure /var","text":"<ul> <li>1.1.3.1 Ensure separate partition exists for /var</li> <li>1.1.3.2 Ensure nodev option set on /var partition</li> <li>1.1.3.3 Ensure nosuid option set on /var partition</li> </ul>"},{"location":"tags/#configure-varlog","title":"Configure /var/log","text":"<ul> <li>1.1.5.1 Ensure separate partition exists for /var/log</li> <li>1.1.5.2 Ensure nodev option set on /var/log partition</li> <li>1.1.5.3 Ensure noexec option set on /var/log partition</li> <li>1.1.5.4 Ensure nosuid option set on /var/log partition</li> </ul>"},{"location":"tags/#configure-varlogaudit","title":"Configure /var/log/audit","text":"<ul> <li>1.1.6.1 Ensure separate partition exists for /var/log/audit</li> <li>1.1.6.2 Ensure noexec option set on /var/log/audit partition</li> <li>1.1.6.3 Ensure nodev option set on /var/log/audit partition</li> <li>1.1.6.4 Ensure nosuid option set on /var/log/audit partition</li> </ul>"},{"location":"tags/#configure-vartmp","title":"Configure /var/tmp","text":"<ul> <li>1.1.4.1 Ensure separate partition exists for /var/tmp</li> <li>1.1.4.2 Ensure noexec option set on /var/tmp partition</li> <li>1.1.4.3 Ensure nosuid option set on /var/tmp partition</li> <li>1.1.4.4 Ensure nodev option set on /var/tmp partition</li> </ul>"},{"location":"tags/#configure-apparmor","title":"Configure AppArmor","text":"<ul> <li>1.6.1.1 Ensure AppArmor is installed</li> <li>1.6.1.2 Ensure AppArmor is enabled in the bootloader configuration</li> <li>1.6.1.3 Ensure all AppArmor Profiles are in enforce or complain mode</li> <li>1.6.1.4 Ensure all AppArmor Profiles are enforcing</li> </ul>"},{"location":"tags/#configure-data-retention","title":"Configure Data Retention","text":"<ul> <li>4.1.2.1 Ensure audit log storage size is configured</li> <li>4.1.2.2 Ensure audit logs are not automatically deleted</li> <li>4.1.2.3 Ensure system is disabled when audit logs are full</li> </ul>"},{"location":"tags/#configure-ipv4-iptables","title":"Configure IPv4 iptables","text":"<ul> <li>3.5.3.2.1 Ensure iptables default deny firewall policy</li> <li>3.5.3.2.2 Ensure iptables loopback traffic is configured</li> <li>3.5.3.2.4 Ensure iptables firewall rules exist for all open ports</li> </ul>"},{"location":"tags/#configure-ipv6-ip6tables","title":"Configure IPv6 ip6tables","text":"<ul> <li>3.5.3.3.1 Ensure ip6tables default deny firewall policy</li> <li>3.5.3.3.2 Ensure ip6tables loopback traffic is configured</li> <li>3.5.3.3.3 Ensure ip6tables outbound and established connections are configured</li> <li>3.5.3.3.4 Ensure ip6tables firewall rules exist for all open ports</li> </ul>"},{"location":"tags/#configure-logging","title":"Configure Logging","text":"<ul> <li>4.2.3 Ensure all logfiles have appropriate permissions and ownership</li> <li>4.2.1.2 Ensure journald service is enabled</li> <li>4.2.1.3 Ensure journald is configured to compress large log files</li> <li>4.2.1.4 Ensure journald is configured to write logfiles to persistent disk</li> <li>4.2.1.5 Ensure journald is not configured to send logs to rsyslog</li> <li>4.2.1.6 Ensure journald log rotation is configured per site policy</li> <li>4.2.1.7 Ensure journald default file permissions configured</li> <li>4.2.1.1.1 Ensure systemd-journal-remote is installed</li> <li>4.2.1.1.2 Ensure systemd-journal-remote is configured</li> <li>4.2.1.1.3 Ensure systemd-journal-remote is enabled</li> <li>4.2.1.1.4 Ensure journald is not configured to recieve logs from a remote client</li> <li>4.2.2.1 Ensure rsyslog is installed</li> <li>4.2.2.2 Ensure rsyslog service is enabled</li> <li>4.2.2.3 Ensure journald is configured to send logs to rsyslog</li> <li>4.2.2.4 Ensure rsyslog default file permissions are configured</li> <li>4.2.2.5 Ensure logging is configured</li> <li>4.2.2.6 Ensure rsyslog is configured to send logs to a remote log host</li> <li>4.2.2.7 Ensure rsyslog is not configured to receive logs from a remote client</li> </ul>"},{"location":"tags/#configure-pam","title":"Configure PAM","text":"<ul> <li>5.4.1 Ensure password creation requirements are configured</li> <li>5.4.2 Ensure lockout for failed password attempts is configured</li> <li>5.4.3 Ensure password reuse is limited</li> <li>5.4.4 Ensure password hashing algorithm is up to date with the latest standards</li> </ul>"},{"location":"tags/#configure-ssh-server","title":"Configure SSH Server","text":"<ul> <li>5.2.1 Ensure permissions on /etc/ssh/sshd_config are configured</li> <li>5.2.10 Ensure SSH PermitUserEnvironment is disabled</li> <li>5.2.11 Ensure SSH IgnoreRhosts is enabled</li> <li>5.2.12 Ensure SSH X11 forwarding is disabled</li> <li>5.2.13 Ensure only strong Ciphers are used</li> <li>5.2.14 Ensure only strong MAC algorithms are used</li> <li>5.2.15 Ensure only strong Key Exchange algorithms are used</li> <li>5.2.16 Ensure SSH AllowTcpForwarding is disabled</li> <li>5.2.17 Ensure SSH warning banner is configured</li> <li>5.2.18 Ensure SSH MaxAuthTries is set to 4 or less</li> <li>5.2.19 Ensure SSH MaxStartups is configured</li> <li>5.2.2 Ensure permissions on SSH private host key files are configured</li> <li>5.2.20 Ensure SSH MaxSessions is set to 10 or less</li> <li>5.2.21 Ensure SSH LoginGraceTime is set to one minute or less</li> <li>5.2.22 Ensure SSH Idle Timeout Interval is configured</li> <li>5.2.3 Ensure permissions on SSH public host key files are configured</li> <li>5.2.4 Ensure SSH access is limited</li> <li>5.2.5 Ensure SSH LogLevel is appropriate</li> <li>5.2.6 Ensure SSH PAM is enabled</li> <li>5.2.7 Ensure SSH root login is disabled</li> <li>5.2.8 Ensure SSH HostbasedAuthentication is disabled</li> <li>5.2.9 Ensure SSH PermitEmptyPasswords is disabled</li> </ul>"},{"location":"tags/#configure-software-updates","title":"Configure Software Updates","text":"<ul> <li>1.2.1 Ensure package manager repositories are configured</li> <li>1.2.2 Ensure GPG keys are configured</li> </ul>"},{"location":"tags/#configure-system-accounting-auditd","title":"Configure System Accounting (auditd)","text":"<ul> <li>4.1.1.1 Ensure auditd is installed</li> <li>4.1.1.2 Ensure auditd service is enabled and active</li> <li>4.1.1.3 Ensure auditing for processes that start prior to auditd is enabled</li> <li>4.1.1.4 Ensure audit_backlog_limit is sufficient</li> <li>4.1.2.1 Ensure audit log storage size is configured</li> <li>4.1.2.2 Ensure audit logs are not automatically deleted</li> <li>4.1.2.3 Ensure system is disabled when audit logs are full</li> <li>4.1.3.1 Ensure changes to system administration scope (sudoers) is collected</li> <li>4.1.3.10 Ensure successful file system mounts are collected</li> <li>4.1.3.11 Ensure session initiation information is collected</li> <li>4.1.3.12 Ensure login and logout events are collected</li> <li>4.1.3.13 Ensure file deletion events by users are collected</li> <li>4.1.3.14 Ensure events that modify the system's Mandatory Access Controls are collected</li> <li>4.1.3.15 Ensure successful and unsuccessful attempts to use the chcon command are recorded</li> <li>4.1.3.16 Ensure successful and unsuccessful attempts to use the setfacl command are recorded</li> <li>4.1.3.17 Ensure successful and unsuccessful attempts to use the chacl command are recorde</li> <li>4.1.3.18 Ensure successful and unsuccessful attempts to use the usermod command are recorded</li> <li>4.1.3.19 Ensure kernel module loading unloading and modification is collected</li> <li>4.1.3.2 Ensure actions as another user are always logged</li> <li>4.1.3.20 Ensure the audit configuration is immutable</li> <li>4.1.3.21 Ensure the running and on disk configuration is the same</li> <li>4.1.3.3 Ensure events that modify the sudo log file are collected</li> <li>4.1.3.4 Ensure events that modify date and time information are collected</li> <li>4.1.3.5 Ensure events that modify the system's network environment are collected</li> <li>4.1.3.6 Ensure use of privileged commands are collected</li> <li>4.1.3.7 Ensure unsuccessful file access attempts are collected</li> <li>4.1.3.8 Ensure events that modify user/group information are collected</li> <li>4.1.3.9 Ensure discretionary access control permission modification events are collected</li> <li>4.1.4.1 Ensure audit log files are mode 0640 or less permissive</li> <li>4.1.4.10 Ensure audit tools belong to group root</li> <li>4.1.4.11 Ensure cryptographic mechanisms are used to protect the integrity of audit tool</li> <li>4.1.4.2 Ensure only authorized users own audit log files</li> <li>4.1.4.3 Ensure only authorized groups are assigned ownership of audit log files</li> <li>4.1.4.4 Ensure the audit log directory is 0750 or more restrictive</li> <li>4.1.4.5 Ensure audit configuration files are 640 or more restrictive</li> <li>4.1.4.6 Ensure audit configuration files are owned by root</li> <li>4.1.4.7 Ensure audit configuration files belong to group root</li> <li>4.1.4.8 Ensure audit tools are 755 or more restrictive</li> <li>4.1.4.9 Ensure audit tools are owned by root</li> </ul>"},{"location":"tags/#configure-time-synchronization","title":"Configure Time Synchronization","text":"<ul> <li>2.1.1.1 Ensure a single time synchronization daemon is in use</li> <li>2.1.2.1 Ensure chrony is configured with authorized timeserver</li> <li>2.1.2.2 Ensure chrony is running as user _chrony</li> <li>2.1.2.3 Ensure chrony is enabled and running</li> <li>2.1.3.1 Ensure systemd-timesyncd configured with authorized timeserver</li> <li>2.1.3.2 Ensure systemd-timesyncd is enabled and running</li> <li>2.1.4.1 Ensure ntp access control is configured</li> <li>2.1.4.2 Ensure ntp is configured with authorized timeserver</li> <li>2.1.4.3 Ensure ntp is running as user ntp</li> <li>Ensure mounting of cramfs filesystems is disabled</li> </ul>"},{"location":"tags/#configure-uncomplicatedfirewall","title":"Configure UncomplicatedFirewall","text":"<ul> <li>3.5.1.1 Ensure ufw is installed</li> <li>3.5.1.2 Ensure iptables-persistent is not installed with ufw</li> <li>3.5.1.3 Ensure ufw service is enabled</li> <li>3.5.1.4 Ensure ufw loopback traffic is configured</li> <li>3.5.1.5 Ensure ufw outbound connections are configured</li> <li>3.5.1.6 Ensure ufw firewall rules exist for all open ports</li> <li>3.5.1.7 Ensure ufw default deny firewall policy</li> </ul>"},{"location":"tags/#configure-auditd-file-access","title":"Configure auditd file access","text":"<ul> <li>4.1.4.1 Ensure audit log files are mode 0640 or less permissive</li> <li>4.1.4.10 Ensure audit tools belong to group root</li> <li>4.1.4.11 Ensure cryptographic mechanisms are used to protect the integrity of audit tool</li> <li>4.1.4.2 Ensure only authorized users own audit log files</li> <li>4.1.4.3 Ensure only authorized groups are assigned ownership of audit log files</li> <li>4.1.4.4 Ensure the audit log directory is 0750 or more restrictive</li> <li>4.1.4.5 Ensure audit configuration files are 640 or more restrictive</li> <li>4.1.4.6 Ensure audit configuration files are owned by root</li> <li>4.1.4.7 Ensure audit configuration files belong to group root</li> <li>4.1.4.8 Ensure audit tools are 755 or more restrictive</li> <li>4.1.4.9 Ensure audit tools are owned by root</li> </ul>"},{"location":"tags/#configure-auditd-rules","title":"Configure auditd rules","text":"<ul> <li>4.1.3.1 Ensure changes to system administration scope (sudoers) is collected</li> <li>4.1.3.10 Ensure successful file system mounts are collected</li> <li>4.1.3.11 Ensure session initiation information is collected</li> <li>4.1.3.12 Ensure login and logout events are collected</li> <li>4.1.3.13 Ensure file deletion events by users are collected</li> <li>4.1.3.14 Ensure events that modify the system's Mandatory Access Controls are collected</li> <li>4.1.3.15 Ensure successful and unsuccessful attempts to use the chcon command are recorded</li> <li>4.1.3.16 Ensure successful and unsuccessful attempts to use the setfacl command are recorded</li> <li>4.1.3.17 Ensure successful and unsuccessful attempts to use the chacl command are recorde</li> <li>4.1.3.18 Ensure successful and unsuccessful attempts to use the usermod command are recorded</li> <li>4.1.3.19 Ensure kernel module loading unloading and modification is collected</li> <li>4.1.3.2 Ensure actions as another user are always logged</li> <li>4.1.3.20 Ensure the audit configuration is immutable</li> <li>4.1.3.21 Ensure the running and on disk configuration is the same</li> <li>4.1.3.3 Ensure events that modify the sudo log file are collected</li> <li>4.1.3.4 Ensure events that modify date and time information are collected</li> <li>4.1.3.5 Ensure events that modify the system's network environment are collected</li> <li>4.1.3.6 Ensure use of privileged commands are collected</li> <li>4.1.3.7 Ensure unsuccessful file access attempts are collected</li> <li>4.1.3.8 Ensure events that modify user/group information are collected</li> <li>4.1.3.9 Ensure discretionary access control permission modification events are collected</li> </ul>"},{"location":"tags/#configure-chrony","title":"Configure chrony","text":"<ul> <li>2.1.2.1 Ensure chrony is configured with authorized timeserver</li> <li>2.1.2.2 Ensure chrony is running as user _chrony</li> <li>2.1.2.3 Ensure chrony is enabled and running</li> </ul>"},{"location":"tags/#configure-iptables","title":"Configure iptables","text":"<ul> <li>3.5.3.1.1 Ensure iptables packages are installed</li> <li>3.5.3.1.2 Ensure nftables is not installed with iptables</li> <li>3.5.3.1.3 Ensure ufw is uninstalled or disabled with iptables</li> <li>3.5.3.2.1 Ensure iptables default deny firewall policy</li> <li>3.5.3.2.2 Ensure iptables loopback traffic is configured</li> <li>3.5.3.2.4 Ensure iptables firewall rules exist for all open ports</li> <li>3.5.3.3.1 Ensure ip6tables default deny firewall policy</li> <li>3.5.3.3.2 Ensure ip6tables loopback traffic is configured</li> <li>3.5.3.3.3 Ensure ip6tables outbound and established connections are configured</li> <li>3.5.3.3.4 Ensure ip6tables firewall rules exist for all open ports</li> </ul>"},{"location":"tags/#configure-iptables-software","title":"Configure iptables software","text":"<ul> <li>3.5.3.1.1 Ensure iptables packages are installed</li> <li>3.5.3.1.2 Ensure nftables is not installed with iptables</li> <li>3.5.3.1.3 Ensure ufw is uninstalled or disabled with iptables</li> </ul>"},{"location":"tags/#configure-journald","title":"Configure journald","text":"<ul> <li>4.2.1.2 Ensure journald service is enabled</li> <li>4.2.1.3 Ensure journald is configured to compress large log files</li> <li>4.2.1.4 Ensure journald is configured to write logfiles to persistent disk</li> <li>4.2.1.5 Ensure journald is not configured to send logs to rsyslog</li> <li>4.2.1.6 Ensure journald log rotation is configured per site policy</li> <li>4.2.1.7 Ensure journald default file permissions configured</li> <li>4.2.1.1.1 Ensure systemd-journal-remote is installed</li> <li>4.2.1.1.2 Ensure systemd-journal-remote is configured</li> <li>4.2.1.1.3 Ensure systemd-journal-remote is enabled</li> <li>4.2.1.1.4 Ensure journald is not configured to recieve logs from a remote client</li> </ul>"},{"location":"tags/#configure-nftables","title":"Configure nftables","text":"<ul> <li>3.5.2.1 Ensure nftables is installed</li> <li>3.5.2.10 Ensure nftables rules are permanent</li> <li>3.5.2.2 Ensure ufw is uninstalled or disabled with nftables</li> <li>3.5.2.3 Ensure iptables are flushed with nftables</li> <li>3.5.2.4 Ensure a nftables table exists</li> <li>3.5.2.5 Ensure nftables base chains exist</li> <li>3.5.2.6 Ensure nftables loopback traffic is configured</li> <li>3.5.2.7 Ensure nftables outbound and established connections are configured</li> <li>3.5.2.8 Ensure nftables default deny firewall policy</li> <li>3.5.2.9 Ensure nftables service is enabled</li> </ul>"},{"location":"tags/#configure-ntp","title":"Configure ntp","text":"<ul> <li>2.1.4.1 Ensure ntp access control is configured</li> <li>2.1.4.2 Ensure ntp is configured with authorized timeserver</li> <li>2.1.4.3 Ensure ntp is running as user ntp</li> <li>Ensure mounting of cramfs filesystems is disabled</li> </ul>"},{"location":"tags/#configure-privilege-escalation","title":"Configure privilege escalation","text":"<ul> <li>5.3.1 Ensure sudo is installed</li> <li>5.3.2 Ensure sudo commands use pty</li> <li>5.3.3 Ensure sudo log file exists</li> <li>5.3.4 Ensure users must provide password for privilege escalation</li> <li>5.3.5 Ensure re-authentication for privilege escalation is not disabled globally</li> <li>5.3.6 Ensure sudo authentication timeout is configured correctly</li> <li>5.3.7 Ensure access to the su command is restricted</li> </ul>"},{"location":"tags/#configure-rsyslog","title":"Configure rsyslog","text":"<ul> <li>4.2.3 Ensure all logfiles have appropriate permissions and ownership</li> <li>4.2.2.1 Ensure rsyslog is installed</li> <li>4.2.2.2 Ensure rsyslog service is enabled</li> <li>4.2.2.3 Ensure journald is configured to send logs to rsyslog</li> <li>4.2.2.4 Ensure rsyslog default file permissions are configured</li> <li>4.2.2.5 Ensure logging is configured</li> <li>4.2.2.6 Ensure rsyslog is configured to send logs to a remote log host</li> <li>4.2.2.7 Ensure rsyslog is not configured to receive logs from a remote client</li> </ul>"},{"location":"tags/#configure-systemd-timesyncd","title":"Configure systemd-timesyncd","text":"<ul> <li>2.1.3.1 Ensure systemd-timesyncd configured with authorized timeserver</li> <li>2.1.3.2 Ensure systemd-timesyncd is enabled and running</li> </ul>"},{"location":"tags/#configure-time-based-job-schedulers","title":"Configure time-based job schedulers","text":"<ul> <li>5.1.1 Ensure cron daemon is enabled and running</li> <li>5.1.2 Ensure permissions on /etc/crontab are configured</li> <li>5.1.3 Ensure permissions on /etc/cron.hourly are configured</li> <li>5.1.4 Ensure permissions on /etc/cron.daily are configured</li> <li>5.1.5 Ensure permissions on /etc/cron.weekly are configured</li> <li>5.1.6 Ensure permissions on /etc/cron.monthly are configured</li> <li>5.1.7 Ensure permissions on /etc/cron.d are configured</li> <li>5.1.8 Ensure cron is restricted to authorized users</li> <li>5.1.9 Ensure at is restricted to authorized users</li> </ul>"},{"location":"tags/#disable-automounting","title":"Disable Automounting","text":"<ul> <li>1.1.9 Disable Automounting</li> </ul>"},{"location":"tags/#disable-unused-filesystems","title":"Disable unused filesystems","text":"<ul> <li>1.1.10 Disable USB Storage</li> <li>1.1.1.1 Ensure mounting of cramfs filesystems is disabled</li> <li>1.1.1.2 Ensure mounting of squashfs filesystems is disabled</li> <li>1.1.1.3 Ensure mounting of udf filesystems is disabled</li> </ul>"},{"location":"tags/#disable-unused-network-protocols-and-devices","title":"Disable unused network protocols and devices","text":"<ul> <li>3.1.1 Ensure system is checked to determine if IPv6 is enabled</li> <li>3.1.2 Ensure wireless interfaces are disabled</li> <li>3.1.3 Ensure DCCP is disabled</li> <li>3.1.4 Ensure SCTP is disabled</li> <li>3.1.5 Ensure RDS is disabled</li> <li>3.1.6 Ensure TIPC is disabled</li> </ul>"},{"location":"tags/#ensure-auditing-is-enabled","title":"Ensure auditing is enabled","text":"<ul> <li>4.1.1.1 Ensure auditd is installed</li> <li>4.1.1.2 Ensure auditd service is enabled and active</li> <li>4.1.1.3 Ensure auditing for processes that start prior to auditd is enabled</li> <li>4.1.1.4 Ensure audit_backlog_limit is sufficient</li> </ul>"},{"location":"tags/#ensure-journald-is-configured-to-send-logs-to-a-remote-log-host","title":"Ensure journald is configured to send logs to a remote log host","text":"<ul> <li>4.2.1.1.1 Ensure systemd-journal-remote is installed</li> <li>4.2.1.1.2 Ensure systemd-journal-remote is configured</li> <li>4.2.1.1.3 Ensure systemd-journal-remote is enabled</li> <li>4.2.1.1.4 Ensure journald is not configured to recieve logs from a remote client</li> </ul>"},{"location":"tags/#ensure-time-synchronization-is-in-use","title":"Ensure time synchronization is in use","text":"<ul> <li>2.1.1.1 Ensure a single time synchronization daemon is in use</li> </ul>"},{"location":"tags/#filesystem-configuration","title":"Filesystem Configuration","text":"<ul> <li>1.1.10 Disable USB Storage</li> <li>1.1.9 Disable Automounting</li> <li>1.1.1.1 Ensure mounting of cramfs filesystems is disabled</li> <li>1.1.1.2 Ensure mounting of squashfs filesystems is disabled</li> <li>1.1.1.3 Ensure mounting of udf filesystems is disabled</li> <li>1.1.2.1 Ensure /tmp is a separate partition</li> <li>1.1.2.2 Ensure nodev option set on /tmp partition</li> <li>1.1.2.3 Ensure noexec option set on /tmp partition</li> <li>1.1.2.4 Ensure nosuid option set on /tmp partition</li> <li>1.1.3.1 Ensure separate partition exists for /var</li> <li>1.1.3.2 Ensure nodev option set on /var partition</li> <li>1.1.3.3 Ensure nosuid option set on /var partition</li> <li>1.1.4.1 Ensure separate partition exists for /var/tmp</li> <li>1.1.4.2 Ensure noexec option set on /var/tmp partition</li> <li>1.1.4.3 Ensure nosuid option set on /var/tmp partition</li> <li>1.1.4.4 Ensure nodev option set on /var/tmp partition</li> <li>1.1.5.1 Ensure separate partition exists for /var/log</li> <li>1.1.5.2 Ensure nodev option set on /var/log partition</li> <li>1.1.5.3 Ensure noexec option set on /var/log partition</li> <li>1.1.5.4 Ensure nosuid option set on /var/log partition</li> <li>1.1.6.1 Ensure separate partition exists for /var/log/audit</li> <li>1.1.6.2 Ensure noexec option set on /var/log/audit partition</li> <li>1.1.6.3 Ensure nodev option set on /var/log/audit partition</li> <li>1.1.6.4 Ensure nosuid option set on /var/log/audit partition</li> <li>1.1.7.1 Ensure separate partition exists for /home</li> <li>1.1.7.2 Ensure nodev option set on /home partition</li> <li>1.1.7.3 Ensure nosuid option set on /home partition</li> <li>1.1.8.1 Ensure nodev option set on /dev/shm partition</li> <li>1.1.8.2 Ensure noexec option set on /dev/shm partition</li> <li>1.1.8.3 Ensure nosuid option set on /dev/shm partition</li> </ul>"},{"location":"tags/#filesystem-integrity-checking","title":"Filesystem Integrity Checking","text":"<ul> <li>1.3.1 Ensure AIDE is installed</li> <li>1.3.2 Ensure filesystem integrity is regularly checked</li> </ul>"},{"location":"tags/#firewall-configuration","title":"Firewall Configuration","text":"<ul> <li>3.5.1.1 Ensure ufw is installed</li> <li>3.5.1.2 Ensure iptables-persistent is not installed with ufw</li> <li>3.5.1.3 Ensure ufw service is enabled</li> <li>3.5.1.4 Ensure ufw loopback traffic is configured</li> <li>3.5.1.5 Ensure ufw outbound connections are configured</li> <li>3.5.1.6 Ensure ufw firewall rules exist for all open ports</li> <li>3.5.1.7 Ensure ufw default deny firewall policy</li> <li>3.5.2.1 Ensure nftables is installed</li> <li>3.5.2.10 Ensure nftables rules are permanent</li> <li>3.5.2.2 Ensure ufw is uninstalled or disabled with nftables</li> <li>3.5.2.3 Ensure iptables are flushed with nftables</li> <li>3.5.2.4 Ensure a nftables table exists</li> <li>3.5.2.5 Ensure nftables base chains exist</li> <li>3.5.2.6 Ensure nftables loopback traffic is configured</li> <li>3.5.2.7 Ensure nftables outbound and established connections are configured</li> <li>3.5.2.8 Ensure nftables default deny firewall policy</li> <li>3.5.2.9 Ensure nftables service is enabled</li> <li>3.5.3.1.1 Ensure iptables packages are installed</li> <li>3.5.3.1.2 Ensure nftables is not installed with iptables</li> <li>3.5.3.1.3 Ensure ufw is uninstalled or disabled with iptables</li> <li>3.5.3.2.1 Ensure iptables default deny firewall policy</li> <li>3.5.3.2.2 Ensure iptables loopback traffic is configured</li> <li>3.5.3.2.4 Ensure iptables firewall rules exist for all open ports</li> <li>3.5.3.3.1 Ensure ip6tables default deny firewall policy</li> <li>3.5.3.3.2 Ensure ip6tables loopback traffic is configured</li> <li>3.5.3.3.3 Ensure ip6tables outbound and established connections are configured</li> <li>3.5.3.3.4 Ensure ip6tables firewall rules exist for all open ports</li> </ul>"},{"location":"tags/#gnome-display-manager","title":"GNOME Display Manager","text":"<ul> <li>1.8.1 Ensure GNOME Display Manager is removed</li> <li>1.8.10 Ensure XDCMP is not enabled</li> <li>1.8.2 Ensure GDM login banner is configured</li> <li>1.8.3 Ensure GDM disable-user-list option is enabled</li> <li>1.8.4 Ensure GDM screen locks when the user is idle</li> <li>1.8.5 Ensure GDM screen locks cannot be overridden</li> <li>1.8.6 Ensure GDM automatic mounting of removable media is disabled</li> <li>1.8.7 Ensure GDM disabling automatic mounting of removable media is not overridden</li> <li>1.8.8 Ensure GDM autorun-never is enabled</li> <li>1.8.9 Ensure GDM autorun-never is not overridden</li> </ul>"},{"location":"tags/#ig1","title":"IG1","text":"<ul> <li>1.9 Ensure updates, patches, and additional security software are installed</li> <li>1.1.9 Disable Automounting</li> <li>1.1.2.1 Ensure /tmp is a separate partition</li> <li>1.1.2.2 Ensure nodev option set on /tmp partition</li> <li>1.1.2.3 Ensure noexec option set on /tmp partition</li> <li>1.1.2.4 Ensure nosuid option set on /tmp partition</li> <li>1.1.3.1 Ensure separate partition exists for /var</li> <li>1.1.3.2 Ensure nodev option set on /var partition</li> <li>1.1.3.3 Ensure nosuid option set on /var partition</li> <li>1.1.4.1 Ensure separate partition exists for /var/tmp</li> <li>1.1.4.2 Ensure noexec option set on /var/tmp partition</li> <li>1.1.4.3 Ensure nosuid option set on /var/tmp partition</li> <li>1.1.4.4 Ensure nodev option set on /var/tmp partition</li> <li>1.1.5.1 Ensure separate partition exists for /var/log</li> <li>1.1.5.2 Ensure nodev option set on /var/log partition</li> <li>1.1.5.3 Ensure noexec option set on /var/log partition</li> <li>1.1.5.4 Ensure nosuid option set on /var/log partition</li> <li>1.1.6.1 Ensure separate partition exists for /var/log/audit</li> <li>1.1.6.2 Ensure noexec option set on /var/log/audit partition</li> <li>1.1.6.3 Ensure nodev option set on /var/log/audit partition</li> <li>1.1.6.4 Ensure nosuid option set on /var/log/audit partition</li> <li>1.1.7.1 Ensure separate partition exists for /home</li> <li>1.1.7.2 Ensure nodev option set on /home partition</li> <li>1.1.7.3 Ensure nosuid option set on /home partition</li> <li>1.1.8.1 Ensure nodev option set on /dev/shm partition</li> <li>1.1.8.2 Ensure noexec option set on /dev/shm partition</li> <li>1.1.8.3 Ensure nosuid option set on /dev/shm partition</li> <li>1.2.1 Ensure package manager repositories are configured</li> <li>1.2.2 Ensure GPG keys are configured</li> <li>1.4.1 Ensure bootloader password is set</li> <li>1.4.2 Ensure permissions on bootloader config are configured</li> <li>1.4.3 Ensure authentication required for single user mode</li> <li>1.6.1.1 Ensure AppArmor is installed</li> <li>1.6.1.2 Ensure AppArmor is enabled in the bootloader configuration</li> <li>1.6.1.3 Ensure all AppArmor Profiles are in enforce or complain mode</li> <li>1.6.1.4 Ensure all AppArmor Profiles are enforcing</li> <li>1.7.4 Ensure permissions on /etc/motd are configured</li> <li>1.7.5 Ensure permissions on /etc/issue are configured</li> <li>1.7.6 Ensure permissions on /etc/issue.net are configured</li> <li>1.8.4 Ensure GDM screen locks when the user is idle</li> <li>1.8.5 Ensure GDM screen locks cannot be overridden</li> <li>1.8.6 Ensure GDM automatic mounting of removable media is disabled</li> <li>1.8.8 Ensure GDM autorun-never is enabled</li> <li>1.8.9 Ensure GDM autorun-never is not overridden</li> <li>3.5.1.1 Ensure ufw is installed</li> <li>3.5.1.2 Ensure iptables-persistent is not installed with ufw</li> <li>3.5.1.3 Ensure ufw service is enabled</li> <li>3.5.1.4 Ensure ufw loopback traffic is configured</li> <li>3.5.1.5 Ensure ufw outbound connections are configured</li> <li>3.5.1.6 Ensure ufw firewall rules exist for all open ports</li> <li>3.5.1.7 Ensure ufw default deny firewall policy</li> <li>3.5.2.1 Ensure nftables is installed</li> <li>3.5.2.10 Ensure nftables rules are permanent</li> <li>3.5.2.2 Ensure ufw is uninstalled or disabled with nftables</li> <li>3.5.2.3 Ensure iptables are flushed with nftables</li> <li>3.5.2.4 Ensure a nftables table exists</li> <li>3.5.2.5 Ensure nftables base chains exist</li> <li>3.5.2.6 Ensure nftables loopback traffic is configured</li> <li>3.5.2.7 Ensure nftables outbound and established connections are configured</li> <li>3.5.2.8 Ensure nftables default deny firewall policy</li> <li>3.5.2.9 Ensure nftables service is enabled</li> <li>3.5.3.1.1 Ensure iptables packages are installed</li> <li>3.5.3.1.2 Ensure nftables is not installed with iptables</li> <li>3.5.3.1.3 Ensure ufw is uninstalled or disabled with iptables</li> <li>3.5.3.2.1 Ensure iptables default deny firewall policy</li> <li>3.5.3.2.2 Ensure iptables loopback traffic is configured</li> <li>3.5.3.2.4 Ensure iptables firewall rules exist for all open ports</li> <li>3.5.3.3.1 Ensure ip6tables default deny firewall policy</li> <li>3.5.3.3.2 Ensure ip6tables loopback traffic is configured</li> <li>3.5.3.3.3 Ensure ip6tables outbound and established connections are configured</li> <li>3.5.3.3.4 Ensure ip6tables firewall rules exist for all open ports</li> <li>4.1.1.2 Ensure auditd service is enabled and active</li> <li>4.1.1.3 Ensure auditing for processes that start prior to auditd is enabled</li> <li>4.1.1.4 Ensure audit_backlog_limit is sufficient</li> <li>4.1.2.1 Ensure audit log storage size is configured</li> <li>4.1.2.2 Ensure audit logs are not automatically deleted</li> <li>4.1.2.3 Ensure system is disabled when audit logs are full</li> <li>4.1.3.15 Ensure successful and unsuccessful attempts to use the chcon command are recorded</li> <li>4.1.3.16 Ensure successful and unsuccessful attempts to use the setfacl command are recorded</li> <li>4.1.3.17 Ensure successful and unsuccessful attempts to use the chacl command are recorde</li> <li>4.1.3.18 Ensure successful and unsuccessful attempts to use the usermod command are recorded</li> <li>4.1.3.20 Ensure the audit configuration is immutable</li> <li>4.1.4.1 Ensure audit log files are mode 0640 or less permissive</li> <li>4.1.4.10 Ensure audit tools belong to group root</li> <li>4.1.4.11 Ensure cryptographic mechanisms are used to protect the integrity of audit tool</li> <li>4.1.4.2 Ensure only authorized users own audit log files</li> <li>4.1.4.3 Ensure only authorized groups are assigned ownership of audit log files</li> <li>4.1.4.4 Ensure the audit log directory is 0750 or more restrictive</li> <li>4.1.4.5 Ensure audit configuration files are 640 or more restrictive</li> <li>4.1.4.6 Ensure audit configuration files are owned by root</li> <li>4.1.4.7 Ensure audit configuration files belong to group root</li> <li>4.1.4.8 Ensure audit tools are 755 or more restrictive</li> <li>4.1.4.9 Ensure audit tools are owned by root</li> <li>4.2.3 Ensure all logfiles have appropriate permissions and ownership</li> <li>4.2.1.2 Ensure journald service is enabled</li> <li>4.2.1.3 Ensure journald is configured to compress large log files</li> <li>4.2.1.4 Ensure journald is configured to write logfiles to persistent disk</li> <li>4.2.1.5 Ensure journald is not configured to send logs to rsyslog</li> <li>4.2.1.6 Ensure journald log rotation is configured per site policy</li> <li>4.2.1.7 Ensure journald default file permissions configured</li> <li>4.2.1.1.1 Ensure systemd-journal-remote is installed</li> <li>4.2.1.1.2 Ensure systemd-journal-remote is configured</li> <li>4.2.1.1.3 Ensure systemd-journal-remote is enabled</li> <li>4.2.1.1.4 Ensure journald is not configured to recieve logs from a remote client</li> <li>4.2.2.1 Ensure rsyslog is installed</li> <li>4.2.2.2 Ensure rsyslog service is enabled</li> <li>4.2.2.3 Ensure journald is configured to send logs to rsyslog</li> <li>4.2.2.4 Ensure rsyslog default file permissions are configured</li> <li>4.2.2.5 Ensure logging is configured</li> <li>4.2.2.6 Ensure rsyslog is configured to send logs to a remote log host</li> <li>4.2.2.7 Ensure rsyslog is not configured to receive logs from a remote client</li> <li>5.1.2 Ensure permissions on /etc/crontab are configured</li> <li>5.1.3 Ensure permissions on /etc/cron.hourly are configured</li> <li>5.1.4 Ensure permissions on /etc/cron.daily are configured</li> <li>5.1.5 Ensure permissions on /etc/cron.weekly are configured</li> <li>5.1.6 Ensure permissions on /etc/cron.monthly are configured</li> <li>5.1.7 Ensure permissions on /etc/cron.d are configured</li> <li>5.1.8 Ensure cron is restricted to authorized users</li> <li>5.1.9 Ensure at is restricted to authorized users</li> <li>5.2.1 Ensure permissions on /etc/ssh/sshd_config are configured</li> <li>5.2.10 Ensure SSH PermitUserEnvironment is disabled</li> <li>5.2.11 Ensure SSH IgnoreRhosts is enabled</li> <li>5.2.16 Ensure SSH AllowTcpForwarding is disabled</li> <li>5.2.17 Ensure SSH warning banner is configured</li> <li>5.2.2 Ensure permissions on SSH private host key files are configured</li> <li>5.2.21 Ensure SSH LoginGraceTime is set to one minute or less</li> <li>5.2.3 Ensure permissions on SSH public host key files are configured</li> <li>5.2.4 Ensure SSH access is limited</li> <li>5.2.5 Ensure SSH LogLevel is appropriate</li> <li>5.2.6 Ensure SSH PAM is enabled</li> <li>5.2.7 Ensure SSH root login is disabled</li> <li>5.2.8 Ensure SSH HostbasedAuthentication is disabled</li> <li>5.2.9 Ensure SSH PermitEmptyPasswords is disabled</li> <li>5.3.1 Ensure sudo is installed</li> <li>5.3.2 Ensure sudo commands use pty</li> <li>5.3.4 Ensure users must provide password for privilege escalation</li> <li>5.3.5 Ensure re-authentication for privilege escalation is not disabled globally</li> <li>5.3.6 Ensure sudo authentication timeout is configured correctly</li> <li>5.3.7 Ensure access to the su command is restricted</li> <li>5.4.1 Ensure password creation requirements are configured</li> <li>5.4.2 Ensure lockout for failed password attempts is configured</li> <li>5.4.3 Ensure password reuse is limited</li> <li>5.5.2 Ensure system accounts are secured</li> <li>5.5.3 Ensure default group for the root account is GID 0</li> <li>5.5.4 Ensure default user umask is 027 or more restrictive</li> <li>5.5.5 Ensure default user shell timeout is 900 seconds or less</li> <li>5.5.1.1 Ensure minimum days between password changes is configured</li> <li>5.5.1.2 Ensure password expiration is 365 days or less</li> <li>5.5.1.3 Ensure password expiration warning days is 7 or more</li> <li>5.5.1.4 Ensure inactive password lock is 30 days or less</li> <li>5.5.1.5 Ensure all users last password change date is in the past</li> <li>6.1.1 Ensure permissions on /etc/passwd are configured</li> <li>6.1.10 Ensure no unowned files or directories exist</li> <li>6.1.11 Ensure no ungrouped files or directories exist</li> <li>6.1.12 Audit SUID executables</li> <li>6.1.13 Audit SGID executables</li> <li>6.1.2 Ensure permissions on /etc/passwd- are configured</li> <li>6.1.3 Ensure permissions on /etc/group are configured</li> <li>6.1.4 Ensure permissions on /etc/group- are configured</li> <li>6.1.5 Ensure permissions on /etc/shadow are configured</li> <li>6.1.6 Ensure permissions on /etc/shadow- are configured</li> <li>6.1.7 Ensure permissions on /etc/gshadow are configured</li> <li>E6.1.8 Ensure permissions on /etc/gshadow- are configured</li> <li>6.1.9 Ensure no world writable files exist</li> <li>6.2.11 Ensure local interactive user home directories exist</li> <li>6.2.12 Ensure local interactive users own their home directories</li> <li>6.2.13 Ensure local interactive user home directories are mode 750 or more restrictive</li> <li>6.2.14 Ensure no local interactive user has .netrc files</li> <li>6.2.15 Ensure no local interactive user has .forward files</li> <li>6.2.16 Ensue no local interactive user has .rhosts files</li> <li>6.2.17 Ensure local interactive user dot files are not group or world writable</li> <li>6.2.2 Ensure /etc/shadow password fields are not empty</li> <li>6.2.4 Ensure shadow group is empty</li> <li>6.2.5 Ensure no duplicate UIDs exist</li> </ul>"},{"location":"tags/#ig2","title":"IG2","text":"<ul> <li>1.9 Ensure updates, patches, and additional security software are installed</li> <li>1.1.10 Disable USB Storage</li> <li>1.1.9 Disable Automounting</li> <li>1.1.1.1 Ensure mounting of cramfs filesystems is disabled</li> <li>1.1.1.2 Ensure mounting of squashfs filesystems is disabled</li> <li>1.1.1.3 Ensure mounting of udf filesystems is disabled</li> <li>1.1.2.1 Ensure /tmp is a separate partition</li> <li>1.1.2.2 Ensure nodev option set on /tmp partition</li> <li>1.1.2.3 Ensure noexec option set on /tmp partition</li> <li>1.1.2.4 Ensure nosuid option set on /tmp partition</li> <li>1.1.3.1 Ensure separate partition exists for /var</li> <li>1.1.3.2 Ensure nodev option set on /var partition</li> <li>1.1.3.3 Ensure nosuid option set on /var partition</li> <li>1.1.4.1 Ensure separate partition exists for /var/tmp</li> <li>1.1.4.2 Ensure noexec option set on /var/tmp partition</li> <li>1.1.4.3 Ensure nosuid option set on /var/tmp partition</li> <li>1.1.4.4 Ensure nodev option set on /var/tmp partition</li> <li>1.1.5.1 Ensure separate partition exists for /var/log</li> <li>1.1.5.2 Ensure nodev option set on /var/log partition</li> <li>1.1.5.3 Ensure noexec option set on /var/log partition</li> <li>1.1.5.4 Ensure nosuid option set on /var/log partition</li> <li>1.1.6.1 Ensure separate partition exists for /var/log/audit</li> <li>1.1.6.2 Ensure noexec option set on /var/log/audit partition</li> <li>1.1.6.3 Ensure nodev option set on /var/log/audit partition</li> <li>1.1.6.4 Ensure nosuid option set on /var/log/audit partition</li> <li>1.1.7.1 Ensure separate partition exists for /home</li> <li>1.1.7.2 Ensure nodev option set on /home partition</li> <li>1.1.7.3 Ensure nosuid option set on /home partition</li> <li>1.1.8.1 Ensure nodev option set on /dev/shm partition</li> <li>1.1.8.2 Ensure noexec option set on /dev/shm partition</li> <li>1.1.8.3 Ensure nosuid option set on /dev/shm partition</li> <li>1.2.1 Ensure package manager repositories are configured</li> <li>1.2.2 Ensure GPG keys are configured</li> <li>1.3.2 Ensure filesystem integrity is regularly checked</li> <li>1.4.1 Ensure bootloader password is set</li> <li>1.4.2 Ensure permissions on bootloader config are configured</li> <li>1.4.3 Ensure authentication required for single user mode</li> <li>1.5.1 Ensure address space layout randomization (ASLR) is enabled</li> <li>1.5.3 Ensure Automatic Error Reporting is not enabled</li> <li>1.5.4 Ensure core dumps are restricted</li> <li>1.6.1.1 Ensure AppArmor is installed</li> <li>1.6.1.2 Ensure AppArmor is enabled in the bootloader configuration</li> <li>1.6.1.3 Ensure all AppArmor Profiles are in enforce or complain mode</li> <li>1.6.1.4 Ensure all AppArmor Profiles are enforcing</li> <li>1.7.4 Ensure permissions on /etc/motd are configured</li> <li>1.7.5 Ensure permissions on /etc/issue are configured</li> <li>1.7.6 Ensure permissions on /etc/issue.net are configured</li> <li>1.8.1 Ensure GNOME Display Manager is removed</li> <li>1.8.10 Ensure XDCMP is not enabled</li> <li>1.8.4 Ensure GDM screen locks when the user is idle</li> <li>1.8.5 Ensure GDM screen locks cannot be overridden</li> <li>1.8.6 Ensure GDM automatic mounting of removable media is disabled</li> <li>1.8.8 Ensure GDM autorun-never is enabled</li> <li>1.8.9 Ensure GDM autorun-never is not overridden</li> <li>2.4 Ensure nonessential services are removed or masked</li> <li>2.1.1.1 Ensure a single time synchronization daemon is in use</li> <li>2.1.2.1 Ensure chrony is configured with authorized timeserver</li> <li>2.1.2.2 Ensure chrony is running as user _chrony</li> <li>2.1.2.3 Ensure chrony is enabled and running</li> <li>2.1.3.1 Ensure systemd-timesyncd configured with authorized timeserver</li> <li>2.1.3.2 Ensure systemd-timesyncd is enabled and running</li> <li>2.1.4.1 Ensure ntp access control is configured</li> <li>2.1.4.2 Ensure ntp is configured with authorized timeserver</li> <li>2.1.4.3 Ensure ntp is running as user ntp</li> <li>Ensure mounting of cramfs filesystems is disabled</li> <li>2.2.1 Ensure X Window System is not installed</li> <li>2.2.10 Ensure IMAP and POP3 server are not installed</li> <li>2.2.11 Ensure Samba is not installed</li> <li>2.2.12 Ensure HTTP Proxy Server is not installed</li> <li>2.2.13 Ensure SNMP Server is not installed</li> <li>2.2.14 Ensure NIS Server is not installed</li> <li>2.2.15 Ensure mail transfer agent is configured for local-only mode</li> <li>2.2.16 Ensure rsync service is either not installed or masked</li> <li>2.2.2 Ensure Avahi Server is not installed</li> <li>2.2.3 Ensure CUPS is not installed</li> <li>2.2.4 Ensure DHCP Server is not installed</li> <li>2.2.5 Ensure LDAP server is not installed</li> <li>2.2.6 Ensure NFS is not installed</li> <li>2.2.7 Ensure DNS Server is not installed</li> <li>2.2.8 Ensure FTP Server is not installed</li> <li>2.2.9 Ensure HTTP server is not installed</li> <li>2.3.1 Ensure NIS Client is not installed</li> <li>2.3.2 Ensure rsh client is not installed</li> <li>2.3.3 Ensure talk client is not installed</li> <li>2.3.4 Ensure telnet client is not installed</li> <li>2.3.5 Ensure LDAP client is not installed</li> <li>2.3.6 Ensure RPC is not installed</li> <li>3.1.1 Ensure system is checked to determine if IPv6 is enabled</li> <li>3.1.2 Ensure wireless interfaces are disabled</li> <li>3.1.3 Ensure DCCP is disabled</li> <li>3.1.4 Ensure SCTP is disabled</li> <li>3.1.5 Ensure RDS is disabled</li> <li>3.1.6 Ensure TIPC is disabled</li> <li>3.2.1 Ensure packet redirect sending is disabled</li> <li>3.2.2 Ensure IP forwarding is disabled</li> <li>3.3.1 Ensure source routed packets are not accepted</li> <li>3.3.2 Ensure ICMP redirects are not accepted</li> <li>3.3.3 Ensure secure ICMP redirects are not accepted</li> <li>3.3.4 Ensure suspicious packets are logged</li> <li>3.3.5 Ensure broadcast ICMP requests are ignored</li> <li>3.3.6 Ensure bogus ICMP responses are ignored</li> <li>3.3.7 Ensure Reverse Path Filtering is enabled</li> <li>3.3.8 Ensure TCP SYN Cookies is enabled</li> <li>3.3.9 Ensure IPv6 router advertisements are not accepted</li> <li>3.5.1.1 Ensure ufw is installed</li> <li>3.5.1.2 Ensure iptables-persistent is not installed with ufw</li> <li>3.5.1.3 Ensure ufw service is enabled</li> <li>3.5.1.4 Ensure ufw loopback traffic is configured</li> <li>3.5.1.5 Ensure ufw outbound connections are configured</li> <li>3.5.1.6 Ensure ufw firewall rules exist for all open ports</li> <li>3.5.1.7 Ensure ufw default deny firewall policy</li> <li>3.5.2.1 Ensure nftables is installed</li> <li>3.5.2.10 Ensure nftables rules are permanent</li> <li>3.5.2.2 Ensure ufw is uninstalled or disabled with nftables</li> <li>3.5.2.3 Ensure iptables are flushed with nftables</li> <li>3.5.2.4 Ensure a nftables table exists</li> <li>3.5.2.5 Ensure nftables base chains exist</li> <li>3.5.2.6 Ensure nftables loopback traffic is configured</li> <li>3.5.2.7 Ensure nftables outbound and established connections are configured</li> <li>3.5.2.8 Ensure nftables default deny firewall policy</li> <li>3.5.2.9 Ensure nftables service is enabled</li> <li>3.5.3.1.1 Ensure iptables packages are installed</li> <li>3.5.3.1.2 Ensure nftables is not installed with iptables</li> <li>3.5.3.1.3 Ensure ufw is uninstalled or disabled with iptables</li> <li>3.5.3.2.1 Ensure iptables default deny firewall policy</li> <li>3.5.3.2.2 Ensure iptables loopback traffic is configured</li> <li>3.5.3.2.4 Ensure iptables firewall rules exist for all open ports</li> <li>3.5.3.3.1 Ensure ip6tables default deny firewall policy</li> <li>3.5.3.3.2 Ensure ip6tables loopback traffic is configured</li> <li>3.5.3.3.3 Ensure ip6tables outbound and established connections are configured</li> <li>3.5.3.3.4 Ensure ip6tables firewall rules exist for all open ports</li> <li>4.1.1.1 Ensure auditd is installed</li> <li>4.1.1.2 Ensure auditd service is enabled and active</li> <li>4.1.1.3 Ensure auditing for processes that start prior to auditd is enabled</li> <li>4.1.1.4 Ensure audit_backlog_limit is sufficient</li> <li>4.1.2.1 Ensure audit log storage size is configured</li> <li>4.1.2.2 Ensure audit logs are not automatically deleted</li> <li>4.1.2.3 Ensure system is disabled when audit logs are full</li> <li>4.1.3.1 Ensure changes to system administration scope (sudoers) is collected</li> <li>4.1.3.10 Ensure successful file system mounts are collected</li> <li>4.1.3.11 Ensure session initiation information is collected</li> <li>4.1.3.12 Ensure login and logout events are collected</li> <li>4.1.3.13 Ensure file deletion events by users are collected</li> <li>4.1.3.14 Ensure events that modify the system's Mandatory Access Controls are collected</li> <li>4.1.3.15 Ensure successful and unsuccessful attempts to use the chcon command are recorded</li> <li>4.1.3.16 Ensure successful and unsuccessful attempts to use the setfacl command are recorded</li> <li>4.1.3.17 Ensure successful and unsuccessful attempts to use the chacl command are recorde</li> <li>4.1.3.18 Ensure successful and unsuccessful attempts to use the usermod command are recorded</li> <li>4.1.3.19 Ensure kernel module loading unloading and modification is collected</li> <li>4.1.3.2 Ensure actions as another user are always logged</li> <li>4.1.3.20 Ensure the audit configuration is immutable</li> <li>4.1.3.21 Ensure the running and on disk configuration is the same</li> <li>4.1.3.3 Ensure events that modify the sudo log file are collected</li> <li>4.1.3.4 Ensure events that modify date and time information are collected</li> <li>4.1.3.5 Ensure events that modify the system's network environment are collected</li> <li>4.1.3.6 Ensure use of privileged commands are collected</li> <li>4.1.3.7 Ensure unsuccessful file access attempts are collected</li> <li>4.1.3.8 Ensure events that modify user/group information are collected</li> <li>4.1.3.9 Ensure discretionary access control permission modification events are collected</li> <li>4.1.4.1 Ensure audit log files are mode 0640 or less permissive</li> <li>4.1.4.10 Ensure audit tools belong to group root</li> <li>4.1.4.11 Ensure cryptographic mechanisms are used to protect the integrity of audit tool</li> <li>4.1.4.2 Ensure only authorized users own audit log files</li> <li>4.1.4.3 Ensure only authorized groups are assigned ownership of audit log files</li> <li>4.1.4.4 Ensure the audit log directory is 0750 or more restrictive</li> <li>4.1.4.5 Ensure audit configuration files are 640 or more restrictive</li> <li>4.1.4.6 Ensure audit configuration files are owned by root</li> <li>4.1.4.7 Ensure audit configuration files belong to group root</li> <li>4.1.4.8 Ensure audit tools are 755 or more restrictive</li> <li>4.1.4.9 Ensure audit tools are owned by root</li> <li>4.2.3 Ensure all logfiles have appropriate permissions and ownership</li> <li>4.2.1.2 Ensure journald service is enabled</li> <li>4.2.1.3 Ensure journald is configured to compress large log files</li> <li>4.2.1.4 Ensure journald is configured to write logfiles to persistent disk</li> <li>4.2.1.5 Ensure journald is not configured to send logs to rsyslog</li> <li>4.2.1.6 Ensure journald log rotation is configured per site policy</li> <li>4.2.1.7 Ensure journald default file permissions configured</li> <li>4.2.1.1.1 Ensure systemd-journal-remote is installed</li> <li>4.2.1.1.2 Ensure systemd-journal-remote is configured</li> <li>4.2.1.1.3 Ensure systemd-journal-remote is enabled</li> <li>4.2.1.1.4 Ensure journald is not configured to recieve logs from a remote client</li> <li>4.2.2.1 Ensure rsyslog is installed</li> <li>4.2.2.2 Ensure rsyslog service is enabled</li> <li>4.2.2.3 Ensure journald is configured to send logs to rsyslog</li> <li>4.2.2.4 Ensure rsyslog default file permissions are configured</li> <li>4.2.2.5 Ensure logging is configured</li> <li>4.2.2.6 Ensure rsyslog is configured to send logs to a remote log host</li> <li>4.2.2.7 Ensure rsyslog is not configured to receive logs from a remote client</li> <li>5.1.2 Ensure permissions on /etc/crontab are configured</li> <li>5.1.3 Ensure permissions on /etc/cron.hourly are configured</li> <li>5.1.4 Ensure permissions on /etc/cron.daily are configured</li> <li>5.1.5 Ensure permissions on /etc/cron.weekly are configured</li> <li>5.1.6 Ensure permissions on /etc/cron.monthly are configured</li> <li>5.1.7 Ensure permissions on /etc/cron.d are configured</li> <li>5.1.8 Ensure cron is restricted to authorized users</li> <li>5.1.9 Ensure at is restricted to authorized users</li> <li>5.2.1 Ensure permissions on /etc/ssh/sshd_config are configured</li> <li>5.2.10 Ensure SSH PermitUserEnvironment is disabled</li> <li>5.2.11 Ensure SSH IgnoreRhosts is enabled</li> <li>5.2.12 Ensure SSH X11 forwarding is disabled</li> <li>5.2.13 Ensure only strong Ciphers are used</li> <li>5.2.14 Ensure only strong MAC algorithms are used</li> <li>5.2.15 Ensure only strong Key Exchange algorithms are used</li> <li>5.2.16 Ensure SSH AllowTcpForwarding is disabled</li> <li>5.2.17 Ensure SSH warning banner is configured</li> <li>5.2.18 Ensure SSH MaxAuthTries is set to 4 or less</li> <li>5.2.19 Ensure SSH MaxStartups is configured</li> <li>5.2.2 Ensure permissions on SSH private host key files are configured</li> <li>5.2.21 Ensure SSH LoginGraceTime is set to one minute or less</li> <li>5.2.3 Ensure permissions on SSH public host key files are configured</li> <li>5.2.4 Ensure SSH access is limited</li> <li>5.2.5 Ensure SSH LogLevel is appropriate</li> <li>5.2.6 Ensure SSH PAM is enabled</li> <li>5.2.7 Ensure SSH root login is disabled</li> <li>5.2.8 Ensure SSH HostbasedAuthentication is disabled</li> <li>5.2.9 Ensure SSH PermitEmptyPasswords is disabled</li> <li>5.3.1 Ensure sudo is installed</li> <li>5.3.2 Ensure sudo commands use pty</li> <li>5.3.3 Ensure sudo log file exists</li> <li>5.3.4 Ensure users must provide password for privilege escalation</li> <li>5.3.5 Ensure re-authentication for privilege escalation is not disabled globally</li> <li>5.3.6 Ensure sudo authentication timeout is configured correctly</li> <li>5.3.7 Ensure access to the su command is restricted</li> <li>5.4.1 Ensure password creation requirements are configured</li> <li>5.4.2 Ensure lockout for failed password attempts is configured</li> <li>5.4.3 Ensure password reuse is limited</li> <li>5.4.4 Ensure password hashing algorithm is up to date with the latest standards</li> <li>5.5.2 Ensure system accounts are secured</li> <li>5.5.3 Ensure default group for the root account is GID 0</li> <li>5.5.4 Ensure default user umask is 027 or more restrictive</li> <li>5.5.5 Ensure default user shell timeout is 900 seconds or less</li> <li>5.5.1.1 Ensure minimum days between password changes is configured</li> <li>5.5.1.2 Ensure password expiration is 365 days or less</li> <li>5.5.1.3 Ensure password expiration warning days is 7 or more</li> <li>5.5.1.4 Ensure inactive password lock is 30 days or less</li> <li>5.5.1.5 Ensure all users last password change date is in the past</li> <li>6.1.1 Ensure permissions on /etc/passwd are configured</li> <li>6.1.10 Ensure no unowned files or directories exist</li> <li>6.1.11 Ensure no ungrouped files or directories exist</li> <li>6.1.12 Audit SUID executables</li> <li>6.1.13 Audit SGID executables</li> <li>6.1.2 Ensure permissions on /etc/passwd- are configured</li> <li>6.1.3 Ensure permissions on /etc/group are configured</li> <li>6.1.4 Ensure permissions on /etc/group- are configured</li> <li>6.1.5 Ensure permissions on /etc/shadow are configured</li> <li>6.1.6 Ensure permissions on /etc/shadow- are configured</li> <li>6.1.7 Ensure permissions on /etc/gshadow are configured</li> <li>E6.1.8 Ensure permissions on /etc/gshadow- are configured</li> <li>6.1.9 Ensure no world writable files exist</li> <li>6.2.1 Ensure accounts in /etc/passwd use shadowed passwords</li> <li>6.2.11 Ensure local interactive user home directories exist</li> <li>6.2.12 Ensure local interactive users own their home directories</li> <li>6.2.13 Ensure local interactive user home directories are mode 750 or more restrictive</li> <li>6.2.14 Ensure no local interactive user has .netrc files</li> <li>6.2.15 Ensure no local interactive user has .forward files</li> <li>6.2.16 Ensue no local interactive user has .rhosts files</li> <li>6.2.17 Ensure local interactive user dot files are not group or world writable</li> <li>6.2.2 Ensure /etc/shadow password fields are not empty</li> <li>6.2.4 Ensure shadow group is empty</li> <li>6.2.5 Ensure no duplicate UIDs exist</li> </ul>"},{"location":"tags/#ig3","title":"IG3","text":"<ul> <li>1.9 Ensure updates, patches, and additional security software are installed</li> <li>1.1.10 Disable USB Storage</li> <li>1.1.9 Disable Automounting</li> <li>1.1.1.1 Ensure mounting of cramfs filesystems is disabled</li> <li>1.1.1.2 Ensure mounting of squashfs filesystems is disabled</li> <li>1.1.1.3 Ensure mounting of udf filesystems is disabled</li> <li>1.1.2.1 Ensure /tmp is a separate partition</li> <li>1.1.2.2 Ensure nodev option set on /tmp partition</li> <li>1.1.2.3 Ensure noexec option set on /tmp partition</li> <li>1.1.2.4 Ensure nosuid option set on /tmp partition</li> <li>1.1.3.1 Ensure separate partition exists for /var</li> <li>1.1.3.2 Ensure nodev option set on /var partition</li> <li>1.1.3.3 Ensure nosuid option set on /var partition</li> <li>1.1.4.1 Ensure separate partition exists for /var/tmp</li> <li>1.1.4.2 Ensure noexec option set on /var/tmp partition</li> <li>1.1.4.3 Ensure nosuid option set on /var/tmp partition</li> <li>1.1.4.4 Ensure nodev option set on /var/tmp partition</li> <li>1.1.5.1 Ensure separate partition exists for /var/log</li> <li>1.1.5.2 Ensure nodev option set on /var/log partition</li> <li>1.1.5.3 Ensure noexec option set on /var/log partition</li> <li>1.1.5.4 Ensure nosuid option set on /var/log partition</li> <li>1.1.6.1 Ensure separate partition exists for /var/log/audit</li> <li>1.1.6.2 Ensure noexec option set on /var/log/audit partition</li> <li>1.1.6.3 Ensure nodev option set on /var/log/audit partition</li> <li>1.1.6.4 Ensure nosuid option set on /var/log/audit partition</li> <li>1.1.7.1 Ensure separate partition exists for /home</li> <li>1.1.7.2 Ensure nodev option set on /home partition</li> <li>1.1.7.3 Ensure nosuid option set on /home partition</li> <li>1.1.8.1 Ensure nodev option set on /dev/shm partition</li> <li>1.1.8.2 Ensure noexec option set on /dev/shm partition</li> <li>1.1.8.3 Ensure nosuid option set on /dev/shm partition</li> <li>1.2.1 Ensure package manager repositories are configured</li> <li>1.2.2 Ensure GPG keys are configured</li> <li>1.3.1 Ensure AIDE is installed</li> <li>1.3.2 Ensure filesystem integrity is regularly checked</li> <li>1.4.1 Ensure bootloader password is set</li> <li>1.4.2 Ensure permissions on bootloader config are configured</li> <li>1.4.3 Ensure authentication required for single user mode</li> <li>1.5.1 Ensure address space layout randomization (ASLR) is enabled</li> <li>1.5.2 Ensure prelink is not installed</li> <li>1.5.3 Ensure Automatic Error Reporting is not enabled</li> <li>1.5.4 Ensure core dumps are restricted</li> <li>1.6.1.1 Ensure AppArmor is installed</li> <li>1.6.1.2 Ensure AppArmor is enabled in the bootloader configuration</li> <li>1.6.1.3 Ensure all AppArmor Profiles are in enforce or complain mode</li> <li>1.6.1.4 Ensure all AppArmor Profiles are enforcing</li> <li>1.7.4 Ensure permissions on /etc/motd are configured</li> <li>1.7.5 Ensure permissions on /etc/issue are configured</li> <li>1.7.6 Ensure permissions on /etc/issue.net are configured</li> <li>1.8.1 Ensure GNOME Display Manager is removed</li> <li>1.8.10 Ensure XDCMP is not enabled</li> <li>1.8.4 Ensure GDM screen locks when the user is idle</li> <li>1.8.5 Ensure GDM screen locks cannot be overridden</li> <li>1.8.6 Ensure GDM automatic mounting of removable media is disabled</li> <li>1.8.8 Ensure GDM autorun-never is enabled</li> <li>1.8.9 Ensure GDM autorun-never is not overridden</li> <li>2.4 Ensure nonessential services are removed or masked</li> <li>2.1.1.1 Ensure a single time synchronization daemon is in use</li> <li>2.1.2.1 Ensure chrony is configured with authorized timeserver</li> <li>2.1.2.2 Ensure chrony is running as user _chrony</li> <li>2.1.2.3 Ensure chrony is enabled and running</li> <li>2.1.3.1 Ensure systemd-timesyncd configured with authorized timeserver</li> <li>2.1.3.2 Ensure systemd-timesyncd is enabled and running</li> <li>2.1.4.1 Ensure ntp access control is configured</li> <li>2.1.4.2 Ensure ntp is configured with authorized timeserver</li> <li>2.1.4.3 Ensure ntp is running as user ntp</li> <li>Ensure mounting of cramfs filesystems is disabled</li> <li>2.2.1 Ensure X Window System is not installed</li> <li>2.2.10 Ensure IMAP and POP3 server are not installed</li> <li>2.2.11 Ensure Samba is not installed</li> <li>2.2.12 Ensure HTTP Proxy Server is not installed</li> <li>2.2.13 Ensure SNMP Server is not installed</li> <li>2.2.14 Ensure NIS Server is not installed</li> <li>2.2.15 Ensure mail transfer agent is configured for local-only mode</li> <li>2.2.16 Ensure rsync service is either not installed or masked</li> <li>2.2.2 Ensure Avahi Server is not installed</li> <li>2.2.3 Ensure CUPS is not installed</li> <li>2.2.4 Ensure DHCP Server is not installed</li> <li>2.2.5 Ensure LDAP server is not installed</li> <li>2.2.6 Ensure NFS is not installed</li> <li>2.2.7 Ensure DNS Server is not installed</li> <li>2.2.8 Ensure FTP Server is not installed</li> <li>2.2.9 Ensure HTTP server is not installed</li> <li>2.3.1 Ensure NIS Client is not installed</li> <li>2.3.2 Ensure rsh client is not installed</li> <li>2.3.3 Ensure talk client is not installed</li> <li>2.3.4 Ensure telnet client is not installed</li> <li>2.3.5 Ensure LDAP client is not installed</li> <li>2.3.6 Ensure RPC is not installed</li> <li>3.1.1 Ensure system is checked to determine if IPv6 is enabled</li> <li>3.1.2 Ensure wireless interfaces are disabled</li> <li>3.1.3 Ensure DCCP is disabled</li> <li>3.1.4 Ensure SCTP is disabled</li> <li>3.1.5 Ensure RDS is disabled</li> <li>3.1.6 Ensure TIPC is disabled</li> <li>3.2.1 Ensure packet redirect sending is disabled</li> <li>3.2.2 Ensure IP forwarding is disabled</li> <li>3.3.1 Ensure source routed packets are not accepted</li> <li>3.3.2 Ensure ICMP redirects are not accepted</li> <li>3.3.3 Ensure secure ICMP redirects are not accepted</li> <li>3.3.4 Ensure suspicious packets are logged</li> <li>3.3.5 Ensure broadcast ICMP requests are ignored</li> <li>3.3.6 Ensure bogus ICMP responses are ignored</li> <li>3.3.7 Ensure Reverse Path Filtering is enabled</li> <li>3.3.8 Ensure TCP SYN Cookies is enabled</li> <li>3.3.9 Ensure IPv6 router advertisements are not accepted</li> <li>3.5.1.1 Ensure ufw is installed</li> <li>3.5.1.2 Ensure iptables-persistent is not installed with ufw</li> <li>3.5.1.3 Ensure ufw service is enabled</li> <li>3.5.1.4 Ensure ufw loopback traffic is configured</li> <li>3.5.1.5 Ensure ufw outbound connections are configured</li> <li>3.5.1.6 Ensure ufw firewall rules exist for all open ports</li> <li>3.5.1.7 Ensure ufw default deny firewall policy</li> <li>3.5.2.1 Ensure nftables is installed</li> <li>3.5.2.10 Ensure nftables rules are permanent</li> <li>3.5.2.2 Ensure ufw is uninstalled or disabled with nftables</li> <li>3.5.2.3 Ensure iptables are flushed with nftables</li> <li>3.5.2.4 Ensure a nftables table exists</li> <li>3.5.2.5 Ensure nftables base chains exist</li> <li>3.5.2.6 Ensure nftables loopback traffic is configured</li> <li>3.5.2.7 Ensure nftables outbound and established connections are configured</li> <li>3.5.2.8 Ensure nftables default deny firewall policy</li> <li>3.5.2.9 Ensure nftables service is enabled</li> <li>3.5.3.1.1 Ensure iptables packages are installed</li> <li>3.5.3.1.2 Ensure nftables is not installed with iptables</li> <li>3.5.3.1.3 Ensure ufw is uninstalled or disabled with iptables</li> <li>3.5.3.2.1 Ensure iptables default deny firewall policy</li> <li>3.5.3.2.2 Ensure iptables loopback traffic is configured</li> <li>3.5.3.2.4 Ensure iptables firewall rules exist for all open ports</li> <li>3.5.3.3.1 Ensure ip6tables default deny firewall policy</li> <li>3.5.3.3.2 Ensure ip6tables loopback traffic is configured</li> <li>3.5.3.3.3 Ensure ip6tables outbound and established connections are configured</li> <li>3.5.3.3.4 Ensure ip6tables firewall rules exist for all open ports</li> <li>4.1.1.1 Ensure auditd is installed</li> <li>4.1.1.2 Ensure auditd service is enabled and active</li> <li>4.1.1.3 Ensure auditing for processes that start prior to auditd is enabled</li> <li>4.1.1.4 Ensure audit_backlog_limit is sufficient</li> <li>4.1.2.1 Ensure audit log storage size is configured</li> <li>4.1.2.2 Ensure audit logs are not automatically deleted</li> <li>4.1.2.3 Ensure system is disabled when audit logs are full</li> <li>4.1.3.1 Ensure changes to system administration scope (sudoers) is collected</li> <li>4.1.3.10 Ensure successful file system mounts are collected</li> <li>4.1.3.11 Ensure session initiation information is collected</li> <li>4.1.3.12 Ensure login and logout events are collected</li> <li>4.1.3.13 Ensure file deletion events by users are collected</li> <li>4.1.3.14 Ensure events that modify the system's Mandatory Access Controls are collected</li> <li>4.1.3.15 Ensure successful and unsuccessful attempts to use the chcon command are recorded</li> <li>4.1.3.16 Ensure successful and unsuccessful attempts to use the setfacl command are recorded</li> <li>4.1.3.17 Ensure successful and unsuccessful attempts to use the chacl command are recorde</li> <li>4.1.3.18 Ensure successful and unsuccessful attempts to use the usermod command are recorded</li> <li>4.1.3.19 Ensure kernel module loading unloading and modification is collected</li> <li>4.1.3.2 Ensure actions as another user are always logged</li> <li>4.1.3.20 Ensure the audit configuration is immutable</li> <li>4.1.3.21 Ensure the running and on disk configuration is the same</li> <li>4.1.3.3 Ensure events that modify the sudo log file are collected</li> <li>4.1.3.4 Ensure events that modify date and time information are collected</li> <li>4.1.3.5 Ensure events that modify the system's network environment are collected</li> <li>4.1.3.6 Ensure use of privileged commands are collected</li> <li>4.1.3.7 Ensure unsuccessful file access attempts are collected</li> <li>4.1.3.8 Ensure events that modify user/group information are collected</li> <li>4.1.3.9 Ensure discretionary access control permission modification events are collected</li> <li>4.1.4.1 Ensure audit log files are mode 0640 or less permissive</li> <li>4.1.4.10 Ensure audit tools belong to group root</li> <li>4.1.4.11 Ensure cryptographic mechanisms are used to protect the integrity of audit tool</li> <li>4.1.4.2 Ensure only authorized users own audit log files</li> <li>4.1.4.3 Ensure only authorized groups are assigned ownership of audit log files</li> <li>4.1.4.4 Ensure the audit log directory is 0750 or more restrictive</li> <li>4.1.4.5 Ensure audit configuration files are 640 or more restrictive</li> <li>4.1.4.6 Ensure audit configuration files are owned by root</li> <li>4.1.4.7 Ensure audit configuration files belong to group root</li> <li>4.1.4.8 Ensure audit tools are 755 or more restrictive</li> <li>4.1.4.9 Ensure audit tools are owned by root</li> <li>4.2.3 Ensure all logfiles have appropriate permissions and ownership</li> <li>4.2.1.2 Ensure journald service is enabled</li> <li>4.2.1.3 Ensure journald is configured to compress large log files</li> <li>4.2.1.4 Ensure journald is configured to write logfiles to persistent disk</li> <li>4.2.1.5 Ensure journald is not configured to send logs to rsyslog</li> <li>4.2.1.6 Ensure journald log rotation is configured per site policy</li> <li>4.2.1.7 Ensure journald default file permissions configured</li> <li>4.2.1.1.1 Ensure systemd-journal-remote is installed</li> <li>4.2.1.1.2 Ensure systemd-journal-remote is configured</li> <li>4.2.1.1.3 Ensure systemd-journal-remote is enabled</li> <li>4.2.1.1.4 Ensure journald is not configured to recieve logs from a remote client</li> <li>4.2.2.1 Ensure rsyslog is installed</li> <li>4.2.2.2 Ensure rsyslog service is enabled</li> <li>4.2.2.3 Ensure journald is configured to send logs to rsyslog</li> <li>4.2.2.4 Ensure rsyslog default file permissions are configured</li> <li>4.2.2.5 Ensure logging is configured</li> <li>4.2.2.6 Ensure rsyslog is configured to send logs to a remote log host</li> <li>4.2.2.7 Ensure rsyslog is not configured to receive logs from a remote client</li> <li>5.1.2 Ensure permissions on /etc/crontab are configured</li> <li>5.1.3 Ensure permissions on /etc/cron.hourly are configured</li> <li>5.1.4 Ensure permissions on /etc/cron.daily are configured</li> <li>5.1.5 Ensure permissions on /etc/cron.weekly are configured</li> <li>5.1.6 Ensure permissions on /etc/cron.monthly are configured</li> <li>5.1.7 Ensure permissions on /etc/cron.d are configured</li> <li>5.1.8 Ensure cron is restricted to authorized users</li> <li>5.1.9 Ensure at is restricted to authorized users</li> <li>5.2.1 Ensure permissions on /etc/ssh/sshd_config are configured</li> <li>5.2.10 Ensure SSH PermitUserEnvironment is disabled</li> <li>5.2.11 Ensure SSH IgnoreRhosts is enabled</li> <li>5.2.12 Ensure SSH X11 forwarding is disabled</li> <li>5.2.13 Ensure only strong Ciphers are used</li> <li>5.2.14 Ensure only strong MAC algorithms are used</li> <li>5.2.15 Ensure only strong Key Exchange algorithms are used</li> <li>5.2.16 Ensure SSH AllowTcpForwarding is disabled</li> <li>5.2.17 Ensure SSH warning banner is configured</li> <li>5.2.18 Ensure SSH MaxAuthTries is set to 4 or less</li> <li>5.2.19 Ensure SSH MaxStartups is configured</li> <li>5.2.2 Ensure permissions on SSH private host key files are configured</li> <li>5.2.21 Ensure SSH LoginGraceTime is set to one minute or less</li> <li>5.2.3 Ensure permissions on SSH public host key files are configured</li> <li>5.2.4 Ensure SSH access is limited</li> <li>5.2.5 Ensure SSH LogLevel is appropriate</li> <li>5.2.6 Ensure SSH PAM is enabled</li> <li>5.2.7 Ensure SSH root login is disabled</li> <li>5.2.8 Ensure SSH HostbasedAuthentication is disabled</li> <li>5.2.9 Ensure SSH PermitEmptyPasswords is disabled</li> <li>5.3.1 Ensure sudo is installed</li> <li>5.3.2 Ensure sudo commands use pty</li> <li>5.3.3 Ensure sudo log file exists</li> <li>5.3.4 Ensure users must provide password for privilege escalation</li> <li>5.3.5 Ensure re-authentication for privilege escalation is not disabled globally</li> <li>5.3.6 Ensure sudo authentication timeout is configured correctly</li> <li>5.3.7 Ensure access to the su command is restricted</li> <li>5.4.1 Ensure password creation requirements are configured</li> <li>5.4.2 Ensure lockout for failed password attempts is configured</li> <li>5.4.3 Ensure password reuse is limited</li> <li>5.4.4 Ensure password hashing algorithm is up to date with the latest standards</li> <li>5.5.2 Ensure system accounts are secured</li> <li>5.5.3 Ensure default group for the root account is GID 0</li> <li>5.5.4 Ensure default user umask is 027 or more restrictive</li> <li>5.5.5 Ensure default user shell timeout is 900 seconds or less</li> <li>5.5.1.1 Ensure minimum days between password changes is configured</li> <li>5.5.1.2 Ensure password expiration is 365 days or less</li> <li>5.5.1.3 Ensure password expiration warning days is 7 or more</li> <li>5.5.1.4 Ensure inactive password lock is 30 days or less</li> <li>5.5.1.5 Ensure all users last password change date is in the past</li> <li>6.1.1 Ensure permissions on /etc/passwd are configured</li> <li>6.1.10 Ensure no unowned files or directories exist</li> <li>6.1.11 Ensure no ungrouped files or directories exist</li> <li>6.1.12 Audit SUID executables</li> <li>6.1.13 Audit SGID executables</li> <li>6.1.2 Ensure permissions on /etc/passwd- are configured</li> <li>6.1.3 Ensure permissions on /etc/group are configured</li> <li>6.1.4 Ensure permissions on /etc/group- are configured</li> <li>6.1.5 Ensure permissions on /etc/shadow are configured</li> <li>6.1.6 Ensure permissions on /etc/shadow- are configured</li> <li>6.1.7 Ensure permissions on /etc/gshadow are configured</li> <li>E6.1.8 Ensure permissions on /etc/gshadow- are configured</li> <li>6.1.9 Ensure no world writable files exist</li> <li>6.2.1 Ensure accounts in /etc/passwd use shadowed passwords</li> <li>6.2.11 Ensure local interactive user home directories exist</li> <li>6.2.12 Ensure local interactive users own their home directories</li> <li>6.2.13 Ensure local interactive user home directories are mode 750 or more restrictive</li> <li>6.2.14 Ensure no local interactive user has .netrc files</li> <li>6.2.15 Ensure no local interactive user has .forward files</li> <li>6.2.16 Ensue no local interactive user has .rhosts files</li> <li>6.2.17 Ensure local interactive user dot files are not group or world writable</li> <li>6.2.2 Ensure /etc/shadow password fields are not empty</li> <li>6.2.4 Ensure shadow group is empty</li> <li>6.2.5 Ensure no duplicate UIDs exist</li> </ul>"},{"location":"tags/#initial-setup","title":"Initial Setup","text":"<ul> <li>1.9 Ensure updates, patches, and additional security software are installed</li> <li>1.1.10 Disable USB Storage</li> <li>1.1.9 Disable Automounting</li> <li>1.1.1.1 Ensure mounting of cramfs filesystems is disabled</li> <li>1.1.1.2 Ensure mounting of squashfs filesystems is disabled</li> <li>1.1.1.3 Ensure mounting of udf filesystems is disabled</li> <li>1.1.2.1 Ensure /tmp is a separate partition</li> <li>1.1.2.2 Ensure nodev option set on /tmp partition</li> <li>1.1.2.3 Ensure noexec option set on /tmp partition</li> <li>1.1.2.4 Ensure nosuid option set on /tmp partition</li> <li>1.1.3.1 Ensure separate partition exists for /var</li> <li>1.1.3.2 Ensure nodev option set on /var partition</li> <li>1.1.3.3 Ensure nosuid option set on /var partition</li> <li>1.1.4.1 Ensure separate partition exists for /var/tmp</li> <li>1.1.4.2 Ensure noexec option set on /var/tmp partition</li> <li>1.1.4.3 Ensure nosuid option set on /var/tmp partition</li> <li>1.1.4.4 Ensure nodev option set on /var/tmp partition</li> <li>1.1.5.1 Ensure separate partition exists for /var/log</li> <li>1.1.5.2 Ensure nodev option set on /var/log partition</li> <li>1.1.5.3 Ensure noexec option set on /var/log partition</li> <li>1.1.5.4 Ensure nosuid option set on /var/log partition</li> <li>1.1.6.1 Ensure separate partition exists for /var/log/audit</li> <li>1.1.6.2 Ensure noexec option set on /var/log/audit partition</li> <li>1.1.6.3 Ensure nodev option set on /var/log/audit partition</li> <li>1.1.6.4 Ensure nosuid option set on /var/log/audit partition</li> <li>1.1.7.1 Ensure separate partition exists for /home</li> <li>1.1.7.2 Ensure nodev option set on /home partition</li> <li>1.1.7.3 Ensure nosuid option set on /home partition</li> <li>1.1.8.1 Ensure nodev option set on /dev/shm partition</li> <li>1.1.8.2 Ensure noexec option set on /dev/shm partition</li> <li>1.1.8.3 Ensure nosuid option set on /dev/shm partition</li> <li>1.2.1 Ensure package manager repositories are configured</li> <li>1.2.2 Ensure GPG keys are configured</li> <li>1.3.1 Ensure AIDE is installed</li> <li>1.3.2 Ensure filesystem integrity is regularly checked</li> <li>1.4.1 Ensure bootloader password is set</li> <li>1.4.2 Ensure permissions on bootloader config are configured</li> <li>1.4.3 Ensure authentication required for single user mode</li> <li>1.5.1 Ensure address space layout randomization (ASLR) is enabled</li> <li>1.5.2 Ensure prelink is not installed</li> <li>1.5.3 Ensure Automatic Error Reporting is not enabled</li> <li>1.5.4 Ensure core dumps are restricted</li> <li>1.6.1.1 Ensure AppArmor is installed</li> <li>1.6.1.2 Ensure AppArmor is enabled in the bootloader configuration</li> <li>1.6.1.3 Ensure all AppArmor Profiles are in enforce or complain mode</li> <li>1.6.1.4 Ensure all AppArmor Profiles are enforcing</li> <li>1.7.1 Ensure message of the day is configured properly</li> <li>1.7.2 Ensure local login warning banner is configured properly</li> <li>1.7.3 Ensure remote login warning banner is configured properly</li> <li>1.7.4 Ensure permissions on /etc/motd are configured</li> <li>1.7.5 Ensure permissions on /etc/issue are configured</li> <li>1.7.6 Ensure permissions on /etc/issue.net are configured</li> <li>1.8.1 Ensure GNOME Display Manager is removed</li> <li>1.8.10 Ensure XDCMP is not enabled</li> <li>1.8.2 Ensure GDM login banner is configured</li> <li>1.8.3 Ensure GDM disable-user-list option is enabled</li> <li>1.8.4 Ensure GDM screen locks when the user is idle</li> <li>1.8.5 Ensure GDM screen locks cannot be overridden</li> <li>1.8.6 Ensure GDM automatic mounting of removable media is disabled</li> <li>1.8.7 Ensure GDM disabling automatic mounting of removable media is not overridden</li> <li>1.8.8 Ensure GDM autorun-never is enabled</li> <li>1.8.9 Ensure GDM autorun-never is not overridden</li> </ul>"},{"location":"tags/#level-1","title":"Level 1","text":"<ul> <li>1.9 Ensure updates, patches, and additional security software are installed</li> <li>1.1.10 Disable USB Storage</li> <li>1.1.9 Disable Automounting</li> <li>1.1.1.1 Ensure mounting of cramfs filesystems is disabled</li> <li>1.1.2.1 Ensure /tmp is a separate partition</li> <li>1.1.2.2 Ensure nodev option set on /tmp partition</li> <li>1.1.2.3 Ensure noexec option set on /tmp partition</li> <li>1.1.2.4 Ensure nosuid option set on /tmp partition</li> <li>1.1.3.2 Ensure nodev option set on /var partition</li> <li>1.1.3.3 Ensure nosuid option set on /var partition</li> <li>1.1.4.2 Ensure noexec option set on /var/tmp partition</li> <li>1.1.4.3 Ensure nosuid option set on /var/tmp partition</li> <li>1.1.4.4 Ensure nodev option set on /var/tmp partition</li> <li>1.1.5.2 Ensure nodev option set on /var/log partition</li> <li>1.1.5.3 Ensure noexec option set on /var/log partition</li> <li>1.1.5.4 Ensure nosuid option set on /var/log partition</li> <li>1.1.6.2 Ensure noexec option set on /var/log/audit partition</li> <li>1.1.6.3 Ensure nodev option set on /var/log/audit partition</li> <li>1.1.6.4 Ensure nosuid option set on /var/log/audit partition</li> <li>1.1.7.2 Ensure nodev option set on /home partition</li> <li>1.1.7.3 Ensure nosuid option set on /home partition</li> <li>1.1.8.1 Ensure nodev option set on /dev/shm partition</li> <li>1.1.8.2 Ensure noexec option set on /dev/shm partition</li> <li>1.1.8.3 Ensure nosuid option set on /dev/shm partition</li> <li>1.2.1 Ensure package manager repositories are configured</li> <li>1.2.2 Ensure GPG keys are configured</li> <li>1.3.1 Ensure AIDE is installed</li> <li>1.3.2 Ensure filesystem integrity is regularly checked</li> <li>1.4.1 Ensure bootloader password is set</li> <li>1.4.2 Ensure permissions on bootloader config are configured</li> <li>1.4.3 Ensure authentication required for single user mode</li> <li>1.5.1 Ensure address space layout randomization (ASLR) is enabled</li> <li>1.5.2 Ensure prelink is not installed</li> <li>1.5.3 Ensure Automatic Error Reporting is not enabled</li> <li>1.5.4 Ensure core dumps are restricted</li> <li>1.6.1.1 Ensure AppArmor is installed</li> <li>1.6.1.2 Ensure AppArmor is enabled in the bootloader configuration</li> <li>1.6.1.3 Ensure all AppArmor Profiles are in enforce or complain mode</li> <li>1.7.1 Ensure message of the day is configured properly</li> <li>1.7.2 Ensure local login warning banner is configured properly</li> <li>1.7.3 Ensure remote login warning banner is configured properly</li> <li>1.7.4 Ensure permissions on /etc/motd are configured</li> <li>1.7.5 Ensure permissions on /etc/issue are configured</li> <li>1.7.6 Ensure permissions on /etc/issue.net are configured</li> <li>1.8.10 Ensure XDCMP is not enabled</li> <li>1.8.4 Ensure GDM screen locks when the user is idle</li> <li>1.8.5 Ensure GDM screen locks cannot be overridden</li> <li>1.8.6 Ensure GDM automatic mounting of removable media is disabled</li> <li>1.8.7 Ensure GDM disabling automatic mounting of removable media is not overridden</li> <li>1.8.8 Ensure GDM autorun-never is enabled</li> <li>1.8.9 Ensure GDM autorun-never is not overridden</li> <li>2.4 Ensure nonessential services are removed or masked</li> <li>2.1.1.1 Ensure a single time synchronization daemon is in use</li> <li>2.1.2.1 Ensure chrony is configured with authorized timeserver</li> <li>2.1.2.2 Ensure chrony is running as user _chrony</li> <li>2.1.2.3 Ensure chrony is enabled and running</li> <li>2.1.3.1 Ensure systemd-timesyncd configured with authorized timeserver</li> <li>2.1.3.2 Ensure systemd-timesyncd is enabled and running</li> <li>2.1.4.1 Ensure ntp access control is configured</li> <li>2.1.4.2 Ensure ntp is configured with authorized timeserver</li> <li>2.1.4.3 Ensure ntp is running as user ntp</li> <li>Ensure mounting of cramfs filesystems is disabled</li> <li>2.2.1 Ensure X Window System is not installed</li> <li>2.2.10 Ensure IMAP and POP3 server are not installed</li> <li>2.2.11 Ensure Samba is not installed</li> <li>2.2.12 Ensure HTTP Proxy Server is not installed</li> <li>2.2.13 Ensure SNMP Server is not installed</li> <li>2.2.14 Ensure NIS Server is not installed</li> <li>2.2.15 Ensure mail transfer agent is configured for local-only mode</li> <li>2.2.16 Ensure rsync service is either not installed or masked</li> <li>2.2.2 Ensure Avahi Server is not installed</li> <li>2.2.3 Ensure CUPS is not installed</li> <li>2.2.4 Ensure DHCP Server is not installed</li> <li>2.2.5 Ensure LDAP server is not installed</li> <li>2.2.6 Ensure NFS is not installed</li> <li>2.2.7 Ensure DNS Server is not installed</li> <li>2.2.8 Ensure FTP Server is not installed</li> <li>2.2.9 Ensure HTTP server is not installed</li> <li>2.3.1 Ensure NIS Client is not installed</li> <li>2.3.2 Ensure rsh client is not installed</li> <li>2.3.3 Ensure talk client is not installed</li> <li>2.3.4 Ensure telnet client is not installed</li> <li>2.3.5 Ensure LDAP client is not installed</li> <li>2.3.6 Ensure RPC is not installed</li> <li>3.1.1 Ensure system is checked to determine if IPv6 is enabled</li> <li>3.1.2 Ensure wireless interfaces are disabled</li> <li>3.2.1 Ensure packet redirect sending is disabled</li> <li>3.2.2 Ensure IP forwarding is disabled</li> <li>3.3.1 Ensure source routed packets are not accepted</li> <li>3.3.2 Ensure ICMP redirects are not accepted</li> <li>3.3.3 Ensure secure ICMP redirects are not accepted</li> <li>3.3.4 Ensure suspicious packets are logged</li> <li>3.3.5 Ensure broadcast ICMP requests are ignored</li> <li>3.3.6 Ensure bogus ICMP responses are ignored</li> <li>3.3.7 Ensure Reverse Path Filtering is enabled</li> <li>3.3.8 Ensure TCP SYN Cookies is enabled</li> <li>3.3.9 Ensure IPv6 router advertisements are not accepted</li> <li>3.5.1.1 Ensure ufw is installed</li> <li>3.5.1.2 Ensure iptables-persistent is not installed with ufw</li> <li>3.5.1.3 Ensure ufw service is enabled</li> <li>3.5.1.4 Ensure ufw loopback traffic is configured</li> <li>3.5.1.5 Ensure ufw outbound connections are configured</li> <li>3.5.1.6 Ensure ufw firewall rules exist for all open ports</li> <li>3.5.1.7 Ensure ufw default deny firewall policy</li> <li>3.5.2.1 Ensure nftables is installed</li> <li>3.5.2.10 Ensure nftables rules are permanent</li> <li>3.5.2.2 Ensure ufw is uninstalled or disabled with nftables</li> <li>3.5.2.3 Ensure iptables are flushed with nftables</li> <li>3.5.2.4 Ensure a nftables table exists</li> <li>3.5.2.5 Ensure nftables base chains exist</li> <li>3.5.2.6 Ensure nftables loopback traffic is configured</li> <li>3.5.2.7 Ensure nftables outbound and established connections are configured</li> <li>3.5.2.8 Ensure nftables default deny firewall policy</li> <li>3.5.2.9 Ensure nftables service is enabled</li> <li>3.5.3.1.1 Ensure iptables packages are installed</li> <li>3.5.3.1.2 Ensure nftables is not installed with iptables</li> <li>3.5.3.1.3 Ensure ufw is uninstalled or disabled with iptables</li> <li>3.5.3.2.1 Ensure iptables default deny firewall policy</li> <li>3.5.3.2.2 Ensure iptables loopback traffic is configured</li> <li>3.5.3.2.4 Ensure iptables firewall rules exist for all open ports</li> <li>3.5.3.3.1 Ensure ip6tables default deny firewall policy</li> <li>3.5.3.3.2 Ensure ip6tables loopback traffic is configured</li> <li>3.5.3.3.3 Ensure ip6tables outbound and established connections are configured</li> <li>3.5.3.3.4 Ensure ip6tables firewall rules exist for all open ports</li> <li>4.1.4.11 Ensure cryptographic mechanisms are used to protect the integrity of audit tool</li> <li>4.2.3 Ensure all logfiles have appropriate permissions and ownership</li> <li>4.2.1.2 Ensure journald service is enabled</li> <li>4.2.1.3 Ensure journald is configured to compress large log files</li> <li>4.2.1.4 Ensure journald is configured to write logfiles to persistent disk</li> <li>4.2.1.5 Ensure journald is not configured to send logs to rsyslog</li> <li>4.2.1.6 Ensure journald log rotation is configured per site policy</li> <li>4.2.1.7 Ensure journald default file permissions configured</li> <li>4.2.1.1.1 Ensure systemd-journal-remote is installed</li> <li>4.2.1.1.2 Ensure systemd-journal-remote is configured</li> <li>4.2.1.1.3 Ensure systemd-journal-remote is enabled</li> <li>4.2.1.1.4 Ensure journald is not configured to recieve logs from a remote client</li> <li>4.2.2.1 Ensure rsyslog is installed</li> <li>4.2.2.2 Ensure rsyslog service is enabled</li> <li>4.2.2.3 Ensure journald is configured to send logs to rsyslog</li> <li>4.2.2.4 Ensure rsyslog default file permissions are configured</li> <li>4.2.2.5 Ensure logging is configured</li> <li>4.2.2.6 Ensure rsyslog is configured to send logs to a remote log host</li> <li>4.2.2.7 Ensure rsyslog is not configured to receive logs from a remote client</li> <li>5.1.1 Ensure cron daemon is enabled and running</li> <li>5.1.2 Ensure permissions on /etc/crontab are configured</li> <li>5.1.3 Ensure permissions on /etc/cron.hourly are configured</li> <li>5.1.4 Ensure permissions on /etc/cron.daily are configured</li> <li>5.1.5 Ensure permissions on /etc/cron.weekly are configured</li> <li>5.1.6 Ensure permissions on /etc/cron.monthly are configured</li> <li>5.1.7 Ensure permissions on /etc/cron.d are configured</li> <li>5.1.8 Ensure cron is restricted to authorized users</li> <li>5.1.9 Ensure at is restricted to authorized users</li> <li>5.2.1 Ensure permissions on /etc/ssh/sshd_config are configured</li> <li>5.2.10 Ensure SSH PermitUserEnvironment is disabled</li> <li>5.2.11 Ensure SSH IgnoreRhosts is enabled</li> <li>5.2.12 Ensure SSH X11 forwarding is disabled</li> <li>5.2.13 Ensure only strong Ciphers are used</li> <li>5.2.14 Ensure only strong MAC algorithms are used</li> <li>5.2.15 Ensure only strong Key Exchange algorithms are used</li> <li>5.2.17 Ensure SSH warning banner is configured</li> <li>5.2.18 Ensure SSH MaxAuthTries is set to 4 or less</li> <li>5.2.19 Ensure SSH MaxStartups is configured</li> <li>5.2.2 Ensure permissions on SSH private host key files are configured</li> <li>5.2.20 Ensure SSH MaxSessions is set to 10 or less</li> <li>5.2.21 Ensure SSH LoginGraceTime is set to one minute or less</li> <li>5.2.22 Ensure SSH Idle Timeout Interval is configured</li> <li>5.2.3 Ensure permissions on SSH public host key files are configured</li> <li>5.2.4 Ensure SSH access is limited</li> <li>5.2.5 Ensure SSH LogLevel is appropriate</li> <li>5.2.6 Ensure SSH PAM is enabled</li> <li>5.2.7 Ensure SSH root login is disabled</li> <li>5.2.8 Ensure SSH HostbasedAuthentication is disabled</li> <li>5.2.9 Ensure SSH PermitEmptyPasswords is disabled</li> <li>5.3.1 Ensure sudo is installed</li> <li>5.3.2 Ensure sudo commands use pty</li> <li>5.3.3 Ensure sudo log file exists</li> <li>5.3.5 Ensure re-authentication for privilege escalation is not disabled globally</li> <li>5.3.6 Ensure sudo authentication timeout is configured correctly</li> <li>5.3.7 Ensure access to the su command is restricted</li> <li>5.4.1 Ensure password creation requirements are configured</li> <li>5.4.2 Ensure lockout for failed password attempts is configured</li> <li>5.4.3 Ensure password reuse is limited</li> <li>5.4.4 Ensure password hashing algorithm is up to date with the latest standards</li> <li>5.5.2 Ensure system accounts are secured</li> <li>5.5.3 Ensure default group for the root account is GID 0</li> <li>5.5.4 Ensure default user umask is 027 or more restrictive</li> <li>5.5.5 Ensure default user shell timeout is 900 seconds or less</li> <li>5.5.1.1 Ensure minimum days between password changes is configured</li> <li>5.5.1.2 Ensure password expiration is 365 days or less</li> <li>5.5.1.3 Ensure password expiration warning days is 7 or more</li> <li>5.5.1.4 Ensure inactive password lock is 30 days or less</li> <li>5.5.1.5 Ensure all users last password change date is in the past</li> <li>6.1.1 Ensure permissions on /etc/passwd are configured</li> <li>6.1.10 Ensure no unowned files or directories exist</li> <li>6.1.11 Ensure no ungrouped files or directories exist</li> <li>6.1.12 Audit SUID executables</li> <li>6.1.13 Audit SGID executables</li> <li>6.1.2 Ensure permissions on /etc/passwd- are configured</li> <li>6.1.3 Ensure permissions on /etc/group are configured</li> <li>6.1.4 Ensure permissions on /etc/group- are configured</li> <li>6.1.5 Ensure permissions on /etc/shadow are configured</li> <li>6.1.6 Ensure permissions on /etc/shadow- are configured</li> <li>6.1.7 Ensure permissions on /etc/gshadow are configured</li> <li>E6.1.8 Ensure permissions on /etc/gshadow- are configured</li> <li>6.1.9 Ensure no world writable files exist</li> <li>6.2.1 Ensure accounts in /etc/passwd use shadowed passwords</li> <li>6.2.10 Ensure root is the only UID 0 account</li> <li>6.2.11 Ensure local interactive user home directories exist</li> <li>6.2.12 Ensure local interactive users own their home directories</li> <li>6.2.13 Ensure local interactive user home directories are mode 750 or more restrictive</li> <li>6.2.14 Ensure no local interactive user has .netrc files</li> <li>6.2.15 Ensure no local interactive user has .forward files</li> <li>6.2.16 Ensue no local interactive user has .rhosts files</li> <li>6.2.17 Ensure local interactive user dot files are not group or world writable</li> <li>6.2.2 Ensure /etc/shadow password fields are not empty</li> <li>6.2.3 Ensure all groups in /etc/passwd exist in /etc/group</li> <li>6.2.4 Ensure shadow group is empty</li> <li>6.2.5 Ensure no duplicate UIDs exist</li> <li>6.2.6 Ensure no duplicate GIDs exist</li> <li>6.2.7 Ensure no duplicate user names exist</li> <li>6.2.8 Ensure no duplicate group names exist</li> <li>6.2.9 Ensure root PATH Integrity</li> </ul>"},{"location":"tags/#level-2","title":"Level 2","text":"<ul> <li>1.1.10 Disable USB Storage</li> <li>1.1.1.2 Ensure mounting of squashfs filesystems is disabled</li> <li>1.1.1.3 Ensure mounting of udf filesystems is disabled</li> <li>1.1.3.1 Ensure separate partition exists for /var</li> <li>1.1.4.1 Ensure separate partition exists for /var/tmp</li> <li>1.1.5.1 Ensure separate partition exists for /var/log</li> <li>1.1.6.1 Ensure separate partition exists for /var/log/audit</li> <li>1.1.7.1 Ensure separate partition exists for /home</li> <li>1.6.1.4 Ensure all AppArmor Profiles are enforcing</li> <li>1.8.1 Ensure GNOME Display Manager is removed</li> <li>1.8.2 Ensure GDM login banner is configured</li> <li>1.8.3 Ensure GDM disable-user-list option is enabled</li> <li>1.8.6 Ensure GDM automatic mounting of removable media is disabled</li> <li>1.8.7 Ensure GDM disabling automatic mounting of removable media is not overridden</li> <li>1.8.8 Ensure GDM autorun-never is enabled</li> <li>2.2.3 Ensure CUPS is not installed</li> <li>3.1.2 Ensure wireless interfaces are disabled</li> <li>3.1.3 Ensure DCCP is disabled</li> <li>3.1.4 Ensure SCTP is disabled</li> <li>3.1.5 Ensure RDS is disabled</li> <li>3.1.6 Ensure TIPC is disabled</li> <li>4.1.1.1 Ensure auditd is installed</li> <li>4.1.1.2 Ensure auditd service is enabled and active</li> <li>4.1.1.3 Ensure auditing for processes that start prior to auditd is enabled</li> <li>4.1.1.4 Ensure audit_backlog_limit is sufficient</li> <li>4.1.2.1 Ensure audit log storage size is configured</li> <li>4.1.2.2 Ensure audit logs are not automatically deleted</li> <li>4.1.2.3 Ensure system is disabled when audit logs are full</li> <li>4.1.3.1 Ensure changes to system administration scope (sudoers) is collected</li> <li>4.1.3.10 Ensure successful file system mounts are collected</li> <li>4.1.3.11 Ensure session initiation information is collected</li> <li>4.1.3.12 Ensure login and logout events are collected</li> <li>4.1.3.13 Ensure file deletion events by users are collected</li> <li>4.1.3.14 Ensure events that modify the system's Mandatory Access Controls are collected</li> <li>4.1.3.15 Ensure successful and unsuccessful attempts to use the chcon command are recorded</li> <li>4.1.3.16 Ensure successful and unsuccessful attempts to use the setfacl command are recorded</li> <li>4.1.3.17 Ensure successful and unsuccessful attempts to use the chacl command are recorde</li> <li>4.1.3.18 Ensure successful and unsuccessful attempts to use the usermod command are recorded</li> <li>4.1.3.19 Ensure kernel module loading unloading and modification is collected</li> <li>4.1.3.2 Ensure actions as another user are always logged</li> <li>4.1.3.20 Ensure the audit configuration is immutable</li> <li>4.1.3.21 Ensure the running and on disk configuration is the same</li> <li>4.1.3.3 Ensure events that modify the sudo log file are collected</li> <li>4.1.3.4 Ensure events that modify date and time information are collected</li> <li>4.1.3.5 Ensure events that modify the system's network environment are collected</li> <li>4.1.3.6 Ensure use of privileged commands are collected</li> <li>4.1.3.7 Ensure unsuccessful file access attempts are collected</li> <li>4.1.3.8 Ensure events that modify user/group information are collected</li> <li>4.1.3.9 Ensure discretionary access control permission modification events are collected</li> <li>4.1.4.1 Ensure audit log files are mode 0640 or less permissive</li> <li>4.1.4.10 Ensure audit tools belong to group root</li> <li>4.1.4.2 Ensure only authorized users own audit log files</li> <li>4.1.4.3 Ensure only authorized groups are assigned ownership of audit log files</li> <li>4.1.4.4 Ensure the audit log directory is 0750 or more restrictive</li> <li>4.1.4.5 Ensure audit configuration files are 640 or more restrictive</li> <li>4.1.4.6 Ensure audit configuration files are owned by root</li> <li>4.1.4.7 Ensure audit configuration files belong to group root</li> <li>4.1.4.8 Ensure audit tools are 755 or more restrictive</li> <li>4.1.4.9 Ensure audit tools are owned by root</li> <li>5.2.12 Ensure SSH X11 forwarding is disabled</li> <li>5.2.16 Ensure SSH AllowTcpForwarding is disabled</li> <li>5.3.4 Ensure users must provide password for privilege escalation</li> </ul>"},{"location":"tags/#local-user-and-group-settings","title":"Local User and Group Settings","text":"<ul> <li>6.2.1 Ensure accounts in /etc/passwd use shadowed passwords</li> <li>6.2.10 Ensure root is the only UID 0 account</li> <li>6.2.11 Ensure local interactive user home directories exist</li> <li>6.2.12 Ensure local interactive users own their home directories</li> <li>6.2.13 Ensure local interactive user home directories are mode 750 or more restrictive</li> <li>6.2.14 Ensure no local interactive user has .netrc files</li> <li>6.2.15 Ensure no local interactive user has .forward files</li> <li>6.2.16 Ensue no local interactive user has .rhosts files</li> <li>6.2.17 Ensure local interactive user dot files are not group or world writable</li> <li>6.2.2 Ensure /etc/shadow password fields are not empty</li> <li>6.2.3 Ensure all groups in /etc/passwd exist in /etc/group</li> <li>6.2.4 Ensure shadow group is empty</li> <li>6.2.5 Ensure no duplicate UIDs exist</li> <li>6.2.6 Ensure no duplicate GIDs exist</li> <li>6.2.7 Ensure no duplicate user names exist</li> <li>6.2.8 Ensure no duplicate group names exist</li> <li>6.2.9 Ensure root PATH Integrity</li> </ul>"},{"location":"tags/#logging-and-auditing","title":"Logging and Auditing","text":"<ul> <li>4.1.1.1 Ensure auditd is installed</li> <li>4.1.1.2 Ensure auditd service is enabled and active</li> <li>4.1.1.3 Ensure auditing for processes that start prior to auditd is enabled</li> <li>4.1.1.4 Ensure audit_backlog_limit is sufficient</li> <li>4.1.2.1 Ensure audit log storage size is configured</li> <li>4.1.2.2 Ensure audit logs are not automatically deleted</li> <li>4.1.2.3 Ensure system is disabled when audit logs are full</li> <li>4.1.3.1 Ensure changes to system administration scope (sudoers) is collected</li> <li>4.1.3.10 Ensure successful file system mounts are collected</li> <li>4.1.3.11 Ensure session initiation information is collected</li> <li>4.1.3.12 Ensure login and logout events are collected</li> <li>4.1.3.13 Ensure file deletion events by users are collected</li> <li>4.1.3.14 Ensure events that modify the system's Mandatory Access Controls are collected</li> <li>4.1.3.15 Ensure successful and unsuccessful attempts to use the chcon command are recorded</li> <li>4.1.3.16 Ensure successful and unsuccessful attempts to use the setfacl command are recorded</li> <li>4.1.3.17 Ensure successful and unsuccessful attempts to use the chacl command are recorde</li> <li>4.1.3.18 Ensure successful and unsuccessful attempts to use the usermod command are recorded</li> <li>4.1.3.19 Ensure kernel module loading unloading and modification is collected</li> <li>4.1.3.2 Ensure actions as another user are always logged</li> <li>4.1.3.20 Ensure the audit configuration is immutable</li> <li>4.1.3.21 Ensure the running and on disk configuration is the same</li> <li>4.1.3.3 Ensure events that modify the sudo log file are collected</li> <li>4.1.3.4 Ensure events that modify date and time information are collected</li> <li>4.1.3.5 Ensure events that modify the system's network environment are collected</li> <li>4.1.3.6 Ensure use of privileged commands are collected</li> <li>4.1.3.7 Ensure unsuccessful file access attempts are collected</li> <li>4.1.3.8 Ensure events that modify user/group information are collected</li> <li>4.1.3.9 Ensure discretionary access control permission modification events are collected</li> <li>4.1.4.1 Ensure audit log files are mode 0640 or less permissive</li> <li>4.1.4.10 Ensure audit tools belong to group root</li> <li>4.1.4.11 Ensure cryptographic mechanisms are used to protect the integrity of audit tool</li> <li>4.1.4.2 Ensure only authorized users own audit log files</li> <li>4.1.4.3 Ensure only authorized groups are assigned ownership of audit log files</li> <li>4.1.4.4 Ensure the audit log directory is 0750 or more restrictive</li> <li>4.1.4.5 Ensure audit configuration files are 640 or more restrictive</li> <li>4.1.4.6 Ensure audit configuration files are owned by root</li> <li>4.1.4.7 Ensure audit configuration files belong to group root</li> <li>4.1.4.8 Ensure audit tools are 755 or more restrictive</li> <li>4.1.4.9 Ensure audit tools are owned by root</li> <li>4.2.3 Ensure all logfiles have appropriate permissions and ownership</li> <li>4.2.1.2 Ensure journald service is enabled</li> <li>4.2.1.3 Ensure journald is configured to compress large log files</li> <li>4.2.1.4 Ensure journald is configured to write logfiles to persistent disk</li> <li>4.2.1.5 Ensure journald is not configured to send logs to rsyslog</li> <li>4.2.1.6 Ensure journald log rotation is configured per site policy</li> <li>4.2.1.7 Ensure journald default file permissions configured</li> <li>4.2.1.1.1 Ensure systemd-journal-remote is installed</li> <li>4.2.1.1.2 Ensure systemd-journal-remote is configured</li> <li>4.2.1.1.3 Ensure systemd-journal-remote is enabled</li> <li>4.2.1.1.4 Ensure journald is not configured to recieve logs from a remote client</li> <li>4.2.2.1 Ensure rsyslog is installed</li> <li>4.2.2.2 Ensure rsyslog service is enabled</li> <li>4.2.2.3 Ensure journald is configured to send logs to rsyslog</li> <li>4.2.2.4 Ensure rsyslog default file permissions are configured</li> <li>4.2.2.5 Ensure logging is configured</li> <li>4.2.2.6 Ensure rsyslog is configured to send logs to a remote log host</li> <li>4.2.2.7 Ensure rsyslog is not configured to receive logs from a remote client</li> </ul>"},{"location":"tags/#m1018","title":"M1018","text":"<ul> <li>5.1.1 Ensure cron daemon is enabled and running</li> <li>5.1.2 Ensure permissions on /etc/crontab are configured</li> <li>5.1.3 Ensure permissions on /etc/cron.hourly are configured</li> <li>5.1.4 Ensure permissions on /etc/cron.daily are configured</li> <li>5.1.5 Ensure permissions on /etc/cron.weekly are configured</li> <li>5.1.6 Ensure permissions on /etc/cron.monthly are configured</li> <li>5.1.7 Ensure permissions on /etc/cron.d are configured</li> <li>5.1.8 Ensure cron is restricted to authorized users</li> <li>5.1.9 Ensure at is restricted to authorized users</li> <li>5.2.4 Ensure SSH access is limited</li> </ul>"},{"location":"tags/#m1022","title":"M1022","text":"<ul> <li>1.1.2.1 Ensure /tmp is a separate partition</li> <li>1.1.2.2 Ensure nodev option set on /tmp partition</li> <li>1.1.2.3 Ensure noexec option set on /tmp partition</li> <li>1.1.2.4 Ensure nosuid option set on /tmp partition</li> <li>1.1.4.1 Ensure separate partition exists for /var/tmp</li> <li>1.1.4.2 Ensure noexec option set on /var/tmp partition</li> <li>1.1.4.3 Ensure nosuid option set on /var/tmp partition</li> <li>1.1.4.4 Ensure nodev option set on /var/tmp partition</li> <li>1.1.5.1 Ensure separate partition exists for /var/log</li> <li>1.1.5.3 Ensure noexec option set on /var/log partition</li> <li>1.1.5.4 Ensure nosuid option set on /var/log partition</li> <li>1.1.6.1 Ensure separate partition exists for /var/log/audit</li> <li>1.1.6.2 Ensure noexec option set on /var/log/audit partition</li> <li>1.1.6.3 Ensure nodev option set on /var/log/audit partition</li> <li>1.1.6.4 Ensure nosuid option set on /var/log/audit partition</li> <li>1.1.7.2 Ensure nodev option set on /home partition</li> <li>1.1.7.3 Ensure nosuid option set on /home partition</li> <li>1.3.2 Ensure filesystem integrity is regularly checked</li> <li>1.4.2 Ensure permissions on bootloader config are configured</li> <li>1.4.3 Ensure authentication required for single user mode</li> <li>1.7.4 Ensure permissions on /etc/motd are configured</li> <li>1.7.5 Ensure permissions on /etc/issue are configured</li> <li>1.7.6 Ensure permissions on /etc/issue.net are configured</li> <li>2.1.2.1 Ensure chrony is configured with authorized timeserver</li> <li>2.1.4.2 Ensure ntp is configured with authorized timeserver</li> <li>4.1.3.14 Ensure events that modify the system's Mandatory Access Controls are collected</li> <li>4.1.3.9 Ensure discretionary access control permission modification events are collected</li> <li>4.2.1.4 Ensure journald is configured to write logfiles to persistent disk</li> <li>4.2.1.6 Ensure journald log rotation is configured per site policy</li> <li>5.2.1 Ensure permissions on /etc/ssh/sshd_config are configured</li> <li>5.2.2 Ensure permissions on SSH private host key files are configured</li> <li>5.2.3 Ensure permissions on SSH public host key files are configured</li> <li>6.1.1 Ensure permissions on /etc/passwd are configured</li> <li>6.1.2 Ensure permissions on /etc/passwd- are configured</li> <li>6.1.3 Ensure permissions on /etc/group are configured</li> <li>6.1.4 Ensure permissions on /etc/group- are configured</li> <li>6.1.5 Ensure permissions on /etc/shadow are configured</li> <li>6.1.6 Ensure permissions on /etc/shadow- are configured</li> <li>6.1.7 Ensure permissions on /etc/gshadow are configured</li> <li>E6.1.8 Ensure permissions on /etc/gshadow- are configured</li> <li>6.1.9 Ensure no world writable files exist</li> <li>6.2.11 Ensure local interactive user home directories exist</li> <li>6.2.12 Ensure local interactive users own their home directories</li> <li>6.2.13 Ensure local interactive user home directories are mode 750 or more restrictive</li> <li>6.2.17 Ensure local interactive user dot files are not group or world writable</li> <li>6.2.4 Ensure shadow group is empty</li> <li>6.2.9 Ensure root PATH Integrity</li> </ul>"},{"location":"tags/#m1026","title":"M1026","text":"<ul> <li>1.6.1.1 Ensure AppArmor is installed</li> <li>1.6.1.2 Ensure AppArmor is enabled in the bootloader configuration</li> <li>4.1.3.6 Ensure use of privileged commands are collected</li> <li>5.2.22 Ensure SSH Idle Timeout Interval is configured</li> <li>5.3.7 Ensure access to the su command is restricted</li> <li>5.5.2 Ensure system accounts are secured</li> <li>5.5.3 Ensure default group for the root account is GID 0</li> <li>5.5.5 Ensure default user shell timeout is 900 seconds or less</li> <li>6.2.10 Ensure root is the only UID 0 account</li> </ul>"},{"location":"tags/#m1027","title":"M1027","text":"<ul> <li>5.2.11 Ensure SSH IgnoreRhosts is enabled</li> <li>5.4.1 Ensure password creation requirements are configured</li> <li>5.4.2 Ensure lockout for failed password attempts is configured</li> <li>5.5.1.3 Ensure password expiration warning days is 7 or more</li> <li>5.5.1.4 Ensure inactive password lock is 30 days or less</li> <li>6.2.1 Ensure accounts in /etc/passwd use shadowed passwords</li> <li>6.2.14 Ensure no local interactive user has .netrc files</li> <li>6.2.2 Ensure /etc/shadow password fields are not empty</li> <li>6.2.3 Ensure all groups in /etc/passwd exist in /etc/group</li> <li>6.2.5 Ensure no duplicate UIDs exist</li> <li>6.2.6 Ensure no duplicate GIDs exist</li> <li>6.2.7 Ensure no duplicate user names exist</li> <li>6.2.8 Ensure no duplicate group names exist</li> </ul>"},{"location":"tags/#m1028","title":"M1028","text":"<ul> <li>1.8.3 Ensure GDM disable-user-list option is enabled</li> <li>3.1.2 Ensure wireless interfaces are disabled</li> <li>6.1.12 Audit SUID executables</li> <li>6.1.13 Audit SGID executables</li> </ul>"},{"location":"tags/#m1029","title":"M1029","text":"<ul> <li>4.2.1.5 Ensure journald is not configured to send logs to rsyslog</li> <li>4.2.1.1.1 Ensure systemd-journal-remote is installed</li> <li>4.2.1.1.2 Ensure systemd-journal-remote is configured</li> <li>4.2.1.1.3 Ensure systemd-journal-remote is enabled</li> <li>4.2.1.1.4 Ensure journald is not configured to recieve logs from a remote client</li> <li>4.2.2.6 Ensure rsyslog is configured to send logs to a remote log host</li> </ul>"},{"location":"tags/#m1030","title":"M1030","text":"<ul> <li>3.2.1 Ensure packet redirect sending is disabled</li> <li>3.2.2 Ensure IP forwarding is disabled</li> <li>3.3.2 Ensure ICMP redirects are not accepted</li> <li>3.3.3 Ensure secure ICMP redirects are not accepted</li> <li>3.3.7 Ensure Reverse Path Filtering is enabled</li> <li>3.3.9 Ensure IPv6 router advertisements are not accepted</li> </ul>"},{"location":"tags/#m1031","title":"M1031","text":"<ul> <li>3.5.1.1 Ensure ufw is installed</li> <li>3.5.1.4 Ensure ufw loopback traffic is configured</li> <li>3.5.1.5 Ensure ufw outbound connections are configured</li> <li>3.5.1.6 Ensure ufw firewall rules exist for all open ports</li> <li>3.5.1.7 Ensure ufw default deny firewall policy</li> <li>3.5.2.1 Ensure nftables is installed</li> <li>3.5.2.10 Ensure nftables rules are permanent</li> <li>3.5.2.4 Ensure a nftables table exists</li> <li>3.5.2.7 Ensure nftables outbound and established connections are configured</li> <li>3.5.2.8 Ensure nftables default deny firewall policy</li> <li>3.5.2.9 Ensure nftables service is enabled</li> <li>3.5.3.1.1 Ensure iptables packages are installed</li> <li>3.5.3.2.1 Ensure iptables default deny firewall policy</li> <li>3.5.3.2.2 Ensure iptables loopback traffic is configured</li> <li>3.5.3.2.4 Ensure iptables firewall rules exist for all open ports</li> <li>3.5.3.3.1 Ensure ip6tables default deny firewall policy</li> <li>3.5.3.3.2 Ensure ip6tables loopback traffic is configured</li> <li>3.5.3.3.3 Ensure ip6tables outbound and established connections are configured</li> <li>3.5.3.3.4 Ensure ip6tables firewall rules exist for all open ports</li> <li>6.2.15 Ensure no local interactive user has .forward files</li> </ul>"},{"location":"tags/#m1034","title":"M1034","text":"<ul> <li>4.1.3.10 Ensure successful file system mounts are collected</li> </ul>"},{"location":"tags/#m1035","title":"M1035","text":"<ul> <li>5.2.17 Ensure SSH warning banner is configured</li> <li>5.2.6 Ensure SSH PAM is enabled</li> </ul>"},{"location":"tags/#m1036","title":"M1036","text":"<ul> <li>5.2.18 Ensure SSH MaxAuthTries is set to 4 or less</li> <li>5.2.21 Ensure SSH LoginGraceTime is set to one minute or less</li> </ul>"},{"location":"tags/#m1037","title":"M1037","text":"<ul> <li>3.3.5 Ensure broadcast ICMP requests are ignored</li> <li>3.3.8 Ensure TCP SYN Cookies is enabled</li> <li>3.5.1.1 Ensure ufw is installed</li> <li>3.5.1.4 Ensure ufw loopback traffic is configured</li> <li>3.5.1.5 Ensure ufw outbound connections are configured</li> <li>3.5.1.6 Ensure ufw firewall rules exist for all open ports</li> <li>3.5.1.7 Ensure ufw default deny firewall policy</li> <li>3.5.2.1 Ensure nftables is installed</li> <li>3.5.2.4 Ensure a nftables table exists</li> <li>3.5.2.7 Ensure nftables outbound and established connections are configured</li> <li>3.5.2.8 Ensure nftables default deny firewall policy</li> <li>3.5.2.9 Ensure nftables service is enabled</li> <li>3.5.3.1.1 Ensure iptables packages are installed</li> <li>3.5.3.2.1 Ensure iptables default deny firewall policy</li> <li>3.5.3.2.2 Ensure iptables loopback traffic is configured</li> <li>3.5.3.2.4 Ensure iptables firewall rules exist for all open ports</li> <li>3.5.3.3.1 Ensure ip6tables default deny firewall policy</li> <li>3.5.3.3.2 Ensure ip6tables loopback traffic is configured</li> <li>3.5.3.3.3 Ensure ip6tables outbound and established connections are configured</li> <li>3.5.3.3.4 Ensure ip6tables firewall rules exist for all open ports</li> </ul>"},{"location":"tags/#m1038","title":"M1038","text":"<ul> <li>1.1.9 Disable Automounting</li> <li>1.1.3.2 Ensure nodev option set on /var partition</li> <li>1.1.3.3 Ensure nosuid option set on /var partition</li> <li>1.1.7.1 Ensure separate partition exists for /home</li> <li>1.1.8.1 Ensure nodev option set on /dev/shm partition</li> <li>1.1.8.2 Ensure noexec option set on /dev/shm partition</li> <li>1.1.8.3 Ensure nosuid option set on /dev/shm partition</li> </ul>"},{"location":"tags/#m1041","title":"M1041","text":"<ul> <li>2.3.2 Ensure rsh client is not installed</li> <li>2.3.3 Ensure talk client is not installed</li> <li>2.3.4 Ensure telnet client is not installed</li> <li>5.2.13 Ensure only strong Ciphers are used</li> <li>5.2.14 Ensure only strong MAC algorithms are used</li> <li>5.2.15 Ensure only strong Key Exchange algorithms are used</li> </ul>"},{"location":"tags/#m1042","title":"M1042","text":"<ul> <li>2.4 Ensure nonessential services are removed or masked</li> <li>2.2.1 Ensure X Window System is not installed</li> <li>2.2.10 Ensure IMAP and POP3 server are not installed</li> <li>2.2.12 Ensure HTTP Proxy Server is not installed</li> <li>2.2.13 Ensure SNMP Server is not installed</li> <li>2.2.14 Ensure NIS Server is not installed</li> <li>2.2.15 Ensure mail transfer agent is configured for local-only mode</li> <li>2.2.16 Ensure rsync service is either not installed or masked</li> <li>2.2.2 Ensure Avahi Server is not installed</li> <li>2.2.3 Ensure CUPS is not installed</li> <li>2.2.4 Ensure DHCP Server is not installed</li> <li>2.2.5 Ensure LDAP server is not installed</li> <li>2.2.7 Ensure DNS Server is not installed</li> <li>2.2.8 Ensure FTP Server is not installed</li> <li>2.2.9 Ensure HTTP server is not installed</li> <li>2.3.1 Ensure NIS Client is not installed</li> <li>2.3.2 Ensure rsh client is not installed</li> <li>2.3.3 Ensure talk client is not installed</li> <li>2.3.4 Ensure telnet client is not installed</li> <li>2.3.5 Ensure LDAP client is not installed</li> <li>2.3.6 Ensure RPC is not installed</li> <li>3.1.1 Ensure system is checked to determine if IPv6 is enabled</li> <li>3.1.3 Ensure DCCP is disabled</li> <li>3.1.4 Ensure SCTP is disabled</li> <li>3.1.5 Ensure RDS is disabled</li> <li>3.1.6 Ensure TIPC is disabled</li> <li>3.2.1 Ensure packet redirect sending is disabled</li> <li>3.2.2 Ensure IP forwarding is disabled</li> <li>3.3.2 Ensure ICMP redirects are not accepted</li> <li>3.3.3 Ensure secure ICMP redirects are not accepted</li> <li>3.3.7 Ensure Reverse Path Filtering is enabled</li> <li>3.3.9 Ensure IPv6 router advertisements are not accepted</li> <li>5.2.10 Ensure SSH PermitUserEnvironment is disabled</li> <li>5.2.12 Ensure SSH X11 forwarding is disabled</li> <li>5.2.16 Ensure SSH AllowTcpForwarding is disabled</li> <li>5.2.7 Ensure SSH root login is disabled</li> <li>5.2.8 Ensure SSH HostbasedAuthentication is disabled</li> <li>5.2.9 Ensure SSH PermitEmptyPasswords is disabled</li> </ul>"},{"location":"tags/#m1046","title":"M1046","text":"<ul> <li>1.4.1 Ensure bootloader password is set</li> </ul>"},{"location":"tags/#m1047","title":"M1047","text":"<ul> <li>4.1.3.1 Ensure changes to system administration scope (sudoers) is collected</li> <li>4.1.3.19 Ensure kernel module loading unloading and modification is collected</li> <li>4.1.3.2 Ensure actions as another user are always logged</li> <li>4.1.3.5 Ensure events that modify the system's network environment are collected</li> <li>4.1.3.8 Ensure events that modify user/group information are collected</li> </ul>"},{"location":"tags/#m1050","title":"M1050","text":"<ul> <li>1.1.10 Disable USB Storage</li> <li>1.1.1.1 Ensure mounting of cramfs filesystems is disabled</li> <li>1.1.1.2 Ensure mounting of squashfs filesystems is disabled</li> <li>1.1.1.3 Ensure mounting of udf filesystems is disabled</li> <li>1.1.5.2 Ensure nodev option set on /var/log partition</li> <li>1.5.1 Ensure address space layout randomization (ASLR) is enabled</li> <li>1.5.2 Ensure prelink is not installed</li> <li>1.8.10 Ensure XDCMP is not enabled</li> </ul>"},{"location":"tags/#m1051","title":"M1051","text":"<ul> <li>1.2.1 Ensure package manager repositories are configured</li> <li>1.2.2 Ensure GPG keys are configured</li> </ul>"},{"location":"tags/#m1053","title":"M1053","text":"<ul> <li>3.3.6 Ensure bogus ICMP responses are ignored</li> <li>4.1.2.1 Ensure audit log storage size is configured</li> <li>4.1.2.2 Ensure audit logs are not automatically deleted</li> <li>4.2.1.3 Ensure journald is configured to compress large log files</li> </ul>"},{"location":"tags/#ma1027","title":"MA1027","text":"<ul> <li>5.5.1.1 Ensure minimum days between password changes is configured</li> </ul>"},{"location":"tags/#ma1041","title":"MA1041","text":"<ul> <li>5.4.4 Ensure password hashing algorithm is up to date with the latest standards</li> </ul>"},{"location":"tags/#mandatory-access-control","title":"Mandatory Access Control","text":"<ul> <li>1.6.1.1 Ensure AppArmor is installed</li> <li>1.6.1.2 Ensure AppArmor is enabled in the bootloader configuration</li> <li>1.6.1.3 Ensure all AppArmor Profiles are in enforce or complain mode</li> <li>1.6.1.4 Ensure all AppArmor Profiles are enforcing</li> </ul>"},{"location":"tags/#manual","title":"Manual","text":"<ul> <li>1.9 Ensure updates, patches, and additional security software are installed</li> <li>1.2.1 Ensure package manager repositories are configured</li> <li>1.2.2 Ensure GPG keys are configured</li> <li>2.4 Ensure nonessential services are removed or masked</li> <li>2.1.2.1 Ensure chrony is configured with authorized timeserver</li> <li>2.1.3.1 Ensure systemd-timesyncd configured with authorized timeserver</li> <li>2.1.4.2 Ensure ntp is configured with authorized timeserver</li> <li>3.1.1 Ensure system is checked to determine if IPv6 is enabled</li> <li>3.5.1.5 Ensure ufw outbound connections are configured</li> <li>3.5.2.3 Ensure iptables are flushed with nftables</li> <li>3.5.2.7 Ensure nftables outbound and established connections are configured</li> <li>3.5.3.3.3 Ensure ip6tables outbound and established connections are configured</li> <li>4.1.3.21 Ensure the running and on disk configuration is the same</li> <li>4.2.1.5 Ensure journald is not configured to send logs to rsyslog</li> <li>4.2.1.6 Ensure journald log rotation is configured per site policy</li> <li>4.2.1.7 Ensure journald default file permissions configured</li> <li>4.2.1.1.2 Ensure systemd-journal-remote is configured</li> <li>4.2.1.1.3 Ensure systemd-journal-remote is enabled</li> <li>4.2.2.3 Ensure journald is configured to send logs to rsyslog</li> <li>4.2.2.5 Ensure logging is configured</li> <li>4.2.2.6 Ensure rsyslog is configured to send logs to a remote log host</li> <li>6.1.12 Audit SUID executables</li> <li>6.1.13 Audit SGID executables</li> </ul>"},{"location":"tags/#network-configuration","title":"Network Configuration","text":"<ul> <li>3.1.1 Ensure system is checked to determine if IPv6 is enabled</li> <li>3.1.2 Ensure wireless interfaces are disabled</li> <li>3.1.3 Ensure DCCP is disabled</li> <li>3.1.4 Ensure SCTP is disabled</li> <li>3.1.5 Ensure RDS is disabled</li> <li>3.1.6 Ensure TIPC is disabled</li> <li>3.2.1 Ensure packet redirect sending is disabled</li> <li>3.2.2 Ensure IP forwarding is disabled</li> <li>3.3.1 Ensure source routed packets are not accepted</li> <li>3.3.2 Ensure ICMP redirects are not accepted</li> <li>3.3.3 Ensure secure ICMP redirects are not accepted</li> <li>3.3.4 Ensure suspicious packets are logged</li> <li>3.3.5 Ensure broadcast ICMP requests are ignored</li> <li>3.3.6 Ensure bogus ICMP responses are ignored</li> <li>3.3.7 Ensure Reverse Path Filtering is enabled</li> <li>3.3.8 Ensure TCP SYN Cookies is enabled</li> <li>3.3.9 Ensure IPv6 router advertisements are not accepted</li> <li>3.5.1.1 Ensure ufw is installed</li> <li>3.5.1.2 Ensure iptables-persistent is not installed with ufw</li> <li>3.5.1.3 Ensure ufw service is enabled</li> <li>3.5.1.4 Ensure ufw loopback traffic is configured</li> <li>3.5.1.5 Ensure ufw outbound connections are configured</li> <li>3.5.1.6 Ensure ufw firewall rules exist for all open ports</li> <li>3.5.1.7 Ensure ufw default deny firewall policy</li> <li>3.5.2.1 Ensure nftables is installed</li> <li>3.5.2.10 Ensure nftables rules are permanent</li> <li>3.5.2.2 Ensure ufw is uninstalled or disabled with nftables</li> <li>3.5.2.3 Ensure iptables are flushed with nftables</li> <li>3.5.2.4 Ensure a nftables table exists</li> <li>3.5.2.5 Ensure nftables base chains exist</li> <li>3.5.2.6 Ensure nftables loopback traffic is configured</li> <li>3.5.2.7 Ensure nftables outbound and established connections are configured</li> <li>3.5.2.8 Ensure nftables default deny firewall policy</li> <li>3.5.2.9 Ensure nftables service is enabled</li> <li>3.5.3.1.1 Ensure iptables packages are installed</li> <li>3.5.3.1.2 Ensure nftables is not installed with iptables</li> <li>3.5.3.1.3 Ensure ufw is uninstalled or disabled with iptables</li> <li>3.5.3.2.1 Ensure iptables default deny firewall policy</li> <li>3.5.3.2.2 Ensure iptables loopback traffic is configured</li> <li>3.5.3.2.4 Ensure iptables firewall rules exist for all open ports</li> <li>3.5.3.3.1 Ensure ip6tables default deny firewall policy</li> <li>3.5.3.3.2 Ensure ip6tables loopback traffic is configured</li> <li>3.5.3.3.3 Ensure ip6tables outbound and established connections are configured</li> <li>3.5.3.3.4 Ensure ip6tables firewall rules exist for all open ports</li> </ul>"},{"location":"tags/#network-parameters-host-only","title":"Network Parameters (Host Only)","text":"<ul> <li>3.2.1 Ensure packet redirect sending is disabled</li> <li>3.2.2 Ensure IP forwarding is disabled</li> </ul>"},{"location":"tags/#network-parameters-host-and-router","title":"Network Parameters (Host and Router)","text":"<ul> <li>3.3.1 Ensure source routed packets are not accepted</li> <li>3.3.2 Ensure ICMP redirects are not accepted</li> <li>3.3.3 Ensure secure ICMP redirects are not accepted</li> <li>3.3.4 Ensure suspicious packets are logged</li> <li>3.3.5 Ensure broadcast ICMP requests are ignored</li> <li>3.3.6 Ensure bogus ICMP responses are ignored</li> <li>3.3.7 Ensure Reverse Path Filtering is enabled</li> <li>3.3.8 Ensure TCP SYN Cookies is enabled</li> <li>3.3.9 Ensure IPv6 router advertisements are not accepted</li> </ul>"},{"location":"tags/#secure-boot-settings","title":"Secure Boot Settings","text":"<ul> <li>1.4.1 Ensure bootloader password is set</li> <li>1.4.2 Ensure permissions on bootloader config are configured</li> <li>1.4.3 Ensure authentication required for single user mode</li> </ul>"},{"location":"tags/#server","title":"Server","text":"<ul> <li>1.9 Ensure updates, patches, and additional security software are installed</li> <li>1.1.10 Disable USB Storage</li> <li>1.1.9 Disable Automounting</li> <li>1.1.1.1 Ensure mounting of cramfs filesystems is disabled</li> <li>1.1.1.2 Ensure mounting of squashfs filesystems is disabled</li> <li>1.1.1.3 Ensure mounting of udf filesystems is disabled</li> <li>1.1.2.1 Ensure /tmp is a separate partition</li> <li>1.1.2.2 Ensure nodev option set on /tmp partition</li> <li>1.1.2.3 Ensure noexec option set on /tmp partition</li> <li>1.1.2.4 Ensure nosuid option set on /tmp partition</li> <li>1.1.3.1 Ensure separate partition exists for /var</li> <li>1.1.3.2 Ensure nodev option set on /var partition</li> <li>1.1.3.3 Ensure nosuid option set on /var partition</li> <li>1.1.4.1 Ensure separate partition exists for /var/tmp</li> <li>1.1.4.2 Ensure noexec option set on /var/tmp partition</li> <li>1.1.4.3 Ensure nosuid option set on /var/tmp partition</li> <li>1.1.4.4 Ensure nodev option set on /var/tmp partition</li> <li>1.1.5.1 Ensure separate partition exists for /var/log</li> <li>1.1.5.2 Ensure nodev option set on /var/log partition</li> <li>1.1.5.3 Ensure noexec option set on /var/log partition</li> <li>1.1.5.4 Ensure nosuid option set on /var/log partition</li> <li>1.1.6.1 Ensure separate partition exists for /var/log/audit</li> <li>1.1.6.2 Ensure noexec option set on /var/log/audit partition</li> <li>1.1.6.3 Ensure nodev option set on /var/log/audit partition</li> <li>1.1.6.4 Ensure nosuid option set on /var/log/audit partition</li> <li>1.1.7.1 Ensure separate partition exists for /home</li> <li>1.1.7.2 Ensure nodev option set on /home partition</li> <li>1.1.7.3 Ensure nosuid option set on /home partition</li> <li>1.1.8.1 Ensure nodev option set on /dev/shm partition</li> <li>1.1.8.2 Ensure noexec option set on /dev/shm partition</li> <li>1.1.8.3 Ensure nosuid option set on /dev/shm partition</li> <li>1.2.1 Ensure package manager repositories are configured</li> <li>1.2.2 Ensure GPG keys are configured</li> <li>1.3.1 Ensure AIDE is installed</li> <li>1.3.2 Ensure filesystem integrity is regularly checked</li> <li>1.4.1 Ensure bootloader password is set</li> <li>1.4.2 Ensure permissions on bootloader config are configured</li> <li>1.4.3 Ensure authentication required for single user mode</li> <li>1.5.1 Ensure address space layout randomization (ASLR) is enabled</li> <li>1.5.2 Ensure prelink is not installed</li> <li>1.5.3 Ensure Automatic Error Reporting is not enabled</li> <li>1.5.4 Ensure core dumps are restricted</li> <li>1.6.1.1 Ensure AppArmor is installed</li> <li>1.6.1.2 Ensure AppArmor is enabled in the bootloader configuration</li> <li>1.6.1.3 Ensure all AppArmor Profiles are in enforce or complain mode</li> <li>1.6.1.4 Ensure all AppArmor Profiles are enforcing</li> <li>1.7.1 Ensure message of the day is configured properly</li> <li>1.7.2 Ensure local login warning banner is configured properly</li> <li>1.7.3 Ensure remote login warning banner is configured properly</li> <li>1.7.4 Ensure permissions on /etc/motd are configured</li> <li>1.7.5 Ensure permissions on /etc/issue are configured</li> <li>1.7.6 Ensure permissions on /etc/issue.net are configured</li> <li>1.8.1 Ensure GNOME Display Manager is removed</li> <li>1.8.10 Ensure XDCMP is not enabled</li> <li>1.8.2 Ensure GDM login banner is configured</li> <li>1.8.3 Ensure GDM disable-user-list option is enabled</li> <li>1.8.4 Ensure GDM screen locks when the user is idle</li> <li>1.8.5 Ensure GDM screen locks cannot be overridden</li> <li>1.8.6 Ensure GDM automatic mounting of removable media is disabled</li> <li>1.8.7 Ensure GDM disabling automatic mounting of removable media is not overridden</li> <li>1.8.8 Ensure GDM autorun-never is enabled</li> <li>1.8.9 Ensure GDM autorun-never is not overridden</li> <li>2.4 Ensure nonessential services are removed or masked</li> <li>2.1.1.1 Ensure a single time synchronization daemon is in use</li> <li>2.1.2.1 Ensure chrony is configured with authorized timeserver</li> <li>2.1.2.2 Ensure chrony is running as user _chrony</li> <li>2.1.2.3 Ensure chrony is enabled and running</li> <li>2.1.3.1 Ensure systemd-timesyncd configured with authorized timeserver</li> <li>2.1.3.2 Ensure systemd-timesyncd is enabled and running</li> <li>2.1.4.1 Ensure ntp access control is configured</li> <li>2.1.4.2 Ensure ntp is configured with authorized timeserver</li> <li>2.1.4.3 Ensure ntp is running as user ntp</li> <li>Ensure mounting of cramfs filesystems is disabled</li> <li>2.2.1 Ensure X Window System is not installed</li> <li>2.2.10 Ensure IMAP and POP3 server are not installed</li> <li>2.2.11 Ensure Samba is not installed</li> <li>2.2.12 Ensure HTTP Proxy Server is not installed</li> <li>2.2.13 Ensure SNMP Server is not installed</li> <li>2.2.14 Ensure NIS Server is not installed</li> <li>2.2.15 Ensure mail transfer agent is configured for local-only mode</li> <li>2.2.16 Ensure rsync service is either not installed or masked</li> <li>2.2.2 Ensure Avahi Server is not installed</li> <li>2.2.3 Ensure CUPS is not installed</li> <li>2.2.4 Ensure DHCP Server is not installed</li> <li>2.2.5 Ensure LDAP server is not installed</li> <li>2.2.6 Ensure NFS is not installed</li> <li>2.2.7 Ensure DNS Server is not installed</li> <li>2.2.8 Ensure FTP Server is not installed</li> <li>2.2.9 Ensure HTTP server is not installed</li> <li>2.3.1 Ensure NIS Client is not installed</li> <li>2.3.2 Ensure rsh client is not installed</li> <li>2.3.3 Ensure talk client is not installed</li> <li>2.3.4 Ensure telnet client is not installed</li> <li>2.3.5 Ensure LDAP client is not installed</li> <li>2.3.6 Ensure RPC is not installed</li> <li>3.1.1 Ensure system is checked to determine if IPv6 is enabled</li> <li>3.1.2 Ensure wireless interfaces are disabled</li> <li>3.1.3 Ensure DCCP is disabled</li> <li>3.1.4 Ensure SCTP is disabled</li> <li>3.1.5 Ensure RDS is disabled</li> <li>3.1.6 Ensure TIPC is disabled</li> <li>3.2.1 Ensure packet redirect sending is disabled</li> <li>3.2.2 Ensure IP forwarding is disabled</li> <li>3.3.1 Ensure source routed packets are not accepted</li> <li>3.3.2 Ensure ICMP redirects are not accepted</li> <li>3.3.3 Ensure secure ICMP redirects are not accepted</li> <li>3.3.4 Ensure suspicious packets are logged</li> <li>3.3.5 Ensure broadcast ICMP requests are ignored</li> <li>3.3.6 Ensure bogus ICMP responses are ignored</li> <li>3.3.7 Ensure Reverse Path Filtering is enabled</li> <li>3.3.8 Ensure TCP SYN Cookies is enabled</li> <li>3.3.9 Ensure IPv6 router advertisements are not accepted</li> <li>3.5.1.1 Ensure ufw is installed</li> <li>3.5.1.2 Ensure iptables-persistent is not installed with ufw</li> <li>3.5.1.3 Ensure ufw service is enabled</li> <li>3.5.1.4 Ensure ufw loopback traffic is configured</li> <li>3.5.1.5 Ensure ufw outbound connections are configured</li> <li>3.5.1.6 Ensure ufw firewall rules exist for all open ports</li> <li>3.5.1.7 Ensure ufw default deny firewall policy</li> <li>3.5.2.1 Ensure nftables is installed</li> <li>3.5.2.10 Ensure nftables rules are permanent</li> <li>3.5.2.2 Ensure ufw is uninstalled or disabled with nftables</li> <li>3.5.2.3 Ensure iptables are flushed with nftables</li> <li>3.5.2.4 Ensure a nftables table exists</li> <li>3.5.2.5 Ensure nftables base chains exist</li> <li>3.5.2.6 Ensure nftables loopback traffic is configured</li> <li>3.5.2.7 Ensure nftables outbound and established connections are configured</li> <li>3.5.2.8 Ensure nftables default deny firewall policy</li> <li>3.5.2.9 Ensure nftables service is enabled</li> <li>3.5.3.1.1 Ensure iptables packages are installed</li> <li>3.5.3.1.2 Ensure nftables is not installed with iptables</li> <li>3.5.3.1.3 Ensure ufw is uninstalled or disabled with iptables</li> <li>3.5.3.2.1 Ensure iptables default deny firewall policy</li> <li>3.5.3.2.2 Ensure iptables loopback traffic is configured</li> <li>3.5.3.2.4 Ensure iptables firewall rules exist for all open ports</li> <li>3.5.3.3.1 Ensure ip6tables default deny firewall policy</li> <li>3.5.3.3.2 Ensure ip6tables loopback traffic is configured</li> <li>3.5.3.3.3 Ensure ip6tables outbound and established connections are configured</li> <li>3.5.3.3.4 Ensure ip6tables firewall rules exist for all open ports</li> <li>4.1.1.1 Ensure auditd is installed</li> <li>4.1.1.2 Ensure auditd service is enabled and active</li> <li>4.1.1.3 Ensure auditing for processes that start prior to auditd is enabled</li> <li>4.1.1.4 Ensure audit_backlog_limit is sufficient</li> <li>4.1.2.1 Ensure audit log storage size is configured</li> <li>4.1.2.2 Ensure audit logs are not automatically deleted</li> <li>4.1.2.3 Ensure system is disabled when audit logs are full</li> <li>4.1.3.1 Ensure changes to system administration scope (sudoers) is collected</li> <li>4.1.3.10 Ensure successful file system mounts are collected</li> <li>4.1.3.11 Ensure session initiation information is collected</li> <li>4.1.3.12 Ensure login and logout events are collected</li> <li>4.1.3.13 Ensure file deletion events by users are collected</li> <li>4.1.3.14 Ensure events that modify the system's Mandatory Access Controls are collected</li> <li>4.1.3.15 Ensure successful and unsuccessful attempts to use the chcon command are recorded</li> <li>4.1.3.16 Ensure successful and unsuccessful attempts to use the setfacl command are recorded</li> <li>4.1.3.17 Ensure successful and unsuccessful attempts to use the chacl command are recorde</li> <li>4.1.3.18 Ensure successful and unsuccessful attempts to use the usermod command are recorded</li> <li>4.1.3.19 Ensure kernel module loading unloading and modification is collected</li> <li>4.1.3.2 Ensure actions as another user are always logged</li> <li>4.1.3.20 Ensure the audit configuration is immutable</li> <li>4.1.3.21 Ensure the running and on disk configuration is the same</li> <li>4.1.3.3 Ensure events that modify the sudo log file are collected</li> <li>4.1.3.4 Ensure events that modify date and time information are collected</li> <li>4.1.3.5 Ensure events that modify the system's network environment are collected</li> <li>4.1.3.6 Ensure use of privileged commands are collected</li> <li>4.1.3.7 Ensure unsuccessful file access attempts are collected</li> <li>4.1.3.8 Ensure events that modify user/group information are collected</li> <li>4.1.3.9 Ensure discretionary access control permission modification events are collected</li> <li>4.1.4.1 Ensure audit log files are mode 0640 or less permissive</li> <li>4.1.4.10 Ensure audit tools belong to group root</li> <li>4.1.4.11 Ensure cryptographic mechanisms are used to protect the integrity of audit tool</li> <li>4.1.4.2 Ensure only authorized users own audit log files</li> <li>4.1.4.3 Ensure only authorized groups are assigned ownership of audit log files</li> <li>4.1.4.4 Ensure the audit log directory is 0750 or more restrictive</li> <li>4.1.4.5 Ensure audit configuration files are 640 or more restrictive</li> <li>4.1.4.6 Ensure audit configuration files are owned by root</li> <li>4.1.4.7 Ensure audit configuration files belong to group root</li> <li>4.1.4.8 Ensure audit tools are 755 or more restrictive</li> <li>4.1.4.9 Ensure audit tools are owned by root</li> <li>4.2.3 Ensure all logfiles have appropriate permissions and ownership</li> <li>4.2.1.2 Ensure journald service is enabled</li> <li>4.2.1.3 Ensure journald is configured to compress large log files</li> <li>4.2.1.4 Ensure journald is configured to write logfiles to persistent disk</li> <li>4.2.1.5 Ensure journald is not configured to send logs to rsyslog</li> <li>4.2.1.6 Ensure journald log rotation is configured per site policy</li> <li>4.2.1.7 Ensure journald default file permissions configured</li> <li>4.2.1.1.1 Ensure systemd-journal-remote is installed</li> <li>4.2.1.1.2 Ensure systemd-journal-remote is configured</li> <li>4.2.1.1.3 Ensure systemd-journal-remote is enabled</li> <li>4.2.1.1.4 Ensure journald is not configured to recieve logs from a remote client</li> <li>4.2.2.1 Ensure rsyslog is installed</li> <li>4.2.2.2 Ensure rsyslog service is enabled</li> <li>4.2.2.3 Ensure journald is configured to send logs to rsyslog</li> <li>4.2.2.4 Ensure rsyslog default file permissions are configured</li> <li>4.2.2.5 Ensure logging is configured</li> <li>4.2.2.6 Ensure rsyslog is configured to send logs to a remote log host</li> <li>4.2.2.7 Ensure rsyslog is not configured to receive logs from a remote client</li> <li>5.1.1 Ensure cron daemon is enabled and running</li> <li>5.1.2 Ensure permissions on /etc/crontab are configured</li> <li>5.1.3 Ensure permissions on /etc/cron.hourly are configured</li> <li>5.1.4 Ensure permissions on /etc/cron.daily are configured</li> <li>5.1.5 Ensure permissions on /etc/cron.weekly are configured</li> <li>5.1.6 Ensure permissions on /etc/cron.monthly are configured</li> <li>5.1.7 Ensure permissions on /etc/cron.d are configured</li> <li>5.1.8 Ensure cron is restricted to authorized users</li> <li>5.1.9 Ensure at is restricted to authorized users</li> <li>5.2.1 Ensure permissions on /etc/ssh/sshd_config are configured</li> <li>5.2.10 Ensure SSH PermitUserEnvironment is disabled</li> <li>5.2.11 Ensure SSH IgnoreRhosts is enabled</li> <li>5.2.12 Ensure SSH X11 forwarding is disabled</li> <li>5.2.13 Ensure only strong Ciphers are used</li> <li>5.2.14 Ensure only strong MAC algorithms are used</li> <li>5.2.15 Ensure only strong Key Exchange algorithms are used</li> <li>5.2.16 Ensure SSH AllowTcpForwarding is disabled</li> <li>5.2.17 Ensure SSH warning banner is configured</li> <li>5.2.18 Ensure SSH MaxAuthTries is set to 4 or less</li> <li>5.2.19 Ensure SSH MaxStartups is configured</li> <li>5.2.2 Ensure permissions on SSH private host key files are configured</li> <li>5.2.20 Ensure SSH MaxSessions is set to 10 or less</li> <li>5.2.21 Ensure SSH LoginGraceTime is set to one minute or less</li> <li>5.2.22 Ensure SSH Idle Timeout Interval is configured</li> <li>5.2.3 Ensure permissions on SSH public host key files are configured</li> <li>5.2.4 Ensure SSH access is limited</li> <li>5.2.5 Ensure SSH LogLevel is appropriate</li> <li>5.2.6 Ensure SSH PAM is enabled</li> <li>5.2.7 Ensure SSH root login is disabled</li> <li>5.2.8 Ensure SSH HostbasedAuthentication is disabled</li> <li>5.2.9 Ensure SSH PermitEmptyPasswords is disabled</li> <li>5.3.1 Ensure sudo is installed</li> <li>5.3.2 Ensure sudo commands use pty</li> <li>5.3.3 Ensure sudo log file exists</li> <li>5.3.4 Ensure users must provide password for privilege escalation</li> <li>5.3.5 Ensure re-authentication for privilege escalation is not disabled globally</li> <li>5.3.6 Ensure sudo authentication timeout is configured correctly</li> <li>5.3.7 Ensure access to the su command is restricted</li> <li>5.4.1 Ensure password creation requirements are configured</li> <li>5.4.2 Ensure lockout for failed password attempts is configured</li> <li>5.4.3 Ensure password reuse is limited</li> <li>5.4.4 Ensure password hashing algorithm is up to date with the latest standards</li> <li>5.5.2 Ensure system accounts are secured</li> <li>5.5.3 Ensure default group for the root account is GID 0</li> <li>5.5.4 Ensure default user umask is 027 or more restrictive</li> <li>5.5.5 Ensure default user shell timeout is 900 seconds or less</li> <li>5.5.1.1 Ensure minimum days between password changes is configured</li> <li>5.5.1.2 Ensure password expiration is 365 days or less</li> <li>5.5.1.3 Ensure password expiration warning days is 7 or more</li> <li>5.5.1.4 Ensure inactive password lock is 30 days or less</li> <li>5.5.1.5 Ensure all users last password change date is in the past</li> <li>6.1.1 Ensure permissions on /etc/passwd are configured</li> <li>6.1.10 Ensure no unowned files or directories exist</li> <li>6.1.11 Ensure no ungrouped files or directories exist</li> <li>6.1.12 Audit SUID executables</li> <li>6.1.13 Audit SGID executables</li> <li>6.1.2 Ensure permissions on /etc/passwd- are configured</li> <li>6.1.3 Ensure permissions on /etc/group are configured</li> <li>6.1.4 Ensure permissions on /etc/group- are configured</li> <li>6.1.5 Ensure permissions on /etc/shadow are configured</li> <li>6.1.6 Ensure permissions on /etc/shadow- are configured</li> <li>6.1.7 Ensure permissions on /etc/gshadow are configured</li> <li>E6.1.8 Ensure permissions on /etc/gshadow- are configured</li> <li>6.1.9 Ensure no world writable files exist</li> <li>6.2.1 Ensure accounts in /etc/passwd use shadowed passwords</li> <li>6.2.10 Ensure root is the only UID 0 account</li> <li>6.2.11 Ensure local interactive user home directories exist</li> <li>6.2.12 Ensure local interactive users own their home directories</li> <li>6.2.13 Ensure local interactive user home directories are mode 750 or more restrictive</li> <li>6.2.14 Ensure no local interactive user has .netrc files</li> <li>6.2.15 Ensure no local interactive user has .forward files</li> <li>6.2.16 Ensue no local interactive user has .rhosts files</li> <li>6.2.17 Ensure local interactive user dot files are not group or world writable</li> <li>6.2.2 Ensure /etc/shadow password fields are not empty</li> <li>6.2.3 Ensure all groups in /etc/passwd exist in /etc/group</li> <li>6.2.4 Ensure shadow group is empty</li> <li>6.2.5 Ensure no duplicate UIDs exist</li> <li>6.2.6 Ensure no duplicate GIDs exist</li> <li>6.2.7 Ensure no duplicate user names exist</li> <li>6.2.8 Ensure no duplicate group names exist</li> <li>6.2.9 Ensure root PATH Integrity</li> </ul>"},{"location":"tags/#service-clients","title":"Service Clients","text":"<ul> <li>2.3.1 Ensure NIS Client is not installed</li> <li>2.3.2 Ensure rsh client is not installed</li> <li>2.3.3 Ensure talk client is not installed</li> <li>2.3.4 Ensure telnet client is not installed</li> <li>2.3.5 Ensure LDAP client is not installed</li> <li>2.3.6 Ensure RPC is not installed</li> </ul>"},{"location":"tags/#services","title":"Services","text":"<ul> <li>2.4 Ensure nonessential services are removed or masked</li> <li>2.1.1.1 Ensure a single time synchronization daemon is in use</li> <li>2.1.2.1 Ensure chrony is configured with authorized timeserver</li> <li>2.1.2.2 Ensure chrony is running as user _chrony</li> <li>2.1.2.3 Ensure chrony is enabled and running</li> <li>2.1.3.1 Ensure systemd-timesyncd configured with authorized timeserver</li> <li>2.1.3.2 Ensure systemd-timesyncd is enabled and running</li> <li>2.1.4.1 Ensure ntp access control is configured</li> <li>2.1.4.2 Ensure ntp is configured with authorized timeserver</li> <li>2.1.4.3 Ensure ntp is running as user ntp</li> <li>Ensure mounting of cramfs filesystems is disabled</li> <li>2.2.1 Ensure X Window System is not installed</li> <li>2.2.10 Ensure IMAP and POP3 server are not installed</li> <li>2.2.11 Ensure Samba is not installed</li> <li>2.2.12 Ensure HTTP Proxy Server is not installed</li> <li>2.2.13 Ensure SNMP Server is not installed</li> <li>2.2.14 Ensure NIS Server is not installed</li> <li>2.2.15 Ensure mail transfer agent is configured for local-only mode</li> <li>2.2.16 Ensure rsync service is either not installed or masked</li> <li>2.2.2 Ensure Avahi Server is not installed</li> <li>2.2.3 Ensure CUPS is not installed</li> <li>2.2.4 Ensure DHCP Server is not installed</li> <li>2.2.5 Ensure LDAP server is not installed</li> <li>2.2.6 Ensure NFS is not installed</li> <li>2.2.7 Ensure DNS Server is not installed</li> <li>2.2.8 Ensure FTP Server is not installed</li> <li>2.2.9 Ensure HTTP server is not installed</li> <li>2.3.1 Ensure NIS Client is not installed</li> <li>2.3.2 Ensure rsh client is not installed</li> <li>2.3.3 Ensure talk client is not installed</li> <li>2.3.4 Ensure telnet client is not installed</li> <li>2.3.5 Ensure LDAP client is not installed</li> <li>2.3.6 Ensure RPC is not installed</li> </ul>"},{"location":"tags/#set-shadow-password-suite-parameters","title":"Set Shadow Password Suite Parameters","text":"<ul> <li>5.5.1.1 Ensure minimum days between password changes is configured</li> <li>5.5.1.2 Ensure password expiration is 365 days or less</li> <li>5.5.1.3 Ensure password expiration warning days is 7 or more</li> <li>5.5.1.4 Ensure inactive password lock is 30 days or less</li> <li>5.5.1.5 Ensure all users last password change date is in the past</li> </ul>"},{"location":"tags/#special-purpose-services","title":"Special Purpose Services","text":"<ul> <li>2.2.1 Ensure X Window System is not installed</li> <li>2.2.10 Ensure IMAP and POP3 server are not installed</li> <li>2.2.11 Ensure Samba is not installed</li> <li>2.2.12 Ensure HTTP Proxy Server is not installed</li> <li>2.2.13 Ensure SNMP Server is not installed</li> <li>2.2.14 Ensure NIS Server is not installed</li> <li>2.2.15 Ensure mail transfer agent is configured for local-only mode</li> <li>2.2.16 Ensure rsync service is either not installed or masked</li> <li>2.2.2 Ensure Avahi Server is not installed</li> <li>2.2.3 Ensure CUPS is not installed</li> <li>2.2.4 Ensure DHCP Server is not installed</li> <li>2.2.5 Ensure LDAP server is not installed</li> <li>2.2.6 Ensure NFS is not installed</li> <li>2.2.7 Ensure DNS Server is not installed</li> <li>2.2.8 Ensure FTP Server is not installed</li> <li>2.2.9 Ensure HTTP server is not installed</li> </ul>"},{"location":"tags/#system-file-permissions","title":"System File Permissions","text":"<ul> <li>6.1.1 Ensure permissions on /etc/passwd are configured</li> <li>6.1.10 Ensure no unowned files or directories exist</li> <li>6.1.11 Ensure no ungrouped files or directories exist</li> <li>6.1.12 Audit SUID executables</li> <li>6.1.13 Audit SGID executables</li> <li>6.1.2 Ensure permissions on /etc/passwd- are configured</li> <li>6.1.3 Ensure permissions on /etc/group are configured</li> <li>6.1.4 Ensure permissions on /etc/group- are configured</li> <li>6.1.5 Ensure permissions on /etc/shadow are configured</li> <li>6.1.6 Ensure permissions on /etc/shadow- are configured</li> <li>6.1.7 Ensure permissions on /etc/gshadow are configured</li> <li>E6.1.8 Ensure permissions on /etc/gshadow- are configured</li> <li>6.1.9 Ensure no world writable files exist</li> </ul>"},{"location":"tags/#system-maintenance","title":"System Maintenance","text":"<ul> <li>6.1.1 Ensure permissions on /etc/passwd are configured</li> <li>6.1.10 Ensure no unowned files or directories exist</li> <li>6.1.11 Ensure no ungrouped files or directories exist</li> <li>6.1.12 Audit SUID executables</li> <li>6.1.13 Audit SGID executables</li> <li>6.1.2 Ensure permissions on /etc/passwd- are configured</li> <li>6.1.3 Ensure permissions on /etc/group are configured</li> <li>6.1.4 Ensure permissions on /etc/group- are configured</li> <li>6.1.5 Ensure permissions on /etc/shadow are configured</li> <li>6.1.6 Ensure permissions on /etc/shadow- are configured</li> <li>6.1.7 Ensure permissions on /etc/gshadow are configured</li> <li>E6.1.8 Ensure permissions on /etc/gshadow- are configured</li> <li>6.1.9 Ensure no world writable files exist</li> <li>6.2.1 Ensure accounts in /etc/passwd use shadowed passwords</li> <li>6.2.10 Ensure root is the only UID 0 account</li> <li>6.2.11 Ensure local interactive user home directories exist</li> <li>6.2.12 Ensure local interactive users own their home directories</li> <li>6.2.13 Ensure local interactive user home directories are mode 750 or more restrictive</li> <li>6.2.14 Ensure no local interactive user has .netrc files</li> <li>6.2.15 Ensure no local interactive user has .forward files</li> <li>6.2.16 Ensue no local interactive user has .rhosts files</li> <li>6.2.17 Ensure local interactive user dot files are not group or world writable</li> <li>6.2.2 Ensure /etc/shadow password fields are not empty</li> <li>6.2.3 Ensure all groups in /etc/passwd exist in /etc/group</li> <li>6.2.4 Ensure shadow group is empty</li> <li>6.2.5 Ensure no duplicate UIDs exist</li> <li>6.2.6 Ensure no duplicate GIDs exist</li> <li>6.2.7 Ensure no duplicate user names exist</li> <li>6.2.8 Ensure no duplicate group names exist</li> <li>6.2.9 Ensure root PATH Integrity</li> </ul>"},{"location":"tags/#t1003","title":"T1003","text":"<ul> <li>5.4.4 Ensure password hashing algorithm is up to date with the latest standards</li> <li>6.1.1 Ensure permissions on /etc/passwd are configured</li> <li>6.1.2 Ensure permissions on /etc/passwd- are configured</li> <li>6.1.3 Ensure permissions on /etc/group are configured</li> <li>6.1.4 Ensure permissions on /etc/group- are configured</li> <li>6.1.5 Ensure permissions on /etc/shadow are configured</li> <li>6.1.6 Ensure permissions on /etc/shadow- are configured</li> <li>6.1.7 Ensure permissions on /etc/gshadow are configured</li> <li>E6.1.8 Ensure permissions on /etc/gshadow- are configured</li> <li>6.2.1 Ensure accounts in /etc/passwd use shadowed passwords</li> <li>6.2.4 Ensure shadow group is empty</li> </ul>"},{"location":"tags/#t1003008","title":"T1003.008","text":"<ul> <li>5.4.4 Ensure password hashing algorithm is up to date with the latest standards</li> <li>6.1.1 Ensure permissions on /etc/passwd are configured</li> <li>6.1.2 Ensure permissions on /etc/passwd- are configured</li> <li>6.1.3 Ensure permissions on /etc/group are configured</li> <li>6.1.4 Ensure permissions on /etc/group- are configured</li> <li>6.1.5 Ensure permissions on /etc/shadow are configured</li> <li>6.1.6 Ensure permissions on /etc/shadow- are configured</li> <li>6.1.7 Ensure permissions on /etc/gshadow are configured</li> <li>E6.1.8 Ensure permissions on /etc/gshadow- are configured</li> <li>6.2.1 Ensure accounts in /etc/passwd use shadowed passwords</li> <li>6.2.4 Ensure shadow group is empty</li> </ul>"},{"location":"tags/#t1005","title":"T1005","text":"<ul> <li>1.1.10 Disable USB Storage</li> <li>1.1.1.1 Ensure mounting of cramfs filesystems is disabled</li> <li>1.1.1.2 Ensure mounting of squashfs filesystems is disabled</li> <li>1.1.1.3 Ensure mounting of udf filesystems is disabled</li> <li>1.1.5.2 Ensure nodev option set on /var/log partition</li> <li>1.5.4 Ensure core dumps are restricted</li> <li>2.2.11 Ensure Samba is not installed</li> <li>4.2.2.1 Ensure rsyslog is installed</li> </ul>"},{"location":"tags/#t1011","title":"T1011","text":"<ul> <li>3.1.2 Ensure wireless interfaces are disabled</li> </ul>"},{"location":"tags/#t1018","title":"T1018","text":"<ul> <li>1.7.3 Ensure remote login warning banner is configured properly</li> <li>2.2.15 Ensure mail transfer agent is configured for local-only mode</li> </ul>"},{"location":"tags/#t1021","title":"T1021","text":"<ul> <li>5.2.10 Ensure SSH PermitUserEnvironment is disabled</li> <li>5.2.4 Ensure SSH access is limited</li> <li>5.2.6 Ensure SSH PAM is enabled</li> <li>5.2.7 Ensure SSH root login is disabled</li> <li>5.2.9 Ensure SSH PermitEmptyPasswords is disabled</li> </ul>"},{"location":"tags/#t1021004","title":"T1021.004","text":"<ul> <li>5.2.4 Ensure SSH access is limited</li> <li>5.2.6 Ensure SSH PAM is enabled</li> </ul>"},{"location":"tags/#t1036","title":"T1036","text":"<ul> <li>1.3.1 Ensure AIDE is installed</li> <li>1.3.2 Ensure filesystem integrity is regularly checked</li> </ul>"},{"location":"tags/#t1036002","title":"T1036.002","text":"<ul> <li>1.3.1 Ensure AIDE is installed</li> <li>1.3.2 Ensure filesystem integrity is regularly checked</li> </ul>"},{"location":"tags/#t1036003","title":"T1036.003","text":"<ul> <li>1.3.1 Ensure AIDE is installed</li> <li>1.3.2 Ensure filesystem integrity is regularly checked</li> </ul>"},{"location":"tags/#t1036005","title":"T1036.005","text":"<ul> <li>1.3.1 Ensure AIDE is installed</li> <li>1.3.2 Ensure filesystem integrity is regularly checked</li> </ul>"},{"location":"tags/#t1039","title":"T1039","text":"<ul> <li>2.2.11 Ensure Samba is not installed</li> </ul>"},{"location":"tags/#t1040","title":"T1040","text":"<ul> <li>1.8.10 Ensure XDCMP is not enabled</li> <li>2.3.2 Ensure rsh client is not installed</li> <li>2.3.4 Ensure telnet client is not installed</li> <li>5.2.13 Ensure only strong Ciphers are used</li> <li>5.2.14 Ensure only strong MAC algorithms are used</li> <li>5.2.15 Ensure only strong Key Exchange algorithms are used</li> </ul>"},{"location":"tags/#t1048","title":"T1048","text":"<ul> <li>5.2.16 Ensure SSH AllowTcpForwarding is disabled</li> </ul>"},{"location":"tags/#t1048002","title":"T1048.002","text":"<ul> <li>5.2.16 Ensure SSH AllowTcpForwarding is disabled</li> </ul>"},{"location":"tags/#t1049","title":"T1049","text":"<ul> <li>6.2.16 Ensue no local interactive user has .rhosts files</li> </ul>"},{"location":"tags/#t1053","title":"T1053","text":"<ul> <li>5.1.2 Ensure permissions on /etc/crontab are configured</li> <li>5.1.3 Ensure permissions on /etc/cron.hourly are configured</li> <li>5.1.4 Ensure permissions on /etc/cron.daily are configured</li> <li>5.1.5 Ensure permissions on /etc/cron.weekly are configured</li> <li>5.1.6 Ensure permissions on /etc/cron.monthly are configured</li> <li>5.1.7 Ensure permissions on /etc/cron.d are configured</li> <li>5.1.8 Ensure cron is restricted to authorized users</li> <li>5.1.9 Ensure at is restricted to authorized users</li> </ul>"},{"location":"tags/#t1053003","title":"T1053.003","text":"<ul> <li>5.1.2 Ensure permissions on /etc/crontab are configured</li> <li>5.1.3 Ensure permissions on /etc/cron.hourly are configured</li> <li>5.1.4 Ensure permissions on /etc/cron.daily are configured</li> <li>5.1.5 Ensure permissions on /etc/cron.weekly are configured</li> <li>5.1.6 Ensure permissions on /etc/cron.monthly are configured</li> <li>5.1.7 Ensure permissions on /etc/cron.d are configured</li> <li>5.1.8 Ensure cron is restricted to authorized users</li> <li>5.1.9 Ensure at is restricted to authorized users</li> </ul>"},{"location":"tags/#t1055","title":"T1055","text":"<ul> <li>1.5.2 Ensure prelink is not installed</li> </ul>"},{"location":"tags/#t1055001","title":"T1055.001","text":"<ul> <li>1.5.2 Ensure prelink is not installed</li> </ul>"},{"location":"tags/#t1055009","title":"T1055.009","text":"<ul> <li>1.5.2 Ensure prelink is not installed</li> </ul>"},{"location":"tags/#t1056","title":"T1056","text":"<ul> <li>1.8.10 Ensure XDCMP is not enabled</li> </ul>"},{"location":"tags/#t1056001","title":"T1056.001","text":"<ul> <li>1.8.10 Ensure XDCMP is not enabled</li> </ul>"},{"location":"tags/#t1065","title":"T1065","text":"<ul> <li>1.5.2 Ensure prelink is not installed</li> </ul>"},{"location":"tags/#t1068","title":"T1068","text":"<ul> <li>1.1.9 Disable Automounting</li> <li>1.2.1 Ensure package manager repositories are configured</li> <li>1.5.1 Ensure address space layout randomization (ASLR) is enabled</li> <li>1.6.1.1 Ensure AppArmor is installed</li> <li>1.6.1.2 Ensure AppArmor is enabled in the bootloader configuration</li> <li>1.6.1.4 Ensure all AppArmor Profiles are enforcing</li> <li>3.1.3 Ensure DCCP is disabled</li> <li>3.1.4 Ensure SCTP is disabled</li> <li>3.1.5 Ensure RDS is disabled</li> <li>3.1.6 Ensure TIPC is disabled</li> </ul>"},{"location":"tags/#t1070","title":"T1070","text":"<ul> <li>2.1.1.1 Ensure a single time synchronization daemon is in use</li> <li>2.1.2.1 Ensure chrony is configured with authorized timeserver</li> <li>2.1.3.1 Ensure systemd-timesyncd configured with authorized timeserver</li> <li>2.1.4.2 Ensure ntp is configured with authorized timeserver</li> <li>4.1.4.1 Ensure audit log files are mode 0640 or less permissive</li> <li>4.1.4.10 Ensure audit tools belong to group root</li> <li>4.1.4.11 Ensure cryptographic mechanisms are used to protect the integrity of audit tool</li> <li>4.1.4.2 Ensure only authorized users own audit log files</li> <li>4.1.4.3 Ensure only authorized groups are assigned ownership of audit log files</li> <li>4.1.4.4 Ensure the audit log directory is 0750 or more restrictive</li> <li>4.1.4.5 Ensure audit configuration files are 640 or more restrictive</li> <li>4.1.4.6 Ensure audit configuration files are owned by root</li> <li>4.1.4.7 Ensure audit configuration files belong to group root</li> <li>4.1.4.8 Ensure audit tools are 755 or more restrictive</li> <li>4.1.4.9 Ensure audit tools are owned by root</li> <li>4.2.3 Ensure all logfiles have appropriate permissions and ownership</li> <li>4.2.1.2 Ensure journald service is enabled</li> <li>4.2.1.4 Ensure journald is configured to write logfiles to persistent disk</li> <li>4.2.1.5 Ensure journald is not configured to send logs to rsyslog</li> <li>4.2.1.6 Ensure journald log rotation is configured per site policy</li> <li>4.2.1.7 Ensure journald default file permissions configured</li> <li>4.2.1.1.1 Ensure systemd-journal-remote is installed</li> <li>4.2.1.1.2 Ensure systemd-journal-remote is configured</li> <li>4.2.1.1.3 Ensure systemd-journal-remote is enabled</li> <li>4.2.1.1.4 Ensure journald is not configured to recieve logs from a remote client</li> <li>4.2.2.1 Ensure rsyslog is installed</li> <li>4.2.2.2 Ensure rsyslog service is enabled</li> <li>4.2.2.4 Ensure rsyslog default file permissions are configured</li> <li>4.2.2.5 Ensure logging is configured</li> <li>4.2.2.6 Ensure rsyslog is configured to send logs to a remote log host</li> <li>4.2.2.7 Ensure rsyslog is not configured to receive logs from a remote client</li> </ul>"},{"location":"tags/#t1070002","title":"T1070.002","text":"<ul> <li>2.1.1.1 Ensure a single time synchronization daemon is in use</li> <li>2.1.2.1 Ensure chrony is configured with authorized timeserver</li> <li>2.1.3.1 Ensure systemd-timesyncd configured with authorized timeserver</li> <li>2.1.4.2 Ensure ntp is configured with authorized timeserver</li> <li>4.1.4.1 Ensure audit log files are mode 0640 or less permissive</li> <li>4.1.4.10 Ensure audit tools belong to group root</li> <li>4.1.4.11 Ensure cryptographic mechanisms are used to protect the integrity of audit tool</li> <li>4.1.4.2 Ensure only authorized users own audit log files</li> <li>4.1.4.3 Ensure only authorized groups are assigned ownership of audit log files</li> <li>4.1.4.4 Ensure the audit log directory is 0750 or more restrictive</li> <li>4.1.4.5 Ensure audit configuration files are 640 or more restrictive</li> <li>4.1.4.6 Ensure audit configuration files are owned by root</li> <li>4.1.4.7 Ensure audit configuration files belong to group root</li> <li>4.1.4.8 Ensure audit tools are 755 or more restrictive</li> <li>4.1.4.9 Ensure audit tools are owned by root</li> <li>4.2.3 Ensure all logfiles have appropriate permissions and ownership</li> <li>4.2.1.2 Ensure journald service is enabled</li> <li>4.2.1.4 Ensure journald is configured to write logfiles to persistent disk</li> <li>4.2.1.5 Ensure journald is not configured to send logs to rsyslog</li> <li>4.2.1.6 Ensure journald log rotation is configured per site policy</li> <li>4.2.1.7 Ensure journald default file permissions configured</li> <li>4.2.1.1.1 Ensure systemd-journal-remote is installed</li> <li>4.2.1.1.2 Ensure systemd-journal-remote is configured</li> <li>4.2.1.1.3 Ensure systemd-journal-remote is enabled</li> <li>4.2.1.1.4 Ensure journald is not configured to recieve logs from a remote client</li> <li>4.2.2.1 Ensure rsyslog is installed</li> <li>4.2.2.2 Ensure rsyslog service is enabled</li> <li>4.2.2.4 Ensure rsyslog default file permissions are configured</li> <li>4.2.2.5 Ensure logging is configured</li> <li>4.2.2.6 Ensure rsyslog is configured to send logs to a remote log host</li> <li>4.2.2.7 Ensure rsyslog is not configured to receive logs from a remote client</li> </ul>"},{"location":"tags/#t1078","title":"T1078","text":"<ul> <li>1.8.3 Ensure GDM disable-user-list option is enabled</li> <li>5.2.11 Ensure SSH IgnoreRhosts is enabled</li> <li>5.2.22 Ensure SSH Idle Timeout Interval is configured</li> <li>5.2.8 Ensure SSH HostbasedAuthentication is disabled</li> <li>5.3.1 Ensure sudo is installed</li> <li>5.4.1 Ensure password creation requirements are configured</li> <li>5.4.3 Ensure password reuse is limited</li> <li>5.5.2 Ensure system accounts are secured</li> <li>5.5.5 Ensure default user shell timeout is 900 seconds or less</li> <li>5.5.1.1 Ensure minimum days between password changes is configured</li> <li>5.5.1.2 Ensure password expiration is 365 days or less</li> <li>5.5.1.4 Ensure inactive password lock is 30 days or less</li> <li>5.5.1.5 Ensure all users last password change date is in the past</li> <li>6.2.2 Ensure /etc/shadow password fields are not empty</li> <li>6.2.5 Ensure no duplicate UIDs exist</li> <li>6.2.6 Ensure no duplicate GIDs exist</li> <li>6.2.7 Ensure no duplicate user names exist</li> <li>6.2.8 Ensure no duplicate group names exist</li> </ul>"},{"location":"tags/#t1078001","title":"T1078.001","text":"<ul> <li>1.8.3 Ensure GDM disable-user-list option is enabled</li> <li>5.2.11 Ensure SSH IgnoreRhosts is enabled</li> <li>5.2.22 Ensure SSH Idle Timeout Interval is configured</li> <li>5.2.8 Ensure SSH HostbasedAuthentication is disabled</li> <li>5.4.1 Ensure password creation requirements are configured</li> <li>5.4.3 Ensure password reuse is limited</li> <li>5.5.2 Ensure system accounts are secured</li> <li>5.5.5 Ensure default user shell timeout is 900 seconds or less</li> <li>5.5.1.1 Ensure minimum days between password changes is configured</li> <li>5.5.1.2 Ensure password expiration is 365 days or less</li> <li>5.5.1.5 Ensure all users last password change date is in the past</li> <li>6.2.2 Ensure /etc/shadow password fields are not empty</li> <li>6.2.5 Ensure no duplicate UIDs exist</li> <li>6.2.6 Ensure no duplicate GIDs exist</li> <li>6.2.7 Ensure no duplicate user names exist</li> <li>6.2.8 Ensure no duplicate group names exist</li> </ul>"},{"location":"tags/#t1078002","title":"T1078.002","text":"<ul> <li>1.8.3 Ensure GDM disable-user-list option is enabled</li> <li>5.2.22 Ensure SSH Idle Timeout Interval is configured</li> <li>5.4.1 Ensure password creation requirements are configured</li> <li>5.4.3 Ensure password reuse is limited</li> <li>5.5.5 Ensure default user shell timeout is 900 seconds or less</li> <li>5.5.1.1 Ensure minimum days between password changes is configured</li> <li>5.5.1.2 Ensure password expiration is 365 days or less</li> <li>5.5.1.4 Ensure inactive password lock is 30 days or less</li> <li>5.5.1.5 Ensure all users last password change date is in the past</li> </ul>"},{"location":"tags/#t1078003","title":"T1078.003","text":"<ul> <li>1.8.3 Ensure GDM disable-user-list option is enabled</li> <li>5.2.11 Ensure SSH IgnoreRhosts is enabled</li> <li>5.2.22 Ensure SSH Idle Timeout Interval is configured</li> <li>5.2.8 Ensure SSH HostbasedAuthentication is disabled</li> <li>5.3.1 Ensure sudo is installed</li> <li>5.4.1 Ensure password creation requirements are configured</li> <li>5.4.3 Ensure password reuse is limited</li> <li>5.5.2 Ensure system accounts are secured</li> <li>5.5.5 Ensure default user shell timeout is 900 seconds or less</li> <li>5.5.1.1 Ensure minimum days between password changes is configured</li> <li>5.5.1.2 Ensure password expiration is 365 days or less</li> <li>5.5.1.4 Ensure inactive password lock is 30 days or less</li> <li>5.5.1.5 Ensure all users last password change date is in the past</li> <li>6.2.2 Ensure /etc/shadow password fields are not empty</li> <li>6.2.5 Ensure no duplicate UIDs exist</li> <li>6.2.6 Ensure no duplicate GIDs exist</li> <li>6.2.7 Ensure no duplicate user names exist</li> <li>6.2.8 Ensure no duplicate group names exist</li> </ul>"},{"location":"tags/#t1078004","title":"T1078.004","text":"<ul> <li>5.4.1 Ensure password creation requirements are configured</li> <li>5.4.3 Ensure password reuse is limited</li> <li>5.5.1.1 Ensure minimum days between password changes is configured</li> <li>5.5.1.2 Ensure password expiration is 365 days or less</li> <li>5.5.1.5 Ensure all users last password change date is in the past</li> </ul>"},{"location":"tags/#t1082","title":"T1082","text":"<ul> <li>1.7.1 Ensure message of the day is configured properly</li> <li>1.7.2 Ensure local login warning banner is configured properly</li> <li>1.7.3 Ensure remote login warning banner is configured properly</li> </ul>"},{"location":"tags/#t1083","title":"T1083","text":"<ul> <li>2.2.11 Ensure Samba is not installed</li> <li>4.1.4.1 Ensure audit log files are mode 0640 or less permissive</li> <li>4.1.4.10 Ensure audit tools belong to group root</li> <li>4.1.4.11 Ensure cryptographic mechanisms are used to protect the integrity of audit tool</li> <li>4.1.4.2 Ensure only authorized users own audit log files</li> <li>4.1.4.3 Ensure only authorized groups are assigned ownership of audit log files</li> <li>4.1.4.4 Ensure the audit log directory is 0750 or more restrictive</li> <li>4.1.4.5 Ensure audit configuration files are 640 or more restrictive</li> <li>4.1.4.6 Ensure audit configuration files are owned by root</li> <li>4.1.4.7 Ensure audit configuration files belong to group root</li> <li>4.1.4.8 Ensure audit tools are 755 or more restrictive</li> <li>4.1.4.9 Ensure audit tools are owned by root</li> <li>4.2.3 Ensure all logfiles have appropriate permissions and ownership</li> <li>4.2.1.7 Ensure journald default file permissions configured</li> <li>4.2.2.4 Ensure rsyslog default file permissions are configured</li> </ul>"},{"location":"tags/#t1087","title":"T1087","text":"<ul> <li>1.8.3 Ensure GDM disable-user-list option is enabled</li> </ul>"},{"location":"tags/#t1087001","title":"T1087.001","text":"<ul> <li>1.8.3 Ensure GDM disable-user-list option is enabled</li> </ul>"},{"location":"tags/#t1087002","title":"T1087.002","text":"<ul> <li>1.8.3 Ensure GDM disable-user-list option is enabled</li> </ul>"},{"location":"tags/#t1091","title":"T1091","text":"<ul> <li>1.8.8 Ensure GDM autorun-never is enabled</li> <li>1.8.9 Ensure GDM autorun-never is not overridden</li> </ul>"},{"location":"tags/#t1098","title":"T1098","text":"<ul> <li>5.2.1 Ensure permissions on /etc/ssh/sshd_config are configured</li> </ul>"},{"location":"tags/#t1098004","title":"T1098.004","text":"<ul> <li>5.2.1 Ensure permissions on /etc/ssh/sshd_config are configured</li> </ul>"},{"location":"tags/#t1105","title":"T1105","text":"<ul> <li>2.2.16 Ensure rsync service is either not installed or masked</li> </ul>"},{"location":"tags/#t1110","title":"T1110","text":"<ul> <li>5.2.18 Ensure SSH MaxAuthTries is set to 4 or less</li> <li>5.2.21 Ensure SSH LoginGraceTime is set to one minute or less</li> <li>5.4.1 Ensure password creation requirements are configured</li> <li>5.4.2 Ensure lockout for failed password attempts is configured</li> <li>5.4.3 Ensure password reuse is limited</li> <li>5.4.4 Ensure password hashing algorithm is up to date with the latest standards</li> <li>5.5.1.1 Ensure minimum days between password changes is configured</li> <li>5.5.1.2 Ensure password expiration is 365 days or less</li> <li>5.5.1.5 Ensure all users last password change date is in the past</li> </ul>"},{"location":"tags/#t1110001","title":"T1110.001","text":"<ul> <li>5.2.18 Ensure SSH MaxAuthTries is set to 4 or less</li> <li>5.4.1 Ensure password creation requirements are configured</li> <li>5.4.2 Ensure lockout for failed password attempts is configured</li> <li>5.5.1.2 Ensure password expiration is 365 days or less</li> <li>5.5.1.5 Ensure all users last password change date is in the past</li> </ul>"},{"location":"tags/#t1110002","title":"T1110.002","text":"<ul> <li>5.4.1 Ensure password creation requirements are configured</li> <li>5.4.4 Ensure password hashing algorithm is up to date with the latest standards</li> <li>5.5.1.2 Ensure password expiration is 365 days or less</li> <li>5.5.1.5 Ensure all users last password change date is in the past</li> </ul>"},{"location":"tags/#t1110003","title":"T1110.003","text":"<ul> <li>5.2.18 Ensure SSH MaxAuthTries is set to 4 or less</li> <li>5.2.21 Ensure SSH LoginGraceTime is set to one minute or less</li> <li>5.4.1 Ensure password creation requirements are configured</li> <li>5.4.2 Ensure lockout for failed password attempts is configured</li> <li>5.5.1.2 Ensure password expiration is 365 days or less</li> <li>5.5.1.5 Ensure all users last password change date is in the past</li> </ul>"},{"location":"tags/#t1110004","title":"T1110.004","text":"<ul> <li>5.2.21 Ensure SSH LoginGraceTime is set to one minute or less</li> <li>5.4.3 Ensure password reuse is limited</li> <li>5.5.1.1 Ensure minimum days between password changes is configured</li> <li>5.5.1.2 Ensure password expiration is 365 days or less</li> <li>5.5.1.5 Ensure all users last password change date is in the past</li> </ul>"},{"location":"tags/#t1114","title":"T1114","text":"<ul> <li>6.2.15 Ensure no local interactive user has .forward files</li> </ul>"},{"location":"tags/#t1114003","title":"T1114.003","text":"<ul> <li>6.2.15 Ensure no local interactive user has .forward files</li> </ul>"},{"location":"tags/#t1135","title":"T1135","text":"<ul> <li>2.2.11 Ensure Samba is not installed</li> </ul>"},{"location":"tags/#t1152","title":"T1152","text":"<ul> <li>6.2.14 Ensure no local interactive user has .netrc files</li> <li>6.2.17 Ensure local interactive user dot files are not group or world writable</li> </ul>"},{"location":"tags/#t1152001","title":"T1152.001","text":"<ul> <li>6.2.14 Ensure no local interactive user has .netrc files</li> </ul>"},{"location":"tags/#t1152003","title":"T1152.003","text":"<ul> <li>6.2.17 Ensure local interactive user dot files are not group or world writable</li> </ul>"},{"location":"tags/#t1152004","title":"T1152.004","text":"<ul> <li>6.2.17 Ensure local interactive user dot files are not group or world writable</li> </ul>"},{"location":"tags/#t1195","title":"T1195","text":"<ul> <li>1.2.1 Ensure package manager repositories are configured</li> <li>1.2.2 Ensure GPG keys are configured</li> </ul>"},{"location":"tags/#t1195001","title":"T1195.001","text":"<ul> <li>1.2.1 Ensure package manager repositories are configured</li> <li>1.2.2 Ensure GPG keys are configured</li> </ul>"},{"location":"tags/#t1195002","title":"T1195.002","text":"<ul> <li>1.2.1 Ensure package manager repositories are configured</li> <li>1.2.2 Ensure GPG keys are configured</li> </ul>"},{"location":"tags/#t1200","title":"T1200","text":"<ul> <li>1.1.2.2 Ensure nodev option set on /tmp partition</li> <li>1.1.3.2 Ensure nodev option set on /var partition</li> <li>1.1.4.4 Ensure nodev option set on /var/tmp partition</li> <li>1.1.5.1 Ensure separate partition exists for /var/log</li> <li>1.1.6.3 Ensure nodev option set on /var/log/audit partition</li> <li>1.1.7.2 Ensure nodev option set on /home partition</li> <li>1.1.8.1 Ensure nodev option set on /dev/shm partition</li> <li>1.1.8.2 Ensure noexec option set on /dev/shm partition</li> </ul>"},{"location":"tags/#t1203","title":"T1203","text":"<ul> <li>1.1.9 Disable Automounting</li> <li>1.2.1 Ensure package manager repositories are configured</li> <li>2.4 Ensure nonessential services are removed or masked</li> <li>2.2.1 Ensure X Window System is not installed</li> <li>2.2.10 Ensure IMAP and POP3 server are not installed</li> <li>2.2.11 Ensure Samba is not installed</li> <li>2.2.12 Ensure HTTP Proxy Server is not installed</li> <li>2.2.13 Ensure SNMP Server is not installed</li> <li>2.2.14 Ensure NIS Server is not installed</li> <li>2.2.16 Ensure rsync service is either not installed or masked</li> <li>2.2.2 Ensure Avahi Server is not installed</li> <li>2.2.3 Ensure CUPS is not installed</li> <li>2.2.4 Ensure DHCP Server is not installed</li> <li>2.2.5 Ensure LDAP server is not installed</li> <li>2.2.7 Ensure DNS Server is not installed</li> <li>2.2.8 Ensure FTP Server is not installed</li> <li>2.2.9 Ensure HTTP server is not installed</li> <li>2.3.1 Ensure NIS Client is not installed</li> <li>2.3.2 Ensure rsh client is not installed</li> <li>2.3.3 Ensure talk client is not installed</li> <li>2.3.4 Ensure telnet client is not installed</li> <li>2.3.5 Ensure LDAP client is not installed</li> <li>2.3.6 Ensure RPC is not installed</li> </ul>"},{"location":"tags/#t1204","title":"T1204","text":"<ul> <li>1.1.2.3 Ensure noexec option set on /tmp partition</li> <li>1.1.4.2 Ensure noexec option set on /var/tmp partition</li> <li>1.1.5.3 Ensure noexec option set on /var/log partition</li> <li>1.1.6.2 Ensure noexec option set on /var/log/audit partition</li> <li>6.2.9 Ensure root PATH Integrity</li> </ul>"},{"location":"tags/#t1204002","title":"T1204.002","text":"<ul> <li>1.1.2.3 Ensure noexec option set on /tmp partition</li> <li>1.1.4.2 Ensure noexec option set on /var/tmp partition</li> <li>1.1.5.3 Ensure noexec option set on /var/log partition</li> <li>1.1.6.2 Ensure noexec option set on /var/log/audit partition</li> <li>6.2.9 Ensure root PATH Integrity</li> </ul>"},{"location":"tags/#t1210","title":"T1210","text":"<ul> <li>1.2.1 Ensure package manager repositories are configured</li> <li>2.4 Ensure nonessential services are removed or masked</li> <li>2.2.1 Ensure X Window System is not installed</li> <li>2.2.10 Ensure IMAP and POP3 server are not installed</li> <li>2.2.11 Ensure Samba is not installed</li> <li>2.2.12 Ensure HTTP Proxy Server is not installed</li> <li>2.2.13 Ensure SNMP Server is not installed</li> <li>2.2.14 Ensure NIS Server is not installed</li> <li>2.2.15 Ensure mail transfer agent is configured for local-only mode</li> <li>2.2.16 Ensure rsync service is either not installed or masked</li> <li>2.2.2 Ensure Avahi Server is not installed</li> <li>2.2.3 Ensure CUPS is not installed</li> <li>2.2.4 Ensure DHCP Server is not installed</li> <li>2.2.5 Ensure LDAP server is not installed</li> <li>2.2.7 Ensure DNS Server is not installed</li> <li>2.2.8 Ensure FTP Server is not installed</li> <li>2.2.9 Ensure HTTP server is not installed</li> <li>3.1.3 Ensure DCCP is disabled</li> <li>3.1.4 Ensure SCTP is disabled</li> <li>3.1.5 Ensure RDS is disabled</li> <li>3.1.6 Ensure TIPC is disabled</li> <li>5.2.12 Ensure SSH X11 forwarding is disabled</li> </ul>"},{"location":"tags/#t1211","title":"T1211","text":"<ul> <li>1.1.9 Disable Automounting</li> <li>1.2.1 Ensure package manager repositories are configured</li> </ul>"},{"location":"tags/#t1212","title":"T1212","text":"<ul> <li>1.1.9 Disable Automounting</li> <li>1.2.1 Ensure package manager repositories are configured</li> </ul>"},{"location":"tags/#t1222","title":"T1222","text":"<ul> <li>1.7.4 Ensure permissions on /etc/motd are configured</li> <li>1.7.5 Ensure permissions on /etc/issue are configured</li> <li>1.7.6 Ensure permissions on /etc/issue.net are configured</li> <li>6.1.1 Ensure permissions on /etc/passwd are configured</li> <li>6.1.10 Ensure no unowned files or directories exist</li> <li>6.1.11 Ensure no ungrouped files or directories exist</li> <li>6.1.2 Ensure permissions on /etc/passwd- are configured</li> <li>6.1.3 Ensure permissions on /etc/group are configured</li> <li>6.1.4 Ensure permissions on /etc/group- are configured</li> <li>6.1.5 Ensure permissions on /etc/shadow are configured</li> <li>6.1.6 Ensure permissions on /etc/shadow- are configured</li> <li>6.1.7 Ensure permissions on /etc/gshadow are configured</li> <li>E6.1.8 Ensure permissions on /etc/gshadow- are configured</li> <li>6.1.9 Ensure no world writable files exist</li> <li>6.2.12 Ensure local interactive users own their home directories</li> <li>6.2.13 Ensure local interactive user home directories are mode 750 or more restrictive</li> <li>6.2.17 Ensure local interactive user dot files are not group or world writable</li> <li>6.2.3 Ensure all groups in /etc/passwd exist in /etc/group</li> </ul>"},{"location":"tags/#t1222001","title":"T1222.001","text":"<ul> <li>6.2.17 Ensure local interactive user dot files are not group or world writable</li> </ul>"},{"location":"tags/#t1222002","title":"T1222.002","text":"<ul> <li>1.7.4 Ensure permissions on /etc/motd are configured</li> <li>1.7.5 Ensure permissions on /etc/issue are configured</li> <li>1.7.6 Ensure permissions on /etc/issue.net are configured</li> <li>6.1.1 Ensure permissions on /etc/passwd are configured</li> <li>6.1.10 Ensure no unowned files or directories exist</li> <li>6.1.11 Ensure no ungrouped files or directories exist</li> <li>6.1.2 Ensure permissions on /etc/passwd- are configured</li> <li>6.1.3 Ensure permissions on /etc/group are configured</li> <li>6.1.4 Ensure permissions on /etc/group- are configured</li> <li>6.1.5 Ensure permissions on /etc/shadow are configured</li> <li>6.1.6 Ensure permissions on /etc/shadow- are configured</li> <li>6.1.7 Ensure permissions on /etc/gshadow are configured</li> <li>E6.1.8 Ensure permissions on /etc/gshadow- are configured</li> <li>6.1.9 Ensure no world writable files exist</li> <li>6.2.12 Ensure local interactive users own their home directories</li> <li>6.2.13 Ensure local interactive user home directories are mode 750 or more restrictive</li> <li>6.2.17 Ensure local interactive user dot files are not group or world writable</li> <li>6.2.3 Ensure all groups in /etc/passwd exist in /etc/group</li> </ul>"},{"location":"tags/#t1498","title":"T1498","text":"<ul> <li>2.1.4.2 Ensure ntp is configured with authorized timeserver</li> <li>3.3.5 Ensure broadcast ICMP requests are ignored</li> <li>3.3.7 Ensure Reverse Path Filtering is enabled</li> </ul>"},{"location":"tags/#t1498001","title":"T1498.001","text":"<ul> <li>3.3.5 Ensure broadcast ICMP requests are ignored</li> <li>3.3.7 Ensure Reverse Path Filtering is enabled</li> </ul>"},{"location":"tags/#t1498002","title":"T1498.002","text":"<ul> <li>2.1.4.2 Ensure ntp is configured with authorized timeserver</li> </ul>"},{"location":"tags/#t1499","title":"T1499","text":"<ul> <li>1.1.2.1 Ensure /tmp is a separate partition</li> <li>1.1.3.1 Ensure separate partition exists for /var</li> <li>1.1.4.1 Ensure separate partition exists for /var/tmp</li> <li>1.1.6.1 Ensure separate partition exists for /var/log/audit</li> <li>1.1.7.1 Ensure separate partition exists for /home</li> <li>3.3.8 Ensure TCP SYN Cookies is enabled</li> <li>5.2.19 Ensure SSH MaxStartups is configured</li> <li>5.2.20 Ensure SSH MaxSessions is set to 10 or less</li> <li>5.2.21 Ensure SSH LoginGraceTime is set to one minute or less</li> </ul>"},{"location":"tags/#t1499001","title":"T1499.001","text":"<ul> <li>1.1.2.1 Ensure /tmp is a separate partition</li> <li>1.1.3.1 Ensure separate partition exists for /var</li> <li>1.1.4.1 Ensure separate partition exists for /var/tmp</li> <li>1.1.6.1 Ensure separate partition exists for /var/log/audit</li> <li>1.1.7.1 Ensure separate partition exists for /home</li> <li>3.3.8 Ensure TCP SYN Cookies is enabled</li> </ul>"},{"location":"tags/#t1499002","title":"T1499.002","text":"<ul> <li>5.2.19 Ensure SSH MaxStartups is configured</li> <li>5.2.20 Ensure SSH MaxSessions is set to 10 or less</li> <li>5.2.21 Ensure SSH LoginGraceTime is set to one minute or less</li> </ul>"},{"location":"tags/#t1542","title":"T1542","text":"<ul> <li>1.4.1 Ensure bootloader password is set</li> <li>1.4.2 Ensure permissions on bootloader config are configured</li> </ul>"},{"location":"tags/#t1543","title":"T1543","text":"<ul> <li>1.8.1 Ensure GNOME Display Manager is removed</li> <li>2.4 Ensure nonessential services are removed or masked</li> <li>2.2.1 Ensure X Window System is not installed</li> <li>2.2.10 Ensure IMAP and POP3 server are not installed</li> <li>2.2.11 Ensure Samba is not installed</li> <li>2.2.12 Ensure HTTP Proxy Server is not installed</li> <li>2.2.13 Ensure SNMP Server is not installed</li> <li>2.2.14 Ensure NIS Server is not installed</li> <li>2.2.16 Ensure rsync service is either not installed or masked</li> <li>2.2.2 Ensure Avahi Server is not installed</li> <li>2.2.3 Ensure CUPS is not installed</li> <li>2.2.4 Ensure DHCP Server is not installed</li> <li>2.2.5 Ensure LDAP server is not installed</li> <li>2.2.7 Ensure DNS Server is not installed</li> <li>2.2.8 Ensure FTP Server is not installed</li> <li>2.2.9 Ensure HTTP server is not installed</li> <li>2.3.1 Ensure NIS Client is not installed</li> <li>2.3.2 Ensure rsh client is not installed</li> <li>2.3.3 Ensure talk client is not installed</li> <li>2.3.4 Ensure telnet client is not installed</li> <li>2.3.5 Ensure LDAP client is not installed</li> <li>2.3.6 Ensure RPC is not installed</li> <li>5.2.1 Ensure permissions on /etc/ssh/sshd_config are configured</li> </ul>"},{"location":"tags/#t1543002","title":"T1543.002","text":"<ul> <li>1.8.1 Ensure GNOME Display Manager is removed</li> <li>2.4 Ensure nonessential services are removed or masked</li> <li>2.2.1 Ensure X Window System is not installed</li> <li>2.2.10 Ensure IMAP and POP3 server are not installed</li> <li>2.2.11 Ensure Samba is not installed</li> <li>2.2.12 Ensure HTTP Proxy Server is not installed</li> <li>2.2.13 Ensure SNMP Server is not installed</li> <li>2.2.14 Ensure NIS Server is not installed</li> <li>2.2.16 Ensure rsync service is either not installed or masked</li> <li>2.2.2 Ensure Avahi Server is not installed</li> <li>2.2.3 Ensure CUPS is not installed</li> <li>2.2.4 Ensure DHCP Server is not installed</li> <li>2.2.5 Ensure LDAP server is not installed</li> <li>2.2.7 Ensure DNS Server is not installed</li> <li>2.2.8 Ensure FTP Server is not installed</li> <li>2.2.9 Ensure HTTP server is not installed</li> <li>2.3.1 Ensure NIS Client is not installed</li> <li>2.3.2 Ensure rsh client is not installed</li> <li>2.3.3 Ensure talk client is not installed</li> <li>2.3.4 Ensure telnet client is not installed</li> <li>2.3.5 Ensure LDAP client is not installed</li> <li>2.3.6 Ensure RPC is not installed</li> <li>5.2.1 Ensure permissions on /etc/ssh/sshd_config are configured</li> </ul>"},{"location":"tags/#t1548","title":"T1548","text":"<ul> <li>1.1.2.4 Ensure nosuid option set on /tmp partition</li> <li>1.1.3.3 Ensure nosuid option set on /var partition</li> <li>1.1.4.3 Ensure nosuid option set on /var/tmp partition</li> <li>1.1.5.4 Ensure nosuid option set on /var/log partition</li> <li>1.1.6.4 Ensure nosuid option set on /var/log/audit partition</li> <li>1.1.7.3 Ensure nosuid option set on /home partition</li> <li>1.1.8.3 Ensure nosuid option set on /dev/shm partition</li> <li>1.4.3 Ensure authentication required for single user mode</li> <li>5.3.2 Ensure sudo commands use pty</li> <li>5.3.7 Ensure access to the su command is restricted</li> <li>5.5.3 Ensure default group for the root account is GID 0</li> <li>6.1.12 Audit SUID executables</li> <li>6.1.13 Audit SGID executables</li> <li>6.2.10 Ensure root is the only UID 0 account</li> </ul>"},{"location":"tags/#t1548001","title":"T1548.001","text":"<ul> <li>1.1.9 Disable Automounting</li> <li>1.1.2.4 Ensure nosuid option set on /tmp partition</li> <li>1.1.3.3 Ensure nosuid option set on /var partition</li> <li>1.1.4.3 Ensure nosuid option set on /var/tmp partition</li> <li>1.1.5.4 Ensure nosuid option set on /var/log partition</li> <li>1.1.6.4 Ensure nosuid option set on /var/log/audit partition</li> <li>1.1.7.3 Ensure nosuid option set on /home partition</li> <li>1.1.8.3 Ensure nosuid option set on /dev/shm partition</li> <li>6.1.12 Audit SUID executables</li> <li>6.1.13 Audit SGID executables</li> </ul>"},{"location":"tags/#t1548003","title":"T1548.003","text":"<ul> <li>5.3.2 Ensure sudo commands use pty</li> </ul>"},{"location":"tags/#t1552","title":"T1552","text":"<ul> <li>5.2.2 Ensure permissions on SSH private host key files are configured</li> </ul>"},{"location":"tags/#t1552004","title":"T1552.004","text":"<ul> <li>5.2.2 Ensure permissions on SSH private host key files are configured</li> </ul>"},{"location":"tags/#t1557","title":"T1557","text":"<ul> <li>1.8.10 Ensure XDCMP is not enabled</li> <li>3.1.1 Ensure system is checked to determine if IPv6 is enabled</li> <li>3.2.1 Ensure packet redirect sending is disabled</li> <li>3.2.2 Ensure IP forwarding is disabled</li> <li>3.3.2 Ensure ICMP redirects are not accepted</li> <li>3.3.3 Ensure secure ICMP redirects are not accepted</li> <li>3.3.9 Ensure IPv6 router advertisements are not accepted</li> <li>5.2.13 Ensure only strong Ciphers are used</li> <li>5.2.14 Ensure only strong MAC algorithms are used</li> <li>5.2.15 Ensure only strong Key Exchange algorithms are used</li> <li>5.2.3 Ensure permissions on SSH public host key files are configured</li> </ul>"},{"location":"tags/#t1562","title":"T1562","text":"<ul> <li>2.1.1.1 Ensure a single time synchronization daemon is in use</li> <li>2.1.2.1 Ensure chrony is configured with authorized timeserver</li> <li>2.1.3.1 Ensure systemd-timesyncd configured with authorized timeserver</li> <li>2.1.4.2 Ensure ntp is configured with authorized timeserver</li> <li>3.3.4 Ensure suspicious packets are logged</li> <li>3.3.6 Ensure bogus ICMP responses are ignored</li> <li>3.5.1.1 Ensure ufw is installed</li> <li>3.5.1.2 Ensure iptables-persistent is not installed with ufw</li> <li>3.5.1.3 Ensure ufw service is enabled</li> <li>3.5.1.4 Ensure ufw loopback traffic is configured</li> <li>3.5.1.6 Ensure ufw firewall rules exist for all open ports</li> <li>3.5.1.7 Ensure ufw default deny firewall policy</li> <li>3.5.2.1 Ensure nftables is installed</li> <li>3.5.2.10 Ensure nftables rules are permanent</li> <li>3.5.2.2 Ensure ufw is uninstalled or disabled with nftables</li> <li>3.5.2.3 Ensure iptables are flushed with nftables</li> <li>3.5.2.4 Ensure a nftables table exists</li> <li>3.5.2.5 Ensure nftables base chains exist</li> <li>3.5.2.6 Ensure nftables loopback traffic is configured</li> <li>3.5.2.7 Ensure nftables outbound and established connections are configured</li> <li>3.5.2.8 Ensure nftables default deny firewall policy</li> <li>3.5.2.9 Ensure nftables service is enabled</li> <li>3.5.3.1.1 Ensure iptables packages are installed</li> <li>3.5.3.1.2 Ensure nftables is not installed with iptables</li> <li>3.5.3.1.3 Ensure ufw is uninstalled or disabled with iptables</li> <li>3.5.3.2.1 Ensure iptables default deny firewall policy</li> <li>3.5.3.2.2 Ensure iptables loopback traffic is configured</li> <li>3.5.3.2.4 Ensure iptables firewall rules exist for all open ports</li> <li>3.5.3.3.1 Ensure ip6tables default deny firewall policy</li> <li>3.5.3.3.2 Ensure ip6tables loopback traffic is configured</li> <li>3.5.3.3.4 Ensure ip6tables firewall rules exist for all open ports</li> <li>4.1.1.1 Ensure auditd is installed</li> <li>4.1.1.2 Ensure auditd service is enabled and active</li> <li>4.1.1.3 Ensure auditing for processes that start prior to auditd is enabled</li> <li>4.1.1.4 Ensure audit_backlog_limit is sufficient</li> <li>4.1.2.1 Ensure audit log storage size is configured</li> <li>4.1.2.2 Ensure audit logs are not automatically deleted</li> <li>4.1.2.3 Ensure system is disabled when audit logs are full</li> <li>4.1.3.1 Ensure changes to system administration scope (sudoers) is collected</li> <li>4.1.3.10 Ensure successful file system mounts are collected</li> <li>4.1.3.11 Ensure session initiation information is collected</li> <li>4.1.3.12 Ensure login and logout events are collected</li> <li>4.1.3.13 Ensure file deletion events by users are collected</li> <li>4.1.3.14 Ensure events that modify the system's Mandatory Access Controls are collected</li> <li>4.1.3.19 Ensure kernel module loading unloading and modification is collected</li> <li>4.1.3.2 Ensure actions as another user are always logged</li> <li>4.1.3.20 Ensure the audit configuration is immutable</li> <li>4.1.3.4 Ensure events that modify date and time information are collected</li> <li>4.1.3.5 Ensure events that modify the system's network environment are collected</li> <li>4.1.3.6 Ensure use of privileged commands are collected</li> <li>4.1.3.7 Ensure unsuccessful file access attempts are collected</li> <li>4.1.3.8 Ensure events that modify user/group information are collected</li> <li>4.1.3.9 Ensure discretionary access control permission modification events are collected</li> <li>4.2.1.2 Ensure journald service is enabled</li> <li>4.2.1.3 Ensure journald is configured to compress large log files</li> <li>4.2.1.4 Ensure journald is configured to write logfiles to persistent disk</li> <li>4.2.1.5 Ensure journald is not configured to send logs to rsyslog</li> <li>4.2.1.1.1 Ensure systemd-journal-remote is installed</li> <li>4.2.1.1.2 Ensure systemd-journal-remote is configured</li> <li>4.2.1.1.3 Ensure systemd-journal-remote is enabled</li> <li>4.2.1.1.4 Ensure journald is not configured to recieve logs from a remote client</li> <li>4.2.2.2 Ensure rsyslog service is enabled</li> <li>4.2.2.6 Ensure rsyslog is configured to send logs to a remote log host</li> <li>4.2.2.7 Ensure rsyslog is not configured to receive logs from a remote client</li> <li>5.1.1 Ensure cron daemon is enabled and running</li> <li>5.2.5 Ensure SSH LogLevel is appropriate</li> <li>5.3.3 Ensure sudo log file exists</li> </ul>"},{"location":"tags/#t1562001","title":"T1562.001","text":"<ul> <li>2.1.1.1 Ensure a single time synchronization daemon is in use</li> <li>2.1.2.1 Ensure chrony is configured with authorized timeserver</li> <li>2.1.3.1 Ensure systemd-timesyncd configured with authorized timeserver</li> <li>2.1.4.2 Ensure ntp is configured with authorized timeserver</li> <li>4.1.1.1 Ensure auditd is installed</li> <li>4.1.1.2 Ensure auditd service is enabled and active</li> <li>4.1.1.3 Ensure auditing for processes that start prior to auditd is enabled</li> <li>4.1.1.4 Ensure audit_backlog_limit is sufficient</li> <li>4.1.3.20 Ensure the audit configuration is immutable</li> <li>4.2.1.2 Ensure journald service is enabled</li> <li>4.2.2.2 Ensure rsyslog service is enabled</li> <li>5.1.1 Ensure cron daemon is enabled and running</li> </ul>"},{"location":"tags/#t1562002","title":"T1562.002","text":"<ul> <li>4.2.1.3 Ensure journald is configured to compress large log files</li> </ul>"},{"location":"tags/#t1562004","title":"T1562.004","text":"<ul> <li>3.5.1.1 Ensure ufw is installed</li> <li>3.5.1.2 Ensure iptables-persistent is not installed with ufw</li> <li>3.5.1.3 Ensure ufw service is enabled</li> <li>3.5.1.4 Ensure ufw loopback traffic is configured</li> <li>3.5.1.6 Ensure ufw firewall rules exist for all open ports</li> <li>3.5.1.7 Ensure ufw default deny firewall policy</li> <li>3.5.2.1 Ensure nftables is installed</li> <li>3.5.2.10 Ensure nftables rules are permanent</li> <li>3.5.2.2 Ensure ufw is uninstalled or disabled with nftables</li> <li>3.5.2.3 Ensure iptables are flushed with nftables</li> <li>3.5.2.4 Ensure a nftables table exists</li> <li>3.5.2.5 Ensure nftables base chains exist</li> <li>3.5.2.6 Ensure nftables loopback traffic is configured</li> <li>3.5.2.8 Ensure nftables default deny firewall policy</li> <li>3.5.2.9 Ensure nftables service is enabled</li> <li>3.5.3.1.1 Ensure iptables packages are installed</li> <li>3.5.3.1.2 Ensure nftables is not installed with iptables</li> <li>3.5.3.1.3 Ensure ufw is uninstalled or disabled with iptables</li> <li>3.5.3.2.1 Ensure iptables default deny firewall policy</li> <li>3.5.3.2.2 Ensure iptables loopback traffic is configured</li> <li>3.5.3.2.4 Ensure iptables firewall rules exist for all open ports</li> <li>3.5.3.3.1 Ensure ip6tables default deny firewall policy</li> <li>3.5.3.3.2 Ensure ip6tables loopback traffic is configured</li> <li>3.5.3.3.4 Ensure ip6tables firewall rules exist for all open ports</li> </ul>"},{"location":"tags/#t1562006","title":"T1562.006","text":"<ul> <li>3.3.4 Ensure suspicious packets are logged</li> <li>3.3.6 Ensure bogus ICMP responses are ignored</li> <li>4.1.2.1 Ensure audit log storage size is configured</li> <li>4.1.2.2 Ensure audit logs are not automatically deleted</li> <li>4.1.2.3 Ensure system is disabled when audit logs are full</li> <li>4.1.3.1 Ensure changes to system administration scope (sudoers) is collected</li> <li>4.1.3.10 Ensure successful file system mounts are collected</li> <li>4.1.3.11 Ensure session initiation information is collected</li> <li>4.1.3.12 Ensure login and logout events are collected</li> <li>4.1.3.13 Ensure file deletion events by users are collected</li> <li>4.1.3.14 Ensure events that modify the system's Mandatory Access Controls are collected</li> <li>4.1.3.19 Ensure kernel module loading unloading and modification is collected</li> <li>4.1.3.2 Ensure actions as another user are always logged</li> <li>4.1.3.4 Ensure events that modify date and time information are collected</li> <li>4.1.3.5 Ensure events that modify the system's network environment are collected</li> <li>4.1.3.6 Ensure use of privileged commands are collected</li> <li>4.1.3.7 Ensure unsuccessful file access attempts are collected</li> <li>4.1.3.8 Ensure events that modify user/group information are collected</li> <li>4.1.3.9 Ensure discretionary access control permission modification events are collected</li> <li>4.2.1.4 Ensure journald is configured to write logfiles to persistent disk</li> <li>4.2.1.5 Ensure journald is not configured to send logs to rsyslog</li> <li>4.2.1.1.1 Ensure systemd-journal-remote is installed</li> <li>4.2.1.1.2 Ensure systemd-journal-remote is configured</li> <li>4.2.1.1.3 Ensure systemd-journal-remote is enabled</li> <li>4.2.1.1.4 Ensure journald is not configured to recieve logs from a remote client</li> <li>4.2.2.6 Ensure rsyslog is configured to send logs to a remote log host</li> <li>4.2.2.7 Ensure rsyslog is not configured to receive logs from a remote client</li> <li>5.2.5 Ensure SSH LogLevel is appropriate</li> <li>5.3.3 Ensure sudo log file exists</li> </ul>"},{"location":"tags/#t1565","title":"T1565","text":"<ul> <li>1.3.1 Ensure AIDE is installed</li> <li>1.3.2 Ensure filesystem integrity is regularly checked</li> <li>1.6.1.1 Ensure AppArmor is installed</li> <li>1.6.1.2 Ensure AppArmor is enabled in the bootloader configuration</li> <li>1.6.1.4 Ensure all AppArmor Profiles are enforcing</li> <li>5.5.4 Ensure default user umask is 027 or more restrictive</li> </ul>"},{"location":"tags/#t1565001","title":"T1565.001","text":"<ul> <li>1.3.1 Ensure AIDE is installed</li> <li>1.3.2 Ensure filesystem integrity is regularly checked</li> <li>1.6.1.1 Ensure AppArmor is installed</li> <li>1.6.1.2 Ensure AppArmor is enabled in the bootloader configuration</li> <li>1.6.1.4 Ensure all AppArmor Profiles are enforcing</li> <li>5.5.4 Ensure default user umask is 027 or more restrictive</li> </ul>"},{"location":"tags/#t1565003","title":"T1565.003","text":"<ul> <li>1.6.1.1 Ensure AppArmor is installed</li> <li>1.6.1.2 Ensure AppArmor is enabled in the bootloader configuration</li> <li>1.6.1.4 Ensure all AppArmor Profiles are enforcing</li> </ul>"},{"location":"tags/#t1570","title":"T1570","text":"<ul> <li>2.2.16 Ensure rsync service is either not installed or masked</li> <li>2.3.1 Ensure NIS Client is not installed</li> <li>2.3.2 Ensure rsh client is not installed</li> </ul>"},{"location":"tags/#t1572","title":"T1572","text":"<ul> <li>5.2.16 Ensure SSH AllowTcpForwarding is disabled</li> </ul>"},{"location":"tags/#t1590","title":"T1590","text":"<ul> <li>3.3.1 Ensure source routed packets are not accepted</li> </ul>"},{"location":"tags/#t1590005","title":"T1590.005","text":"<ul> <li>3.3.1 Ensure source routed packets are not accepted</li> </ul>"},{"location":"tags/#t1592","title":"T1592","text":"<ul> <li>1.7.1 Ensure message of the day is configured properly</li> <li>1.7.2 Ensure local login warning banner is configured properly</li> <li>1.7.3 Ensure remote login warning banner is configured properly</li> </ul>"},{"location":"tags/#t1592004","title":"T1592.004","text":"<ul> <li>1.7.1 Ensure message of the day is configured properly</li> <li>1.7.2 Ensure local login warning banner is configured properly</li> <li>1.7.3 Ensure remote login warning banner is configured properly</li> </ul>"},{"location":"tags/#t1595","title":"T1595","text":"<ul> <li>3.1.1 Ensure system is checked to determine if IPv6 is enabled</li> <li>3.1.2 Ensure wireless interfaces are disabled</li> </ul>"},{"location":"tags/#t1595001","title":"T1595.001","text":"<ul> <li>3.1.1 Ensure system is checked to determine if IPv6 is enabled</li> <li>3.1.2 Ensure wireless interfaces are disabled</li> </ul>"},{"location":"tags/#t1595002","title":"T1595.002","text":"<ul> <li>3.1.1 Ensure system is checked to determine if IPv6 is enabled</li> <li>3.1.2 Ensure wireless interfaces are disabled</li> </ul>"},{"location":"tags/#ta0001","title":"TA0001","text":"<ul> <li>1.2.1 Ensure package manager repositories are configured</li> <li>1.2.2 Ensure GPG keys are configured</li> <li>4.1.3.11 Ensure session initiation information is collected</li> <li>4.1.3.12 Ensure login and logout events are collected</li> <li>5.2.11 Ensure SSH IgnoreRhosts is enabled</li> <li>5.2.17 Ensure SSH warning banner is configured</li> <li>5.2.22 Ensure SSH Idle Timeout Interval is configured</li> <li>5.2.6 Ensure SSH PAM is enabled</li> <li>5.2.8 Ensure SSH HostbasedAuthentication is disabled</li> <li>5.3.1 Ensure sudo is installed</li> <li>5.5.1.4 Ensure inactive password lock is 30 days or less</li> <li>6.2.10 Ensure root is the only UID 0 account</li> </ul>"},{"location":"tags/#ta0002","title":"TA0002","text":"<ul> <li>1.5.1 Ensure address space layout randomization (ASLR) is enabled</li> <li>1.5.2 Ensure prelink is not installed</li> <li>1.8.1 Ensure GNOME Display Manager is removed</li> <li>1.8.10 Ensure XDCMP is not enabled</li> <li>2.1.4.2 Ensure ntp is configured with authorized timeserver</li> <li>4.1.3.6 Ensure use of privileged commands are collected</li> <li>5.1.2 Ensure permissions on /etc/crontab are configured</li> <li>5.1.3 Ensure permissions on /etc/cron.hourly are configured</li> <li>5.1.4 Ensure permissions on /etc/cron.daily are configured</li> <li>5.1.5 Ensure permissions on /etc/cron.weekly are configured</li> <li>5.1.6 Ensure permissions on /etc/cron.monthly are configured</li> <li>5.1.7 Ensure permissions on /etc/cron.d are configured</li> <li>5.1.8 Ensure cron is restricted to authorized users</li> <li>5.1.9 Ensure at is restricted to authorized users</li> </ul>"},{"location":"tags/#ta0003","title":"TA0003","text":"<ul> <li>1.4.1 Ensure bootloader password is set</li> <li>1.6.1.1 Ensure AppArmor is installed</li> <li>1.6.1.2 Ensure AppArmor is enabled in the bootloader configuration</li> <li>4.1.3.5 Ensure events that modify the system's network environment are collected</li> <li>5.2.2 Ensure permissions on SSH private host key files are configured</li> <li>5.2.3 Ensure permissions on SSH public host key files are configured</li> <li>5.3.2 Ensure sudo commands use pty</li> <li>6.2.1 Ensure accounts in /etc/passwd use shadowed passwords</li> <li>6.2.2 Ensure /etc/shadow password fields are not empty</li> <li>6.2.3 Ensure all groups in /etc/passwd exist in /etc/group</li> </ul>"},{"location":"tags/#ta0004","title":"TA0004","text":"<ul> <li>4.1.3.1 Ensure changes to system administration scope (sudoers) is collected</li> <li>4.1.3.14 Ensure events that modify the system's Mandatory Access Controls are collected</li> <li>4.1.3.19 Ensure kernel module loading unloading and modification is collected</li> <li>4.1.3.2 Ensure actions as another user are always logged</li> <li>4.1.3.8 Ensure events that modify user/group information are collected</li> <li>5.3.3 Ensure sudo log file exists</li> <li>6.1.12 Audit SUID executables</li> <li>6.1.13 Audit SGID executables</li> <li>6.2.7 Ensure no duplicate user names exist</li> <li>6.2.8 Ensure no duplicate group names exist</li> </ul>"},{"location":"tags/#ta0005","title":"TA0005","text":"<ul> <li>1.1.10 Disable USB Storage</li> <li>1.1.9 Disable Automounting</li> <li>1.1.1.1 Ensure mounting of cramfs filesystems is disabled</li> <li>1.1.1.2 Ensure mounting of squashfs filesystems is disabled</li> <li>1.1.1.3 Ensure mounting of udf filesystems is disabled</li> <li>1.1.2.1 Ensure /tmp is a separate partition</li> <li>1.1.2.2 Ensure nodev option set on /tmp partition</li> <li>1.1.2.3 Ensure noexec option set on /tmp partition</li> <li>1.1.2.4 Ensure nosuid option set on /tmp partition</li> <li>1.1.3.2 Ensure nodev option set on /var partition</li> <li>1.1.3.3 Ensure nosuid option set on /var partition</li> <li>1.1.4.1 Ensure separate partition exists for /var/tmp</li> <li>1.1.4.2 Ensure noexec option set on /var/tmp partition</li> <li>1.1.4.3 Ensure nosuid option set on /var/tmp partition</li> <li>1.1.4.4 Ensure nodev option set on /var/tmp partition</li> <li>1.1.5.1 Ensure separate partition exists for /var/log</li> <li>1.1.5.2 Ensure nodev option set on /var/log partition</li> <li>1.1.5.3 Ensure noexec option set on /var/log partition</li> <li>1.1.5.4 Ensure nosuid option set on /var/log partition</li> <li>1.1.6.1 Ensure separate partition exists for /var/log/audit</li> <li>1.1.6.2 Ensure noexec option set on /var/log/audit partition</li> <li>1.1.6.3 Ensure nodev option set on /var/log/audit partition</li> <li>1.1.6.4 Ensure nosuid option set on /var/log/audit partition</li> <li>1.1.7.1 Ensure separate partition exists for /home</li> <li>1.1.7.2 Ensure nodev option set on /home partition</li> <li>1.1.7.3 Ensure nosuid option set on /home partition</li> <li>1.1.8.1 Ensure nodev option set on /dev/shm partition</li> <li>1.1.8.2 Ensure noexec option set on /dev/shm partition</li> <li>1.1.8.3 Ensure nosuid option set on /dev/shm partition</li> <li>1.4.2 Ensure permissions on bootloader config are configured</li> <li>1.4.3 Ensure authentication required for single user mode</li> <li>1.6.1.3 Ensure all AppArmor Profiles are in enforce or complain mode</li> <li>1.6.1.4 Ensure all AppArmor Profiles are enforcing</li> <li>1.7.4 Ensure permissions on /etc/motd are configured</li> <li>1.7.5 Ensure permissions on /etc/issue are configured</li> <li>1.7.6 Ensure permissions on /etc/issue.net are configured</li> <li>2.1.1.1 Ensure a single time synchronization daemon is in use</li> <li>2.1.2.1 Ensure chrony is configured with authorized timeserver</li> <li>3.3.4 Ensure suspicious packets are logged</li> <li>3.5.1.2 Ensure iptables-persistent is not installed with ufw</li> <li>3.5.1.3 Ensure ufw service is enabled</li> <li>3.5.2.2 Ensure ufw is uninstalled or disabled with nftables</li> <li>3.5.2.3 Ensure iptables are flushed with nftables</li> <li>3.5.2.5 Ensure nftables base chains exist</li> <li>3.5.2.6 Ensure nftables loopback traffic is configured</li> <li>4.1.1.1 Ensure auditd is installed</li> <li>4.1.1.2 Ensure auditd service is enabled and active</li> <li>4.1.1.3 Ensure auditing for processes that start prior to auditd is enabled</li> <li>4.1.1.4 Ensure audit_backlog_limit is sufficient</li> <li>4.1.2.3 Ensure system is disabled when audit logs are full</li> <li>4.1.3.13 Ensure file deletion events by users are collected</li> <li>4.1.3.20 Ensure the audit configuration is immutable</li> <li>4.1.3.4 Ensure events that modify date and time information are collected</li> <li>4.1.3.9 Ensure discretionary access control permission modification events are collected</li> <li>4.2.1.2 Ensure journald service is enabled</li> <li>4.2.1.4 Ensure journald is configured to write logfiles to persistent disk</li> <li>4.2.2.1 Ensure rsyslog is installed</li> <li>4.2.2.2 Ensure rsyslog service is enabled</li> <li>4.2.2.5 Ensure logging is configured</li> <li>4.2.2.7 Ensure rsyslog is not configured to receive logs from a remote client</li> <li>5.1.1 Ensure cron daemon is enabled and running</li> <li>5.2.1 Ensure permissions on /etc/ssh/sshd_config are configured</li> <li>5.2.5 Ensure SSH LogLevel is appropriate</li> <li>5.3.7 Ensure access to the su command is restricted</li> <li>5.5.2 Ensure system accounts are secured</li> <li>5.5.3 Ensure default group for the root account is GID 0</li> <li>5.5.5 Ensure default user shell timeout is 900 seconds or less</li> <li>6.1.1 Ensure permissions on /etc/passwd are configured</li> <li>6.1.2 Ensure permissions on /etc/passwd- are configured</li> <li>6.1.3 Ensure permissions on /etc/group are configured</li> <li>6.1.4 Ensure permissions on /etc/group- are configured</li> <li>6.1.5 Ensure permissions on /etc/shadow are configured</li> <li>6.1.6 Ensure permissions on /etc/shadow- are configured</li> <li>6.1.7 Ensure permissions on /etc/gshadow are configured</li> <li>E6.1.8 Ensure permissions on /etc/gshadow- are configured</li> <li>6.1.9 Ensure no world writable files exist</li> <li>6.2.11 Ensure local interactive user home directories exist</li> <li>6.2.12 Ensure local interactive users own their home directories</li> <li>6.2.13 Ensure local interactive user home directories are mode 750 or more restrictive</li> <li>6.2.17 Ensure local interactive user dot files are not group or world writable</li> <li>6.2.4 Ensure shadow group is empty</li> <li>6.2.5 Ensure no duplicate UIDs exist</li> <li>6.2.6 Ensure no duplicate GIDs exist</li> </ul>"},{"location":"tags/#ta0006","title":"TA0006","text":"<ul> <li>1.1.3.1 Ensure separate partition exists for /var</li> <li>2.3.3 Ensure talk client is not installed</li> <li>2.3.4 Ensure telnet client is not installed</li> <li>3.2.1 Ensure packet redirect sending is disabled</li> <li>3.2.2 Ensure IP forwarding is disabled</li> <li>3.3.2 Ensure ICMP redirects are not accepted</li> <li>3.3.3 Ensure secure ICMP redirects are not accepted</li> <li>3.3.7 Ensure Reverse Path Filtering is enabled</li> <li>3.3.9 Ensure IPv6 router advertisements are not accepted</li> <li>5.2.13 Ensure only strong Ciphers are used</li> <li>5.2.14 Ensure only strong MAC algorithms are used</li> <li>5.2.15 Ensure only strong Key Exchange algorithms are used</li> <li>5.2.18 Ensure SSH MaxAuthTries is set to 4 or less</li> <li>5.2.2 Ensure permissions on SSH private host key files are configured</li> <li>5.2.21 Ensure SSH LoginGraceTime is set to one minute or less</li> <li>5.2.3 Ensure permissions on SSH public host key files are configured</li> <li>5.4.1 Ensure password creation requirements are configured</li> <li>5.4.2 Ensure lockout for failed password attempts is configured</li> <li>5.4.4 Ensure password hashing algorithm is up to date with the latest standards</li> <li>5.5.1.1 Ensure minimum days between password changes is configured</li> <li>5.5.1.3 Ensure password expiration warning days is 7 or more</li> <li>6.2.14 Ensure no local interactive user has .netrc files</li> <li>6.2.9 Ensure root PATH Integrity</li> </ul>"},{"location":"tags/#ta0007","title":"TA0007","text":"<ul> <li>1.4.2 Ensure permissions on bootloader config are configured</li> <li>1.5.4 Ensure core dumps are restricted</li> <li>1.7.1 Ensure message of the day is configured properly</li> <li>1.7.2 Ensure local login warning banner is configured properly</li> <li>1.7.3 Ensure remote login warning banner is configured properly</li> <li>1.8.2 Ensure GDM login banner is configured</li> <li>1.8.3 Ensure GDM disable-user-list option is enabled</li> <li>3.3.1 Ensure source routed packets are not accepted</li> <li>3.3.2 Ensure ICMP redirects are not accepted</li> <li>4.1.3.7 Ensure unsuccessful file access attempts are collected</li> <li>4.1.4.1 Ensure audit log files are mode 0640 or less permissive</li> <li>4.1.4.10 Ensure audit tools belong to group root</li> <li>4.1.4.11 Ensure cryptographic mechanisms are used to protect the integrity of audit tool</li> <li>4.1.4.2 Ensure only authorized users own audit log files</li> <li>4.1.4.3 Ensure only authorized groups are assigned ownership of audit log files</li> <li>4.1.4.4 Ensure the audit log directory is 0750 or more restrictive</li> <li>4.1.4.5 Ensure audit configuration files are 640 or more restrictive</li> <li>4.1.4.6 Ensure audit configuration files are owned by root</li> <li>4.1.4.7 Ensure audit configuration files belong to group root</li> <li>4.1.4.8 Ensure audit tools are 755 or more restrictive</li> <li>4.1.4.9 Ensure audit tools are owned by root</li> <li>4.2.3 Ensure all logfiles have appropriate permissions and ownership</li> <li>4.2.1.7 Ensure journald default file permissions configured</li> <li>4.2.2.4 Ensure rsyslog default file permissions are configured</li> <li>5.1.2 Ensure permissions on /etc/crontab are configured</li> <li>5.1.3 Ensure permissions on /etc/cron.hourly are configured</li> <li>5.1.4 Ensure permissions on /etc/cron.daily are configured</li> <li>5.1.5 Ensure permissions on /etc/cron.weekly are configured</li> <li>5.1.6 Ensure permissions on /etc/cron.monthly are configured</li> <li>5.1.7 Ensure permissions on /etc/cron.d are configured</li> <li>5.2.17 Ensure SSH warning banner is configured</li> <li>5.5.4 Ensure default user umask is 027 or more restrictive</li> <li>6.1.10 Ensure no unowned files or directories exist</li> <li>6.1.11 Ensure no ungrouped files or directories exist</li> <li>6.2.16 Ensue no local interactive user has .rhosts files</li> </ul>"},{"location":"tags/#ta0008","title":"TA0008","text":"<ul> <li>2.4 Ensure nonessential services are removed or masked</li> <li>2.2.1 Ensure X Window System is not installed</li> <li>2.2.10 Ensure IMAP and POP3 server are not installed</li> <li>2.2.11 Ensure Samba is not installed</li> <li>2.2.12 Ensure HTTP Proxy Server is not installed</li> <li>2.2.13 Ensure SNMP Server is not installed</li> <li>2.2.14 Ensure NIS Server is not installed</li> <li>2.2.15 Ensure mail transfer agent is configured for local-only mode</li> <li>2.2.16 Ensure rsync service is either not installed or masked</li> <li>2.2.2 Ensure Avahi Server is not installed</li> <li>2.2.3 Ensure CUPS is not installed</li> <li>2.2.4 Ensure DHCP Server is not installed</li> <li>2.2.5 Ensure LDAP server is not installed</li> <li>2.2.7 Ensure DNS Server is not installed</li> <li>2.2.8 Ensure FTP Server is not installed</li> <li>2.2.9 Ensure HTTP server is not installed</li> <li>2.3.1 Ensure NIS Client is not installed</li> <li>2.3.2 Ensure rsh client is not installed</li> <li>2.3.3 Ensure talk client is not installed</li> <li>2.3.4 Ensure telnet client is not installed</li> <li>2.3.5 Ensure LDAP client is not installed</li> <li>2.3.6 Ensure RPC is not installed</li> <li>3.1.1 Ensure system is checked to determine if IPv6 is enabled</li> <li>3.1.3 Ensure DCCP is disabled</li> <li>3.1.4 Ensure SCTP is disabled</li> <li>3.1.5 Ensure RDS is disabled</li> <li>3.1.6 Ensure TIPC is disabled</li> <li>5.2.10 Ensure SSH PermitUserEnvironment is disabled</li> <li>5.2.12 Ensure SSH X11 forwarding is disabled</li> <li>5.2.16 Ensure SSH AllowTcpForwarding is disabled</li> <li>5.2.4 Ensure SSH access is limited</li> <li>5.2.7 Ensure SSH root login is disabled</li> <li>5.2.9 Ensure SSH PermitEmptyPasswords is disabled</li> </ul>"},{"location":"tags/#ta0009","title":"TA0009","text":"<ul> <li>3.2.1 Ensure packet redirect sending is disabled</li> <li>3.2.2 Ensure IP forwarding is disabled</li> <li>3.3.3 Ensure secure ICMP redirects are not accepted</li> </ul>"},{"location":"tags/#ta0010","title":"TA0010","text":"<ul> <li>3.1.2 Ensure wireless interfaces are disabled</li> <li>4.1.3.10 Ensure successful file system mounts are collected</li> <li>6.2.15 Ensure no local interactive user has .forward files</li> </ul>"},{"location":"tags/#ta0011","title":"TA0011","text":"<ul> <li>3.5.1.1 Ensure ufw is installed</li> <li>3.5.1.4 Ensure ufw loopback traffic is configured</li> <li>3.5.1.5 Ensure ufw outbound connections are configured</li> <li>3.5.1.6 Ensure ufw firewall rules exist for all open ports</li> <li>3.5.1.7 Ensure ufw default deny firewall policy</li> <li>3.5.2.1 Ensure nftables is installed</li> <li>3.5.2.10 Ensure nftables rules are permanent</li> <li>3.5.2.4 Ensure a nftables table exists</li> <li>3.5.2.7 Ensure nftables outbound and established connections are configured</li> <li>3.5.2.8 Ensure nftables default deny firewall policy</li> <li>3.5.2.9 Ensure nftables service is enabled</li> <li>3.5.3.1.1 Ensure iptables packages are installed</li> <li>3.5.3.1.2 Ensure nftables is not installed with iptables</li> <li>3.5.3.1.3 Ensure ufw is uninstalled or disabled with iptables</li> <li>3.5.3.2.1 Ensure iptables default deny firewall policy</li> <li>3.5.3.2.2 Ensure iptables loopback traffic is configured</li> <li>3.5.3.2.4 Ensure iptables firewall rules exist for all open ports</li> <li>3.5.3.3.1 Ensure ip6tables default deny firewall policy</li> <li>3.5.3.3.2 Ensure ip6tables loopback traffic is configured</li> <li>3.5.3.3.3 Ensure ip6tables outbound and established connections are configured</li> <li>3.5.3.3.4 Ensure ip6tables firewall rules exist for all open ports</li> </ul>"},{"location":"tags/#ta0040","title":"TA0040","text":"<ul> <li>1.3.2 Ensure filesystem integrity is regularly checked</li> <li>3.3.5 Ensure broadcast ICMP requests are ignored</li> <li>3.3.6 Ensure bogus ICMP responses are ignored</li> <li>3.3.7 Ensure Reverse Path Filtering is enabled</li> <li>3.3.8 Ensure TCP SYN Cookies is enabled</li> <li>3.3.9 Ensure IPv6 router advertisements are not accepted</li> <li>4.1.2.1 Ensure audit log storage size is configured</li> <li>4.1.2.2 Ensure audit logs are not automatically deleted</li> <li>4.2.1.3 Ensure journald is configured to compress large log files</li> <li>4.2.1.5 Ensure journald is not configured to send logs to rsyslog</li> <li>4.2.1.6 Ensure journald log rotation is configured per site policy</li> <li>4.2.1.1.1 Ensure systemd-journal-remote is installed</li> <li>4.2.1.1.2 Ensure systemd-journal-remote is configured</li> <li>4.2.1.1.3 Ensure systemd-journal-remote is enabled</li> <li>4.2.1.1.4 Ensure journald is not configured to recieve logs from a remote client</li> <li>4.2.2.6 Ensure rsyslog is configured to send logs to a remote log host</li> <li>5.2.19 Ensure SSH MaxStartups is configured</li> <li>5.2.20 Ensure SSH MaxSessions is set to 10 or less</li> </ul>"},{"location":"tags/#user-accounts-and-environment","title":"User Accounts and Environment","text":"<ul> <li>5.5.2 Ensure system accounts are secured</li> <li>5.5.3 Ensure default group for the root account is GID 0</li> <li>5.5.4 Ensure default user umask is 027 or more restrictive</li> <li>5.5.5 Ensure default user shell timeout is 900 seconds or less</li> <li>5.5.1.1 Ensure minimum days between password changes is configured</li> <li>5.5.1.2 Ensure password expiration is 365 days or less</li> <li>5.5.1.3 Ensure password expiration warning days is 7 or more</li> <li>5.5.1.4 Ensure inactive password lock is 30 days or less</li> <li>5.5.1.5 Ensure all users last password change date is in the past</li> </ul>"},{"location":"tags/#workstation","title":"Workstation","text":"<ul> <li>1.9 Ensure updates, patches, and additional security software are installed</li> <li>1.1.10 Disable USB Storage</li> <li>1.1.9 Disable Automounting</li> <li>1.1.1.1 Ensure mounting of cramfs filesystems is disabled</li> <li>1.1.1.2 Ensure mounting of squashfs filesystems is disabled</li> <li>1.1.1.3 Ensure mounting of udf filesystems is disabled</li> <li>1.1.2.1 Ensure /tmp is a separate partition</li> <li>1.1.2.2 Ensure nodev option set on /tmp partition</li> <li>1.1.2.3 Ensure noexec option set on /tmp partition</li> <li>1.1.2.4 Ensure nosuid option set on /tmp partition</li> <li>1.1.3.1 Ensure separate partition exists for /var</li> <li>1.1.3.2 Ensure nodev option set on /var partition</li> <li>1.1.3.3 Ensure nosuid option set on /var partition</li> <li>1.1.4.1 Ensure separate partition exists for /var/tmp</li> <li>1.1.4.2 Ensure noexec option set on /var/tmp partition</li> <li>1.1.4.3 Ensure nosuid option set on /var/tmp partition</li> <li>1.1.4.4 Ensure nodev option set on /var/tmp partition</li> <li>1.1.5.1 Ensure separate partition exists for /var/log</li> <li>1.1.5.2 Ensure nodev option set on /var/log partition</li> <li>1.1.5.3 Ensure noexec option set on /var/log partition</li> <li>1.1.5.4 Ensure nosuid option set on /var/log partition</li> <li>1.1.6.1 Ensure separate partition exists for /var/log/audit</li> <li>1.1.6.2 Ensure noexec option set on /var/log/audit partition</li> <li>1.1.6.3 Ensure nodev option set on /var/log/audit partition</li> <li>1.1.6.4 Ensure nosuid option set on /var/log/audit partition</li> <li>1.1.7.1 Ensure separate partition exists for /home</li> <li>1.1.7.2 Ensure nodev option set on /home partition</li> <li>1.1.7.3 Ensure nosuid option set on /home partition</li> <li>1.1.8.1 Ensure nodev option set on /dev/shm partition</li> <li>1.1.8.2 Ensure noexec option set on /dev/shm partition</li> <li>1.1.8.3 Ensure nosuid option set on /dev/shm partition</li> <li>1.2.1 Ensure package manager repositories are configured</li> <li>1.2.2 Ensure GPG keys are configured</li> <li>1.3.1 Ensure AIDE is installed</li> <li>1.3.2 Ensure filesystem integrity is regularly checked</li> <li>1.4.1 Ensure bootloader password is set</li> <li>1.4.2 Ensure permissions on bootloader config are configured</li> <li>1.4.3 Ensure authentication required for single user mode</li> <li>1.5.1 Ensure address space layout randomization (ASLR) is enabled</li> <li>1.5.2 Ensure prelink is not installed</li> <li>1.5.3 Ensure Automatic Error Reporting is not enabled</li> <li>1.5.4 Ensure core dumps are restricted</li> <li>1.6.1.1 Ensure AppArmor is installed</li> <li>1.6.1.2 Ensure AppArmor is enabled in the bootloader configuration</li> <li>1.6.1.3 Ensure all AppArmor Profiles are in enforce or complain mode</li> <li>1.6.1.4 Ensure all AppArmor Profiles are enforcing</li> <li>1.7.1 Ensure message of the day is configured properly</li> <li>1.7.2 Ensure local login warning banner is configured properly</li> <li>1.7.3 Ensure remote login warning banner is configured properly</li> <li>1.7.4 Ensure permissions on /etc/motd are configured</li> <li>1.7.5 Ensure permissions on /etc/issue are configured</li> <li>1.7.6 Ensure permissions on /etc/issue.net are configured</li> <li>1.8.10 Ensure XDCMP is not enabled</li> <li>1.8.4 Ensure GDM screen locks when the user is idle</li> <li>1.8.5 Ensure GDM screen locks cannot be overridden</li> <li>1.8.6 Ensure GDM automatic mounting of removable media is disabled</li> <li>1.8.7 Ensure GDM disabling automatic mounting of removable media is not overridden</li> <li>1.8.8 Ensure GDM autorun-never is enabled</li> <li>1.8.9 Ensure GDM autorun-never is not overridden</li> <li>2.4 Ensure nonessential services are removed or masked</li> <li>2.1.1.1 Ensure a single time synchronization daemon is in use</li> <li>2.1.2.1 Ensure chrony is configured with authorized timeserver</li> <li>2.1.2.2 Ensure chrony is running as user _chrony</li> <li>2.1.2.3 Ensure chrony is enabled and running</li> <li>2.1.3.1 Ensure systemd-timesyncd configured with authorized timeserver</li> <li>2.1.3.2 Ensure systemd-timesyncd is enabled and running</li> <li>2.1.4.1 Ensure ntp access control is configured</li> <li>2.1.4.2 Ensure ntp is configured with authorized timeserver</li> <li>2.1.4.3 Ensure ntp is running as user ntp</li> <li>Ensure mounting of cramfs filesystems is disabled</li> <li>2.2.10 Ensure IMAP and POP3 server are not installed</li> <li>2.2.11 Ensure Samba is not installed</li> <li>2.2.12 Ensure HTTP Proxy Server is not installed</li> <li>2.2.13 Ensure SNMP Server is not installed</li> <li>2.2.14 Ensure NIS Server is not installed</li> <li>2.2.15 Ensure mail transfer agent is configured for local-only mode</li> <li>2.2.16 Ensure rsync service is either not installed or masked</li> <li>2.2.2 Ensure Avahi Server is not installed</li> <li>2.2.3 Ensure CUPS is not installed</li> <li>2.2.4 Ensure DHCP Server is not installed</li> <li>2.2.5 Ensure LDAP server is not installed</li> <li>2.2.6 Ensure NFS is not installed</li> <li>2.2.7 Ensure DNS Server is not installed</li> <li>2.2.8 Ensure FTP Server is not installed</li> <li>2.2.9 Ensure HTTP server is not installed</li> <li>2.3.1 Ensure NIS Client is not installed</li> <li>2.3.2 Ensure rsh client is not installed</li> <li>2.3.3 Ensure talk client is not installed</li> <li>2.3.4 Ensure telnet client is not installed</li> <li>2.3.5 Ensure LDAP client is not installed</li> <li>2.3.6 Ensure RPC is not installed</li> <li>3.1.1 Ensure system is checked to determine if IPv6 is enabled</li> <li>3.1.2 Ensure wireless interfaces are disabled</li> <li>3.1.3 Ensure DCCP is disabled</li> <li>3.1.4 Ensure SCTP is disabled</li> <li>3.1.5 Ensure RDS is disabled</li> <li>3.1.6 Ensure TIPC is disabled</li> <li>3.2.1 Ensure packet redirect sending is disabled</li> <li>3.2.2 Ensure IP forwarding is disabled</li> <li>3.3.1 Ensure source routed packets are not accepted</li> <li>3.3.2 Ensure ICMP redirects are not accepted</li> <li>3.3.3 Ensure secure ICMP redirects are not accepted</li> <li>3.3.4 Ensure suspicious packets are logged</li> <li>3.3.5 Ensure broadcast ICMP requests are ignored</li> <li>3.3.6 Ensure bogus ICMP responses are ignored</li> <li>3.3.7 Ensure Reverse Path Filtering is enabled</li> <li>3.3.8 Ensure TCP SYN Cookies is enabled</li> <li>3.3.9 Ensure IPv6 router advertisements are not accepted</li> <li>3.5.1.1 Ensure ufw is installed</li> <li>3.5.1.2 Ensure iptables-persistent is not installed with ufw</li> <li>3.5.1.3 Ensure ufw service is enabled</li> <li>3.5.1.4 Ensure ufw loopback traffic is configured</li> <li>3.5.1.5 Ensure ufw outbound connections are configured</li> <li>3.5.1.6 Ensure ufw firewall rules exist for all open ports</li> <li>3.5.1.7 Ensure ufw default deny firewall policy</li> <li>3.5.2.1 Ensure nftables is installed</li> <li>3.5.2.10 Ensure nftables rules are permanent</li> <li>3.5.2.2 Ensure ufw is uninstalled or disabled with nftables</li> <li>3.5.2.3 Ensure iptables are flushed with nftables</li> <li>3.5.2.4 Ensure a nftables table exists</li> <li>3.5.2.5 Ensure nftables base chains exist</li> <li>3.5.2.6 Ensure nftables loopback traffic is configured</li> <li>3.5.2.7 Ensure nftables outbound and established connections are configured</li> <li>3.5.2.8 Ensure nftables default deny firewall policy</li> <li>3.5.2.9 Ensure nftables service is enabled</li> <li>3.5.3.1.1 Ensure iptables packages are installed</li> <li>3.5.3.1.2 Ensure nftables is not installed with iptables</li> <li>3.5.3.1.3 Ensure ufw is uninstalled or disabled with iptables</li> <li>3.5.3.2.1 Ensure iptables default deny firewall policy</li> <li>3.5.3.2.2 Ensure iptables loopback traffic is configured</li> <li>3.5.3.2.4 Ensure iptables firewall rules exist for all open ports</li> <li>3.5.3.3.1 Ensure ip6tables default deny firewall policy</li> <li>3.5.3.3.2 Ensure ip6tables loopback traffic is configured</li> <li>3.5.3.3.3 Ensure ip6tables outbound and established connections are configured</li> <li>3.5.3.3.4 Ensure ip6tables firewall rules exist for all open ports</li> <li>4.1.1.1 Ensure auditd is installed</li> <li>4.1.1.2 Ensure auditd service is enabled and active</li> <li>4.1.1.3 Ensure auditing for processes that start prior to auditd is enabled</li> <li>4.1.1.4 Ensure audit_backlog_limit is sufficient</li> <li>4.1.2.1 Ensure audit log storage size is configured</li> <li>4.1.2.2 Ensure audit logs are not automatically deleted</li> <li>4.1.2.3 Ensure system is disabled when audit logs are full</li> <li>4.1.3.1 Ensure changes to system administration scope (sudoers) is collected</li> <li>4.1.3.10 Ensure successful file system mounts are collected</li> <li>4.1.3.11 Ensure session initiation information is collected</li> <li>4.1.3.12 Ensure login and logout events are collected</li> <li>4.1.3.13 Ensure file deletion events by users are collected</li> <li>4.1.3.14 Ensure events that modify the system's Mandatory Access Controls are collected</li> <li>4.1.3.15 Ensure successful and unsuccessful attempts to use the chcon command are recorded</li> <li>4.1.3.16 Ensure successful and unsuccessful attempts to use the setfacl command are recorded</li> <li>4.1.3.17 Ensure successful and unsuccessful attempts to use the chacl command are recorde</li> <li>4.1.3.18 Ensure successful and unsuccessful attempts to use the usermod command are recorded</li> <li>4.1.3.19 Ensure kernel module loading unloading and modification is collected</li> <li>4.1.3.2 Ensure actions as another user are always logged</li> <li>4.1.3.20 Ensure the audit configuration is immutable</li> <li>4.1.3.21 Ensure the running and on disk configuration is the same</li> <li>4.1.3.3 Ensure events that modify the sudo log file are collected</li> <li>4.1.3.4 Ensure events that modify date and time information are collected</li> <li>4.1.3.5 Ensure events that modify the system's network environment are collected</li> <li>4.1.3.6 Ensure use of privileged commands are collected</li> <li>4.1.3.7 Ensure unsuccessful file access attempts are collected</li> <li>4.1.3.8 Ensure events that modify user/group information are collected</li> <li>4.1.3.9 Ensure discretionary access control permission modification events are collected</li> <li>4.1.4.1 Ensure audit log files are mode 0640 or less permissive</li> <li>4.1.4.10 Ensure audit tools belong to group root</li> <li>4.1.4.11 Ensure cryptographic mechanisms are used to protect the integrity of audit tool</li> <li>4.1.4.2 Ensure only authorized users own audit log files</li> <li>4.1.4.3 Ensure only authorized groups are assigned ownership of audit log files</li> <li>4.1.4.4 Ensure the audit log directory is 0750 or more restrictive</li> <li>4.1.4.5 Ensure audit configuration files are 640 or more restrictive</li> <li>4.1.4.6 Ensure audit configuration files are owned by root</li> <li>4.1.4.7 Ensure audit configuration files belong to group root</li> <li>4.1.4.8 Ensure audit tools are 755 or more restrictive</li> <li>4.1.4.9 Ensure audit tools are owned by root</li> <li>4.2.3 Ensure all logfiles have appropriate permissions and ownership</li> <li>4.2.1.2 Ensure journald service is enabled</li> <li>4.2.1.3 Ensure journald is configured to compress large log files</li> <li>4.2.1.4 Ensure journald is configured to write logfiles to persistent disk</li> <li>4.2.1.5 Ensure journald is not configured to send logs to rsyslog</li> <li>4.2.1.6 Ensure journald log rotation is configured per site policy</li> <li>4.2.1.7 Ensure journald default file permissions configured</li> <li>4.2.1.1.1 Ensure systemd-journal-remote is installed</li> <li>4.2.1.1.2 Ensure systemd-journal-remote is configured</li> <li>4.2.1.1.3 Ensure systemd-journal-remote is enabled</li> <li>4.2.1.1.4 Ensure journald is not configured to recieve logs from a remote client</li> <li>4.2.2.1 Ensure rsyslog is installed</li> <li>4.2.2.2 Ensure rsyslog service is enabled</li> <li>4.2.2.3 Ensure journald is configured to send logs to rsyslog</li> <li>4.2.2.4 Ensure rsyslog default file permissions are configured</li> <li>4.2.2.5 Ensure logging is configured</li> <li>4.2.2.6 Ensure rsyslog is configured to send logs to a remote log host</li> <li>4.2.2.7 Ensure rsyslog is not configured to receive logs from a remote client</li> <li>5.1.1 Ensure cron daemon is enabled and running</li> <li>5.1.2 Ensure permissions on /etc/crontab are configured</li> <li>5.1.3 Ensure permissions on /etc/cron.hourly are configured</li> <li>5.1.4 Ensure permissions on /etc/cron.daily are configured</li> <li>5.1.5 Ensure permissions on /etc/cron.weekly are configured</li> <li>5.1.6 Ensure permissions on /etc/cron.monthly are configured</li> <li>5.1.7 Ensure permissions on /etc/cron.d are configured</li> <li>5.1.8 Ensure cron is restricted to authorized users</li> <li>5.1.9 Ensure at is restricted to authorized users</li> <li>5.2.1 Ensure permissions on /etc/ssh/sshd_config are configured</li> <li>5.2.10 Ensure SSH PermitUserEnvironment is disabled</li> <li>5.2.11 Ensure SSH IgnoreRhosts is enabled</li> <li>5.2.12 Ensure SSH X11 forwarding is disabled</li> <li>5.2.13 Ensure only strong Ciphers are used</li> <li>5.2.14 Ensure only strong MAC algorithms are used</li> <li>5.2.15 Ensure only strong Key Exchange algorithms are used</li> <li>5.2.16 Ensure SSH AllowTcpForwarding is disabled</li> <li>5.2.17 Ensure SSH warning banner is configured</li> <li>5.2.18 Ensure SSH MaxAuthTries is set to 4 or less</li> <li>5.2.19 Ensure SSH MaxStartups is configured</li> <li>5.2.2 Ensure permissions on SSH private host key files are configured</li> <li>5.2.20 Ensure SSH MaxSessions is set to 10 or less</li> <li>5.2.21 Ensure SSH LoginGraceTime is set to one minute or less</li> <li>5.2.22 Ensure SSH Idle Timeout Interval is configured</li> <li>5.2.3 Ensure permissions on SSH public host key files are configured</li> <li>5.2.4 Ensure SSH access is limited</li> <li>5.2.5 Ensure SSH LogLevel is appropriate</li> <li>5.2.6 Ensure SSH PAM is enabled</li> <li>5.2.7 Ensure SSH root login is disabled</li> <li>5.2.8 Ensure SSH HostbasedAuthentication is disabled</li> <li>5.2.9 Ensure SSH PermitEmptyPasswords is disabled</li> <li>5.3.1 Ensure sudo is installed</li> <li>5.3.2 Ensure sudo commands use pty</li> <li>5.3.3 Ensure sudo log file exists</li> <li>5.3.4 Ensure users must provide password for privilege escalation</li> <li>5.3.5 Ensure re-authentication for privilege escalation is not disabled globally</li> <li>5.3.6 Ensure sudo authentication timeout is configured correctly</li> <li>5.3.7 Ensure access to the su command is restricted</li> <li>5.4.1 Ensure password creation requirements are configured</li> <li>5.4.2 Ensure lockout for failed password attempts is configured</li> <li>5.4.3 Ensure password reuse is limited</li> <li>5.4.4 Ensure password hashing algorithm is up to date with the latest standards</li> <li>5.5.2 Ensure system accounts are secured</li> <li>5.5.3 Ensure default group for the root account is GID 0</li> <li>5.5.4 Ensure default user umask is 027 or more restrictive</li> <li>5.5.5 Ensure default user shell timeout is 900 seconds or less</li> <li>5.5.1.1 Ensure minimum days between password changes is configured</li> <li>5.5.1.2 Ensure password expiration is 365 days or less</li> <li>5.5.1.3 Ensure password expiration warning days is 7 or more</li> <li>5.5.1.4 Ensure inactive password lock is 30 days or less</li> <li>5.5.1.5 Ensure all users last password change date is in the past</li> <li>6.1.1 Ensure permissions on /etc/passwd are configured</li> <li>6.1.10 Ensure no unowned files or directories exist</li> <li>6.1.11 Ensure no ungrouped files or directories exist</li> <li>6.1.12 Audit SUID executables</li> <li>6.1.13 Audit SGID executables</li> <li>6.1.2 Ensure permissions on /etc/passwd- are configured</li> <li>6.1.3 Ensure permissions on /etc/group are configured</li> <li>6.1.4 Ensure permissions on /etc/group- are configured</li> <li>6.1.5 Ensure permissions on /etc/shadow are configured</li> <li>6.1.6 Ensure permissions on /etc/shadow- are configured</li> <li>6.1.7 Ensure permissions on /etc/gshadow are configured</li> <li>E6.1.8 Ensure permissions on /etc/gshadow- are configured</li> <li>6.1.9 Ensure no world writable files exist</li> <li>6.2.1 Ensure accounts in /etc/passwd use shadowed passwords</li> <li>6.2.10 Ensure root is the only UID 0 account</li> <li>6.2.11 Ensure local interactive user home directories exist</li> <li>6.2.12 Ensure local interactive users own their home directories</li> <li>6.2.13 Ensure local interactive user home directories are mode 750 or more restrictive</li> <li>6.2.14 Ensure no local interactive user has .netrc files</li> <li>6.2.15 Ensure no local interactive user has .forward files</li> <li>6.2.16 Ensue no local interactive user has .rhosts files</li> <li>6.2.17 Ensure local interactive user dot files are not group or world writable</li> <li>6.2.2 Ensure /etc/shadow password fields are not empty</li> <li>6.2.3 Ensure all groups in /etc/passwd exist in /etc/group</li> <li>6.2.4 Ensure shadow group is empty</li> <li>6.2.5 Ensure no duplicate UIDs exist</li> <li>6.2.6 Ensure no duplicate GIDs exist</li> <li>6.2.7 Ensure no duplicate user names exist</li> <li>6.2.8 Ensure no duplicate group names exist</li> <li>6.2.9 Ensure root PATH Integrity</li> </ul>"},{"location":"1-Initial-Setup/1.9-Ensure-updates-patches-and-additional-security-software-are-installed/","title":"1.9 Ensure updates, patches, and additional security software are installed","text":"","tags":["Level 1","Workstation","Server","Initial Setup","Manual","IG1","IG2","IG3","7.3 Perform Automated Operating System Patch Management"]},{"location":"1-Initial-Setup/1.9-Ensure-updates-patches-and-additional-security-software-are-installed/#audit","title":"Audit","text":"<p>Verify there are no updates or patches to install: <pre><code># apt -s upgrade\n</code></pre></p>","tags":["Level 1","Workstation","Server","Initial Setup","Manual","IG1","IG2","IG3","7.3 Perform Automated Operating System Patch Management"]},{"location":"1-Initial-Setup/1.9-Ensure-updates-patches-and-additional-security-software-are-installed/#remediation","title":"Remediation","text":"<p>Run the following command to update all packages following local site policy guidance on applying updates and patches: <pre><code># apt upgrade\n</code></pre></p> <p>OR</p> <pre><code># apt dist-upgrade\n</code></pre>","tags":["Level 1","Workstation","Server","Initial Setup","Manual","IG1","IG2","IG3","7.3 Perform Automated Operating System Patch Management"]},{"location":"1-Initial-Setup/1.1-Filesystem-Configuration/1.1.10-Disable-USB-Storage/","title":"1.1.10 Disable USB Storage","text":"","tags":["Level 1","Level 2","Workstation","Server","Initial Setup","Filesystem Configuration","Disable unused filesystems","Automated","IG2","IG3","10.3 Disable Autorun and Autoplay for Removable Media","T1005","TA0005","M1050"]},{"location":"1-Initial-Setup/1.1-Filesystem-Configuration/1.1.10-Disable-USB-Storage/#audit","title":"Audit","text":"<p>Run the following script to verify usb-storage is disabled: <pre><code>#!/usr/bin/env bash\n{\nl_output=\"\" l_output2=\"\"\nl_mname=\"usb-storage\" # set module name\n# Check how module will be loaded\nl_loadable=\"$(modprobe -n -v \"$l_mname\")\"\nif grep -Pq -- '^\\h*install \\/bin\\/(true|false)' &lt;&lt;&lt; \"$l_loadable\"; then\nl_output=\"$l_output\\n - module: \\\"$l_mname\\\" is not loadable:\\\"$l_loadable\\\"\"\nelse\nl_output2=\"$l_output2\\n - module: \\\"$l_mname\\\" is loadable:\\\"$l_loadable\\\"\"\nfi\n# Check is the module currently loaded\nif ! lsmod | grep \"$l_mname\" &gt; /dev/null 2&gt;&amp;1; then\nl_output=\"$l_output\\n - module: \\\"$l_mname\\\" is not loaded\"\nelse\nl_output2=\"$l_output2\\n - module: \\\"$l_mname\\\" is loaded\"\nfi\n# Check if the module is deny listed\nif grep -Pq -- \"^\\h*blacklist\\h+$l_mname\\b\" /etc/modprobe.d/*; then\nl_output=\"$l_output\\n - module: \\\"$l_mname\\\" is deny listed in:\\\"$(grep -Pl -- \"^\\h*blacklist\\h+$l_mname\\b\" /etc/modprobe.d/*)\\\"\"\nelse\nl_output2=\"$l_output2\\n - module: \\\"$l_mname\\\" is not deny listed\"\nfi\n# Report results. If no failures output in l_output2, we pass\nif [ -z \"$l_output2\" ]; then\necho -e \"\\n- Audit Result:\\n ** PASS **\\n$l_output\\n\"\nelse\necho -e \"\\n- Audit Result:\\n ** FAIL **\\n - Reason(s) for audit failure:\\n$l_output2\\n\" [ -n \"$l_output\" ] &amp;&amp; echo -e \"\\n- Correctly set:\\n$l_output\\n\"\nfi\n}\n</code></pre></p>","tags":["Level 1","Level 2","Workstation","Server","Initial Setup","Filesystem Configuration","Disable unused filesystems","Automated","IG2","IG3","10.3 Disable Autorun and Autoplay for Removable Media","T1005","TA0005","M1050"]},{"location":"1-Initial-Setup/1.1-Filesystem-Configuration/1.1.10-Disable-USB-Storage/#remediation","title":"Remediation","text":"<p>Run the following script to disable usb-storage: <pre><code>#!/usr/bin/env bash\n{\nl_mname=\"usb-storage\" # set module name\nif ! modprobe -n -v \"$l_mname\" | grep -P -- '^\\h*install\\/bin\\/(true|false)'; then\necho -e \" - setting module: \\\"$l_mname\\\" to be not loadable\"\necho -e \"install $l_mname /bin/false\" &gt;&gt; /etc/modprobe.d/\"$l_mname\".conf\n fi\nif lsmod | grep \"$l_mname\" &gt; /dev/null 2&gt;&amp;1; then\necho -e \" - unloading module \\\"$l_mname\\\"\"\nmodprobe -r \"$l_mname\"\nfi\nif ! grep -Pq -- \"^\\h*blacklist\\h+$l_mname\\b\" /etc/modprobe.d/*; then\necho -e \" - deny listing \\\"$l_mname\\\"\"\necho -e \"blacklist $l_mname\" &gt;&gt; /etc/modprobe.d/\"$l_mname\".conf\n fi\n}\n</code></pre></p>","tags":["Level 1","Level 2","Workstation","Server","Initial Setup","Filesystem Configuration","Disable unused filesystems","Automated","IG2","IG3","10.3 Disable Autorun and Autoplay for Removable Media","T1005","TA0005","M1050"]},{"location":"1-Initial-Setup/1.1-Filesystem-Configuration/1.1.9-Disable-Automounting/","title":"1.1.9 Disable Automounting","text":"","tags":["Level 1","Workstation","Server","Initial Setup","Filesystem Configuration","Disable Automounting","Automated","IG1","IG2","IG3","10.3 Disable Autorun and Autoplay for Removable Media","T1068","T1203","T1211","T1212","T1548.001","TA0005","M1038"]},{"location":"1-Initial-Setup/1.1-Filesystem-Configuration/1.1.9-Disable-Automounting/#audit","title":"Audit","text":"<p>As a preference autofs should not be installed unless other packages depend on it.</p> <p>Run the following command to verify autofs is not installed: <pre><code># systemctl is-enabled autofs\nFailed to get unit file state for autofs.service: No such file or directory\n</code></pre></p> <p>Run the following command to verify autofs is not enabled if installed: <pre><code># systemctl is-enabled autofs\ndisabled\n</code></pre></p> <p>Verify result is not \"enabled\"</p>","tags":["Level 1","Workstation","Server","Initial Setup","Filesystem Configuration","Disable Automounting","Automated","IG1","IG2","IG3","10.3 Disable Autorun and Autoplay for Removable Media","T1068","T1203","T1211","T1212","T1548.001","TA0005","M1038"]},{"location":"1-Initial-Setup/1.1-Filesystem-Configuration/1.1.9-Disable-Automounting/#remediation","title":"Remediation","text":"<p>If there are no other packages that depends on autofs, remove the package with: <pre><code># apt purge autofs\n</code></pre></p> <p>OR if there are dependencies on the autofs package: Run the following commands to mask autofs: <pre><code># systemctl stop autofs\n# systemctl mask autofs\n</code></pre></p>","tags":["Level 1","Workstation","Server","Initial Setup","Filesystem Configuration","Disable Automounting","Automated","IG1","IG2","IG3","10.3 Disable Autorun and Autoplay for Removable Media","T1068","T1203","T1211","T1212","T1548.001","TA0005","M1038"]},{"location":"1-Initial-Setup/1.1-Filesystem-Configuration/1.1.1-Disable-unused-filesystems/1.1.1.1-Ensure-mounting-of-cramfs-filesystems-is-disabled/","title":"1.1.1.1 Ensure mounting of cramfs filesystems is disabled","text":"","tags":["Level 1","Workstation","Server","Initial Setup","Filesystem Configuration","Disable unused filesystems","Automated","IG2","IG3","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","T1005","TA0005","M1050"]},{"location":"1-Initial-Setup/1.1-Filesystem-Configuration/1.1.1-Disable-unused-filesystems/1.1.1.1-Ensure-mounting-of-cramfs-filesystems-is-disabled/#audit","title":"Audit","text":"<pre><code>#!/usr/bin/env bash\n{\nl_output=\"\" l_output2=\"\"\nl_mname=\"cramfs\" # set module name\n# Check if the module exists on the system\nif [ -z \"$(modprobe -n -v \"$l_mname\" 2&gt;&amp;1 | grep -Pi -- \"\\h*modprobe:\\h+FATAL:\\h+Module\\h+$l_mname\\h+not\\h+found\\h+in\\h+directory\")\" ]; then\n# Check how module will be loaded\nl_loadable=\"$(modprobe -n -v \"$l_mname\")\"\n[ \"$(wc -l &lt;&lt;&lt; \"$l_loadable\")\" -gt \"1\" ] &amp;&amp; l_loadable=\"$(grep -P -- \"(^\\h*install|\\b$l_mname)\\b\" &lt;&lt;&lt; \"$l_loadable\")\"\nif grep -Pq -- '^\\h*install \\/bin\\/(true|false)' &lt;&lt;&lt; \"$l_loadable\";\nthen\nl_output=\"$l_output\\n - module: \\\"$l_mname\\\" is not loadable:\\\"$l_loadable\\\"\"\nelse\nl_output2=\"$l_output2\\n - module: \\\"$l_mname\\\" is loadable:\\\"$l_loadable\\\"\"\nfi\n# Check is the module currently loaded\nif ! lsmod | grep \"$l_mname\" &gt; /dev/null 2&gt;&amp;1; then\nl_output=\"$l_output\\n - module: \\\"$l_mname\\\" is not loaded\"\nelse\nl_output2=\"$l_output2\\n - module: \\\"$l_mname\\\" is loaded\"\nfi\n# Check if the module is deny listed\nif modprobe --showconfig | grep -Pq -- \"^\\h*blacklist\\h+$l_mname\\b\";\nthen\nl_output=\"$l_output\\n - module: \\\"$l_mname\\\" is deny listed in:\\\"$(grep -Pl -- \"^\\h*blacklist\\h+$l_mname\\b\" /etc/modprobe.d/*)\\\"\"\nelse\nl_output2=\"$l_output2\\n - module: \\\"$l_mname\\\" is not deny listed\"\nfi\nelse\nl_output=\"$l_output\\n - Module \\\"$l_mname\\\" doesn't exist on the system\"\nfi\n# Report results. If no failures output in l_output2, we pass\nif [ -z \"$l_output2\" ]; then\necho -e \"\\n- Audit Result:\\n ** PASS **\\n$l_output\\n\"\nelse\necho -e \"\\n- Audit Result:\\n ** FAIL **\\n - Reason(s) for audit failure:\\n$l_output2\\n\"\n[ -n \"$l_output\" ] &amp;&amp; echo -e \"\\n- Correctly set:\\n$l_output\\n\"\nfi\n}\n</code></pre>","tags":["Level 1","Workstation","Server","Initial Setup","Filesystem Configuration","Disable unused filesystems","Automated","IG2","IG3","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","T1005","TA0005","M1050"]},{"location":"1-Initial-Setup/1.1-Filesystem-Configuration/1.1.1-Disable-unused-filesystems/1.1.1.1-Ensure-mounting-of-cramfs-filesystems-is-disabled/#remediation","title":"Remediation","text":"<pre><code>#!/usr/bin/env bash\n{\nl_mname=\"cramfs\" # set module name\n# Check if the module exists on the system\nif [ -z \"$(modprobe -n -v \"$l_mname\" 2&gt;&amp;1 | grep -Pi -- \"\\h*modprobe:\\h+FATAL:\\h+Module\\h+$l_mname\\h+not\\h+found\\h+in\\h+directory\")\" ]; then\n# Remediate loadable\nl_loadable=\"$(modprobe -n -v \"$l_mname\")\"\n[ \"$(wc -l &lt;&lt;&lt; \"$l_loadable\")\" -gt \"1\" ] &amp;&amp; l_loadable=\"$(grep -P -- \"(^\\h*install|\\b$l_mname)\\b\" &lt;&lt;&lt; \"$l_loadable\")\"\nif ! grep -Pq -- '^\\h*install \\/bin\\/(true|false)' &lt;&lt;&lt; \"$l_loadable\";\nthen\necho -e \" - setting module: \\\"$l_mname\\\" to be not loadable\"\necho -e \"install $l_mname /bin/false\" &gt;&gt; /etc/modprobe.d/\"$l_mname\".conf\n fi\n# Remediate loaded\nif lsmod | grep \"$l_mname\" &gt; /dev/null 2&gt;&amp;1; then\necho -e \" - unloading module \\\"$l_mname\\\"\"\nmodprobe -r \"$l_mname\"\nfi\n# Remediate deny list\nif ! modprobe --showconfig | grep -Pq -- \"^\\h*blacklist\\h+$l_mname\\b\";\nthen\necho -e \" - deny listing \\\"$l_mname\\\"\"\necho -e \"blacklist $l_mname\" &gt;&gt; /etc/modprobe.d/\"$l_mname\".conf\n fi\nelse\necho -e \" - Nothing to remediate\\n - Module \\\"$l_mname\\\" doesn't exist on the system\"\nfi\n}\n</code></pre>","tags":["Level 1","Workstation","Server","Initial Setup","Filesystem Configuration","Disable unused filesystems","Automated","IG2","IG3","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","T1005","TA0005","M1050"]},{"location":"1-Initial-Setup/1.1-Filesystem-Configuration/1.1.1-Disable-unused-filesystems/1.1.1.2-Ensure-mounting-of-squashfs-filesystems-is-disabled/","title":"1.1.1.2 Ensure mounting of squashfs filesystems is disabled","text":"","tags":["Level 2","Workstation","Server","Initial Setup","Filesystem Configuration","Disable unused filesystems","Automated","IG2","IG3","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","T1005","TA0005","M1050"]},{"location":"1-Initial-Setup/1.1-Filesystem-Configuration/1.1.1-Disable-unused-filesystems/1.1.1.2-Ensure-mounting-of-squashfs-filesystems-is-disabled/#audit","title":"Audit","text":"<pre><code>#!/usr/bin/env bash\n{\nl_output=\"\" l_output2=\"\"\nl_mname=\"squashfs\" # set module name\n# Check if the module exists on the system\nif [ -z \"$(modprobe -n -v \"$l_mname\" 2&gt;&amp;1 | grep -Pi -- \"\\h*modprobe:\\h+FATAL:\\h+Module\\h+$l_mname\\h+not\\h+found\\h+in\\h+directory\")\" ]; then\n# Check how module will be loaded\nl_loadable=\"$(modprobe -n -v \"$l_mname\")\"\n[ \"$(wc -l &lt;&lt;&lt; \"$l_loadable\")\" -gt \"1\" ] &amp;&amp; l_loadable=\"$(grep -P -- \"(^\\h*install|\\b$l_mname)\\b\" &lt;&lt;&lt; \"$l_loadable\")\"\nif grep -Pq -- '^\\h*install \\/bin\\/(true|false)' &lt;&lt;&lt; \"$l_loadable\"; then\nl_output=\"$l_output\\n - module: \\\"$l_mname\\\" is not loadable:\\\"$l_loadable\\\"\"\nelse\nl_output2=\"$l_output2\\n - module: \\\"$l_mname\\\" is loadable:\\\"$l_loadable\\\"\"\nfi\n# Check is the module currently loaded\nif ! lsmod | grep \"$l_mname\" &gt; /dev/null 2&gt;&amp;1; then\nl_output=\"$l_output\\n - module: \\\"$l_mname\\\" is not loaded\"\nelse\nl_output2=\"$l_output2\\n - module: \\\"$l_mname\\\" is loaded\"\nfi\n# Check if the module is deny listed\nif modprobe --showconfig | grep -Pq -- \"^\\h*blacklist\\h+$l_mname\\b\"; then\nl_output=\"$l_output\\n - module: \\\"$l_mname\\\" is deny listed in:\\\"$(grep -Pl -- \"^\\h*blacklist\\h+$l_mname\\b\" /etc/modprobe.d/*)\\\"\"\nelse\nl_output2=\"$l_output2\\n - module: \\\"$l_mname\\\" is not deny listed\"\nfi\nelse\nl_output=\"$l_output\\n - Module \\\"$l_mname\\\" doesn't exist on the system\"\nfi\n# Report results. If no failures output in l_output2, we pass\nif [ -z \"$l_output2\" ]; then\necho -e \"\\n- Audit Result:\\n ** PASS **\\n$l_output\\n\"\nelse\necho -e \"\\n- Audit Result:\\n ** FAIL **\\n - Reason(s) for audit failure:\\n$l_output2\\n\"\n[ -n \"$l_output\" ] &amp;&amp; echo -e \"\\n- Correctly set:\\n$l_output\\n\"\nfi\n}\n</code></pre>","tags":["Level 2","Workstation","Server","Initial Setup","Filesystem Configuration","Disable unused filesystems","Automated","IG2","IG3","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","T1005","TA0005","M1050"]},{"location":"1-Initial-Setup/1.1-Filesystem-Configuration/1.1.1-Disable-unused-filesystems/1.1.1.2-Ensure-mounting-of-squashfs-filesystems-is-disabled/#remediation","title":"Remediation","text":"<pre><code>#!/usr/bin/env bash\n{\nl_mname=\"squashfs\" # set module name\n# Check if the module exists on the system\nif [ -z \"$(modprobe -n -v \"$l_mname\" 2&gt;&amp;1 | grep -Pi -- \"\\h*modprobe:\\h+FATAL:\\h+Module\\h+$l_mname\\h+not\\h+found\\h+in\\h+directory\")\" ]; then\n# Remediate loadable\nl_loadable=\"$(modprobe -n -v \"$l_mname\")\" [ \"$(wc -l &lt;&lt;&lt; \"$l_loadable\")\" -gt \"1\" ] &amp;&amp; l_loadable=\"$(grep -P -- \"(^\\h*install|\\b$l_mname)\\b\" &lt;&lt;&lt; \"$l_loadable\")\"\nif ! grep -Pq -- '^\\h*install \\/bin\\/(true|false)' &lt;&lt;&lt; \"$l_loadable\"; then\necho -e \" - setting module: \\\"$l_mname\\\" to be not loadable\"\necho -e \"install $l_mname /bin/false\" &gt;&gt; /etc/modprobe.d/\"$l_mname\".conf\n fi\n# Remediate loaded\nif lsmod | grep \"$l_mname\" &gt; /dev/null 2&gt;&amp;1; then\necho -e \" - unloading module \\\"$l_mname\\\"\"\nmodprobe -r \"$l_mname\"\nfi\n# Remediate deny list\nif ! modprobe --showconfig | grep -Pq -- \"^\\h*blacklist\\h+$l_mname\\b\"; then\necho -e \" - deny listing \\\"$l_mname\\\"\"\necho -e \"blacklist $l_mname\" &gt;&gt; /etc/modprobe.d/\"$l_mname\".conf\n fi\nelse\necho -e \" - Nothing to remediate\\n - Module \\\"$l_mname\\\" doesn't exist on the system\"\nfi\n}\n</code></pre>","tags":["Level 2","Workstation","Server","Initial Setup","Filesystem Configuration","Disable unused filesystems","Automated","IG2","IG3","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","T1005","TA0005","M1050"]},{"location":"1-Initial-Setup/1.1-Filesystem-Configuration/1.1.1-Disable-unused-filesystems/1.1.1.3-Ensure-mounting-of-udf-filesystems-is-disabled/","title":"1.1.1.3 Ensure mounting of udf filesystems is disabled","text":"","tags":["Level 2","Workstation","Server","Initial Setup","Filesystem Configuration","Disable unused filesystems","Automated","IG2","IG3","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","T1005","TA0005","M1050"]},{"location":"1-Initial-Setup/1.1-Filesystem-Configuration/1.1.1-Disable-unused-filesystems/1.1.1.3-Ensure-mounting-of-udf-filesystems-is-disabled/#audit","title":"Audit","text":"<pre><code>#!/usr/bin/env bash\n{\nl_output=\"\" l_output2=\"\"\nl_mname=\"udf\" # set module name\n# Check if the module exists on the system\nif [ -z \"$(modprobe -n -v \"$l_mname\" 2&gt;&amp;1 | grep -Pi -- \"\\h*modprobe:\\h+FATAL:\\h+Module\\h+$l_mname\\h+not\\h+found\\h+in\\h+directory\")\" ]; then\n# Check how module will be loaded\nl_loadable=\"$(modprobe -n -v \"$l_mname\")\" [ \"$(wc -l &lt;&lt;&lt; \"$l_loadable\")\" -gt \"1\" ] &amp;&amp; l_loadable=\"$(grep -P -- \"(^\\h*install|\\b$l_mname)\\b\" &lt;&lt;&lt; \"$l_loadable\")\"\nif grep -Pq -- '^\\h*install \\/bin\\/(true|false)' &lt;&lt;&lt; \"$l_loadable\"; then\nl_output=\"$l_output\\n - module: \\\"$l_mname\\\" is not loadable:\\\"$l_loadable\\\"\"\nelse\nl_output2=\"$l_output2\\n - module: \\\"$l_mname\\\" is loadable:\\\"$l_loadable\\\"\"\nfi\n# Check is the module currently loaded\nif ! lsmod | grep \"$l_mname\" &gt; /dev/null 2&gt;&amp;1; then\nl_output=\"$l_output\\n - module: \\\"$l_mname\\\" is not loaded\"\nelse\nl_output2=\"$l_output2\\n - module: \\\"$l_mname\\\" is loaded\"\nfi\n# Check if the module is deny listed\nif modprobe --showconfig | grep -Pq -- \"^\\h*blacklist\\h+$l_mname\\b\"; then\nl_output=\"$l_output\\n - module: \\\"$l_mname\\\" is deny listed in:\\\"$(grep -Pl -- \"^\\h*blacklist\\h+$l_mname\\b\" /etc/modprobe.d/*)\\\"\"\nelse\nl_output2=\"$l_output2\\n - module: \\\"$l_mname\\\" is not deny listed\"\nfi\nelse\nl_output=\"$l_output\\n - Module \\\"$l_mname\\\" doesn't exist on the system\"\nfi\n# Report results. If no failures output in l_output2, we pass\nif [ -z \"$l_output2\" ]; then\necho -e \"\\n- Audit Result:\\n ** PASS **\\n$l_output\\n\"\nelse\necho -e \"\\n- Audit Result:\\n ** FAIL **\\n - Reason(s) for audit failure:\\n$l_output2\\n\"\n[ -n \"$l_output\" ] &amp;&amp; echo -e \"\\n- Correctly set:\\n$l_output\\n\"\nfi\n}\n</code></pre>","tags":["Level 2","Workstation","Server","Initial Setup","Filesystem Configuration","Disable unused filesystems","Automated","IG2","IG3","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","T1005","TA0005","M1050"]},{"location":"1-Initial-Setup/1.1-Filesystem-Configuration/1.1.1-Disable-unused-filesystems/1.1.1.3-Ensure-mounting-of-udf-filesystems-is-disabled/#remediation","title":"Remediation","text":"<pre><code>#!/usr/bin/env bash\n{\nl_mname=\"udf\" # set module name\n# Check if the module exists on the system\nif [ -z \"$(modprobe -n -v \"$l_mname\" 2&gt;&amp;1 | grep -Pi -- \"\\h*modprobe:\\h+FATAL:\\h+Module\\h+$l_mname\\h+not\\h+found\\h+in\\h+directory\")\" ]; then\n# Remediate loadable\nl_loadable=\"$(modprobe -n -v \"$l_mname\")\" [ \"$(wc -l &lt;&lt;&lt; \"$l_loadable\")\" -gt \"1\" ] &amp;&amp; l_loadable=\"$(grep -P -- \"(^\\h*install|\\b$l_mname)\\b\" &lt;&lt;&lt; \"$l_loadable\")\"\nif ! grep -Pq -- '^\\h*install \\/bin\\/(true|false)' &lt;&lt;&lt; \"$l_loadable\"; then\necho -e \" - setting module: \\\"$l_mname\\\" to be not loadable\"\necho -e \"install $l_mname /bin/false\" &gt;&gt; /etc/modprobe.d/\"$l_mname\".conf\n fi\n# Remediate loaded\nif lsmod | grep \"$l_mname\" &gt; /dev/null 2&gt;&amp;1; then\necho -e \" - unloading module \\\"$l_mname\\\"\"\nmodprobe -r \"$l_mname\"\nfi\n# Remediate deny list\nif ! modprobe --showconfig | grep -Pq -- \"^\\h*blacklist\\h+$l_mname\\b\"; then\necho -e \" - deny listing \\\"$l_mname\\\"\"\necho -e \"blacklist $l_mname\" &gt;&gt; /etc/modprobe.d/\"$l_mname\".conf\n fi\nelse\necho -e \" - Nothing to remediate\\n - Module \\\"$l_mname\\\" doesn't exist on the system\"\nfi\n}\n</code></pre>","tags":["Level 2","Workstation","Server","Initial Setup","Filesystem Configuration","Disable unused filesystems","Automated","IG2","IG3","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","T1005","TA0005","M1050"]},{"location":"1-Initial-Setup/1.1-Filesystem-Configuration/1.1.2-Configure-tmp/1.1.2.1-Ensure-tmp-is-a-separate-partition/","title":"1.1.2.1 Ensure /tmp is a separate partition","text":"","tags":["Level 1","Workstation","Server","Initial Setup","Filesystem Configuration","Configure /tmp","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1499","T1499.001","TA0005","M1022"]},{"location":"1-Initial-Setup/1.1-Filesystem-Configuration/1.1.2-Configure-tmp/1.1.2.1-Ensure-tmp-is-a-separate-partition/#audit","title":"Audit","text":"<p>Run the following command and verify the output shows that /tmp is mounted. Particular requirements pertaining to mount options are covered in ensuing sections. <pre><code># findmnt --kernel /tmp\nTARGET SOURCE FSTYPE OPTIONS\n/tmp tmpfs tmpfs rw,nosuid,nodev,noexec,inode6\n</code></pre> Ensure that systemd will mount the /tmp partition at boot time <pre><code># systemctl is-enabled tmp.mount\nenabled\n</code></pre> Note that by default systemd will output generated if there is an entry in /etc/fstab for /tmp. This just means systemd will use the entry in /etc/fstab instead of it's default unit file configuration for /tmp.</p>","tags":["Level 1","Workstation","Server","Initial Setup","Filesystem Configuration","Configure /tmp","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1499","T1499.001","TA0005","M1022"]},{"location":"1-Initial-Setup/1.1-Filesystem-Configuration/1.1.2-Configure-tmp/1.1.2.1-Ensure-tmp-is-a-separate-partition/#remediation","title":"Remediation","text":"<p>First ensure that systemd is correctly configured to ensure that /tmp will be mounted at boot time. <pre><code># systemctl unmask tmp.mount\n</code></pre> For specific configuration requirements of the /tmp mount for your environment, modify /etc/fstab or tmp.mount. Example of /etc/fstab configured tmpfs file system with specific mount options: <pre><code>tmpfs /tmp tmpfs defaults,rw,nosuid,nodev,noexec,relatime,size=2G 0 0\n</code></pre> Example of tmp.mount configured tmpfs file system with specific mount options: <pre><code>[Unit]\nDescription=Temporary Directory /tmp\nConditionPathIsSymbolicLink=!/tmp\nDefaultDependencies=no\nConflicts=umount.target\nBefore=local-fs.target umount.target\nAfter=swap.target\n\n[Mount]\nWhat=tmpfs\nWhere=/tmp\nType=tmpfs\n</code></pre></p>","tags":["Level 1","Workstation","Server","Initial Setup","Filesystem Configuration","Configure /tmp","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1499","T1499.001","TA0005","M1022"]},{"location":"1-Initial-Setup/1.1-Filesystem-Configuration/1.1.2-Configure-tmp/1.1.2.2-Ensure-nodev-option-set-on-tmp-partition/","title":"1.1.2.2 Ensure nodev option set on /tmp partition","text":"","tags":["Level 1","Workstation","Server","Initial Setup","Filesystem Configuration","Configure /tmp","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1200","TA0005","M1022"]},{"location":"1-Initial-Setup/1.1-Filesystem-Configuration/1.1.2-Configure-tmp/1.1.2.2-Ensure-nodev-option-set-on-tmp-partition/#audit","title":"Audit","text":"<p>Verify that the nodev option is set for the /tmp mount. Run the following command to verify that the nodev mount option is set. Example: <pre><code># findmnt --kernel /tmp | grep nodev\n/tmp tmpfs tmpfs rw,nosuid,nodev,noexec,relatime,seclabel\n</code></pre></p>","tags":["Level 1","Workstation","Server","Initial Setup","Filesystem Configuration","Configure /tmp","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1200","TA0005","M1022"]},{"location":"1-Initial-Setup/1.1-Filesystem-Configuration/1.1.2-Configure-tmp/1.1.2.2-Ensure-nodev-option-set-on-tmp-partition/#remediation","title":"Remediation","text":"<p>Edit the /etc/fstab file and add nodev to the fourth field (mounting options) for the /tmp partition. Example: <pre><code>&lt;device&gt; /tmp &lt;fstype&gt; defaults,rw,nosuid,nodev,noexec,relatime 0 0\n</code></pre> Run the following command to remount /tmp with the configured options: <pre><code>mount -o remount /tmp\n</code></pre></p>","tags":["Level 1","Workstation","Server","Initial Setup","Filesystem Configuration","Configure /tmp","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1200","TA0005","M1022"]},{"location":"1-Initial-Setup/1.1-Filesystem-Configuration/1.1.2-Configure-tmp/1.1.2.3-Ensure-noexec-option-set-on-tmp-partition/","title":"1.1.2.3 Ensure noexec option set on /tmp partition","text":"","tags":["Level 1","Workstation","Server","Initial Setup","Filesystem Configuration","Configure /tmp","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1204","T1204.002","TA0005","M1022"]},{"location":"1-Initial-Setup/1.1-Filesystem-Configuration/1.1.2-Configure-tmp/1.1.2.3-Ensure-noexec-option-set-on-tmp-partition/#audit","title":"Audit","text":"<p>Verify that the noexec option is set for the /tmp mount. Run the following command to verify that the noexec mount option is set. Example: <pre><code># findmnt --kernel /tmp | grep noexec\n/tmp tmpfs tmpfs rw,nosuid,nodev,noexec,relatime,seclabel\n</code></pre></p>","tags":["Level 1","Workstation","Server","Initial Setup","Filesystem Configuration","Configure /tmp","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1204","T1204.002","TA0005","M1022"]},{"location":"1-Initial-Setup/1.1-Filesystem-Configuration/1.1.2-Configure-tmp/1.1.2.3-Ensure-noexec-option-set-on-tmp-partition/#remediation","title":"Remediation","text":"<p>Edit the /etc/fstab file and add noexec to the fourth field (mounting options) for the /tmp partition. Example: <pre><code>&lt;device&gt; /tmp &lt;fstype&gt; defaults,rw,nosuid,nodev,noexec,relatime 0 0\n</code></pre> Run the following command to remount /tmp with the configured options: <pre><code># mount -o remount /tmp\n</code></pre></p>","tags":["Level 1","Workstation","Server","Initial Setup","Filesystem Configuration","Configure /tmp","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1204","T1204.002","TA0005","M1022"]},{"location":"1-Initial-Setup/1.1-Filesystem-Configuration/1.1.2-Configure-tmp/1.1.2.4-Ensure-nosuid-option-set-on-tmp-partition/","title":"1.1.2.4 Ensure nosuid option set on /tmp partition","text":"","tags":["Level 1","Workstation","Server","Initial Setup","Filesystem Configuration","Configure /tmp","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1548","T1548.001","TA0005","M1022"]},{"location":"1-Initial-Setup/1.1-Filesystem-Configuration/1.1.2-Configure-tmp/1.1.2.4-Ensure-nosuid-option-set-on-tmp-partition/#audit","title":"Audit","text":"<p>Verify that the nosuid option is set for the /tmp mount. Run the following command to verify that the nosuid mount option is set. Example: <pre><code># findmnt --kernel /tmp | grep nosuid\n/tmp tmpfs tmpfs rw,nosuid,nodev,noexec,relatime,seclabel\n</code></pre></p>","tags":["Level 1","Workstation","Server","Initial Setup","Filesystem Configuration","Configure /tmp","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1548","T1548.001","TA0005","M1022"]},{"location":"1-Initial-Setup/1.1-Filesystem-Configuration/1.1.2-Configure-tmp/1.1.2.4-Ensure-nosuid-option-set-on-tmp-partition/#remediation","title":"Remediation","text":"<p>Edit the /etc/fstab file and add nosuid to the fourth field (mounting options) for the /tmp partition. Example: <pre><code>&lt;device&gt; /tmp &lt;fstype&gt; defaults,rw,nosuid,nodev,noexec,relatime 0 0\n</code></pre> Run the following command to remount /tmp with the configured options: <pre><code># mount -o remount /tmp\n</code></pre></p>","tags":["Level 1","Workstation","Server","Initial Setup","Filesystem Configuration","Configure /tmp","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1548","T1548.001","TA0005","M1022"]},{"location":"1-Initial-Setup/1.1-Filesystem-Configuration/1.1.3-Configure-var/1.1.3.1-Ensure-separate-partition-exists-for-var/","title":"1.1.3.1 Ensure separate partition exists for /var","text":"","tags":["Level 2","Workstation","Server","Initial Setup","Filesystem Configuration","Configure /var","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1499","T1499.001","TA0006"]},{"location":"1-Initial-Setup/1.1-Filesystem-Configuration/1.1.3-Configure-var/1.1.3.1-Ensure-separate-partition-exists-for-var/#audit","title":"Audit","text":"<p>Run the following command and verify output shows /var is mounted.</p> <p>Example: <pre><code># findmnt --kernel /var\nTARGET SOURCE FSTYPE OPTIONS\n/var /dev/sdb ext4 rw,relatime,seclabel,data=ordered\n</code></pre></p>","tags":["Level 2","Workstation","Server","Initial Setup","Filesystem Configuration","Configure /var","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1499","T1499.001","TA0006"]},{"location":"1-Initial-Setup/1.1-Filesystem-Configuration/1.1.3-Configure-var/1.1.3.1-Ensure-separate-partition-exists-for-var/#remediation","title":"Remediation","text":"<p>For new installations, during installation create a custom partition setup and specify a separate partition for /var.</p> <p>For systems that were previously installed, create a new partition and configure /etc/fstab as appropriate.</p>","tags":["Level 2","Workstation","Server","Initial Setup","Filesystem Configuration","Configure /var","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1499","T1499.001","TA0006"]},{"location":"1-Initial-Setup/1.1-Filesystem-Configuration/1.1.3-Configure-var/1.1.3.2-Ensure-nodev-option-set-on-var-partition/","title":"1.1.3.2 Ensure nodev option set on /var partition","text":"","tags":["Level 1","Workstation","Server","Initial Setup","Filesystem Configuration","Configure /var","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1200","TA0005","M1038"]},{"location":"1-Initial-Setup/1.1-Filesystem-Configuration/1.1.3-Configure-var/1.1.3.2-Ensure-nodev-option-set-on-var-partition/#audit","title":"Audit","text":"<p>Verify that the nodev option is set for the /var mount.</p> <p>Run the following command to verify that the nodev mount option is set.</p> <p>Example: <pre><code># findmnt --kernel /var\n/var /dev/sdb ext4 rw,nosuid,nodev,relatime,seclabel\n</code></pre></p> <p>IF output is produced, ensure it includes the nodev option</p>","tags":["Level 1","Workstation","Server","Initial Setup","Filesystem Configuration","Configure /var","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1200","TA0005","M1038"]},{"location":"1-Initial-Setup/1.1-Filesystem-Configuration/1.1.3-Configure-var/1.1.3.2-Ensure-nodev-option-set-on-var-partition/#remediation","title":"Remediation","text":"<p>IF the /var partition exists, edit the /etc/fstab file and add nodev to the fourth field (mounting options) for the /var partition.</p> <p>Example: <pre><code>&lt;device&gt; /var &lt;fstype&gt; defaults,rw,nosuid,nodev,relatime 0 0\n</code></pre></p> <p>Run the following command to remount /var with the configured options: <pre><code># mount -o remount /var\n</code></pre></p>","tags":["Level 1","Workstation","Server","Initial Setup","Filesystem Configuration","Configure /var","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1200","TA0005","M1038"]},{"location":"1-Initial-Setup/1.1-Filesystem-Configuration/1.1.3-Configure-var/1.1.3.3-Ensure-nosuid-option-set-on-var-partition/","title":"1.1.3.3 Ensure nosuid option set on /var partition","text":"","tags":["Level 1","Workstation","Server","Initial Setup","Filesystem Configuration","Configure /var","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1548","T1548.001","TA0005","M1038"]},{"location":"1-Initial-Setup/1.1-Filesystem-Configuration/1.1.3-Configure-var/1.1.3.3-Ensure-nosuid-option-set-on-var-partition/#audit","title":"Audit","text":"<p>Verify that the nosuid option is set for the /var mount.</p> <p>Run the following command to verify that the nosuid mount option is set.</p> <p>Example: <pre><code># findmnt --kernel /var\n/var /dev/sdb ext4 rw,nosuid,nodev,relatime,seclabel\n</code></pre></p> <p>IF output is produced, ensure it includes the nosuid option.</p>","tags":["Level 1","Workstation","Server","Initial Setup","Filesystem Configuration","Configure /var","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1548","T1548.001","TA0005","M1038"]},{"location":"1-Initial-Setup/1.1-Filesystem-Configuration/1.1.3-Configure-var/1.1.3.3-Ensure-nosuid-option-set-on-var-partition/#remediation","title":"Remediation","text":"<p>IF the /var partition exists, edit the /etc/fstab file and add nosuid to the fourth field (mounting options) for the /var partition.</p> <p>Example: <pre><code>&lt;device&gt; /var &lt;fstype&gt; defaults,rw,nosuid,nodev,relatime 0 0\n</code></pre> Run the following command to remount /var with the configured options: <pre><code># mount -o remount /var\n</code></pre></p>","tags":["Level 1","Workstation","Server","Initial Setup","Filesystem Configuration","Configure /var","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1548","T1548.001","TA0005","M1038"]},{"location":"1-Initial-Setup/1.1-Filesystem-Configuration/1.1.4-Configure-var-tmp/1.1.4.1-Ensure-separate-partition-exists-for-var-tmp/","title":"1.1.4.1 Ensure separate partition exists for /var/tmp","text":"","tags":["Level 2","Workstation","Server","Initial Setup","Filesystem Configuration","Configure /var/tmp","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1499","T1499.001","TA0005","M1022"]},{"location":"1-Initial-Setup/1.1-Filesystem-Configuration/1.1.4-Configure-var-tmp/1.1.4.1-Ensure-separate-partition-exists-for-var-tmp/#audit","title":"Audit","text":"<p>Run the following command and verify output shows /var/tmp is mounted.</p> <p>Example: <pre><code># findmnt --kernel /var/tmp\nTARGET SOURCE FSTYPE OPTIONS\n/var/tmp /dev/sdb ext4 rw,relatime,seclabel,data=ordered\n</code></pre></p>","tags":["Level 2","Workstation","Server","Initial Setup","Filesystem Configuration","Configure /var/tmp","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1499","T1499.001","TA0005","M1022"]},{"location":"1-Initial-Setup/1.1-Filesystem-Configuration/1.1.4-Configure-var-tmp/1.1.4.1-Ensure-separate-partition-exists-for-var-tmp/#remediation","title":"Remediation","text":"<p>For new installations, during installation create a custom partition setup and specify a separate partition for /var/tmp.</p> <p>For systems that were previously installed, create a new partition and configure /etc/fstab as appropriate.</p>","tags":["Level 2","Workstation","Server","Initial Setup","Filesystem Configuration","Configure /var/tmp","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1499","T1499.001","TA0005","M1022"]},{"location":"1-Initial-Setup/1.1-Filesystem-Configuration/1.1.4-Configure-var-tmp/1.1.4.2-Ensure-noexec-option-set-on-var-tmp-partition/","title":"1.1.4.2 Ensure noexec option set on /var/tmp partition","text":"","tags":["Level 1","Workstation","Server","Initial Setup","Filesystem Configuration","Configure /var/tmp","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1204","T1204.002","TA0005","M1022"]},{"location":"1-Initial-Setup/1.1-Filesystem-Configuration/1.1.4-Configure-var-tmp/1.1.4.2-Ensure-noexec-option-set-on-var-tmp-partition/#audit","title":"Audit","text":"<p>Verify that the noexec option is set for the /var/tmp mount.</p> <p>Run the following command to verify that the noexec mount option is set.</p> <p>Example: <pre><code># findmnt --kernel /var/tmp\n/var/tmp    /dev/sdb ext4   rw,nosuid,nodev,noexec,relatime,seclabel\n</code></pre></p> <p>IF output is produced, ensure it includes the noexec option</p>","tags":["Level 1","Workstation","Server","Initial Setup","Filesystem Configuration","Configure /var/tmp","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1204","T1204.002","TA0005","M1022"]},{"location":"1-Initial-Setup/1.1-Filesystem-Configuration/1.1.4-Configure-var-tmp/1.1.4.2-Ensure-noexec-option-set-on-var-tmp-partition/#remediation","title":"Remediation","text":"<p>IF the /var/tmp partition exists, edit the /etc/fstab file and add noexec to the fourth field (mounting options) for the /var/tmp partition.</p> <p>Example: <pre><code>&lt;device&gt; /var/tmp   &lt;fstype&gt;    defaults,rw,nosuid,nodev,noexec,relatime    0 0\n</code></pre></p> <p>Run the following command to remount /var/tmp with the configured options: <pre><code># mount -o remount /var/tmp\n</code></pre></p>","tags":["Level 1","Workstation","Server","Initial Setup","Filesystem Configuration","Configure /var/tmp","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1204","T1204.002","TA0005","M1022"]},{"location":"1-Initial-Setup/1.1-Filesystem-Configuration/1.1.4-Configure-var-tmp/1.1.4.3-Ensure-nosuid-option-set-on-var-tmp-partition/","title":"1.1.4.3 Ensure nosuid option set on /var/tmp partition","text":"","tags":["Level 1","Workstation","Server","Initial Setup","Filesystem Configuration","Configure /var/tmp","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1548","T1548.001","TA0005","M1022"]},{"location":"1-Initial-Setup/1.1-Filesystem-Configuration/1.1.4-Configure-var-tmp/1.1.4.3-Ensure-nosuid-option-set-on-var-tmp-partition/#audit","title":"Audit","text":"<p>Verify that the nosuid option is set for the /var/tmp mount.</p> <p>Run the following command to verify that the nosuid mount option is set.</p> <p>Example: <pre><code># findmnt --kernel /var/tmp\n/var/tmp    /dev/sdb ext4   rw,nosuid,nodev,noexec,relatime,seclabel\n</code></pre> IF output is produced, ensure it includes the nosuid option</p>","tags":["Level 1","Workstation","Server","Initial Setup","Filesystem Configuration","Configure /var/tmp","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1548","T1548.001","TA0005","M1022"]},{"location":"1-Initial-Setup/1.1-Filesystem-Configuration/1.1.4-Configure-var-tmp/1.1.4.3-Ensure-nosuid-option-set-on-var-tmp-partition/#remediation","title":"Remediation","text":"<p>IF the /var/tmp partition exists, edit the /etc/fstab file and add nosuid to the fourth field (mounting options) for the /var/tmp partition.</p> <p>Example: <pre><code>&lt;device&gt; /var/tmp   &lt;fstype&gt;    defaults,rw,nosuid,nodev,noexec,relatime    0 0\n</code></pre></p> <p>Run the following command to remount /var/tmp with the configured options: <pre><code># mount -o remount /var/tmp\n</code></pre></p>","tags":["Level 1","Workstation","Server","Initial Setup","Filesystem Configuration","Configure /var/tmp","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1548","T1548.001","TA0005","M1022"]},{"location":"1-Initial-Setup/1.1-Filesystem-Configuration/1.1.4-Configure-var-tmp/1.1.4.4-Ensure-nodev-option-set-on-var-tmp-partition/","title":"1.1.4.4 Ensure nodev option set on /var/tmp partition","text":"","tags":["Level 1","Workstation","Server","Initial Setup","Filesystem Configuration","Configure /var/tmp","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1200","TA0005","M1022"]},{"location":"1-Initial-Setup/1.1-Filesystem-Configuration/1.1.4-Configure-var-tmp/1.1.4.4-Ensure-nodev-option-set-on-var-tmp-partition/#audit","title":"Audit","text":"<p>Verify that the nodev option is set for the /var/tmp mount. Run the following command to verify that the nodev mount option is set. Example: <pre><code># findmnt --kernel /var/tmp\n/var/tmp    /dev/sdb ext4   rw,nosuid,nodev,noexec,relatime,seclabel\n</code></pre> IF output is produced, ensure it includes the nodev option</p>","tags":["Level 1","Workstation","Server","Initial Setup","Filesystem Configuration","Configure /var/tmp","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1200","TA0005","M1022"]},{"location":"1-Initial-Setup/1.1-Filesystem-Configuration/1.1.4-Configure-var-tmp/1.1.4.4-Ensure-nodev-option-set-on-var-tmp-partition/#remediation","title":"Remediation","text":"<p>IF the /var/tmp partition exists, edit the /etc/fstab file and add nodev to the fourth field (mounting options) for the /var/tmp partition.</p> <p>Example: <pre><code>&lt;device&gt; /var/tmp   &lt;fstype&gt;    defaults,rw,nosuid,nodev,noexec,relatime    0 0\n</code></pre></p> <p>Run the following command to remount /var/tmp with the configured options: <pre><code># mount -o remount /var/tmp\n</code></pre></p>","tags":["Level 1","Workstation","Server","Initial Setup","Filesystem Configuration","Configure /var/tmp","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1200","TA0005","M1022"]},{"location":"1-Initial-Setup/1.1-Filesystem-Configuration/1.1.5-Configure-var-log/1.1.5.1-Ensure-separate-partition-exists-for-var-log/","title":"1.1.5.1 Ensure separate partition exists for /var/log","text":"","tags":["Level 2","Workstation","Server","Initial Setup","Filesystem Configuration","Configure /var/log","Automated","IG1","IG2","IG3","8.3 Ensure Adequate Audit Log Storage","T1200","TA0005","M1022"]},{"location":"1-Initial-Setup/1.1-Filesystem-Configuration/1.1.5-Configure-var-log/1.1.5.1-Ensure-separate-partition-exists-for-var-log/#audit","title":"Audit","text":"<p>Run the following command and verify output shows /var/log is mounted: <pre><code># findmnt --kernel /var/log\nTARGET  SOURCE  FSTYPE  OPTIONS\n/var/log    /dev/sdb    ext4    rw,relatime,seclabel,data=ordered\n</code></pre></p>","tags":["Level 2","Workstation","Server","Initial Setup","Filesystem Configuration","Configure /var/log","Automated","IG1","IG2","IG3","8.3 Ensure Adequate Audit Log Storage","T1200","TA0005","M1022"]},{"location":"1-Initial-Setup/1.1-Filesystem-Configuration/1.1.5-Configure-var-log/1.1.5.1-Ensure-separate-partition-exists-for-var-log/#remediation","title":"Remediation","text":"<p>For new installations, during installation create a custom partition setup and specify a separate partition for /var/log.</p> <p>For systems that were previously installed, create a new partition and configure /etc/fstab as appropriate.</p>","tags":["Level 2","Workstation","Server","Initial Setup","Filesystem Configuration","Configure /var/log","Automated","IG1","IG2","IG3","8.3 Ensure Adequate Audit Log Storage","T1200","TA0005","M1022"]},{"location":"1-Initial-Setup/1.1-Filesystem-Configuration/1.1.5-Configure-var-log/1.1.5.2-Ensure-nodev-option-set-on-var-log-partition/","title":"1.1.5.2 Ensure nodev option set on /var/log partition","text":"","tags":["Level 1","Workstation","Server","Initial Setup","Filesystem Configuration","Configure /var/log","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1005","TA0005","M1050"]},{"location":"1-Initial-Setup/1.1-Filesystem-Configuration/1.1.5-Configure-var-log/1.1.5.2-Ensure-nodev-option-set-on-var-log-partition/#audit","title":"Audit","text":"<p>Verify that the nodev option is set for the /var/log mount.</p> <p>Run the following command to verify that the nodev mount option is set.</p> <p>Example: <pre><code># findmnt --kernel /var/log\n/var/log    /dev/sdb ext4   rw,nosuid,nodev,noexec,relatime,seclabel\n</code></pre> IF output is produced, ensure it includes the nodev option</p>","tags":["Level 1","Workstation","Server","Initial Setup","Filesystem Configuration","Configure /var/log","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1005","TA0005","M1050"]},{"location":"1-Initial-Setup/1.1-Filesystem-Configuration/1.1.5-Configure-var-log/1.1.5.2-Ensure-nodev-option-set-on-var-log-partition/#remediation","title":"Remediation","text":"<p>IF the /var/log partition exists, edit the /etc/fstab file and add nodev to the fourth field (mounting options) for the /var/log partition.</p> <p>Example: <pre><code>&lt;device&gt; /var/log   &lt;fstype&gt;    defaults,rw,nosuid,nodev,noexec,relatime    0 0\n</code></pre></p> <p>Run the following command to remount /var/log with the configured options: <pre><code># mount -o remount /var/log\n</code></pre></p>","tags":["Level 1","Workstation","Server","Initial Setup","Filesystem Configuration","Configure /var/log","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1005","TA0005","M1050"]},{"location":"1-Initial-Setup/1.1-Filesystem-Configuration/1.1.5-Configure-var-log/1.1.5.3-Ensure-noexec-option-set-on-var-log-partition/","title":"1.1.5.3 Ensure noexec option set on /var/log partition","text":"","tags":["Level 1","Workstation","Server","Initial Setup","Filesystem Configuration","Configure /var/log","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1204","T1204.002","TA0005","M1022"]},{"location":"1-Initial-Setup/1.1-Filesystem-Configuration/1.1.5-Configure-var-log/1.1.5.3-Ensure-noexec-option-set-on-var-log-partition/#audit","title":"Audit","text":"<p>Verify that the noexec option is set for the /var/log mount.</p> <p>Run the following command to verify that the noexec mount option is set.</p> <p>Example: <pre><code># findmnt --kernel /var/log\n/var/log    /dev/sdb ext4   rw,nosuid,nodev,noexec,relatime,seclabel\n</code></pre></p> <p>IF output is produced, ensure it includes the noexec option</p>","tags":["Level 1","Workstation","Server","Initial Setup","Filesystem Configuration","Configure /var/log","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1204","T1204.002","TA0005","M1022"]},{"location":"1-Initial-Setup/1.1-Filesystem-Configuration/1.1.5-Configure-var-log/1.1.5.3-Ensure-noexec-option-set-on-var-log-partition/#remediation","title":"Remediation","text":"<p>IF the /var/log partition exists, edit the /etc/fstab file and add noexec to the fourth field (mounting options) for the /var/log partition.</p> <p>Example: <pre><code>&lt;device&gt; /var/log   &lt;fstype&gt;    defaults,rw,nosuid,nodev,noexec,relatime    0 0\n</code></pre></p> <p>Run the following command to remount /var/log with the configured options: <pre><code># mount -o remount /var/log\n</code></pre></p>","tags":["Level 1","Workstation","Server","Initial Setup","Filesystem Configuration","Configure /var/log","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1204","T1204.002","TA0005","M1022"]},{"location":"1-Initial-Setup/1.1-Filesystem-Configuration/1.1.5-Configure-var-log/1.1.5.4-Ensure-nosuid-option-set-on-var-log-partition/","title":"1.1.5.4 Ensure nosuid option set on /var/log partition","text":"","tags":["Level 1","Workstation","Server","Initial Setup","Filesystem Configuration","Configure /var/log","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1548","T1548.001","TA0005","M1022"]},{"location":"1-Initial-Setup/1.1-Filesystem-Configuration/1.1.5-Configure-var-log/1.1.5.4-Ensure-nosuid-option-set-on-var-log-partition/#audit","title":"Audit","text":"<p>Verify that the nosuid option is set for the /var/log mount.</p> <p>Run the following command to verify that the nosuid mount option is set.</p> <p>Example: <pre><code># findmnt --kernel /var/log\n/var/log    /dev/sdb ext4   rw,nosuid,nodev,noexec,relatime,seclabel\n</code></pre> IF output is produced, ensure it includes the nosuid option</p>","tags":["Level 1","Workstation","Server","Initial Setup","Filesystem Configuration","Configure /var/log","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1548","T1548.001","TA0005","M1022"]},{"location":"1-Initial-Setup/1.1-Filesystem-Configuration/1.1.5-Configure-var-log/1.1.5.4-Ensure-nosuid-option-set-on-var-log-partition/#remediation","title":"Remediation","text":"<p>IF the /var/log partition exists, edit the /etc/fstab file and add nosuid to the fourth field (mounting options) for the /var/log partition.</p> <p>Example: <pre><code>&lt;device&gt; /var/log   &lt;fstype&gt;    defaults,rw,nosuid,nodev,noexec,relatime    0 0\n</code></pre></p> <p>Run the following command to remount /var/log with the configured options: <pre><code># mount -o remount /var/log\n</code></pre></p>","tags":["Level 1","Workstation","Server","Initial Setup","Filesystem Configuration","Configure /var/log","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1548","T1548.001","TA0005","M1022"]},{"location":"1-Initial-Setup/1.1-Filesystem-Configuration/1.1.6-Configure-var-log-audit/1.1.6.1-Ensure-separate-partition-exists-for-var-log-audit/","title":"1.1.6.1 Ensure separate partition exists for /var/log/audit","text":"","tags":["Level 2","Workstation","Server","Initial Setup","Filesystem Configuration","Configure /var/log/audit","Automated","IG1","IG2","IG3","8.3 Ensure Adequate Audit Log Storage","T1499","T1499.001","TA0005","M1022"]},{"location":"1-Initial-Setup/1.1-Filesystem-Configuration/1.1.6-Configure-var-log-audit/1.1.6.1-Ensure-separate-partition-exists-for-var-log-audit/#audit","title":"Audit","text":"<p>Run the following command and verify output shows /var/log/audit is mounted: <pre><code># findmnt --kernel /var/log/audit\nTARGET SOURCE FSTYPE OPTIONS\n/var/log/audit /dev/sdb ext4 rw,relatime,seclabel,data=ordered\n</code></pre></p>","tags":["Level 2","Workstation","Server","Initial Setup","Filesystem Configuration","Configure /var/log/audit","Automated","IG1","IG2","IG3","8.3 Ensure Adequate Audit Log Storage","T1499","T1499.001","TA0005","M1022"]},{"location":"1-Initial-Setup/1.1-Filesystem-Configuration/1.1.6-Configure-var-log-audit/1.1.6.1-Ensure-separate-partition-exists-for-var-log-audit/#remediation","title":"Remediation","text":"<p>For new installations, during installation create a custom partition setup and specify a separate partition for /var/log/audit.</p> <p>For systems that were previously installed, create a new partition and configure /etc/fstab as appropriate.</p>","tags":["Level 2","Workstation","Server","Initial Setup","Filesystem Configuration","Configure /var/log/audit","Automated","IG1","IG2","IG3","8.3 Ensure Adequate Audit Log Storage","T1499","T1499.001","TA0005","M1022"]},{"location":"1-Initial-Setup/1.1-Filesystem-Configuration/1.1.6-Configure-var-log-audit/1.1.6.2-Ensure-noexec-option-set-on-var-log-audit-partition/","title":"1.1.6.2 Ensure noexec option set on /var/log/audit partition","text":"","tags":["Level 1","Workstation","Server","Initial Setup","Filesystem Configuration","Configure /var/log/audit","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1204","T1204.002","TA0005","M1022"]},{"location":"1-Initial-Setup/1.1-Filesystem-Configuration/1.1.6-Configure-var-log-audit/1.1.6.2-Ensure-noexec-option-set-on-var-log-audit-partition/#audit","title":"Audit","text":"<p>Verify that the noexec option is set for the /var/log/audit mount.</p> <p>Run the following command to verify that the noexec mount option is set.</p> <p>Example: <pre><code># findmnt --kernel /var/log/audit\n/var/log/audit /dev/sdb ext4 rw,nosuid,nodev,noexec,relatime,seclabel\n</code></pre></p> <p>IF output is produced, ensure it includes the noexec option.</p>","tags":["Level 1","Workstation","Server","Initial Setup","Filesystem Configuration","Configure /var/log/audit","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1204","T1204.002","TA0005","M1022"]},{"location":"1-Initial-Setup/1.1-Filesystem-Configuration/1.1.6-Configure-var-log-audit/1.1.6.2-Ensure-noexec-option-set-on-var-log-audit-partition/#remediation","title":"Remediation","text":"<p>IF the /var/log/audit partition exists, edit the /etc/fstab file and add noexec to the fourth field (mounting options) for the /var partition.</p> <p>Example: <pre><code>&lt;device&gt; /var/log/audit &lt;fstype&gt;    defaults,rw,nosuid,nodev,noexec,relatime 0 0\n</code></pre></p> <p>Run the following command to remount /var/log/audit with the configured options: <pre><code># mount -o remount /var/log/audit\n</code></pre></p>","tags":["Level 1","Workstation","Server","Initial Setup","Filesystem Configuration","Configure /var/log/audit","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1204","T1204.002","TA0005","M1022"]},{"location":"1-Initial-Setup/1.1-Filesystem-Configuration/1.1.6-Configure-var-log-audit/1.1.6.3-Ensure-nodev-option-set-on-var-log-audit-partition/","title":"1.1.6.3 Ensure nodev option set on /var/log/audit partition","text":"","tags":["Level 1","Workstation","Server","Initial Setup","Filesystem Configuration","Configure /var/log/audit","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1200","TA0005","M1022"]},{"location":"1-Initial-Setup/1.1-Filesystem-Configuration/1.1.6-Configure-var-log-audit/1.1.6.3-Ensure-nodev-option-set-on-var-log-audit-partition/#audit","title":"Audit","text":"<p>Verify that the nodev option is set for the /var/log/audit mount.</p> <p>Run the following command to verify that the nodev mount option is set.</p> <p>Example: <pre><code># findmnt --kernel /var/log/audit\n/var/log/audit /dev/sdb ext4 rw,nosuid,nodev,noexec,relatime,seclabel\n</code></pre></p> <p>IF output is produced, ensure it includes the nodev option.</p>","tags":["Level 1","Workstation","Server","Initial Setup","Filesystem Configuration","Configure /var/log/audit","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1200","TA0005","M1022"]},{"location":"1-Initial-Setup/1.1-Filesystem-Configuration/1.1.6-Configure-var-log-audit/1.1.6.3-Ensure-nodev-option-set-on-var-log-audit-partition/#remediation","title":"Remediation","text":"<p>IF the /var/log/audit partition exists, edit the /etc/fstab file and add nodev to the fourth field (mounting options) for the /var/log/audit partition.</p> <p>Example: <pre><code>&lt;device&gt; /var/log/audit &lt;fstype&gt;    defaults,rw,nosuid,nodev,noexec,relatime 0 0\n</code></pre></p> <p>Run the following command to remount /var/log/audit with the configured options: <pre><code># mount -o remount /var/log/audit\n</code></pre></p>","tags":["Level 1","Workstation","Server","Initial Setup","Filesystem Configuration","Configure /var/log/audit","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1200","TA0005","M1022"]},{"location":"1-Initial-Setup/1.1-Filesystem-Configuration/1.1.6-Configure-var-log-audit/1.1.6.4-Ensure-nosuid-option-set-on-var-log-audit-partition/","title":"1.1.6.4 Ensure nosuid option set on /var/log/audit partition","text":"","tags":["Level 1","Workstation","Server","Initial Setup","Filesystem Configuration","Configure /var/log/audit","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1548","T1548.001","TA0005","M1022"]},{"location":"1-Initial-Setup/1.1-Filesystem-Configuration/1.1.6-Configure-var-log-audit/1.1.6.4-Ensure-nosuid-option-set-on-var-log-audit-partition/#audit","title":"Audit","text":"<p>Verify that the nosuid option is set for the /var/log/audit mount.</p> <p>Run the following command to verify that the nosuid mount option is set.</p> <p>Example: <pre><code># findmnt --kernel /var/log/audit\n/var/log/audit /dev/sdb ext4 rw,nosuid,nodev,noexec,relatime,seclabel\n</code></pre></p> <p>IF output is produced, ensure it includes the nosuid option</p>","tags":["Level 1","Workstation","Server","Initial Setup","Filesystem Configuration","Configure /var/log/audit","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1548","T1548.001","TA0005","M1022"]},{"location":"1-Initial-Setup/1.1-Filesystem-Configuration/1.1.6-Configure-var-log-audit/1.1.6.4-Ensure-nosuid-option-set-on-var-log-audit-partition/#remediation","title":"Remediation","text":"<p>IF the /var/log/audit partition exists, edit the /etc/fstab file and add nosuid to the fourth field (mounting options) for the /var/log/audit partition.</p> <p>Example: <pre><code>&lt;device&gt; /var/log/audit &lt;fstype&gt; defaults,rw,nosuid,nodev,noexec,relatime 0 0\n</code></pre></p> <p>Run the following command to remount /var/log/audit with the configured options: <pre><code># mount -o remount /var/log/audit\n</code></pre></p>","tags":["Level 1","Workstation","Server","Initial Setup","Filesystem Configuration","Configure /var/log/audit","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1548","T1548.001","TA0005","M1022"]},{"location":"1-Initial-Setup/1.1-Filesystem-Configuration/1.1.7-Configure-home/1.1.7.1-Ensure-separate-partition-exists-for-home/","title":"1.1.7.1 Ensure separate partition exists for /home","text":"","tags":["Level 2","Workstation","Server","Initial Setup","Filesystem Configuration","Configure /home","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1499","T1499.001","TA0005","M1038"]},{"location":"1-Initial-Setup/1.1-Filesystem-Configuration/1.1.7-Configure-home/1.1.7.1-Ensure-separate-partition-exists-for-home/#audit","title":"Audit","text":"<p>Run the following command and verify output shows /home is mounted: <pre><code># findmnt --kernel /home\nTARGET SOURCE FSTYPE OPTIONS\n/home /dev/sdb ext4 rw,relatime,seclabel\n</code></pre></p>","tags":["Level 2","Workstation","Server","Initial Setup","Filesystem Configuration","Configure /home","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1499","T1499.001","TA0005","M1038"]},{"location":"1-Initial-Setup/1.1-Filesystem-Configuration/1.1.7-Configure-home/1.1.7.1-Ensure-separate-partition-exists-for-home/#remediation","title":"Remediation","text":"<p>For new installations, during installation create a custom partition setup and specify a separate partition for /home.</p> <p>For systems that were previously installed, create a new partition and configure /etc/fstab as appropriate.</p>","tags":["Level 2","Workstation","Server","Initial Setup","Filesystem Configuration","Configure /home","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1499","T1499.001","TA0005","M1038"]},{"location":"1-Initial-Setup/1.1-Filesystem-Configuration/1.1.7-Configure-home/1.1.7.2-Ensure-nodev-option-set-on-home-partition/","title":"1.1.7.2 Ensure nodev option set on /home partition","text":"","tags":["Level 1","Workstation","Server","Initial Setup","Filesystem Configuration","Configure /home","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1200","TA0005","M1022"]},{"location":"1-Initial-Setup/1.1-Filesystem-Configuration/1.1.7-Configure-home/1.1.7.2-Ensure-nodev-option-set-on-home-partition/#audit","title":"Audit","text":"<p>Verify that the nodev option is set for the /home mount.</p> <p>Run the following command to verify that the nodev mount option is set.</p> <p>Example: <pre><code># findmnt --kernel /home\n/home /dev/sdb ext4 rw,nosuid,nodev,relatime,seclabel\n</code></pre> IF output is produced, ensure it includes the nodev option</p>","tags":["Level 1","Workstation","Server","Initial Setup","Filesystem Configuration","Configure /home","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1200","TA0005","M1022"]},{"location":"1-Initial-Setup/1.1-Filesystem-Configuration/1.1.7-Configure-home/1.1.7.2-Ensure-nodev-option-set-on-home-partition/#remediation","title":"Remediation","text":"<p>IF the /home partition exists, edit the /etc/fstab file and add nodev to the fourth field (mounting options) for the /home partition.</p> <p>Example: <pre><code>&lt;device&gt; /home &lt;fstype&gt; defaults,rw,nosuid,nodev,relatime 0 0\n</code></pre></p> <p>Run the following command to remount /home with the configured options: <pre><code># mount -o remount /home\n</code></pre></p>","tags":["Level 1","Workstation","Server","Initial Setup","Filesystem Configuration","Configure /home","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1200","TA0005","M1022"]},{"location":"1-Initial-Setup/1.1-Filesystem-Configuration/1.1.7-Configure-home/1.1.7.3-Ensure-nosuid-option-set-on-home-partition/","title":"1.1.7.3 Ensure nosuid option set on /home partition","text":"","tags":["Level 1","Workstation","Server","Initial Setup","Filesystem Configuration","Configure /home","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1548","T1548.001","TA0005","M1022"]},{"location":"1-Initial-Setup/1.1-Filesystem-Configuration/1.1.7-Configure-home/1.1.7.3-Ensure-nosuid-option-set-on-home-partition/#audit","title":"Audit","text":"<p>Verify that the nosuid option is set for the /home mount.</p> <p>Run the following command to verify that the nosuid mount option is set.</p> <p>Example: <pre><code># findmnt --kernel /home\n/home /dev/sdb ext4 rw,nosuid,nodev,relatime,seclabel\n</code></pre></p> <p>IF output is produced, ensure it includes the nosuid option</p>","tags":["Level 1","Workstation","Server","Initial Setup","Filesystem Configuration","Configure /home","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1548","T1548.001","TA0005","M1022"]},{"location":"1-Initial-Setup/1.1-Filesystem-Configuration/1.1.7-Configure-home/1.1.7.3-Ensure-nosuid-option-set-on-home-partition/#remediation","title":"Remediation","text":"<p>IF the /home partition exists, edit the /etc/fstab file and add nosuid to the fourth field (mounting options) for the /home partition.</p> <p>Example: <pre><code>&lt;device&gt; /home &lt;fstype&gt; defaults,rw,nosuid,nodev,relatime 0 0\n</code></pre></p> <p>Run the following command to remount /home with the configured options: <pre><code># mount -o remount /home\n</code></pre></p>","tags":["Level 1","Workstation","Server","Initial Setup","Filesystem Configuration","Configure /home","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1548","T1548.001","TA0005","M1022"]},{"location":"1-Initial-Setup/1.1-Filesystem-Configuration/1.1.8-Configure-dev-shm/1.1.8.1-Ensure-nodev-option-set-on-dev-shm-partition/","title":"1.1.8.1 Ensure nodev option set on /dev/shm partition","text":"","tags":["Level 1","Workstation","Server","Initial Setup","Filesystem Configuration","Configure /dev/shm","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1200","TA0005","M1038"]},{"location":"1-Initial-Setup/1.1-Filesystem-Configuration/1.1.8-Configure-dev-shm/1.1.8.1-Ensure-nodev-option-set-on-dev-shm-partition/#audit","title":"Audit","text":"<p>Verify that the nodev option is set for the /dev/shm mount.</p> <p>Run the following command to verify that the nodev mount option is set.</p> <p>Example: <pre><code># findmnt --kernel /dev/shm | grep nodev\n</code></pre></p>","tags":["Level 1","Workstation","Server","Initial Setup","Filesystem Configuration","Configure /dev/shm","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1200","TA0005","M1038"]},{"location":"1-Initial-Setup/1.1-Filesystem-Configuration/1.1.8-Configure-dev-shm/1.1.8.1-Ensure-nodev-option-set-on-dev-shm-partition/#remediation","title":"Remediation","text":"<p>Edit the /etc/fstab file and add nodev to the fourth field (mounting options) for the /dev/shm partition. See the fstab(5) manual page for more information.</p> <p>Run the following command to remount /dev/shm using the updated options from /etc/fstab: <pre><code># mount -o remount /dev/shm\n</code></pre></p>","tags":["Level 1","Workstation","Server","Initial Setup","Filesystem Configuration","Configure /dev/shm","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1200","TA0005","M1038"]},{"location":"1-Initial-Setup/1.1-Filesystem-Configuration/1.1.8-Configure-dev-shm/1.1.8.2-Ensure-noexec-option-set-on-dev-shm-partition/","title":"1.1.8.2 Ensure noexec option set on /dev/shm partition","text":"","tags":["Level 1","Workstation","Server","Initial Setup","Filesystem Configuration","Configure /dev/shm","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1200","TA0005","M1038"]},{"location":"1-Initial-Setup/1.1-Filesystem-Configuration/1.1.8-Configure-dev-shm/1.1.8.2-Ensure-noexec-option-set-on-dev-shm-partition/#audit","title":"Audit","text":"<p>Verify that the noexec option is set for the /dev/shm mount.</p> <p>Run the following command to verify that the noexec mount option is set.</p> <p>Example: <pre><code># findmnt --kernel /dev/shm | grep noexec\n/dev/shm tmpfs tmpfs rw,nosuid,nodev,noexec,relatime,seclabel\n</code></pre></p>","tags":["Level 1","Workstation","Server","Initial Setup","Filesystem Configuration","Configure /dev/shm","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1200","TA0005","M1038"]},{"location":"1-Initial-Setup/1.1-Filesystem-Configuration/1.1.8-Configure-dev-shm/1.1.8.2-Ensure-noexec-option-set-on-dev-shm-partition/#remediation","title":"Remediation","text":"<p>Edit the /etc/fstab file and add noexec to the fourth field (mounting options) for the /dev/shm partition.</p> <p>Example: <pre><code>&lt;device&gt; /dev/shm &lt;fstype&gt; defaults,rw,nosuid,nodev,noexec,relatime 0 0\n</code></pre></p> <p>Run the following command to remount /dev/shm with the configured options: <pre><code># mount -o remount /dev/shm\n</code></pre> NOTE It is recommended to use tmpfs as the device/filesystem type as /dev/shm is used as shared memory space by applications.</p>","tags":["Level 1","Workstation","Server","Initial Setup","Filesystem Configuration","Configure /dev/shm","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1200","TA0005","M1038"]},{"location":"1-Initial-Setup/1.1-Filesystem-Configuration/1.1.8-Configure-dev-shm/1.1.8.3-Ensure-nosuid-option-set-on-dev-shm-partition/","title":"1.1.8.3 Ensure nosuid option set on /dev/shm partition","text":"","tags":["Level 1","Workstation","Server","Initial Setup","Filesystem Configuration","Configure /dev/shm","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1548","T1548.001","TA0005","M1038"]},{"location":"1-Initial-Setup/1.1-Filesystem-Configuration/1.1.8-Configure-dev-shm/1.1.8.3-Ensure-nosuid-option-set-on-dev-shm-partition/#audit","title":"Audit","text":"<p>Verify that the nosuid option is set for the /dev/shm mount</p> <p>Run the following command to verify that the nosuid mount option is set.</p> <p>Example: <pre><code># findmnt --kernel /dev/shm | grep nosuid\n</code></pre></p>","tags":["Level 1","Workstation","Server","Initial Setup","Filesystem Configuration","Configure /dev/shm","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1548","T1548.001","TA0005","M1038"]},{"location":"1-Initial-Setup/1.1-Filesystem-Configuration/1.1.8-Configure-dev-shm/1.1.8.3-Ensure-nosuid-option-set-on-dev-shm-partition/#remediation","title":"Remediation","text":"<p>Edit the /etc/fstab file and add nosuid to the fourth field (mounting options) for the /dev/shm partition. See the fstab(5) manual page for more information.</p> <p>Run the following command to remount /dev/shm using the updated options from /etc/fstab: <pre><code># mount -o remount /dev/shm\n</code></pre></p>","tags":["Level 1","Workstation","Server","Initial Setup","Filesystem Configuration","Configure /dev/shm","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1548","T1548.001","TA0005","M1038"]},{"location":"1-Initial-Setup/1.2-Configure-Software-Updates/1.2.1-Ensure-package-manager-repositories-are-configured/","title":"1.2.1 Ensure package manager repositories are configured","text":"","tags":["Level 1","Workstation","Server","Initial Setup","Configure Software Updates","Manual","IG1","IG2","IG3","7.3 Perform Automated Operating System Patch Management","T1068","T1195","T1195.001","T1195.002","T1203","T1210","T1211","T1212","TA0001","M1051"]},{"location":"1-Initial-Setup/1.2-Configure-Software-Updates/1.2.1-Ensure-package-manager-repositories-are-configured/#audit","title":"Audit","text":"<p>Run the following command and verify package repositories are configured correctly: <pre><code># apt-cache policy\n</code></pre></p>","tags":["Level 1","Workstation","Server","Initial Setup","Configure Software Updates","Manual","IG1","IG2","IG3","7.3 Perform Automated Operating System Patch Management","T1068","T1195","T1195.001","T1195.002","T1203","T1210","T1211","T1212","TA0001","M1051"]},{"location":"1-Initial-Setup/1.2-Configure-Software-Updates/1.2.1-Ensure-package-manager-repositories-are-configured/#remediation","title":"Remediation","text":"<p>Configure your package manager repositories according to site policy.</p>","tags":["Level 1","Workstation","Server","Initial Setup","Configure Software Updates","Manual","IG1","IG2","IG3","7.3 Perform Automated Operating System Patch Management","T1068","T1195","T1195.001","T1195.002","T1203","T1210","T1211","T1212","TA0001","M1051"]},{"location":"1-Initial-Setup/1.2-Configure-Software-Updates/1.2.2-Ensure-gpg-keys-are-configured/","title":"1.2.2 Ensure GPG keys are configured","text":"","tags":["Level 1","Workstation","Server","Initial Setup","Configure Software Updates","Manual","IG1","IG2","IG3","7.3 Perform Automated Operating System Patch Management","T1195","T1195.001","T1195.002","TA0001","M1051"]},{"location":"1-Initial-Setup/1.2-Configure-Software-Updates/1.2.2-Ensure-gpg-keys-are-configured/#audit","title":"Audit","text":"<p>Verify GPG keys are configured correctly for your package manager: <pre><code># apt-key list\n</code></pre></p>","tags":["Level 1","Workstation","Server","Initial Setup","Configure Software Updates","Manual","IG1","IG2","IG3","7.3 Perform Automated Operating System Patch Management","T1195","T1195.001","T1195.002","TA0001","M1051"]},{"location":"1-Initial-Setup/1.2-Configure-Software-Updates/1.2.2-Ensure-gpg-keys-are-configured/#remediation","title":"Remediation","text":"<p>Update your package manager GPG keys in accordance with site policy.</p>","tags":["Level 1","Workstation","Server","Initial Setup","Configure Software Updates","Manual","IG1","IG2","IG3","7.3 Perform Automated Operating System Patch Management","T1195","T1195.001","T1195.002","TA0001","M1051"]},{"location":"1-Initial-Setup/1.3-Filesystem-Integrity-Checking/1.3.1-Ensure-aide-is-installed/","title":"1.3.1 Ensure AIDE is installed","text":"","tags":["Level 1","Workstation","Server","Initial Setup","Filesystem Integrity Checking","Automated","IG3","3.14 Log Sensitive Data Access","T1036","T1036.002","T1036.003","T1036.005","T1565","T1565.001"]},{"location":"1-Initial-Setup/1.3-Filesystem-Integrity-Checking/1.3.1-Ensure-aide-is-installed/#audit","title":"Audit","text":"<p>Run the following commands to verify AIDE is installed: <pre><code># dpkg-query -W -f='${binary:Package}\\t${Status}\\t${db:Status-Status}\\n' aide aide-common\naide install ok installed installed\naide-common install ok installed installed\n</code></pre></p>","tags":["Level 1","Workstation","Server","Initial Setup","Filesystem Integrity Checking","Automated","IG3","3.14 Log Sensitive Data Access","T1036","T1036.002","T1036.003","T1036.005","T1565","T1565.001"]},{"location":"1-Initial-Setup/1.3-Filesystem-Integrity-Checking/1.3.1-Ensure-aide-is-installed/#remediation","title":"Remediation","text":"<p>Install AIDE using the appropriate package manager or manual installation: <pre><code># apt install aide aide-common\n</code></pre></p> <p>Configure AIDE as appropriate for your environment. Consult the AIDE documentation for options.</p> <p>Run the following commands to initialize AIDE: <pre><code># aideinit\n# mv /var/lib/aide/aide.db.new /var/lib/aide/aide.db\n</code></pre></p>","tags":["Level 1","Workstation","Server","Initial Setup","Filesystem Integrity Checking","Automated","IG3","3.14 Log Sensitive Data Access","T1036","T1036.002","T1036.003","T1036.005","T1565","T1565.001"]},{"location":"1-Initial-Setup/1.3-Filesystem-Integrity-Checking/1.3.2-Ensure-filesystem-integrity-is-regularly-checked/","title":"1.3.2 Ensure filesystem integrity is regularly checked","text":"","tags":["Level 1","Workstation","Server","Initial Setup","Filesystem Integrity Checking","Automated","IG2","IG3","8.5 Collect Detailed Audit Logs","T1036","T1036.002","T1036.003","T1036.005","T1565","T1565.001","TA0040","M1022"]},{"location":"1-Initial-Setup/1.3-Filesystem-Integrity-Checking/1.3.2-Ensure-filesystem-integrity-is-regularly-checked/#audit","title":"Audit","text":"<p>Run the following commands to verify a cron job scheduled to run the aide check. <pre><code># grep -Prs '^([^#\\n\\r]+\\h+)?(\\/usr\\/s?bin\\/|^\\h*)aide(\\.wrapper)?\\h+(--check|([^#\\n\\r]+\\h+)?\\$AIDEARGS)\\b' /etc/cron.* /etc/crontab /var/spool/cron/\n</code></pre></p> <p>Ensure a cron job in compliance with site policy is returned.</p> <p>OR</p> <p>Run the following commands to verify that aidcheck.service and aidcheck.timer are enabled and aidcheck.timer is running <pre><code># systemctl is-enabled aidecheck.service\n# systemctl is-enabled aidecheck.timer\n# systemctl status aidecheck.timer\n</code></pre></p>","tags":["Level 1","Workstation","Server","Initial Setup","Filesystem Integrity Checking","Automated","IG2","IG3","8.5 Collect Detailed Audit Logs","T1036","T1036.002","T1036.003","T1036.005","T1565","T1565.001","TA0040","M1022"]},{"location":"1-Initial-Setup/1.3-Filesystem-Integrity-Checking/1.3.2-Ensure-filesystem-integrity-is-regularly-checked/#remediation","title":"Remediation","text":"<p>If cron will be used to schedule and run aide check:</p> <p>Run the following command: <pre><code># crontab -u root -e\n</code></pre></p> <p>Add the following line to the crontab: <pre><code>0 5 * * * /usr/bin/aide.wrapper --config /etc/aide/aide.conf --check\n</code></pre></p> <p>OR If aidecheck.service and aidecheck.timer will be used to schedule and run aide check:</p> <p>Create or edit the file /etc/systemd/system/aidecheck.service and add the following lines: <pre><code>[Unit]\nDescription=Aide Check\n[Service]\nType=simple\nExecStart=/usr/bin/aide.wrapper --config /etc/aide/aide.conf --check\n[Install]\nWantedBy=multi-user.target\n</code></pre></p> <p>Create or edit the file /etc/systemd/system/aidecheck.timer and add the following lines: <pre><code>[Unit]\nDescription=Aide check every day at 5AM\n[Timer]\nOnCalendar=*-*-* 05:00:00\nUnit=aidecheck.service\n[Install]\nWantedBy=multi-user.target\n</code></pre></p> <p>Run the following commands: <pre><code># chown root:root /etc/systemd/system/aidecheck.*\n# chmod 0644 /etc/systemd/system/aidecheck.*\n# systemctl daemon-reload\n# systemctl enable aidecheck.service\n# systemctl --now enable aidecheck.timer\n</code></pre></p>","tags":["Level 1","Workstation","Server","Initial Setup","Filesystem Integrity Checking","Automated","IG2","IG3","8.5 Collect Detailed Audit Logs","T1036","T1036.002","T1036.003","T1036.005","T1565","T1565.001","TA0040","M1022"]},{"location":"1-Initial-Setup/1.4-Secure-Boot-Settings/1.4.1-Ensure-bootloader-password-is-set/","title":"1.4.1 Ensure bootloader password is set","text":"","tags":["Level 1","Workstation","Server","Initial Setup","Secure Boot Settings","Automated","IG1","IG2","IG3","5.2 Use Unique Passwords","T1542","TA0003","M1046"]},{"location":"1-Initial-Setup/1.4-Secure-Boot-Settings/1.4.1-Ensure-bootloader-password-is-set/#audit","title":"Audit","text":"<p>Run the following commands and verify output matches: <pre><code># grep \"^set superusers\" /boot/grub/grub.cfg\nset superusers=\"&lt;username&gt;\"\n# grep \"^password\" /boot/grub/grub.cfg\npassword_pbkdf2 &lt;username&gt; &lt;encrypted-password&gt;\n</code></pre></p>","tags":["Level 1","Workstation","Server","Initial Setup","Secure Boot Settings","Automated","IG1","IG2","IG3","5.2 Use Unique Passwords","T1542","TA0003","M1046"]},{"location":"1-Initial-Setup/1.4-Secure-Boot-Settings/1.4.1-Ensure-bootloader-password-is-set/#remediation","title":"Remediation","text":"<p>Create an encrypted password with grub-mkpasswd-pbkdf2: <pre><code># grub-mkpasswd-pbkdf2\nEnter password: &lt;password&gt;\nReenter password: &lt;password&gt;\nPBKDF2 hash of your password is &lt;encrypted-password&gt;\n</code></pre></p> <p>Add the following into a custom /etc/grub.d configuration file: <pre><code>cat &lt;&lt;EOF\nset superusers=\"&lt;username&gt;\"\npassword_pbkdf2 &lt;username&gt; &lt;encrypted-password&gt;\nEOF\n</code></pre></p> <p>The superuser/user information and password should not be contained in the /etc/grub.d/00_header file as this file could be overwritten in a package update.</p> <p>If there is a requirement to be able to boot/reboot without entering the password, edit /etc/grub.d/10_linux and add --unrestricted to the line CLASS=</p> <p>Example: <pre><code>CLASS=\"--class gnu-linux --class gnu --class os --unrestricted\"\n</code></pre></p> <p>Run the following command to update the grub2 configuration: <pre><code># update-grub\n</code></pre></p> <p>Default Value:</p> <p>This recommendation is designed around the grub bootloader, if LILO or another bootloader is in use in your environment enact equivalent settings.</p> <p>Replace /boot/grub/grub.cfg with the appropriate grub configuration file for your environment.</p>","tags":["Level 1","Workstation","Server","Initial Setup","Secure Boot Settings","Automated","IG1","IG2","IG3","5.2 Use Unique Passwords","T1542","TA0003","M1046"]},{"location":"1-Initial-Setup/1.4-Secure-Boot-Settings/1.4.2-Ensure-permissions-on-bootloader-config-are-configured/","title":"1.4.2 Ensure permissions on bootloader config are configured","text":"","tags":["Level 1","Workstation","Server","Initial Setup","Secure Boot Settings","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1542","TA0005","TA0007","M1022"]},{"location":"1-Initial-Setup/1.4-Secure-Boot-Settings/1.4.2-Ensure-permissions-on-bootloader-config-are-configured/#audit","title":"Audit","text":"<p>Run the following command and verify Uid and Gid are both 0/root and Access is 0400 or more restrictive. <pre><code># stat /boot/grub/grub.cfg\nAccess: (0400/-r--------) Uid: ( 0/ root) Gid: ( 0/ root)\n</code></pre></p>","tags":["Level 1","Workstation","Server","Initial Setup","Secure Boot Settings","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1542","TA0005","TA0007","M1022"]},{"location":"1-Initial-Setup/1.4-Secure-Boot-Settings/1.4.2-Ensure-permissions-on-bootloader-config-are-configured/#remediation","title":"Remediation","text":"<p>Run the following commands to set permissions on your grub configuration: <pre><code># chown root:root /boot/grub/grub.cfg\n# chmod u-wx,go-rwx /boot/grub/grub.cfg\n</code></pre></p>","tags":["Level 1","Workstation","Server","Initial Setup","Secure Boot Settings","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1542","TA0005","TA0007","M1022"]},{"location":"1-Initial-Setup/1.4-Secure-Boot-Settings/1.4.3-Ensure-authentication-required-for-single-user-mode/","title":"1.4.3 Ensure authentication required for single user mode","text":"","tags":["Level 1","Workstation","Server","Initial Setup","Secure Boot Settings","Automated","IG1","IG2","IG3","5.2 Use Unique Passwords","T1548","TA0005","M1022"]},{"location":"1-Initial-Setup/1.4-Secure-Boot-Settings/1.4.3-Ensure-authentication-required-for-single-user-mode/#audit","title":"Audit","text":"<p>Perform the following to determine if a password is set for the root user: <pre><code># grep -Eq '^root:\\$[0-9]' /etc/shadow || echo \"root is locked\"\n</code></pre></p> <p>No results should be returned.</p>","tags":["Level 1","Workstation","Server","Initial Setup","Secure Boot Settings","Automated","IG1","IG2","IG3","5.2 Use Unique Passwords","T1548","TA0005","M1022"]},{"location":"1-Initial-Setup/1.4-Secure-Boot-Settings/1.4.3-Ensure-authentication-required-for-single-user-mode/#remediation","title":"Remediation","text":"<p>Run the following command and follow the prompts to set a password for the root user: <pre><code># passwd root\n</code></pre></p>","tags":["Level 1","Workstation","Server","Initial Setup","Secure Boot Settings","Automated","IG1","IG2","IG3","5.2 Use Unique Passwords","T1548","TA0005","M1022"]},{"location":"1-Initial-Setup/1.5-Additional-Process-Hardening/1.5.1-Ensure-address-space-layout-randomization-%28aslr%29-is-enabled/","title":"1.5.1 Ensure address space layout randomization (ASLR) is enabled","text":"","tags":["Level 1","Workstation","Server","Initial Setup","Additional Process Hardening","Automated","IG2","IG3","10.5 Enable Anti-Exploitation Features","T1068","TA0002","M1050"]},{"location":"1-Initial-Setup/1.5-Additional-Process-Hardening/1.5.1-Ensure-address-space-layout-randomization-%28aslr%29-is-enabled/#audit","title":"Audit","text":"<p>Run the following script to verify kernel.randomize_va_space is set to 2: <pre><code>#!/usr/bin/env bash\n{\nkrp=\"\" pafile=\"\" fafile=\"\"\nkpname=\"kernel.randomize_va_space\"\nkpvalue=\"2\"\nsearchloc=\"/run/sysctl.d/*.conf /etc/sysctl.d/*.conf /usr/local/lib/sysctl.d/*.conf /usr/lib/sysctl.d/*.conf /lib/sysctl.d/*.conf /etc/sysctl.conf\"\nkrp=\"$(sysctl \"$kpname\" | awk -F= '{print $2}' | xargs)\"\npafile=\"$(grep -Psl -- \"^\\h*$kpname\\h*=\\h*$kpvalue\\b\\h*(#.*)?$\" $searchloc)\"\nfafile=\"$(grep -s -- \"^\\s*$kpname\" $searchloc | grep -Pv -- \"\\h*=\\h*$kpvalue\\b\\h*\" | awk -F: '{print $1}')\"\nif [ \"$krp\" = \"$kpvalue\" ] &amp;&amp; [ -n \"$pafile\" ] &amp;&amp; [ -z \"$fafile\" ]; then\necho -e \"\\nPASS:\\n\\\"$kpname\\\" is set to \\\"$kpvalue\\\" in the running configuration and in \\\"$pafile\\\"\"\nelse\necho -e \"\\nFAIL: \"[ \"$krp\" != \"$kpvalue\" ] &amp;&amp; echo -e \"\\\"$kpname\\\" is set to \\\"$krp\\\" in the running configuration\\n\"\n[ -n \"$fafile\" ] &amp;&amp; echo -e \"\\n\\\"$kpname\\\" is set incorrectly in \\\"$fafile\\\"\"\n[ -z \"$pafile\" ] &amp;&amp; echo -e \"\\n\\\"$kpname = $kpvalue\\\" is not set in a kernel parameter configuration file\\n\"\nfi\n}\n</code></pre></p>","tags":["Level 1","Workstation","Server","Initial Setup","Additional Process Hardening","Automated","IG2","IG3","10.5 Enable Anti-Exploitation Features","T1068","TA0002","M1050"]},{"location":"1-Initial-Setup/1.5-Additional-Process-Hardening/1.5.1-Ensure-address-space-layout-randomization-%28aslr%29-is-enabled/#remediation","title":"Remediation","text":"<p>Set the following parameter in /etc/sysctl.conf or a /etc/sysctl.d/* file:</p> <p>Example: <pre><code># printf \"kernel.randomize_va_space = 2\" &gt;&gt; /etc/sysctl.d/60-kernel_sysctl.conf\n</code></pre></p> <p>Run the following command to set the active kernel parameter: <pre><code># sysctl -w kernel.randomize_va_space=2\n</code></pre></p>","tags":["Level 1","Workstation","Server","Initial Setup","Additional Process Hardening","Automated","IG2","IG3","10.5 Enable Anti-Exploitation Features","T1068","TA0002","M1050"]},{"location":"1-Initial-Setup/1.5-Additional-Process-Hardening/1.5.2-Ensure-prelink-is-not-installed/","title":"1.5.2 Ensure prelink is not installed","text":"","tags":["Level 1","Workstation","Server","Initial Setup","Additional Process Hardening","Automated","IG3","3.14 Log Sensitive Data Access","T1055","T1055.009","T1065","T1055.001","TA0002","M1050"]},{"location":"1-Initial-Setup/1.5-Additional-Process-Hardening/1.5.2-Ensure-prelink-is-not-installed/#audit","title":"Audit","text":"<p>Verify prelink is not installed: <pre><code># dpkg-query -W -f='${binary:Package}\\t${Status}\\t${db:Status-Status}\\n' prelink\nprelink unknown ok not-installed not-installed\n</code></pre></p>","tags":["Level 1","Workstation","Server","Initial Setup","Additional Process Hardening","Automated","IG3","3.14 Log Sensitive Data Access","T1055","T1055.009","T1065","T1055.001","TA0002","M1050"]},{"location":"1-Initial-Setup/1.5-Additional-Process-Hardening/1.5.2-Ensure-prelink-is-not-installed/#remediation","title":"Remediation","text":"<p>Run the following command to restore binaries to normal: <pre><code># prelink -ua\n</code></pre></p> <p>Uninstall prelink using the appropriate package manager or manual installation: <pre><code># apt purge prelink\n</code></pre></p>","tags":["Level 1","Workstation","Server","Initial Setup","Additional Process Hardening","Automated","IG3","3.14 Log Sensitive Data Access","T1055","T1055.009","T1065","T1055.001","TA0002","M1050"]},{"location":"1-Initial-Setup/1.5-Additional-Process-Hardening/1.5.3-Ensure-automatic-error-reporting-is-not-enabled/","title":"1.5.3 Ensure Automatic Error Reporting is not enabled","text":"","tags":["Level 1","Workstation","Server","Initial Setup","Additional Process Hardening","Automated","IG2","IG3","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software"]},{"location":"1-Initial-Setup/1.5-Additional-Process-Hardening/1.5.3-Ensure-automatic-error-reporting-is-not-enabled/#audit","title":"Audit","text":"<p>Run the following command to verify that the Apport Error Reporting Service is not enabled: <pre><code># dpkg-query -s apport &gt; /dev/null 2&gt;&amp;1 &amp;&amp; grep -Psi -- '^\\h*enabled\\h*=\\h*[^0]\\b' /etc/default/apport\n</code></pre></p> <p>Nothing should be returned</p> <p>Run the following command to verify that the apport service is not active: <pre><code># systemctl is-active apport.service | grep '^active'\n</code></pre></p> <p>Nothing should be returned</p>","tags":["Level 1","Workstation","Server","Initial Setup","Additional Process Hardening","Automated","IG2","IG3","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software"]},{"location":"1-Initial-Setup/1.5-Additional-Process-Hardening/1.5.3-Ensure-automatic-error-reporting-is-not-enabled/#remediation","title":"Remediation","text":"<p>Edit /etc/default/apport and add or edit the enabled parameter to equal 0: <pre><code>enabled=0\n</code></pre></p> <p>Run the following commands to stop and disable the apport service <pre><code># systemctl stop apport.service\n# systemctl --now disable apport.service\n</code></pre></p> <p>-- OR --</p> <p>Run the following command to remove the apport package: <pre><code># apt purge apport\n</code></pre></p> <p>Default Value:</p> <p>enabled=1</p>","tags":["Level 1","Workstation","Server","Initial Setup","Additional Process Hardening","Automated","IG2","IG3","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software"]},{"location":"1-Initial-Setup/1.5-Additional-Process-Hardening/1.5.4-Ensure-core-dumps-are-restricted/","title":"1.5.4 Ensure core dumps are restricted","text":"","tags":["Level 1","Workstation","Server","Initial Setup","Additional Process Hardening","Automated","IG2","IG3","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","T1005","TA0007"]},{"location":"1-Initial-Setup/1.5-Additional-Process-Hardening/1.5.4-Ensure-core-dumps-are-restricted/#audit","title":"Audit","text":"<p>Run the following commands and verify output matches: <pre><code># grep -Es '^(\\*|\\s).*hard.*core.*(\\s+#.*)?$' /etc/security/limits.conf /etc/security/limits.d/*\n* hard core 0\n# sysctl fs.suid_dumpable\nfs.suid_dumpable = 0\n# grep \"fs.suid_dumpable\" /etc/sysctl.conf /etc/sysctl.d/*\nfs.suid_dumpable = 0\n</code></pre></p> <p>Run the following command to check if systemd-coredump is installed: <pre><code># systemctl is-enabled coredump.service\n</code></pre></p> <p>If enabled, masked, or disabled is returned systemd-coredump is installed</p>","tags":["Level 1","Workstation","Server","Initial Setup","Additional Process Hardening","Automated","IG2","IG3","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","T1005","TA0007"]},{"location":"1-Initial-Setup/1.5-Additional-Process-Hardening/1.5.4-Ensure-core-dumps-are-restricted/#remediation","title":"Remediation","text":"<p>Add the following line to /etc/security/limits.conf or a /etc/security/limits.d/* file: <pre><code>* hard core 0\n</code></pre></p> <p>Set the following parameter in /etc/sysctl.conf or a /etc/sysctl.d/* file: <pre><code>fs.suid_dumpable = 0\n</code></pre></p> <p>Run the following command to set the active kernel parameter: <pre><code># sysctl -w fs.suid_dumpable=0\n</code></pre></p> <p>IF systemd-coredump is installed:</p> <p>edit /etc/systemd/coredump.conf and add/modify the following lines: <pre><code>Storage=none\nProcessSizeMax=0\n</code></pre></p> <p>Run the command: <pre><code>systemctl daemon-reload\n</code></pre></p>","tags":["Level 1","Workstation","Server","Initial Setup","Additional Process Hardening","Automated","IG2","IG3","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","T1005","TA0007"]},{"location":"1-Initial-Setup/1.6-Mandatory-Access-Control/1.6.1-Configure-AppArmor/1.6.1.1-Ensure-apparmor-is-installed/","title":"1.6.1.1 Ensure AppArmor is installed","text":"","tags":["Level 1","Workstation","Server","Initial Setup","Mandatory Access Control","Configure AppArmor","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1068","T1565","T1565.001","T1565.003","TA0003","M1026"]},{"location":"1-Initial-Setup/1.6-Mandatory-Access-Control/1.6.1-Configure-AppArmor/1.6.1.1-Ensure-apparmor-is-installed/#audit","title":"Audit","text":"<p>Verify that AppArmor is installed: <pre><code># dpkg-query -W -f='${binary:Package}\\t${Status}\\t${db:Status-Status}\\n' apparmor apparmor-utils\napparmor install ok installed installed\napparmor-utils install ok installed installed\n</code></pre></p>","tags":["Level 1","Workstation","Server","Initial Setup","Mandatory Access Control","Configure AppArmor","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1068","T1565","T1565.001","T1565.003","TA0003","M1026"]},{"location":"1-Initial-Setup/1.6-Mandatory-Access-Control/1.6.1-Configure-AppArmor/1.6.1.1-Ensure-apparmor-is-installed/#remediation","title":"Remediation","text":"<p>Install AppArmor. <pre><code># apt install apparmor apparmor-utils\n</code></pre></p>","tags":["Level 1","Workstation","Server","Initial Setup","Mandatory Access Control","Configure AppArmor","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1068","T1565","T1565.001","T1565.003","TA0003","M1026"]},{"location":"1-Initial-Setup/1.6-Mandatory-Access-Control/1.6.1-Configure-AppArmor/1.6.1.2-Ensure-apparmor-is-enabled-in-the-bootloader-configuration/","title":"1.6.1.2 Ensure AppArmor is enabled in the bootloader configuration","text":"","tags":["Level 1","Workstation","Server","Initial Setup","Mandatory Access Control","Configure AppArmor","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1068","T1565","T1565.001","T1565.003","TA0003","M1026"]},{"location":"1-Initial-Setup/1.6-Mandatory-Access-Control/1.6.1-Configure-AppArmor/1.6.1.2-Ensure-apparmor-is-enabled-in-the-bootloader-configuration/#audit","title":"Audit","text":"<p>Run the following commands to verify that all linux lines have the apparmor=1 and security=apparmor parameters set: <pre><code># grep \"^\\s*linux\" /boot/grub/grub.cfg | grep -v \"apparmor=1\"\n</code></pre></p> <p>Nothing should be returned</p> <pre><code># grep \"^\\s*linux\" /boot/grub/grub.cfg | grep -v \"security=apparmor\"\n</code></pre> <p>Nothing should be returned</p>","tags":["Level 1","Workstation","Server","Initial Setup","Mandatory Access Control","Configure AppArmor","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1068","T1565","T1565.001","T1565.003","TA0003","M1026"]},{"location":"1-Initial-Setup/1.6-Mandatory-Access-Control/1.6.1-Configure-AppArmor/1.6.1.2-Ensure-apparmor-is-enabled-in-the-bootloader-configuration/#remediation","title":"Remediation","text":"<p>Edit /etc/default/grub and add the apparmor=1 and security=apparmor parameters to the GRUB_CMDLINE_LINUX= line <pre><code>GRUB_CMDLINE_LINUX=\"apparmor=1 security=apparmor\"\n</code></pre></p> <p>Run the following command to update the grub2 configuration: <pre><code># update-grub\n</code></pre></p>","tags":["Level 1","Workstation","Server","Initial Setup","Mandatory Access Control","Configure AppArmor","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1068","T1565","T1565.001","T1565.003","TA0003","M1026"]},{"location":"1-Initial-Setup/1.6-Mandatory-Access-Control/1.6.1-Configure-AppArmor/1.6.1.3-Ensure-all-apparmor-profiles-are-in-enforce-or-complain-mode/","title":"1.6.1.3 Ensure all AppArmor Profiles are in enforce or complain mode","text":"","tags":["Level 1","Workstation","Server","Initial Setup","Mandatory Access Control","Configure AppArmor","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","TA0005"]},{"location":"1-Initial-Setup/1.6-Mandatory-Access-Control/1.6.1-Configure-AppArmor/1.6.1.3-Ensure-all-apparmor-profiles-are-in-enforce-or-complain-mode/#audit","title":"Audit","text":"<p>Run the following command and verify that profiles are loaded, and are in either enforce or complain mode: <pre><code># apparmor_status | grep profiles\n</code></pre></p> <p>Review output and ensure that profiles are loaded, and in either enforce or complain mode: <pre><code>37 profiles are loaded.\n35 profiles are in enforce mode.\n2 profiles are in complain mode.\n4 processes have profiles defined.\n</code></pre></p> <p>Run the following command and verify no processes are unconfined <pre><code># apparmor_status | grep processes\n</code></pre></p> <p>Review the output and ensure no processes are unconfined: <pre><code>4 processes have profiles defined.\n4 processes are in enforce mode.\n0 processes are in complain mode.\n0 processes are unconfined but have a profile defined.\n</code></pre></p>","tags":["Level 1","Workstation","Server","Initial Setup","Mandatory Access Control","Configure AppArmor","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","TA0005"]},{"location":"1-Initial-Setup/1.6-Mandatory-Access-Control/1.6.1-Configure-AppArmor/1.6.1.3-Ensure-all-apparmor-profiles-are-in-enforce-or-complain-mode/#remediation","title":"Remediation","text":"<p>Run the following command to set all profiles to enforce mode: <pre><code># aa-enforce /etc/apparmor.d/*\n</code></pre></p> <p>OR</p> <p>Run the following command to set all profiles to complain mode: <pre><code># aa-complain /etc/apparmor.d/*\n</code></pre></p> <p>Note: Any unconfined processes may need to have a profile created or activated for them and then be restarted</p>","tags":["Level 1","Workstation","Server","Initial Setup","Mandatory Access Control","Configure AppArmor","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","TA0005"]},{"location":"1-Initial-Setup/1.6-Mandatory-Access-Control/1.6.1-Configure-AppArmor/1.6.1.4-Ensure-all-apparmor-profiles-are-enforcing/","title":"1.6.1.4 Ensure all AppArmor Profiles are enforcing","text":"","tags":["Level 2","Workstation","Server","Initial Setup","Mandatory Access Control","Configure AppArmor","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1068","T1565","T1565.001","T1565.003","TA0005"]},{"location":"1-Initial-Setup/1.6-Mandatory-Access-Control/1.6.1-Configure-AppArmor/1.6.1.4-Ensure-all-apparmor-profiles-are-enforcing/#audit","title":"Audit","text":"<p>Run the following commands and verify that profiles are loaded and are not in complain mode: <pre><code># apparmor_status | grep profiles\n</code></pre></p> <p>Review output and ensure that profiles are loaded, and in enforce mode: <pre><code>34 profiles are loaded.\n34 profiles are in enforce mode.\n0 profiles are in complain mode.\n2 processes have profiles defined.\n</code></pre></p> <p>Run the following command and verify that no processes are unconfined: <pre><code>apparmor_status | grep processes\n</code></pre></p> <p>Review the output and ensure no processes are unconfined: <pre><code>2 processes have profiles defined.\n2 processes are in enforce mode.\n0 processes are in complain mode.\n0 processes are unconfined but have a profile defined.\n</code></pre></p>","tags":["Level 2","Workstation","Server","Initial Setup","Mandatory Access Control","Configure AppArmor","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1068","T1565","T1565.001","T1565.003","TA0005"]},{"location":"1-Initial-Setup/1.6-Mandatory-Access-Control/1.6.1-Configure-AppArmor/1.6.1.4-Ensure-all-apparmor-profiles-are-enforcing/#remediation","title":"Remediation","text":"<p>Run the following command to set all profiles to enforce mode: <pre><code># aa-enforce /etc/apparmor.d/*\n</code></pre></p> <p>Note: Any unconfined processes may need to have a profile created or activated for them and then be restarted</p>","tags":["Level 2","Workstation","Server","Initial Setup","Mandatory Access Control","Configure AppArmor","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1068","T1565","T1565.001","T1565.003","TA0005"]},{"location":"1-Initial-Setup/1.7-Command-Line-Warning-Banners/1.7.1-Ensure-message-of-the-day-is-configured-properly/","title":"1.7.1 Ensure message of the day is configured properly","text":"","tags":["Level 1","Workstation","Server","Initial Setup","Command Line Warning Banners","Automated","T1082","T1592","T1592.004","TA0007"]},{"location":"1-Initial-Setup/1.7-Command-Line-Warning-Banners/1.7.1-Ensure-message-of-the-day-is-configured-properly/#audit","title":"Audit","text":"<p>Run the following command and verify no results are returned: <pre><code># grep -Eis \"(\\\\\\v|\\\\\\r|\\\\\\m|\\\\\\s|$(grep '^ID=' /etc/os-release | cut -d= -f2 | sed -e 's/\"//g'))\" /etc/motd\n</code></pre></p>","tags":["Level 1","Workstation","Server","Initial Setup","Command Line Warning Banners","Automated","T1082","T1592","T1592.004","TA0007"]},{"location":"1-Initial-Setup/1.7-Command-Line-Warning-Banners/1.7.1-Ensure-message-of-the-day-is-configured-properly/#remediation","title":"Remediation","text":"<p>Edit the /etc/motd file with the appropriate contents according to your site policy, remove any instances of \\m , \\r , \\s , \\v or references to the OS platform OR if the motd is not used, this file can be removed.</p> <p>Run the following command to remove the motd file: <pre><code># rm /etc/motd\n</code></pre></p>","tags":["Level 1","Workstation","Server","Initial Setup","Command Line Warning Banners","Automated","T1082","T1592","T1592.004","TA0007"]},{"location":"1-Initial-Setup/1.7-Command-Line-Warning-Banners/1.7.2-Ensure-local-login-warning-banner-is-configured-properly/","title":"1.7.2 Ensure local login warning banner is configured properly","text":"","tags":["Level 1","Workstation","Server","Initial Setup","Command Line Warning Banners","Automated","T1082","T1592","T1592.004","TA0007"]},{"location":"1-Initial-Setup/1.7-Command-Line-Warning-Banners/1.7.2-Ensure-local-login-warning-banner-is-configured-properly/#audit","title":"Audit","text":"<p>Run the following command and verify that the contents match site policy: <pre><code># cat /etc/issue\n</code></pre></p> <p>Run the following command and verify no results are returned: <pre><code># grep -E -i \"(\\\\\\v|\\\\\\r|\\\\\\m|\\\\\\s|$(grep '^ID=' /etc/os-release | cut -d= -f2 | sed -e 's/\"//g'))\" /etc/issue\n</code></pre></p>","tags":["Level 1","Workstation","Server","Initial Setup","Command Line Warning Banners","Automated","T1082","T1592","T1592.004","TA0007"]},{"location":"1-Initial-Setup/1.7-Command-Line-Warning-Banners/1.7.2-Ensure-local-login-warning-banner-is-configured-properly/#remediation","title":"Remediation","text":"<p>Edit the /etc/issue file with the appropriate contents according to your site policy, remove any instances of \\m , \\r , \\s , \\v or references to the OS platform <pre><code># echo \"Authorized uses only. All activity may be monitored and reported.\" &gt; /etc/issue\n</code></pre></p>","tags":["Level 1","Workstation","Server","Initial Setup","Command Line Warning Banners","Automated","T1082","T1592","T1592.004","TA0007"]},{"location":"1-Initial-Setup/1.7-Command-Line-Warning-Banners/1.7.3-Ensure-remote-login-warning-banner-is-configured-properly/","title":"1.7.3 Ensure remote login warning banner is configured properly","text":"","tags":["Level 1","Workstation","Server","Initial Setup","Command Line Warning Banners","Automated","T1018","T1082","T1592","T1592.004","TA0007"]},{"location":"1-Initial-Setup/1.7-Command-Line-Warning-Banners/1.7.3-Ensure-remote-login-warning-banner-is-configured-properly/#audit","title":"Audit","text":"<p>Run the following command and verify that the contents match site policy: <pre><code># cat /etc/issue.net\n</code></pre></p> <p>Run the following command and verify no results are returned: <pre><code># grep -E -i \"(\\\\\\v|\\\\\\r|\\\\\\m|\\\\\\s|$(grep '^ID=' /etc/os-release | cut -d= -f2 | sed -e 's/\"//g'))\" /etc/issue.net\n</code></pre></p>","tags":["Level 1","Workstation","Server","Initial Setup","Command Line Warning Banners","Automated","T1018","T1082","T1592","T1592.004","TA0007"]},{"location":"1-Initial-Setup/1.7-Command-Line-Warning-Banners/1.7.3-Ensure-remote-login-warning-banner-is-configured-properly/#remediation","title":"Remediation","text":"<p>Edit the /etc/issue.net file with the appropriate contents according to your site policy, remove any instances of \\m , \\r , \\s , \\v or references to the OS platform <pre><code># echo \"Authorized uses only. All activity may be monitored and reported.\" &gt; /etc/issue.net\n</code></pre></p>","tags":["Level 1","Workstation","Server","Initial Setup","Command Line Warning Banners","Automated","T1018","T1082","T1592","T1592.004","TA0007"]},{"location":"1-Initial-Setup/1.7-Command-Line-Warning-Banners/1.7.4-Ensure-permissions-on-etc-motd-are-configured/","title":"1.7.4 Ensure permissions on /etc/motd are configured","text":"","tags":["Level 1","Workstation","Server","Initial Setup","Command Line Warning Banners","Automated","3.3 Configure Data Access Control Lists","IG1","IG2","IG3","T1222","T1222.002","TA0005","M1022"]},{"location":"1-Initial-Setup/1.7-Command-Line-Warning-Banners/1.7.4-Ensure-permissions-on-etc-motd-are-configured/#audit","title":"Audit","text":"<p>Run the following command and verify: Uid and Gid are both 0/root and Access is 644, or the file doesn't exist. <pre><code># stat -L /etc/motd\nAccess: (0644/-rw-r--r--) Uid: ( 0/ root) Gid: ( 0/ root)\nOR\nstat: cannot stat '/etc/motd': No such file or directory\n</code></pre></p>","tags":["Level 1","Workstation","Server","Initial Setup","Command Line Warning Banners","Automated","3.3 Configure Data Access Control Lists","IG1","IG2","IG3","T1222","T1222.002","TA0005","M1022"]},{"location":"1-Initial-Setup/1.7-Command-Line-Warning-Banners/1.7.4-Ensure-permissions-on-etc-motd-are-configured/#remediation","title":"Remediation","text":"<p>Run the following commands to set permissions on /etc/motd : <pre><code># chown root:root $(readlink -e /etc/motd)\n# chmod u-x,go-wx $(readlink -e /etc/motd)\n</code></pre></p> <p>OR run the following command to remove the /etc/motd file: <pre><code># rm /etc/motd\n</code></pre></p> <p>Default Value:</p> <p>File doesn't exist</p>","tags":["Level 1","Workstation","Server","Initial Setup","Command Line Warning Banners","Automated","3.3 Configure Data Access Control Lists","IG1","IG2","IG3","T1222","T1222.002","TA0005","M1022"]},{"location":"1-Initial-Setup/1.7-Command-Line-Warning-Banners/1.7.5-Ensure-permissions-on-etc-issue-are-configured/","title":"1.7.5 Ensure permissions on /etc/issue are configured","text":"","tags":["Level 1","Workstation","Server","Initial Setup","Command Line Warning Banners","Automated","3.3 Configure Data Access Control Lists","IG1","IG2","IG3","T1222","T1222.002","TA0005","M1022"]},{"location":"1-Initial-Setup/1.7-Command-Line-Warning-Banners/1.7.5-Ensure-permissions-on-etc-issue-are-configured/#audit","title":"Audit","text":"<p>Run the following command and verify Uid and Gid are both 0/root and Access is 644 : <pre><code># stat -L /etc/issue\nAccess: (0644/-rw-r--r--) Uid: ( 0/ root) Gid: ( 0/ root)\n</code></pre></p>","tags":["Level 1","Workstation","Server","Initial Setup","Command Line Warning Banners","Automated","3.3 Configure Data Access Control Lists","IG1","IG2","IG3","T1222","T1222.002","TA0005","M1022"]},{"location":"1-Initial-Setup/1.7-Command-Line-Warning-Banners/1.7.5-Ensure-permissions-on-etc-issue-are-configured/#remediation","title":"Remediation","text":"<p>Run the following commands to set permissions on /etc/issue: <pre><code># chown root:root $(readlink -e /etc/issue)\n# chmod u-x,go-wx $(readlink -e /etc/issue)\n</code></pre></p> <p>Default Value: <pre><code>Access: (0644/-rw-r--r--) Uid: ( 0/ root) Gid: ( 0/ root)\n</code></pre></p>","tags":["Level 1","Workstation","Server","Initial Setup","Command Line Warning Banners","Automated","3.3 Configure Data Access Control Lists","IG1","IG2","IG3","T1222","T1222.002","TA0005","M1022"]},{"location":"1-Initial-Setup/1.7-Command-Line-Warning-Banners/1.7.6-Ensure-permissions-on-etc-issue.net-are-configured/","title":"1.7.6 Ensure permissions on /etc/issue.net are configured","text":"","tags":["Level 1","Workstation","Server","Initial Setup","Command Line Warning Banners","Automated","3.3 Configure Data Access Control Lists","IG1","IG2","IG3","T1222","T1222.002","TA0005","M1022"]},{"location":"1-Initial-Setup/1.7-Command-Line-Warning-Banners/1.7.6-Ensure-permissions-on-etc-issue.net-are-configured/#audit","title":"Audit","text":"<p>Run the following command and verify Uid and Gid are both 0/root and Access is 644 : <pre><code># stat -L /etc/issue.net\nAccess: (0644/-rw-r--r--) Uid: ( 0/ root) Gid: ( 0/ root)\n</code></pre></p>","tags":["Level 1","Workstation","Server","Initial Setup","Command Line Warning Banners","Automated","3.3 Configure Data Access Control Lists","IG1","IG2","IG3","T1222","T1222.002","TA0005","M1022"]},{"location":"1-Initial-Setup/1.7-Command-Line-Warning-Banners/1.7.6-Ensure-permissions-on-etc-issue.net-are-configured/#remediation","title":"Remediation","text":"<p>Run the following commands to set permissions on /etc/issue.net : <pre><code># chown root:root $(readlink -e /etc/issue.net)\n# chmod u-x,go-wx $(readlink -e /etc/issue.net)\n</code></pre></p> <p>Default Value:</p> <p>Access: (0644/-rw-r--r--) Uid: ( 0/ root) Gid: ( 0/ root)</p>","tags":["Level 1","Workstation","Server","Initial Setup","Command Line Warning Banners","Automated","3.3 Configure Data Access Control Lists","IG1","IG2","IG3","T1222","T1222.002","TA0005","M1022"]},{"location":"1-Initial-Setup/1.8-Gnome-Display-Manager/1.8.1-Ensure-gnome-display-manager-is-removed/","title":"1.8.1 Ensure GNOME Display Manager is removed","text":"","tags":["Level 2","Server","Initial Setup","GNOME Display Manager","Automated","IG2","IG3","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","T1543","T1543.002","TA0002"]},{"location":"1-Initial-Setup/1.8-Gnome-Display-Manager/1.8.1-Ensure-gnome-display-manager-is-removed/#audit","title":"Audit","text":"<p>Run the following command and verify gdm3 is not installed: <pre><code># dpkg-query -W -f='${binary:Package}\\t${Status}\\t${db:Status-Status}\\n' gdm3\ngdm3 unknown ok not-installed not-installed\n</code></pre></p>","tags":["Level 2","Server","Initial Setup","GNOME Display Manager","Automated","IG2","IG3","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","T1543","T1543.002","TA0002"]},{"location":"1-Initial-Setup/1.8-Gnome-Display-Manager/1.8.1-Ensure-gnome-display-manager-is-removed/#remediation","title":"Remediation","text":"<p>Run the following command to uninstall gdm3: <pre><code># apt purge gdm3\n</code></pre></p>","tags":["Level 2","Server","Initial Setup","GNOME Display Manager","Automated","IG2","IG3","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","T1543","T1543.002","TA0002"]},{"location":"1-Initial-Setup/1.8-Gnome-Display-Manager/1.8.10-Ensure-xdcmp-is-not-enabled/","title":"1.8.10 Ensure XDCMP is not enabled","text":"","tags":["Level 1","Workstation","Server","Initial Setup","GNOME Display Manager","Automated","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","IG2","IG3","T1040","T1056","T1056.001","T1557","TA0002","M1050"]},{"location":"1-Initial-Setup/1.8-Gnome-Display-Manager/1.8.10-Ensure-xdcmp-is-not-enabled/#audit","title":"Audit","text":"<p>Run the following command and verify the output: <pre><code># grep -Eis '^\\s*Enable\\s*=\\s*true' /etc/gdm3/custom.conf\n</code></pre></p> <p>Nothing should be returned</p>","tags":["Level 1","Workstation","Server","Initial Setup","GNOME Display Manager","Automated","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","IG2","IG3","T1040","T1056","T1056.001","T1557","TA0002","M1050"]},{"location":"1-Initial-Setup/1.8-Gnome-Display-Manager/1.8.10-Ensure-xdcmp-is-not-enabled/#remediation","title":"Remediation","text":"<p>Edit the file /etc/gdm3/custom.conf and remove the line: <pre><code>Enable=true\n</code></pre></p> <p>Default Value:</p> <p>false (This is denoted by no Enabled= entry in the file /etc/gdm3/custom.conf in the [xdmcp] section</p>","tags":["Level 1","Workstation","Server","Initial Setup","GNOME Display Manager","Automated","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","IG2","IG3","T1040","T1056","T1056.001","T1557","TA0002","M1050"]},{"location":"1-Initial-Setup/1.8-Gnome-Display-Manager/1.8.2-Ensure-gdm-login-banner-is-configured/","title":"1.8.2 Ensure GDM login banner is configured","text":"","tags":["Level 2","Server","Initial Setup","GNOME Display Manager","Automated","TA0007"]},{"location":"1-Initial-Setup/1.8-Gnome-Display-Manager/1.8.2-Ensure-gdm-login-banner-is-configured/#audit","title":"Audit","text":"<p>Run the following script to verify that the text banner on the login screen is enabled and set: <pre><code>#!/usr/bin/env bash\n{\nl_pkgoutput=\"\"\nif command -v dpkg-query &gt; /dev/null 2&gt;&amp;1; then\nl_pq=\"dpkg-query -W\"\nelif command -v rpm &gt; /dev/null 2&gt;&amp;1; then\nl_pq=\"rpm -q\"\nfi\nl_pcl=\"gdm gdm3\" # Space seporated list of packages to check\nfor l_pn in $l_pcl; do\n$l_pq \"$l_pn\" &gt; /dev/null 2&gt;&amp;1 &amp;&amp; l_pkgoutput=\"$l_pkgoutput\\n - Package: \\\"$l_pn\\\" exists on the system\\n - checking configuration\"\ndone\nif [ -n \"$l_pkgoutput\" ]; then\nl_output=\"\" l_output2=\"\"\necho -e \"$l_pkgoutput\"\n# Look for existing settings and set variables if they exist\nl_gdmfile=\"$(grep -Prils '^\\h*banner-message-enable\\b' /etc/dconf/db/*.d)\"\nif [ -n \"$l_gdmfile\" ]; then\n# Set profile name based on dconf db directory ({PROFILE_NAME}.d)\nl_gdmprofile=\"$(awk -F\\/ '{split($(NF-1),a,\".\");print a[1]}' &lt;&lt;&lt; \"$l_gdmfile\")\"\n# Check if banner message is enabled\nif grep -Pisq '^\\h*banner-message-enable=true\\b' \"$l_gdmfile\"; then\nl_output=\"$l_output\\n - The \\\"banner-message-enable\\\" option is enabled in \\\"$l_gdmfile\\\"\"\nelse\nl_output2=\"$l_output2\\n - The \\\"banner-message-enable\\\" option is not enabled\"\nfi\nl_lsbt=\"$(grep -Pios '^\\h*banner-message-text=.*$' \"$l_gdmfile\")\"\nif [ -n \"$l_lsbt\" ]; then\nl_output=\"$l_output\\n - The \\\"banner-message-text\\\" option is set in \\\"$l_gdmfile\\\"\\n - banner-message-text is set to:\\n - \\\"$l_lsbt\\\"\"\nelse\nl_output2=\"$l_output2\\n - The \\\"banner-message-text\\\" option is not set\"\nfi\nif grep -Pq \"^\\h*system-db:$l_gdmprofile\" /etc/dconf/profile/\"$l_gdmprofile\"; then\nl_output=\"$l_output\\n - The \\\"$l_gdmprofile\\\" profile exists\"\nelse\nl_output2=\"$l_output2\\n - The \\\"$l_gdmprofile\\\" profile doesn't exist\"\nfi\nif [ -f \"/etc/dconf/db/$l_gdmprofile\" ]; then\nl_output=\"$l_output\\n - The \\\"$l_gdmprofile\\\" profile exists in the dconf database\"\nelse\nl_output2=\"$l_output2\\n - The \\\"$l_gdmprofile\\\" profile doesn't exist in the dconf database\"\nfi\nelse\nl_output2=\"$l_output2\\n - The \\\"banner-message-enable\\\" option isn't configured\"\nfi\nelse\necho -e \"\\n\\n - GNOME Desktop Manager isn't installed\\n - Recommendation is Not Applicable\\n- Audit result:\\n *** PASS ***\\n\"\nfi\n# Report results. If no failures output in l_output2, we pass\nif [ -z \"$l_output2\" ]; then\necho -e \"\\n- Audit Result:\\n ** PASS **\\n$l_output\\n\"\nelse\necho -e \"\\n- Audit Result:\\n ** FAIL **\\n - Reason(s) for audit failure:\\n$l_output2\\n\"\n[ -n \"$l_output\" ] &amp;&amp; echo -e \"\\n- Correctly set:\\n$l_output\\n\"\nfi\n}\n</code></pre></p>","tags":["Level 2","Server","Initial Setup","GNOME Display Manager","Automated","TA0007"]},{"location":"1-Initial-Setup/1.8-Gnome-Display-Manager/1.8.2-Ensure-gdm-login-banner-is-configured/#remediation","title":"Remediation","text":"<p>Run the following script to verify that the banner message is enabled and set: <pre><code>#!/usr/bin/env bash\n{\nl_pkgoutput=\"\"\nif command -v dpkg-query &gt; /dev/null 2&gt;&amp;1; then\nl_pq=\"dpkg-query -W\"\nelif command -v rpm &gt; /dev/null 2&gt;&amp;1; then\nl_pq=\"rpm -q\"\nfi\nl_pcl=\"gdm gdm3\" # Space seporated list of packages to check\nfor l_pn in $l_pcl; do\n$l_pq \"$l_pn\" &gt; /dev/null 2&gt;&amp;1 &amp;&amp; l_pkgoutput=\"$l_pkgoutput\\n - Package: \\\"$l_pn\\\" exists on the system\\n - checking configuration\"\ndone\nif [ -n \"$l_pkgoutput\" ]; then\nl_gdmprofile=\"gdm\" # Set this to desired profile name IaW Local site policy\nl_bmessage=\"'Authorized uses only. All activity may be monitored and reported'\" # Set to desired banner message\nif [ ! -f \"/etc/dconf/profile/$l_gdmprofile\" ]; then\necho \"Creating profile \\\"$l_gdmprofile\\\"\"\necho -e \"user-db:user\\nsystem-db:$l_gdmprofile\\nfiledb:/usr/share/$l_gdmprofile/greeter-dconf-defaults\" &gt; /etc/dconf/profile/$l_gdmprofile\nfi\nif [ ! -d \"/etc/dconf/db/$l_gdmprofile.d/\" ]; then\necho \"Creating dconf database directory \\\"/etc/dconf/db/$l_gdmprofile.d/\\\"\"\nmkdir /etc/dconf/db/$l_gdmprofile.d/\n fi\nif ! grep -Piq '^\\h*banner-message-enable\\h*=\\h*true\\b' /etc/dconf/db/$l_gdmprofile.d/*; then\necho \"creating gdm keyfile for machine-wide settings\"\nif ! grep -Piq -- '^\\h*banner-message-enable\\h*=\\h*' /etc/dconf/db/$l_gdmprofile.d/*; then\nl_kfile=\"/etc/dconf/db/$l_gdmprofile.d/01-banner-message\"\necho -e \"\\n[org/gnome/login-screen]\\nbanner-message-enable=true\" &gt;&gt; \"$l_kfile\"\nelse\nl_kfile=\"$(grep -Pil -- '^\\h*banner-message-enable\\h*=\\h*' /etc/dconf/db/$l_gdmprofile.d/*)\"\n! grep -Pq '^\\h*\\[org\\/gnome\\/login-screen\\]' \"$l_kfile\" &amp;&amp; sed - ri '/^\\s*banner-message-enable/ i\\[org/gnome/login-screen]' \"$l_kfile\"\n! grep -Pq '^\\h*banner-message-enable\\h*=\\h*true\\b' \"$l_kfile\" &amp;&amp; sed -ri 's/^\\s*(banner-message-enable\\s*=\\s*)(\\S+)(\\s*.*$)/\\1true \\3//' \"$l_kfile\"\n# sed -ri '/^\\s*\\[org\\/gnome\\/login-screen\\]/ a\\\\nbanner-messageenable=true' \"$l_kfile\"\nfi\nfi\nif ! grep -Piq \"^\\h*banner-message-text=[\\'\\\"]+\\S+\" \"$l_kfile\"; then\nsed -ri \"/^\\s*banner-message-enable/ a\\banner-messagetext=$l_bmessage\" \"$l_kfile\"\nfi\ndconf update\n else\necho -e \"\\n\\n - GNOME Desktop Manager isn't installed\\n - Recommendation is Not Applicable\\n - No remediation required\\n\"\nfi\n}\n</code></pre></p> <p>Note:</p> <p>There is no character limit for the banner message. gnome-shell autodetects longer stretches of text and enters two column mode.</p> <p>The banner message cannot be read from an external file.</p> <p>OR</p> <p>Run the following command to remove the gdm3 package: <pre><code># apt purge gdm3\n</code></pre></p> <p>Default Value:</p> <p>disabled</p>","tags":["Level 2","Server","Initial Setup","GNOME Display Manager","Automated","TA0007"]},{"location":"1-Initial-Setup/1.8-Gnome-Display-Manager/1.8.3-Ensure-gdm-disable-user-list-option-is-enabled/","title":"1.8.3 Ensure GDM disable-user-list option is enabled","text":"","tags":["Level 2","Server","Initial Setup","GNOME Display Manager","Automated","T1078","T1078.001","T1078.002","T1078.003","T1087","T1087.001","T1087.002","TA0007","M1028"]},{"location":"1-Initial-Setup/1.8-Gnome-Display-Manager/1.8.3-Ensure-gdm-disable-user-list-option-is-enabled/#audit","title":"Audit","text":"<p>Run the following script and to verify that the disable-user-list option is enabled or GNOME isn't installed: <pre><code>#!/usr/bin/env bash\n{\nl_pkgoutput=\"\"\nif command -v dpkg-query &gt; /dev/null 2&gt;&amp;1; then\nl_pq=\"dpkg-query -W\"\nelif command -v rpm &gt; /dev/null 2&gt;&amp;1; then\nl_pq=\"rpm -q\"\nfi\nl_pcl=\"gdm gdm3\" # Space seporated list of packages to check\nfor l_pn in $l_pcl; do\n$l_pq \"$l_pn\" &gt; /dev/null 2&gt;&amp;1 &amp;&amp; l_pkgoutput=\"$l_pkgoutput\\n - Package: \\\"$l_pn\\\" exists on the system\\n - checking configuration\"\ndone\nif [ -n \"$l_pkgoutput\" ]; then\noutput=\"\" output2=\"\"\nl_gdmfile=\"$(grep -Pril '^\\h*disable-user-list\\h*=\\h*true\\b' /etc/dconf/db)\"\nif [ -n \"$l_gdmfile\" ]; then\noutput=\"$output\\n - The \\\"disable-user-list\\\" option is enabled in \\\"$l_gdmfile\\\"\"\nl_gdmprofile=\"$(awk -F\\/ '{split($(NF-1),a,\".\");print a[1]}' &lt;&lt;&lt; \"$l_gdmfile\")\"\nif grep -Pq \"^\\h*system-db:$l_gdmprofile\" /etc/dconf/profile/\"$l_gdmprofile\"; then\noutput=\"$output\\n - The \\\"$l_gdmprofile\\\" exists\"\nelse\noutput2=\"$output2\\n - The \\\"$l_gdmprofile\\\" doesn't exist\"\nfi\nif [ -f \"/etc/dconf/db/$l_gdmprofile\" ]; then\noutput=\"$output\\n - The \\\"$l_gdmprofile\\\" profile exists in the dconf database\"\nelse\noutput2=\"$output2\\n - The \\\"$l_gdmprofile\\\" profile doesn't exist in the dconf database\"\nfi\nelse\noutput2=\"$output2\\n - The \\\"disable-user-list\\\" option is not enabled\"\nfi\nif [ -z \"$output2\" ]; then\necho -e \"$l_pkgoutput\\n- Audit result:\\n *** PASS: ***\\n$output\\n\"\nelse\necho -e \"$l_pkgoutput\\n- Audit Result:\\n *** FAIL: ***\\n$output2\\n\"\n[ -n \"$output\" ] &amp;&amp; echo -e \"$output\\n\"\nfi\nelse\necho -e \"\\n\\n - GNOME Desktop Manager isn't installed\\n - Recommendation is Not Applicable\\n- Audit result:\\n *** PASS ***\\n\"\nfi\n}\n</code></pre></p>","tags":["Level 2","Server","Initial Setup","GNOME Display Manager","Automated","T1078","T1078.001","T1078.002","T1078.003","T1087","T1087.001","T1087.002","TA0007","M1028"]},{"location":"1-Initial-Setup/1.8-Gnome-Display-Manager/1.8.3-Ensure-gdm-disable-user-list-option-is-enabled/#remediation","title":"Remediation","text":"<p>Run the following script to enable the disable-user-list option:</p> <p>Note: the l_gdm_profile variable in the script can be changed if a different profile name is desired in accordance with local site policy. <pre><code>#!/usr/bin/env bash\n{\nl_gdmprofile=\"gdm\"\nif [ ! -f \"/etc/dconf/profile/$l_gdmprofile\" ]; then\necho \"Creating profile \\\"$l_gdmprofile\\\"\"\necho -e \"user-db:user\\nsystem-db:$l_gdmprofile\\nfiledb:/usr/share/$l_gdmprofile/greeter-dconf-defaults\" &gt; /etc/dconf/profile/$l_gdmprofile\nfi\nif [ ! -d \"/etc/dconf/db/$l_gdmprofile.d/\" ]; then\necho \"Creating dconf database directory \\\"/etc/dconf/db/$l_gdmprofile.d/\\\"\"\nmkdir /etc/dconf/db/$l_gdmprofile.d/\n fi\nif ! grep -Piq '^\\h*disable-user-list\\h*=\\h*true\\b' /etc/dconf/db/$l_gdmprofile.d/*; then\necho \"creating gdm keyfile for machine-wide settings\"\nif ! grep -Piq -- '^\\h*\\[org\\/gnome\\/login-screen\\]' /etc/dconf/db/$l_gdmprofile.d/*; then\necho -e \"\\n[org/gnome/login-screen]\\n# Do not show the user list\\ndisable-user-list=true\" &gt;&gt; /etc/dconf/db/$l_gdmprofile.d/00-loginscreen\n else\nsed -ri '/^\\s*\\[org\\/gnome\\/login-screen\\]/ a\\# Do not show the user list\\ndisable-user-list=true' $(grep -Pil -- '^\\h*\\[org\\/gnome\\/loginscreen\\]' /etc/dconf/db/$l_gdmprofile.d/*)\nfi\nfi\ndconf update\n}\n</code></pre></p> <p>Note: When the user profile is created or changed, the user will need to log out and log in again before the changes will be applied.</p> <p>OR</p> <p>Run the following command to remove the GNOME package: <pre><code># apt purge gdm3\n</code></pre></p>","tags":["Level 2","Server","Initial Setup","GNOME Display Manager","Automated","T1078","T1078.001","T1078.002","T1078.003","T1087","T1087.001","T1087.002","TA0007","M1028"]},{"location":"1-Initial-Setup/1.8-Gnome-Display-Manager/1.8.4-Ensure-gdm-screen-locks-when-the-user-is-idle/","title":"1.8.4 Ensure GDM screen locks when the user is idle","text":"","tags":["Level 1","Workstation","Server","Initial Setup","GNOME Display Manager","Automated","IG1","IG2","IG3","4.3 Configure Automatic Session Locking on Enterprise Assets"]},{"location":"1-Initial-Setup/1.8-Gnome-Display-Manager/1.8.4-Ensure-gdm-screen-locks-when-the-user-is-idle/#audit","title":"Audit","text":"<p>Run the following script to verify that the screen locks when the user is idle: <pre><code>#!/usr/bin/env bash\n{\n# Check if GNMOE Desktop Manager is installed. If package isn't installed, recommendation is Not Applicable\\n\n# determine system's package manager\nl_pkgoutput=\"\"\nif command -v dpkg-query &gt; /dev/null 2&gt;&amp;1; then\nl_pq=\"dpkg-query -W\"\nelif command -v rpm &gt; /dev/null 2&gt;&amp;1; then\nl_pq=\"rpm -q\"\nfi\n# Check if GDM is installed\nl_pcl=\"gdm gdm3\" # Space seporated list of packages to check\nfor l_pn in $l_pcl; do\n$l_pq \"$l_pn\" &gt; /dev/null 2&gt;&amp;1 &amp;&amp; l_pkgoutput=\"$l_pkgoutput\\n - Package: \\\"$l_pn\\\" exists on the system\\n - checking configuration\"\ndone\n# Check configuration (If applicable)\nif [ -n \"$l_pkgoutput\" ]; then\nl_output=\"\" l_output2=\"\"\nl_idmv=\"900\" # Set for max value for idle-delay in seconds\nl_ldmv=\"5\" # Set for max value for lock-delay in seconds\n# Look for idle-delay to determine profile in use, needed for remaining tests\nl_kfile=\"$(grep -Psril '^\\h*idle-delay\\h*=\\h*uint32\\h+\\d+\\b' /etc/dconf/db/*/)\" # Determine file containing idle-delay key\nif [ -n \"$l_kfile\" ]; then\n# set profile name (This is the name of a dconf database)\nl_profile=\"$(awk -F'/' '{split($(NF-1),a,\".\");print a[1]}' &lt;&lt;&lt; \"$l_kfile\")\" #Set the key profile name\nl_pdbdir=\"/etc/dconf/db/$l_profile.d\" # Set the key file dconf db directory\n# Confirm that idle-delay exists, includes unit32, and value is between 1 and max value for idle-delay\nl_idv=\"$(awk -F 'uint32' '/idle-delay/{print $2}' \"$l_kfile\" | xargs)\"\nif [ -n \"$l_idv\" ]; then\n[ \"$l_idv\" -gt \"0\" -a \"$l_idv\" -le \"$l_idmv\" ] &amp;&amp; l_output=\"$l_output\\n - The \\\"idle-delay\\\" option is set to \\\"$l_idv\\\" seconds in \\\"$l_kfile\\\"\"\n[ \"$l_idv\" = \"0\" ] &amp;&amp; l_output2=\"$l_output2\\n - The \\\"idledelay\\\" option is set to \\\"$l_idv\\\" (disabled) in \\\"$l_kfile\\\"\"\n[ \"$l_idv\" -gt \"$l_idmv\" ] &amp;&amp; l_output2=\"$l_output2\\n - The \\\"idle-delay\\\" option is set to \\\"$l_idv\\\" seconds (greater than $l_idmv) in \\\"$l_kfile\\\"\"\nelse\nl_output2=\"$l_output2\\n - The \\\"idle-delay\\\" option is not set in \\\"$l_kfile\\\"\"\nfi\n# Confirm that lock-delay exists, includes unit32, and value is between 0 and max value for lock-delay\nl_ldv=\"$(awk -F 'uint32' '/lock-delay/{print $2}' \"$l_kfile\" | xargs)\"\nif [ -n \"$l_ldv\" ]; then\n[ \"$l_ldv\" -ge \"0\" -a \"$l_ldv\" -le \"$l_ldmv\" ] &amp;&amp; l_output=\"$l_output\\n - The \\\"lock-delay\\\" option is set to \\\"$l_ldv\\\" seconds in \\\"$l_kfile\\\"\"\n[ \"$l_ldv\" -gt \"$l_ldmv\" ] &amp;&amp; l_output2=\"$l_output2\\n - The \\\"lock-delay\\\" option is set to \\\"$l_ldv\\\" seconds (greater than $l_ldmv) in \\\"$l_kfile\\\"\"\nelse\nl_output2=\"$l_output2\\n - The \\\"lock-delay\\\" option is not set in \\\"$l_kfile\\\"\"\nfi\n# Confirm that dconf profile exists\nif grep -Psq \"^\\h*system-db:$l_profile\" /etc/dconf/profile/*; then\nl_output=\"$l_output\\n - The \\\"$l_profile\\\" profile exists\"\nelse\nl_output2=\"$l_output2\\n - The \\\"$l_profile\\\" doesn't exist\"\nfi\n# Confirm that dconf profile database file exists\nif [ -f \"/etc/dconf/db/$l_profile\" ]; then\nl_output=\"$l_output\\n - The \\\"$l_profile\\\" profile exists in the dconf database\"\nelse\nl_output2=\"$l_output2\\n - The \\\"$l_profile\\\" profile doesn't exist in the dconf database\"\nfi\nelse\nl_output2=\"$l_output2\\n - The \\\"idle-delay\\\" option doesn't exist, remaining tests skipped\"\nfi\nelse\nl_output=\"$l_output\\n - GNOME Desktop Manager package is not installed on the system\\n - Recommendation is not applicable\"\nfi\n# Report results. If no failures output in l_output2, we pass\n[ -n \"$l_pkgoutput\" ] &amp;&amp; echo -e \"\\n$l_pkgoutput\"\nif [ -z \"$l_output2\" ]; then\necho -e \"\\n- Audit Result:\\n ** PASS **\\n$l_output\\n\"\nelse\necho -e \"\\n- Audit Result:\\n ** FAIL **\\n - Reason(s) for audit failure:\\n$l_output2\\n\"\n[ -n \"$l_output\" ] &amp;&amp; echo -e \"\\n- Correctly set:\\n$l_output\\n\"\nfi\n}\n</code></pre></p> <p>Note:</p> <p>idle-delay=uint32 Should be 900 seconds (15 minutes) or less, not 0 (disabled) and follow local site policy</p> <p>lock-delay=uint32 should be 5 seconds or less and follow local site policy</p>","tags":["Level 1","Workstation","Server","Initial Setup","GNOME Display Manager","Automated","IG1","IG2","IG3","4.3 Configure Automatic Session Locking on Enterprise Assets"]},{"location":"1-Initial-Setup/1.8-Gnome-Display-Manager/1.8.4-Ensure-gdm-screen-locks-when-the-user-is-idle/#remediation","title":"Remediation","text":"<p>Create or edit a file in the /etc/dconf/profile/ and verify it includes the following: <pre><code>user-db:user\nsystem-db:{NAME_OF_DCONF_DATABASE}\n</code></pre></p> <p>Note: local is the name of a dconf database used in the examples.</p> <p>Example: <pre><code># echo -e '\\nuser-db:user\\nsystem-db:local' &gt;&gt; /etc/dconf/profile/user\n</code></pre> Create the directory /etc/dconf/db/{NAME_OF_DCONF_DATABASE}.d/ if it doesn't already exist:</p> <p>Example: <pre><code># mkdir /etc/dconf/db/local.d\n</code></pre></p> <p>Create the key file `/etc/dconf/db/{NAME_OF_DCONF_DATABASE}.d/{FILE_NAME} to provide information for the {NAME_OF_DCONF_DATABASE} database:</p> <p>Example script: <pre><code>#!/usr/bin/env bash\n{\nl_key_file=\"/etc/dconf/db/local.d/00-screensaver\"\nl_idmv=\"900\" # Set max value for idle-delay in seconds (between 1 and 900)\nl_ldmv=\"5\" # Set max value for lock-delay in seconds (between 0 and 5)\n{\necho '# Specify the dconf path'\necho '[org/gnome/desktop/session]'\necho ''\necho '# Number of seconds of inactivity before the screen goes blank'\necho '# Set to 0 seconds if you want to deactivate the screensaver.'\necho \"idle-delay=uint32 $l_idmv\"\necho ''\necho '# Specify the dconf path'\necho '[org/gnome/desktop/screensaver]'\necho ''\necho '# Number of seconds after the screen is blank before locking the screen'\necho \"lock-delay=uint32 $l_ldmv\"\n} &gt; \"$l_key_file\"\n}\n</code></pre></p> <p>Note: You must include the uint32 along with the integer key values as shown.</p> <p>Run the following command to update the system databases: <pre><code># dconf update\n</code></pre></p> <p>Note: Users must log out and back in again before the system-wide settings take effect.</p>","tags":["Level 1","Workstation","Server","Initial Setup","GNOME Display Manager","Automated","IG1","IG2","IG3","4.3 Configure Automatic Session Locking on Enterprise Assets"]},{"location":"1-Initial-Setup/1.8-Gnome-Display-Manager/1.8.5-Ensure-gdm-screen-locks-cannot-be-overridden/","title":"1.8.5 Ensure GDM screen locks cannot be overridden","text":"","tags":["Level 1","Workstation","Server","Initial Setup","GNOME Display Manager","Automated","IG1","IG2","IG3","4.3 Configure Automatic Session Locking on Enterprise Assets"]},{"location":"1-Initial-Setup/1.8-Gnome-Display-Manager/1.8.5-Ensure-gdm-screen-locks-cannot-be-overridden/#audit","title":"Audit","text":"<p>Run the following script to verify that the screen lock can not be overridden: <pre><code>#!/usr/bin/env bash\n{\n# Check if GNOME Desktop Manager is installed. If package isn't installed, recommendation is Not Applicable\\n\n# determine system's package manager\nl_pkgoutput=\"\"\nif command -v dpkg-query &gt; /dev/null 2&gt;&amp;1; then\nl_pq=\"dpkg-query -W\"\nelif command -v rpm &gt; /dev/null 2&gt;&amp;1; then\nl_pq=\"rpm -q\"\nfi\n# Check if GDM is installed\nl_pcl=\"gdm gdm3\" # Space seporated list of packages to check\nfor l_pn in $l_pcl; do\n$l_pq \"$l_pn\" &gt; /dev/null 2&gt;&amp;1 &amp;&amp; l_pkgoutput=\"$l_pkgoutput\\n - Package: \\\"$l_pn\\\" exists on the system\\n - checking configuration\"\ndone\n# Check configuration (If applicable)\nif [ -n \"$l_pkgoutput\" ]; then\nl_output=\"\" l_output2=\"\"\n# Look for idle-delay to determine profile in use, needed for remaining tests\nl_kfd=\"/etc/dconf/db/$(grep -Psril '^\\h*idledelay\\h*=\\h*uint32\\h+\\d+\\b' /etc/dconf/db/*/ | awk -F'/' '{split($(NF1),a,\".\");print a[1]}').d\" #set directory of key file to be locked\nl_kfd2=\"/etc/dconf/db/$(grep -Psril '^\\h*lockdelay\\h*=\\h*uint32\\h+\\d+\\b' /etc/dconf/db/*/ | awk -F'/' '{split($(NF1),a,\".\");print a[1]}').d\" #set directory of key file to be locked\nif [ -d \"$l_kfd\" ]; then # If key file directory doesn't exist, options can't be locked\nif grep -Prilq '\\/org\\/gnome\\/desktop\\/session\\/idle-delay\\b' \"$l_kfd\"; then\nl_output=\"$l_output\\n - \\\"idle-delay\\\" is locked in \\\"$(grep - Pril '\\/org\\/gnome\\/desktop\\/session\\/idle-delay\\b' \"$l_kfd\")\\\"\"\nelse\nl_output2=\"$l_output2\\n - \\\"idle-delay\\\" is not locked\"\nfi\nelse\nl_output2=\"$l_output2\\n - \\\"idle-delay\\\" is not set so it can not be locked\"\nfi\nif [ -d \"$l_kfd2\" ]; then # If key file directory doesn't exist, options can't be locked\nif grep -Prilq '\\/org\\/gnome\\/desktop\\/screensaver\\/lock-delay\\b' \"$l_kfd2\"; then\nl_output=\"$l_output\\n - \\\"lock-delay\\\" is locked in \\\"$(grep - Pril '\\/org\\/gnome\\/desktop\\/screensaver\\/lock-delay\\b' \"$l_kfd2\")\\\"\"\nelse\nl_output2=\"$l_output2\\n - \\\"lock-delay\\\" is not locked\"\nfi\nelse\nl_output2=\"$l_output2\\n - \\\"lock-delay\\\" is not set so it can not be locked\"\nfi\nelse\nl_output=\"$l_output\\n - GNOME Desktop Manager package is not installed on the system\\n - Recommendation is not applicable\"\nfi\n# Report results. If no failures output in l_output2, we pass\n[ -n \"$l_pkgoutput\" ] &amp;&amp; echo -e \"\\n$l_pkgoutput\"\nif [ -z \"$l_output2\" ]; then\necho -e \"\\n- Audit Result:\\n ** PASS **\\n$l_output\\n\"\nelse\necho -e \"\\n- Audit Result:\\n ** FAIL **\\n - Reason(s) for audit\nfailure:\\n$l_output2\\n\"\n[ -n \"$l_output\" ] &amp;&amp; echo -e \"\\n- Correctly set:\\n$l_output\\n\"\nfi\n}\n</code></pre></p>","tags":["Level 1","Workstation","Server","Initial Setup","GNOME Display Manager","Automated","IG1","IG2","IG3","4.3 Configure Automatic Session Locking on Enterprise Assets"]},{"location":"1-Initial-Setup/1.8-Gnome-Display-Manager/1.8.5-Ensure-gdm-screen-locks-cannot-be-overridden/#remediation","title":"Remediation","text":"<p>Run the following script to ensure screen locks can not be overridden: <pre><code>#!/usr/bin/env bash\n{\n# Check if GNMOE Desktop Manager is installed. If package isn't installed, recommendation is Not Applicable\\n\n# determine system's package manager\nl_pkgoutput=\"\"\nif command -v dpkg-query &gt; /dev/null 2&gt;&amp;1; then\nl_pq=\"dpkg-query -W\"\nelif command -v rpm &gt; /dev/null 2&gt;&amp;1; then\nl_pq=\"rpm -q\"\nfi\n# Check if GDM is installed\nl_pcl=\"gdm gdm3\" # Space seporated list of packages to check\nfor l_pn in $l_pcl; do\n$l_pq \"$l_pn\" &gt; /dev/null 2&gt;&amp;1 &amp;&amp; l_pkgoutput=\"y\" &amp;&amp; echo -e \"\\n - Package: \\\"$l_pn\\\" exists on the system\\n - remediating configuration if needed\"\ndone\n# Check configuration (If applicable)\nif [ -n \"$l_pkgoutput\" ]; then\n# Look for idle-delay to determine profile in use, needed for remaining tests\nl_kfd=\"/etc/dconf/db/$(grep -Psril '^\\h*idledelay\\h*=\\h*uint32\\h+\\d+\\b' /etc/dconf/db/*/ | awk -F'/' '{split($(NF1),a,\".\");print a[1]}').d\" #set directory of key file to be locked\n# Look for lock-delay to determine profile in use, needed for remaining tests\nl_kfd2=\"/etc/dconf/db/$(grep -Psril '^\\h*lockdelay\\h*=\\h*uint32\\h+\\d+\\b' /etc/dconf/db/*/ | awk -F'/' '{split($(NF1),a,\".\");print a[1]}').d\" #set directory of key file to be locked\nif [ -d \"$l_kfd\" ]; then # If key file directory doesn't exist, options can't be locked\nif grep -Prilq '^\\h*\\/org\\/gnome\\/desktop\\/session\\/idle-delay\\b' \"$l_kfd\"; then\necho \" - \\\"idle-delay\\\" is locked in \\\"$(grep -Pril '^\\h*\\/org\\/gnome\\/desktop\\/session\\/idle-delay\\b' \"$l_kfd\")\\\"\"\nelse\necho \"creating entry to lock \\\"idle-delay\\\"\"\n[ ! -d \"$l_kfd\"/locks ] &amp;&amp; echo \"creating directory $l_kfd/locks\" &amp;&amp; mkdir \"$l_kfd\"/locks\n {\necho -e '\\n# Lock desktop screensaver idle-delay setting'\necho '/org/gnome/desktop/session/idle-delay'\n} &gt;&gt; \"$l_kfd\"/locks/00-screensaver\n fi\nelse\necho -e \" - \\\"idle-delay\\\" is not set so it can not be locked\\n - Please follow Recommendation \\\"Ensure GDM screen locks when the user is idle\\\" and follow this Recommendation again\"\nfi\nif [ -d \"$l_kfd2\" ]; then # If key file directory doesn't exist, options can't be locked\nif grep -Prilq '^\\h*\\/org\\/gnome\\/desktop\\/screensaver\\/lockdelay\\b' \"$l_kfd2\"; then\necho \" - \\\"lock-delay\\\" is locked in \\\"$(grep -Pril '^\\h*\\/org\\/gnome\\/desktop\\/screensaver\\/lock-delay\\b' \"$l_kfd2\")\\\"\"\nelse\necho \"creating entry to lock \\\"lock-delay\\\"\"\n[ ! -d \"$l_kfd2\"/locks ] &amp;&amp; echo \"creating directory $l_kfd2/locks\" &amp;&amp; mkdir \"$l_kfd2\"/locks\n {\necho -e '\\n# Lock desktop screensaver lock-delay setting'\necho '/org/gnome/desktop/screensaver/lock-delay'\n} &gt;&gt; \"$l_kfd2\"/locks/00-screensaver\n fi\nelse\necho -e \" - \\\"lock-delay\\\" is not set so it can not be locked\\n - Please follow Recommendation \\\"Ensure GDM screen locks when the user is idle\\\" and follow this Recommendation again\"\nfi\nelse\necho -e \" - GNOME Desktop Manager package is not installed on the system\\n - Recommendation is not applicable\"\nfi\n}\n</code></pre></p> <p>Run the following command to update the system databases: <pre><code># dconf update\n</code></pre></p> <p>Note: Users must log out and back in again before the system-wide settings take effect.</p>","tags":["Level 1","Workstation","Server","Initial Setup","GNOME Display Manager","Automated","IG1","IG2","IG3","4.3 Configure Automatic Session Locking on Enterprise Assets"]},{"location":"1-Initial-Setup/1.8-Gnome-Display-Manager/1.8.6-Ensure-gdm-automatic-mounting-of-removable-media-is-disabled/","title":"1.8.6 Ensure GDM automatic mounting of removable media is disabled","text":"","tags":["Level 1","Level 2","Workstation","Server","Initial Setup","GNOME Display Manager","Automated","IG1","IG2","IG3","10.3 Disable Autorun and Autoplay for Removable Media"]},{"location":"1-Initial-Setup/1.8-Gnome-Display-Manager/1.8.6-Ensure-gdm-automatic-mounting-of-removable-media-is-disabled/#audit","title":"Audit","text":"<p>Run the following script to verify automatic mounting is disabled: <pre><code>#!/usr/bin/env bash\n{\nl_pkgoutput=\"\" l_output=\"\" l_output2=\"\"\n# Check if GNOME Desktop Manager is installed. If package isn't installed, recommendation is Not Applicable\\n\n# determine system's package manager\nif command -v dpkg-query &gt; /dev/null 2&gt;&amp;1; then\nl_pq=\"dpkg-query -W\"\nelif command -v rpm &gt; /dev/null 2&gt;&amp;1; then\nl_pq=\"rpm -q\"\nfi\n# Check if GDM is installed\nl_pcl=\"gdm gdm3\" # Space seporated list of packages to check\nfor l_pn in $l_pcl; do\n$l_pq \"$l_pn\" &gt; /dev/null 2&gt;&amp;1 &amp;&amp; l_pkgoutput=\"$l_pkgoutput\\n - Package: \\\"$l_pn\\\" exists on the system\\n - checking configuration\"\ndone\n# Check configuration (If applicable)\nif [ -n \"$l_pkgoutput\" ]; then\necho -e \"$l_pkgoutput\"\n# Look for existing settings and set variables if they exist\nl_kfile=\"$(grep -Prils -- '^\\h*automount\\b' /etc/dconf/db/*.d)\"\nl_kfile2=\"$(grep -Prils -- '^\\h*automount-open\\b' /etc/dconf/db/*.d)\"\n# Set profile name based on dconf db directory ({PROFILE_NAME}.d)\nif [ -f \"$l_kfile\" ]; then\nl_gpname=\"$(awk -F\\/ '{split($(NF-1),a,\".\");print a[1]}' &lt;&lt;&lt; \"$l_kfile\")\"\nelif [ -f \"$l_kfile2\" ]; then\nl_gpname=\"$(awk -F\\/ '{split($(NF-1),a,\".\");print a[1]}' &lt;&lt;&lt; \"$l_kfile2\")\"\nfi\n# If the profile name exist, continue checks\nif [ -n \"$l_gpname\" ]; then\nl_gpdir=\"/etc/dconf/db/$l_gpname.d\"\n# Check if profile file exists\nif grep -Pq -- \"^\\h*system-db:$l_gpname\\b\" /etc/dconf/profile/*; then\nl_output=\"$l_output\\n - dconf database profile file \\\"$(grep -Pl -- \"^\\h*system-db:$l_gpname\\b\" /etc/dconf/profile/*)\\\" exists\"\nelse\nl_output2=\"$l_output2\\n - dconf database profile isn't set\"\nfi\n# Check if the dconf database file exists\nif [ -f \"/etc/dconf/db/$l_gpname\" ]; then\nl_output=\"$l_output\\n - The dconf database \\\"$l_gpname\\\" exists\"\nelse\nl_output2=\"$l_output2\\n - The dconf database \\\"$l_gpname\\\" doesn't exist\"\nfi\n# check if the dconf database directory exists\nif [ -d \"$l_gpdir\" ]; then\nl_output=\"$l_output\\n - The dconf directory \\\"$l_gpdir\\\" exitst\"\nelse\nl_output2=\"$l_output2\\n - The dconf directory \\\"$l_gpdir\\\" doesn't exist\"\nfi\n# check automount setting\nif grep -Pqrs -- '^\\h*automount\\h*=\\h*false\\b' \"$l_kfile\"; then\nl_output=\"$l_output\\n - \\\"automount\\\" is set to false in: \\\"$l_kfile\\\"\"\nelse\nl_output2=\"$l_output2\\n - \\\"automount\\\" is not set correctly\"\nfi\n# check automount-open setting\nif grep -Pqs -- '^\\h*automount-open\\h*=\\h*false\\b' \"$l_kfile2\"; then\nl_output=\"$l_output\\n - \\\"automount-open\\\" is set to false in: \\\"$l_kfile2\\\"\"\nelse\nl_output2=\"$l_output2\\n - \\\"automount-open\\\" is not set correctly\"\nfi\nelse\n# Setings don't exist. Nothing further to check\nl_output2=\"$l_output2\\n - neither \\\"automount\\\" or \\\"automountopen\\\" is set\"\nfi\nelse\nl_output=\"$l_output\\n - GNOME Desktop Manager package is not installed on the system\\n - Recommendation is not applicable\"\nfi\n# Report results. If no failures output in l_output2, we pass\nif [ -z \"$l_output2\" ]; then\necho -e \"\\n- Audit Result:\\n ** PASS **\\n$l_output\\n\"\nelse\necho -e \"\\n- Audit Result:\\n ** FAIL **\\n - Reason(s) for audit failure:\\n$l_output2\\n\"\n[ -n \"$l_output\" ] &amp;&amp; echo -e \"\\n- Correctly set:\\n$l_output\\n\"\nfi\n}\n</code></pre></p>","tags":["Level 1","Level 2","Workstation","Server","Initial Setup","GNOME Display Manager","Automated","IG1","IG2","IG3","10.3 Disable Autorun and Autoplay for Removable Media"]},{"location":"1-Initial-Setup/1.8-Gnome-Display-Manager/1.8.6-Ensure-gdm-automatic-mounting-of-removable-media-is-disabled/#remediation","title":"Remediation","text":"<p>Run the following script to disable automatic mounting of media for all GNOME users: <pre><code>#!/usr/bin/env bash\n{\nl_pkgoutput=\"\" l_output=\"\" l_output2=\"\"\nl_gpbame=\"local\" # Set to desired dconf profile name (defaule is local)\n# Check if GNOME Desktop Manager is installed. If package isn't installed, recommendation is Not Applicable\\n\n# determine system's package manager\nif command -v dpkg-query &gt; /dev/null 2&gt;&amp;1; then\nl_pq=\"dpkg-query -W\"\nelif command -v rpm &gt; /dev/null 2&gt;&amp;1; then\nl_pq=\"rpm -q\"\nfi\n# Check if GDM is installed\nl_pcl=\"gdm gdm3\" # Space seporated list of packages to check\nfor l_pn in $l_pcl; do\n$l_pq \"$l_pn\" &gt; /dev/null 2&gt;&amp;1 &amp;&amp; l_pkgoutput=\"$l_pkgoutput\\n - Package: \\\"$l_pn\\\" exists on the system\\n - checking configuration\"\ndone\necho -e \"$l_packageout\"\n# Check configuration (If applicable)\nif [ -n \"$l_pkgoutput\" ]; then\necho -e \"$l_pkgoutput\"\n# Look for existing settings and set variables if they exist\nl_kfile=\"$(grep -Prils -- '^\\h*automount\\b' /etc/dconf/db/*.d)\"\nl_kfile2=\"$(grep -Prils -- '^\\h*automount-open\\b' /etc/dconf/db/*.d)\"\n# Set profile name based on dconf db directory ({PROFILE_NAME}.d)\nif [ -f \"$l_kfile\" ]; then\nl_gpname=\"$(awk -F\\/ '{split($(NF-1),a,\".\");print a[1]}' &lt;&lt;&lt; \"$l_kfile\")\"\necho \" - updating dconf profile name to \\\"$l_gpname\\\"\"\nelif [ -f \"$l_kfile2\" ]; then\nl_gpname=\"$(awk -F\\/ '{split($(NF-1),a,\".\");print a[1]}' &lt;&lt;&lt; \"$l_kfile2\")\"\necho \" - updating dconf profile name to \\\"$l_gpname\\\"\"\nfi\n# check for consistency (Clean up configuration if needed)\nif [ -f \"$l_kfile\" ] &amp;&amp; [ \"$(awk -F\\/ '{split($(NF-1),a,\".\");print a[1]}' &lt;&lt;&lt; \"$l_kfile\")\" != \"$l_gpname\" ]; then\nsed -ri \"/^\\s*automount\\s*=/s/^/# /\" \"$l_kfile\"\nl_kfile=\"/etc/dconf/db/$l_gpname.d/00-media-automount\"\nfi\nif [ -f \"$l_kfile2\" ] &amp;&amp; [ \"$(awk -F\\/ '{split($(NF-1),a,\".\");print a[1]}' &lt;&lt;&lt; \"$l_kfile2\")\" != \"$l_gpname\" ]; then\nsed -ri \"/^\\s*automount-open\\s*=/s/^/# /\" \"$l_kfile2\"\nfi\n[ -n \"$l_kfile\" ] &amp;&amp; l_kfile=\"/etc/dconf/db/$l_gpname.d/00-mediaautomount\"\n# Check if profile file exists\nif grep -Pq -- \"^\\h*system-db:$l_gpname\\b\" /etc/dconf/profile/*; then\necho -e \"\\n - dconf database profile exists in: \\\"$(grep -Pl -- \"^\\h*system-db:$l_gpname\\b\" /etc/dconf/profile/*)\\\"\"\nelse\n[ ! -f \"/etc/dconf/profile/user\" ] &amp;&amp; l_gpfile=\"/etc/dconf/profile/user\" || l_gpfile=\"/etc/dconf/profile/user2\"\necho -e \" - creating dconf database profile\"\n{\necho -e \"\\nuser-db:user\"\necho \"system-db:$l_gpname\"\n} &gt;&gt; \"$l_gpfile\"\nfi\n# create dconf directory if it doesn't exists\nl_gpdir=\"/etc/dconf/db/$l_gpname.d\"\nif [ -d \"$l_gpdir\" ]; then\necho \" - The dconf database directory \\\"$l_gpdir\\\" exists\"\nelse\necho \" - creating dconf database directory \\\"$l_gpdir\\\"\"\nmkdir \"$l_gpdir\"\nfi\n# check automount-open setting\nif grep -Pqs -- '^\\h*automount-open\\h*=\\h*false\\b' \"$l_kfile\"; then\necho \" - \\\"automount-open\\\" is set to false in: \\\"$l_kfile\\\"\"\nelse\necho \" - creating \\\"automount-open\\\" entry in \\\"$l_kfile\\\"\"\n! grep -Psq -- '\\^\\h*\\[org\\/gnome\\/desktop\\/media-handling\\]\\b' \"$l_kfile\" &amp;&amp; echo '[org/gnome/desktop/media-handling]' &gt;&gt; \"$l_kfile\"\nsed -ri '/^\\s*\\[org\\/gnome\\/desktop\\/media-handling\\]/a \\\\nautomount-open=false'\nfi\n# check automount setting\nif grep -Pqs -- '^\\h*automount\\h*=\\h*false\\b' \"$l_kfile\"; then\necho \" - \\\"automount\\\" is set to false in: \\\"$l_kfile\\\"\"\nelse\necho \" - creating \\\"automount\\\" entry in \\\"$l_kfile\\\"\"\n! grep -Psq -- '\\^\\h*\\[org\\/gnome\\/desktop\\/media-handling\\]\\b' \"$l_kfile\" &amp;&amp; echo '[org/gnome/desktop/media-handling]' &gt;&gt; \"$l_kfile\"\nsed -ri '/^\\s*\\[org\\/gnome\\/desktop\\/media-handling\\]/a \\\\nautomount=false'\nfi\nelse\necho -e \"\\n - GNOME Desktop Manager package is not installed on the system\\n - Recommendation is not applicable\"\nfi\n# update dconf database\ndconf update\n}\n</code></pre></p> <p>OR</p> <p>Run the following command to uninstall the GNOME desktop Manager package: <pre><code># apt purge gdm3\n</code></pre></p>","tags":["Level 1","Level 2","Workstation","Server","Initial Setup","GNOME Display Manager","Automated","IG1","IG2","IG3","10.3 Disable Autorun and Autoplay for Removable Media"]},{"location":"1-Initial-Setup/1.8-Gnome-Display-Manager/1.8.7-Ensure-gdm-disabling-automatic-mounting-of-removable-media-is-not-overridden/","title":"1.8.7 Ensure GDM disabling automatic mounting of removable media is not overridden","text":"","tags":["Level 1","Level 2","Workstation","Server","Initial Setup","GNOME Display Manager","Automated"]},{"location":"1-Initial-Setup/1.8-Gnome-Display-Manager/1.8.7-Ensure-gdm-disabling-automatic-mounting-of-removable-media-is-not-overridden/#audit","title":"Audit","text":"<p>Run the following script to verify disable automatic mounting is locked: <pre><code>#!/usr/bin/env bash\n{\n# Check if GNOME Desktop Manager is installed. If package isn't installed, recommendation is Not Applicable\\n\n# determine system's package manager\nl_pkgoutput=\"\"\nif command -v dpkg-query &gt; /dev/null 2&gt;&amp;1; then\nl_pq=\"dpkg-query -W\"\nelif command -v rpm &gt; /dev/null 2&gt;&amp;1; then\nl_pq=\"rpm -q\"\nfi\n# Check if GDM is installed\nl_pcl=\"gdm gdm3\" # Space seporated list of packages to check\nfor l_pn in $l_pcl; do\n$l_pq \"$l_pn\" &gt; /dev/null 2&gt;&amp;1 &amp;&amp; l_pkgoutput=\"$l_pkgoutput\\n - Package: \\\"$l_pn\\\" exists on the system\\n - checking configuration\"\ndone\n# Check configuration (If applicable)\nif [ -n \"$l_pkgoutput\" ]; then\nl_output=\"\" l_output2=\"\"\n# Look for idle-delay to determine profile in use, needed for remaining tests\nl_kfd=\"/etc/dconf/db/$(grep -Psril '^\\h*automount\\b' /etc/dconf/db/*/ | awk -F'/' '{split($(NF-1),a,\".\");print a[1]}').d\" #set directory of key file to be locked\nl_kfd2=\"/etc/dconf/db/$(grep -Psril '^\\h*automount-open\\b' /etc/dconf/db/*/ | awk -F'/' '{split($(NF-1),a,\".\");print a[1]}').d\" #set directory of key file to be locked\nif [ -d \"$l_kfd\" ]; then # If key file directory doesn't exist, options can't be locked\nif grep -Piq '^\\h*\\/org/gnome\\/desktop\\/media-handling\\/automount\\b' \"$l_kfd\"; then\nl_output=\"$l_output\\n - \\\"automount\\\" is locked in \\\"$(grep -Pil '^\\h*\\/org/gnome\\/desktop\\/media-handling\\/automount\\b' \"$l_kfd\")\\\"\"\nelse\nl_output2=\"$l_output2\\n - \\\"automount\\\" is not locked\"\nfi\nelse\nl_output2=\"$l_output2\\n - \\\"automount\\\" is not set so it can not be locked\"\nfi\nif [ -d \"$l_kfd2\" ]; then # If key file directory doesn't exist, options can't be locked\nif grep -Piq '^\\h*\\/org/gnome\\/desktop\\/media-handling\\/automountopen\\b' \"$l_kfd2\"; then\nl_output=\"$l_output\\n - \\\"lautomount-open\\\" is locked in \\\"$(grep -Pril '^\\h*\\/org/gnome\\/desktop\\/media-handling\\/automount-open\\b' \"$l_kfd2\")\\\"\"\nelse\nl_output2=\"$l_output2\\n - \\\"automount-open\\\" is not locked\"\nfi\nelse\nl_output2=\"$l_output2\\n - \\\"automount-open\\\" is not set so it can not be locked\"\nfi\nelse\nl_output=\"$l_output\\n - GNOME Desktop Manager package is not installed on the system\\n - Recommendation is not applicable\"\nfi\n# Report results. If no failures output in l_output2, we pass\n[ -n \"$l_pkgoutput\" ] &amp;&amp; echo -e \"\\n$l_pkgoutput\"\nif [ -z \"$l_output2\" ]; then\necho -e \"\\n- Audit Result:\\n ** PASS **\\n$l_output\\n\"\nelse\necho -e \"\\n- Audit Result:\\n ** FAIL **\\n - Reason(s) for audit failure:\\n$l_output2\\n\"\n[ -n \"$l_output\" ] &amp;&amp; echo -e \"\\n- Correctly set:\\n$l_output\\n\"\nfi\n}\n</code></pre></p>","tags":["Level 1","Level 2","Workstation","Server","Initial Setup","GNOME Display Manager","Automated"]},{"location":"1-Initial-Setup/1.8-Gnome-Display-Manager/1.8.7-Ensure-gdm-disabling-automatic-mounting-of-removable-media-is-not-overridden/#remediation","title":"Remediation","text":"<p>Run the following script to lock disable automatic mounting of media for all GNOME users: <pre><code>#!/usr/bin/env bash\n{\n# Check if GNMOE Desktop Manager is installed. If package isn't installed, recommendation is Not Applicable\\n\n# determine system's package manager\nl_pkgoutput=\"\"\nif command -v dpkg-query &gt; /dev/null 2&gt;&amp;1; then\nl_pq=\"dpkg-query -W\"\nelif command -v rpm &gt; /dev/null 2&gt;&amp;1; then\nl_pq=\"rpm -q\"\nfi\n# Check if GDM is installed\nl_pcl=\"gdm gdm3\" # Space seporated list of packages to check\nfor l_pn in $l_pcl; do\n$l_pq \"$l_pn\" &gt; /dev/null 2&gt;&amp;1 &amp;&amp; l_pkgoutput=\"y\" &amp;&amp; echo -e \"\\n - Package: \\\"$l_pn\\\" exists on the system\\n - remediating configuration if needed\"\ndone\n# Check configuration (If applicable)\nif [ -n \"$l_pkgoutput\" ]; then\n# Look for automount to determine profile in use, needed for remaining tests\nl_kfd=\"/etc/dconf/db/$(grep -Psril '^\\h*automount\\b' /etc/dconf/db/*/ | awk -F'/' '{split($(NF-1),a,\".\");print a[1]}').d\" #set directory of key file to be locked\n# Look for automount-open to determine profile in use, needed for remaining tests\nl_kfd2=\"/etc/dconf/db/$(grep -Psril '^\\h*automount-open\\b' /etc/dconf/db/*/ | awk -F'/' '{split($(NF-1),a,\".\");print a[1]}').d\" #set directory of key file to be locked\nif [ -d \"$l_kfd\" ]; then # If key file directory doesn't exist, options can't be locked\nif grep -Priq '^\\h*\\/org/gnome\\/desktop\\/mediahandling\\/automount\\b' \"$l_kfd\"; then\necho \" - \\\"automount\\\" is locked in \\\"$(grep -Pril '^\\h*\\/org/gnome\\/desktop\\/media-handling\\/automount\\b' \"$l_kfd\")\\\"\"\nelse\necho \" - creating entry to lock \\\"automount\\\"\"\n[ ! -d \"$l_kfd\"/locks ] &amp;&amp; echo \"creating directory $l_kfd/locks\" &amp;&amp; mkdir \"$l_kfd\"/locks\n {\necho -e '\\n# Lock desktop media-handling automount setting'\necho '/org/gnome/desktop/media-handling/automount'\n} &gt;&gt; \"$l_kfd\"/locks/00-media-automount\n fi\nelse\necho -e \" - \\\"automount\\\" is not set so it can not be locked\\n - Please follow Recommendation \\\"Ensure GDM automatic mounting of removable media is disabled\\\" and follow this Recommendation again\"\nfi\nif [ -d \"$l_kfd2\" ]; then # If key file directory doesn't exist, options can't be locked\nif grep -Priq '^\\h*\\/org/gnome\\/desktop\\/media-handling\\/automountopen\\b' \"$l_kfd2\"; then\necho \" - \\\"automount-open\\\" is locked in \\\"$(grep -Pril '^\\h*\\/org/gnome\\/desktop\\/media-handling\\/automount-open\\b' \"$l_kfd2\")\\\"\"\nelse\necho \" - creating entry to lock \\\"automount-open\\\"\"\n[ ! -d \"$l_kfd2\"/locks ] &amp;&amp; echo \"creating directory $l_kfd2/locks\" &amp;&amp; mkdir \"$l_kfd2\"/locks\n {\necho -e '\\n# Lock desktop media-handling automount-open setting'\necho '/org/gnome/desktop/media-handling/automount-open'\n} &gt;&gt; \"$l_kfd2\"/locks/00-media-automount\n fi\nelse\necho -e \" - \\\"automount-open\\\" is not set so it can not be locked\\n - Please follow Recommendation \\\"Ensure GDM automatic mounting of removable media is disabled\\\" and follow this Recommendation again\"\nfi\n# update dconf database\ndconf update\n else\necho -e \" - GNOME Desktop Manager package is not installed on the system\\n - Recommendation is not applicable\"\nfi\n}\n</code></pre></p>","tags":["Level 1","Level 2","Workstation","Server","Initial Setup","GNOME Display Manager","Automated"]},{"location":"1-Initial-Setup/1.8-Gnome-Display-Manager/1.8.8-Ensure-gdm-autorun-never-is-enabled/","title":"1.8.8 Ensure GDM autorun-never is enabled","text":"","tags":["Level 1","Level 2","Workstation","Server","Initial Setup","GNOME Display Manager","Automated","10.3 Disable Autorun and Autoplay for Removable Media","IG1","IG2","IG3","T1091"]},{"location":"1-Initial-Setup/1.8-Gnome-Display-Manager/1.8.8-Ensure-gdm-autorun-never-is-enabled/#audit","title":"Audit","text":"<p>Run the following script to verify that autorun-never is set to true for GDM: <pre><code>#!/usr/bin/env bash\n{\nl_pkgoutput=\"\" l_output=\"\" l_output2=\"\"\n# Check if GNOME Desktop Manager is installed. If package isn't installed, recommendation is Not Applicable\\n\n# determine system's package manager\nif command -v dpkg-query &gt; /dev/null 2&gt;&amp;1; then\nl_pq=\"dpkg-query -W\"\nelif command -v rpm &gt; /dev/null 2&gt;&amp;1; then\nl_pq=\"rpm -q\"\nfi\n# Check if GDM is installed\nl_pcl=\"gdm gdm3\" # Space separated list of packages to check\nfor l_pn in $l_pcl; do\n$l_pq \"$l_pn\" &gt; /dev/null 2&gt;&amp;1 &amp;&amp; l_pkgoutput=\"$l_pkgoutput\\n - Package: \\\"$l_pn\\\" exists on the system\\n - checking configuration\"\necho -e \"$l_pkgoutput\"\ndone\n# Check configuration (If applicable)\nif [ -n \"$l_pkgoutput\" ]; then\necho -e \"$l_pkgoutput\"\n# Look for existing settings and set variables if they exist\nl_kfile=\"$(grep -Prils -- '^\\h*autorun-never\\b' /etc/dconf/db/*.d)\"\n# Set profile name based on dconf db directory ({PROFILE_NAME}.d)\nif [ -f \"$l_kfile\" ]; then\nl_gpname=\"$(awk -F\\/ '{split($(NF-1),a,\".\");print a[1]}' &lt;&lt;&lt; \"$l_kfile\")\"\nfi\n# If the profile name exist, continue checks\nif [ -n \"$l_gpname\" ]; then\nl_gpdir=\"/etc/dconf/db/$l_gpname.d\"\n# Check if profile file exists\nif grep -Pq -- \"^\\h*system-db:$l_gpname\\b\" /etc/dconf/profile/*; then\nl_output=\"$l_output\\n - dconf database profile file \\\"$(grep -Pl -- \"^\\h*system-db:$l_gpname\\b\" /etc/dconf/profile/*)\\\" exists\"\nelse\nl_output2=\"$l_output2\\n - dconf database profile isn't set\"\nfi\n# Check if the dconf database file exists\nif [ -f \"/etc/dconf/db/$l_gpname\" ]; then\nl_output=\"$l_output\\n - The dconf database \\\"$l_gpname\\\" exists\"\nelse\nl_output2=\"$l_output2\\n - The dconf database \\\"$l_gpname\\\" doesn't exist\"\nfi\n# check if the dconf database directory exists\nif [ -d \"$l_gpdir\" ]; then\nl_output=\"$l_output\\n - The dconf directory \\\"$l_gpdir\\\" exitst\"\nelse\nl_output2=\"$l_output2\\n - The dconf directory \\\"$l_gpdir\\\" doesn't exist\"\nfi\n# check autorun-never setting\nif grep -Pqrs -- '^\\h*autorun-never\\h*=\\h*true\\b' \"$l_kfile\"; then\nl_output=\"$l_output\\n - \\\"autorun-never\\\" is set to true in: \\\"$l_kfile\\\"\"\nelse\nl_output2=\"$l_output2\\n - \\\"autorun-never\\\" is not set correctly\"\nfi\nelse\n# Settings don't exist. Nothing further to check\nl_output2=\"$l_output2\\n - \\\"autorun-never\\\" is not set\"\nfi\nelse\nl_output=\"$l_output\\n - GNOME Desktop Manager package is not installed on the system\\n - Recommendation is not applicable\"\nfi\n# Report results. If no failures output in l_output2, we pass\nif [ -z \"$l_output2\" ]; then\necho -e \"\\n- Audit Result:\\n ** PASS **\\n$l_output\\n\"\nelse\necho -e \"\\n- Audit Result:\\n ** FAIL **\\n - Reason(s) for audit failure:\\n$l_output2\\n\"\n[ -n \"$l_output\" ] &amp;&amp; echo -e \"\\n- Correctly set:\\n$l_output\\n\"\nfi\n}\n</code></pre></p>","tags":["Level 1","Level 2","Workstation","Server","Initial Setup","GNOME Display Manager","Automated","10.3 Disable Autorun and Autoplay for Removable Media","IG1","IG2","IG3","T1091"]},{"location":"1-Initial-Setup/1.8-Gnome-Display-Manager/1.8.8-Ensure-gdm-autorun-never-is-enabled/#remediation","title":"Remediation","text":"<p>Run the following script to set autorun-never to true for GDM users: <pre><code>#!/usr/bin/env bash\n{\nl_pkgoutput=\"\" l_output=\"\" l_output2=\"\"\nl_gpname=\"local\" # Set to desired dconf profile name (default is local)\n# Check if GNOME Desktop Manager is installed. If package isn't installed, recommendation is Not Applicable\\n\n# determine system's package manager\nif command -v dpkg-query &gt; /dev/null 2&gt;&amp;1; then\nl_pq=\"dpkg-query -W\"\nelif command -v rpm &gt; /dev/null 2&gt;&amp;1; then\nl_pq=\"rpm -q\"\nfi\n# Check if GDM is installed\nl_pcl=\"gdm gdm3\" # Space separated list of packages to check\nfor l_pn in $l_pcl; do\n$l_pq \"$l_pn\" &gt; /dev/null 2&gt;&amp;1 &amp;&amp; l_pkgoutput=\"$l_pkgoutput\\n - Package: \\\"$l_pn\\\" exists on the system\\n - checking configuration\"\ndone\necho -e \"$l_pkgoutput\"\n# Check configuration (If applicable)\nif [ -n \"$l_pkgoutput\" ]; then\necho -e \"$l_pkgoutput\"\n# Look for existing settings and set variables if they exist\nl_kfile=\"$(grep -Prils -- '^\\h*autorun-never\\b' /etc/dconf/db/*.d)\"\n# Set profile name based on dconf db directory ({PROFILE_NAME}.d)\nif [ -f \"$l_kfile\" ]; then\nl_gpname=\"$(awk -F\\/ '{split($(NF-1),a,\".\");print a[1]}' &lt;&lt;&lt; \"$l_kfile\")\"\necho \" - updating dconf profile name to \\\"$l_gpname\\\"\"\nfi\n[ ! -f \"$l_kfile\" ] &amp;&amp; l_kfile=\"/etc/dconf/db/$l_gpname.d/00-mediaautorun\"\n# Check if profile file exists\nif grep -Pq -- \"^\\h*system-db:$l_gpname\\b\" /etc/dconf/profile/*; then\necho -e \"\\n - dconf database profile exists in: \\\"$(grep -Pl -- \"^\\h*system-db:$l_gpname\\b\" /etc/dconf/profile/*)\\\"\"\nelse\n[ ! -f \"/etc/dconf/profile/user\" ] &amp;&amp; l_gpfile=\"/etc/dconf/profile/user\" || l_gpfile=\"/etc/dconf/profile/user2\"\necho -e \" - creating dconf database profile\"\n{\necho -e \"\\nuser-db:user\"\necho \"system-db:$l_gpname\"\n} &gt;&gt; \"$l_gpfile\"\nfi\n# create dconf directory if it doesn't exists\nl_gpdir=\"/etc/dconf/db/$l_gpname.d\"\nif [ -d \"$l_gpdir\" ]; then\necho \" - The dconf database directory \\\"$l_gpdir\\\" exists\"\nelse\necho \" - creating dconf database directory \\\"$l_gpdir\\\"\"\nmkdir \"$l_gpdir\"\nfi\n# check autorun-never setting\nif grep -Pqs -- '^\\h*autorun-never\\h*=\\h*true\\b' \"$l_kfile\"; then\necho \" - \\\"autorun-never\\\" is set to true in: \\\"$l_kfile\\\"\"\nelse\necho \" - creating or updating \\\"autorun-never\\\" entry in \\\"$l_kfile\\\"\"\nif grep -Psq -- '^\\h*autorun-never' \"$l_kfile\"; then\nsed -ri 's/(^\\s*autorun-never\\s*=\\s*)(\\S+)(\\s*.*)$/\\1true \\3/' \"$l_kfile\"\nelse\n! grep -Psq -- '\\^\\h*\\[org\\/gnome\\/desktop\\/media-handling\\]\\b' \"$l_kfile\" &amp;&amp; echo '[org/gnome/desktop/media-handling]' &gt;&gt; \"$l_kfile\"\nsed -ri '/^\\s*\\[org\\/gnome\\/desktop\\/media-handling\\]/a \\\\nautorun-never=true' \"$l_kfile\"\nfi\nfi\nelse\necho -e \"\\n - GNOME Desktop Manager package is not installed on the system\\n - Recommendation is not applicable\"\nfi\n# update dconf database\ndconf update\n}\n</code></pre></p> <p>Default Value:</p> <p>false</p>","tags":["Level 1","Level 2","Workstation","Server","Initial Setup","GNOME Display Manager","Automated","10.3 Disable Autorun and Autoplay for Removable Media","IG1","IG2","IG3","T1091"]},{"location":"1-Initial-Setup/1.8-Gnome-Display-Manager/1.8.9-Ensure-gdm-autorun-never-is-not-overridden/","title":"1.8.9 Ensure GDM autorun-never is not overridden","text":"","tags":["Level 1","Workstation","Server","Initial Setup","GNOME Display Manager","Automated","10.3 Disable Autorun and Autoplay for Removable Media","IG1","IG2","IG3","T1091"]},{"location":"1-Initial-Setup/1.8-Gnome-Display-Manager/1.8.9-Ensure-gdm-autorun-never-is-not-overridden/#audit","title":"Audit","text":"<p>Run the following script to verify that autorun-never=true cannot be overridden: <pre><code>#!/usr/bin/env bash\n{\n# Check if GNOME Desktop Manager is installed. If package isn't installed, recommendation is Not Applicable\\n\n# determine system's package manager\nl_pkgoutput=\"\"\nif command -v dpkg-query &gt; /dev/null 2&gt;&amp;1; then\nl_pq=\"dpkg-query -W\"\nelif command -v rpm &gt; /dev/null 2&gt;&amp;1; then\nl_pq=\"rpm -q\"\nfi\n# Check if GDM is installed\nl_pcl=\"gdm gdm3\" # Space separated list of packages to check\nfor l_pn in $l_pcl; do\n$l_pq \"$l_pn\" &gt; /dev/null 2&gt;&amp;1 &amp;&amp; l_pkgoutput=\"$l_pkgoutput\\n - Package: \\\"$l_pn\\\" exists on the system\\n - checking configuration\"\ndone\n# Check configuration (If applicable)\nif [ -n \"$l_pkgoutput\" ]; then\nl_output=\"\" l_output2=\"\"\n# Look for idle-delay to determine profile in use, needed for remaining tests\nl_kfd=\"/etc/dconf/db/$(grep -Psril '^\\h*autorun-never\\b' /etc/dconf/db/*/ | awk -F'/' '{split($(NF-1),a,\".\");print a[1]}').d\" #set directory of key file to be locked\nif [ -d \"$l_kfd\" ]; then # If key file directory doesn't exist, options can't be locked\nif grep -Piq '^\\h*\\/org/gnome\\/desktop\\/media-handling\\/autorunnever\\b' \"$l_kfd\"; then\nl_output=\"$l_output\\n - \\\"autorun-never\\\" is locked in \\\"$(grep - Pil '^\\h*\\/org/gnome\\/desktop\\/media-handling\\/autorun-never\\b' \"$l_kfd\")\\\"\"\nelse\nl_output2=\"$l_output2\\n - \\\"autorun-never\\\" is not locked\"\nfi\nelse\nl_output2=\"$l_output2\\n - \\\"autorun-never\\\" is not set so it can not be locked\"\nfi\nelse\nl_output=\"$l_output\\n - GNOME Desktop Manager package is not installed on the system\\n - Recommendation is not applicable\"\nfi\n# Report results. If no failures output in l_output2, we pass\n[ -n \"$l_pkgoutput\" ] &amp;&amp; echo -e \"\\n$l_pkgoutput\"\nif [ -z \"$l_output2\" ]; then\necho -e \"\\n- Audit Result:\\n ** PASS **\\n$l_output\\n\"\nelse\necho -e \"\\n- Audit Result:\\n ** FAIL **\\n - Reason(s) for audit failure:\\n$l_output2\\n\"\n[ -n \"$l_output\" ] &amp;&amp; echo -e \"\\n- Correctly set:\\n$l_output\\n\"\nfi\n}\n</code></pre></p>","tags":["Level 1","Workstation","Server","Initial Setup","GNOME Display Manager","Automated","10.3 Disable Autorun and Autoplay for Removable Media","IG1","IG2","IG3","T1091"]},{"location":"1-Initial-Setup/1.8-Gnome-Display-Manager/1.8.9-Ensure-gdm-autorun-never-is-not-overridden/#remediation","title":"Remediation","text":"<p>Run the following script to ensure that autorun-never=true cannot be overridden: <pre><code>#!/usr/bin/env bash\n{\n# Check if GNOME Desktop Manager is installed. If package isn't installed, recommendation is Not Applicable\\n\n# determine system's package manager\nl_pkgoutput=\"\"\nif command -v dpkg-query &gt; /dev/null 2&gt;&amp;1; then\nl_pq=\"dpkg-query -W\"\nelif command -v rpm &gt; /dev/null 2&gt;&amp;1; then\nl_pq=\"rpm -q\"\nfi\n# Check if GDM is installed\nl_pcl=\"gdm gdm3\" # Space separated list of packages to check\nfor l_pn in $l_pcl; do\n$l_pq \"$l_pn\" &gt; /dev/null 2&gt;&amp;1 &amp;&amp; l_pkgoutput=\"y\" &amp;&amp; echo -e \"\\n - Package: \\\"$l_pn\\\" exists on the system\\n - remediating configuration if needed\"\ndone\n# Check configuration (If applicable)\nif [ -n \"$l_pkgoutput\" ]; then\n# Look for autorun to determine profile in use, needed for remaining tests\nl_kfd=\"/etc/dconf/db/$(grep -Psril '^\\h*autorun-never\\b' /etc/dconf/db/*/ | awk -F'/' '{split($(NF-1),a,\".\");print a[1]}').d\" #set directory of key file to be locked\nif [ -d \"$l_kfd\" ]; then # If key file directory doesn't exist, options can't be locked\nif grep -Priq '^\\h*\\/org/gnome\\/desktop\\/media-handling\\/autorunnever\\b' \"$l_kfd\"; then\necho \" - \\\"autorun-never\\\" is locked in \\\"$(grep -Pril '^\\h*\\/org/gnome\\/desktop\\/media-handling\\/autorun-never\\b' \"$l_kfd\")\\\"\"\nelse\necho \" - creating entry to lock \\\"autorun-never\\\"\"\n[ ! -d \"$l_kfd\"/locks ] &amp;&amp; echo \"creating directory $l_kfd/locks\" &amp;&amp; mkdir \"$l_kfd\"/locks\n {\necho -e '\\n# Lock desktop media-handling autorun-never setting'\necho '/org/gnome/desktop/media-handling/autorun-never'\n} &gt;&gt; \"$l_kfd\"/locks/00-media-autorun\n fi\nelse\necho -e \" - \\\"autorun-never\\\" is not set so it can not be locked\\n - Please follow Recommendation \\\"Ensure GDM autorun-never is enabled\\\" and follow this Recommendation again\"\nfi\n# update dconf database\ndconf update\n else\necho -e \" - GNOME Desktop Manager package is not installed on the system\\n - Recommendation is not applicable\"\nfi\n}\n</code></pre></p>","tags":["Level 1","Workstation","Server","Initial Setup","GNOME Display Manager","Automated","10.3 Disable Autorun and Autoplay for Removable Media","IG1","IG2","IG3","T1091"]},{"location":"2-Services/2.4-Ensure-nonessential-services-are-removed-or-masked/","title":"2.4 Ensure nonessential services are removed or masked","text":"","tags":["Level 1","Workstation","Server","Services","Manual","IG2","IG3","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","T1203","T1210","T1543","T1543.002","TA0008","M1042"]},{"location":"2-Services/2.4-Ensure-nonessential-services-are-removed-or-masked/#audit","title":"Audit","text":"<p>Run the following command: <pre><code># ss -plntu\n</code></pre></p> <p>Review the output to ensure that all services listed are required on the system. If a listed service is not required, remove the package containing the service. If the package containing the service is required, stop and mask the service.</p>","tags":["Level 1","Workstation","Server","Services","Manual","IG2","IG3","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","T1203","T1210","T1543","T1543.002","TA0008","M1042"]},{"location":"2-Services/2.4-Ensure-nonessential-services-are-removed-or-masked/#remediation","title":"Remediation","text":"<p>Run the following command to remove the package containing the service: <pre><code># apt purge &lt;package_name&gt;\n</code></pre></p> <p>OR If required packages have a dependency:</p> <p>Run the following commands to stop and mask the service: <pre><code># systemctl stop &lt;service_name&gt;.socket\n# systemctl stop &lt;service_name&gt;.service\n# systemctl mask &lt;service_name&gt;.socket\n# systemctl mask &lt;service_name&gt;.service\n</code></pre></p>","tags":["Level 1","Workstation","Server","Services","Manual","IG2","IG3","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","T1203","T1210","T1543","T1543.002","TA0008","M1042"]},{"location":"2-Services/2.1-Configure-Time-Synchronization/2.1.1-Ensure-time-synchronization-is-in-use/2.1.1.1-Ensure-a-single-time-synchronization-daemon-is-in-use/","title":"2.1.1.1 Ensure a single time synchronization daemon is in use","text":"","tags":["Level 1","Workstation","Server","Services","Configure Time Synchronization","Ensure time synchronization is in use","Automated","IG2","IG3","8.4 Standardize Time Synchronization","T1070","T1070.002","T1562","T1562.001","TA0005"]},{"location":"2-Services/2.1-Configure-Time-Synchronization/2.1.1-Ensure-time-synchronization-is-in-use/2.1.1.1-Ensure-a-single-time-synchronization-daemon-is-in-use/#audit","title":"Audit","text":"<p>On physical systems, and virtual systems where host based time synchronization is not available.</p> <p>One of the three time synchronization daemons should be available; chrony, systemd-timesyncd, or ntp</p> <p>Run the following script to verify that a single time synchronization daemon is available on the system: <pre><code>#!/usr/bin/env bash\n{\noutput=\"\" l_tsd=\"\" l_sdtd=\"\" chrony=\"\" l_ntp=\"\"\ndpkg-query -W chrony &gt; /dev/null 2&gt;&amp;1 &amp;&amp; l_chrony=\"y\"\ndpkg-query -W ntp &gt; /dev/null 2&gt;&amp;1 &amp;&amp; l_ntp=\"y\" || l_ntp=\"\"\nsystemctl list-units --all --type=service | grep -q 'systemdtimesyncd.service' &amp;&amp; systemctl is-enabled systemd-timesyncd.service | grep -q 'enabled' &amp;&amp; l_sdtd=\"y\"\n# ! systemctl is-enabled systemd-timesyncd.service | grep -q 'enabled' &amp;&amp; l_nsdtd=\"y\" || l_nsdtd=\"\"\nif [[ \"$l_chrony\" = \"y\" &amp;&amp; \"$l_ntp\" != \"y\" &amp;&amp; \"$l_sdtd\" != \"y\" ]]; then\nl_tsd=\"chrony\"\noutput=\"$output\\n- chrony is in use on the system\"\nelif [[ \"$l_chrony\" != \"y\" &amp;&amp; \"$l_ntp\" = \"y\" &amp;&amp; \"$l_sdtd\" != \"y\" ]]; then\nl_tsd=\"ntp\"\noutput=\"$output\\n- ntp is in use on the system\"\nelif [[ \"$l_chrony\" != \"y\" &amp;&amp; \"$l_ntp\" != \"y\" ]]; then\nif systemctl list-units --all --type=service | grep -q 'systemdtimesyncd.service' &amp;&amp; systemctl is-enabled systemd-timesyncd.service | grep -Eq '(enabled|disabled|masked)'; then\nl_tsd=\"sdtd\"\noutput=\"$output\\n- systemd-timesyncd is in use on the system\"\nfi\nelse\n[[ \"$l_chrony\" = \"y\" &amp;&amp; \"$l_ntp\" = \"y\" ]] &amp;&amp; output=\"$output\\n- both chrony and ntp are in use on the system\"\n[[ \"$l_chrony\" = \"y\" &amp;&amp; \"$l_sdtd\" = \"y\" ]] &amp;&amp; output=\"$output\\n- both chrony and systemd-timesyncd are in use on the system\"\n[[ \"$l_ntp\" = \"y\" &amp;&amp; \"$l_sdtd\" = \"y\" ]] &amp;&amp; output=\"$output\\n- both ntp and systemd-timesyncd are in use on the system\"\nfi\nif [ -n \"$l_tsd\" ]; then\necho -e \"\\n- PASS:\\n$output\\n\"\nelse\necho -e \"\\n- FAIL:\\n$output\\n\"\nfi\n}\n</code></pre></p> <p>NOTE: Follow the guidance in the subsection for the time synchronization daemon available on the system and skip the other two time synchronization daemon subsections.</p>","tags":["Level 1","Workstation","Server","Services","Configure Time Synchronization","Ensure time synchronization is in use","Automated","IG2","IG3","8.4 Standardize Time Synchronization","T1070","T1070.002","T1562","T1562.001","TA0005"]},{"location":"2-Services/2.1-Configure-Time-Synchronization/2.1.1-Ensure-time-synchronization-is-in-use/2.1.1.1-Ensure-a-single-time-synchronization-daemon-is-in-use/#remediation","title":"Remediation","text":"<p>On physical systems, and virtual systems where host based time synchronization is not available.</p> <p>Select one of the three time synchronization daemons; chrony (1), systemd-timesyncd (2), or ntp (3), and following the remediation procedure for the selected daemon.</p> <p>Note: enabling more than one synchronization daemon could lead to unexpected or unreliable results:</p> <ol> <li>chrony</li> </ol> <p>Run the following command to install chrony: <pre><code># apt install chrony\n</code></pre></p> <p>Run the following commands to stop and mask the systemd-timesyncd daemon: <pre><code># systemctl stop systemd-timesyncd.service\n# systemctl --now mask systemd-timesyncd.service\n</code></pre></p> <p>Run the following command to remove the ntp package: <pre><code># apt purge ntp\n</code></pre></p> <p>NOTE:</p> <p>Subsection: Configure chrony should be followed</p> <p>Subsections: Configure systemd-timesyncd and Configure ntp should be skipped</p> <ol> <li>systemd-timesyncd</li> </ol> <p>Run the following command to remove the chrony package: <pre><code># apt purge chrony\n</code></pre></p> <p>Run the following command to remove the ntp package: <pre><code># apt purge ntp\n</code></pre></p> <p>NOTE:</p> <p>Subsection: Configure systemd-timesyncd should be followed</p> <p>Subsections: Configure chrony and Configure ntp should be skipped</p> <ol> <li>ntp</li> </ol> <p>Run the following command to install ntp: <pre><code># apt install ntp\n</code></pre></p> <p>Run the following commands to stop and mask the systemd-timesyncd daemon: <pre><code># systemctl stop systemd-timesyncd.service\n# systemctl --now mask systemd-timesyncd.service\n</code></pre></p> <p>Run the following command to remove the chrony package: <pre><code># apt purge chrony\n</code></pre></p> <p>NOTE:</p> <p>Subsection: Configure ntp should be followed</p> <p>Subsections: Configure chrony and Configure systemd-timesyncd should be skipped</p>","tags":["Level 1","Workstation","Server","Services","Configure Time Synchronization","Ensure time synchronization is in use","Automated","IG2","IG3","8.4 Standardize Time Synchronization","T1070","T1070.002","T1562","T1562.001","TA0005"]},{"location":"2-Services/2.1-Configure-Time-Synchronization/2.1.2-Configure-chrony/2.1.2.1-Ensure-chrony-is-configured-with-authorized-timeserver/","title":"2.1.2.1 Ensure chrony is configured with authorized timeserver","text":"","tags":["Level 1","Workstation","Server","Services","Configure Time Synchronization","Configure chrony","Manual","IG2","IG3","8.4 Standardize Time Synchronization","T1070","T1070.002","T1562","T1562.001","TA0005","M1022"]},{"location":"2-Services/2.1-Configure-Time-Synchronization/2.1.2-Configure-chrony/2.1.2.1-Ensure-chrony-is-configured-with-authorized-timeserver/#audit","title":"Audit","text":"<p>IF chrony is in use on the system, run the following command to display the server and/or pool directive: <pre><code># grep -Pr --include=*.{sources,conf} '^\\h*(server|pool)\\h+\\H+' /etc/chrony/\n</code></pre></p> <p>Verify that at least one pool line and/or at least three server lines are returned, and the timeserver on the returned lines follows local site policy.</p> <p>Output examples:</p> <p>pool directive: <pre><code>pool time.nist.gov iburst maxsources 4 #The maxsources option is unique to the pool directive\n</code></pre></p> <p>server directive: <pre><code>server time-a-g.nist.gov iburst\nserver 132.163.97.3 iburst\nserver time-d-b.nist.gov iburst\n</code></pre></p>","tags":["Level 1","Workstation","Server","Services","Configure Time Synchronization","Configure chrony","Manual","IG2","IG3","8.4 Standardize Time Synchronization","T1070","T1070.002","T1562","T1562.001","TA0005","M1022"]},{"location":"2-Services/2.1-Configure-Time-Synchronization/2.1.2-Configure-chrony/2.1.2.1-Ensure-chrony-is-configured-with-authorized-timeserver/#remediation","title":"Remediation","text":"<p>Edit /etc/chrony/chrony.conf or a file ending in .sources in /etc/chrony/sources.d/ and add or edit server or pool lines as appropriate according to local site policy: <pre><code>&lt;[server|pool]&gt; &lt;[remote-server|remote-pool]&gt;\n</code></pre></p> <p>Examples:</p> <p>pool directive: <pre><code>pool time.nist.gov iburst maxsources 4 #The maxsources option is unique to the pool directive\n</code></pre></p> <p>server directive: <pre><code>server time-a-g.nist.gov iburst\nserver 132.163.97.3 iburst\nserver time-d-b.nist.gov iburst\n</code></pre></p> <p>Run one of the following commands to load the updated time sources into chronyd running config: <pre><code># systemctl restart chronyd\n</code></pre></p> <p>OR if sources are in a .sources file</p> <pre><code># chronyc reload sources\n</code></pre> <p>OR</p> <p>If another time synchronization service is in use on the system, run the following command to remove chrony from the system: <pre><code># apt purge chrony\n</code></pre></p>","tags":["Level 1","Workstation","Server","Services","Configure Time Synchronization","Configure chrony","Manual","IG2","IG3","8.4 Standardize Time Synchronization","T1070","T1070.002","T1562","T1562.001","TA0005","M1022"]},{"location":"2-Services/2.1-Configure-Time-Synchronization/2.1.2-Configure-chrony/2.1.2.2-Ensure-chrony-is-running-as-user-chrony/","title":"2.1.2.2 Ensure chrony is running as user _chrony","text":"","tags":["Level 1","Workstation","Server","Services","Configure Time Synchronization","Configure chrony","Automated","IG2","IG3","8.4 Standardize Time Synchronization"]},{"location":"2-Services/2.1-Configure-Time-Synchronization/2.1.2-Configure-chrony/2.1.2.2-Ensure-chrony-is-running-as-user-chrony/#audit","title":"Audit","text":"<p>IF chrony is in use on the system, run the following command to verify the chronyd service is being run as the _chrony user: <pre><code># ps -ef | awk '(/[c]hronyd/ &amp;&amp; $1!=\"_chrony\") { print $1 }'\n</code></pre></p> <p>Nothing should be returned</p>","tags":["Level 1","Workstation","Server","Services","Configure Time Synchronization","Configure chrony","Automated","IG2","IG3","8.4 Standardize Time Synchronization"]},{"location":"2-Services/2.1-Configure-Time-Synchronization/2.1.2-Configure-chrony/2.1.2.2-Ensure-chrony-is-running-as-user-chrony/#remediation","title":"Remediation","text":"<p>Add or edit the user line to /etc/chrony/chrony.conf or a file ending in .conf in /etc/chrony/conf.d/: <pre><code>user _chrony\n</code></pre></p> <p>OR</p> <p>If another time synchronization service is in use on the system, run the following command to remove chrony from the system: <pre><code># apt purge chrony\n</code></pre></p> <p>Default Value:</p> <p>user _chrony</p>","tags":["Level 1","Workstation","Server","Services","Configure Time Synchronization","Configure chrony","Automated","IG2","IG3","8.4 Standardize Time Synchronization"]},{"location":"2-Services/2.1-Configure-Time-Synchronization/2.1.2-Configure-chrony/2.1.2.3-Ensure-chrony-is-enabled-and-running/","title":"2.1.2.3 Ensure chrony is enabled and running","text":"","tags":["Level 1","Workstation","Server","Services","Configure Time Synchronization","Configure chrony","Automated","IG2","IG3","8.4 Standardize Time Synchronization"]},{"location":"2-Services/2.1-Configure-Time-Synchronization/2.1.2-Configure-chrony/2.1.2.3-Ensure-chrony-is-enabled-and-running/#audit","title":"Audit","text":"<p>IF chrony is in use on the system, run the following commands:</p> <p>Run the following command to verify that the chrony service is enabled: <pre><code># systemctl is-enabled chrony.service\nenabled\n</code></pre></p> <p>Run the following command to verify that the chrony service is active: <pre><code># systemctl is-active chrony.service\nactive\n</code></pre></p>","tags":["Level 1","Workstation","Server","Services","Configure Time Synchronization","Configure chrony","Automated","IG2","IG3","8.4 Standardize Time Synchronization"]},{"location":"2-Services/2.1-Configure-Time-Synchronization/2.1.2-Configure-chrony/2.1.2.3-Ensure-chrony-is-enabled-and-running/#remediation","title":"Remediation","text":"<p>IF chrony is in use on the system, run the following commands:</p> <p>Run the following command to unmask chrony.service: <pre><code># systemctl unmask chrony.service\n</code></pre></p> <p>Run the following command to enable and start chrony.service: <pre><code># systemctl --now enable chrony.service\n</code></pre></p> <p>OR</p> <p>If another time synchronization service is in use on the system, run the following command to remove chrony: <pre><code># apt purge chrony\n</code></pre></p>","tags":["Level 1","Workstation","Server","Services","Configure Time Synchronization","Configure chrony","Automated","IG2","IG3","8.4 Standardize Time Synchronization"]},{"location":"2-Services/2.1-Configure-Time-Synchronization/2.1.3-Configure-systemd-timesyncd/2.1.3.1-Ensure-systemd-timesyncd-configured-with-authorized-timeserver/","title":"2.1.3.1 Ensure systemd-timesyncd configured with authorized timeserver","text":"","tags":["Level 1","Workstation","Server","Services","Configure Time Synchronization","Configure systemd-timesyncd","Manual","IG2","IG3","8.4 Standardize Time Synchronization","T1070","T1070.002","T1562","T1562.001"]},{"location":"2-Services/2.1-Configure-Time-Synchronization/2.1.3-Configure-systemd-timesyncd/2.1.3.1-Ensure-systemd-timesyncd-configured-with-authorized-timeserver/#audit","title":"Audit","text":"<p>IF systemd-timesyncd is in use on the system, run the following command: <pre><code># find /etc/systemd -type f -name '*.conf' -exec grep -Ph '^\\h*(NTP|FallbackNTP)=\\H+' {} +\n</code></pre></p> <p>Verify that NPT= and/or FallbackNTP= is returned and that the time server(s) shown follows local site policy. <p>Example Output: <pre><code>/etc/systemd/timesyncd.conf.d/50-timesyncd.conf:NTP=time.nist.gov\n/etc/systemd/timesyncd.conf.d/50-timesyncd.conf:FallbackNTP=time-a-g.nist.gov time-b-g.nist.gov time-c-g.nist.gov\n</code></pre></p>","tags":["Level 1","Workstation","Server","Services","Configure Time Synchronization","Configure systemd-timesyncd","Manual","IG2","IG3","8.4 Standardize Time Synchronization","T1070","T1070.002","T1562","T1562.001"]},{"location":"2-Services/2.1-Configure-Time-Synchronization/2.1.3-Configure-systemd-timesyncd/2.1.3.1-Ensure-systemd-timesyncd-configured-with-authorized-timeserver/#remediation","title":"Remediation","text":"<p>Edit or create a file in /etc/systemd/timesyncd.conf.d ending in .conf and add the NTP= and/or FallbackNTP= lines to the [Time] section:</p> <p>Example: <pre><code>[Time]\nNTP=time.nist.gov # Uses the generic name for NIST's time servers\n-AND/OR\n\nFallbackNTP=time-a-g.nist.gov time-b-g.nist.gov time-c-g.nist.gov # Space separated list of NIST time servers\n</code></pre></p> <p>Note: Servers added to these line(s) should follow local site policy. NIST servers are for example. The timesyncd.conf.d directory may need to be created.</p> <p>Example script: The following example script will create the systemd-timesyncd drop-in configuration snippet: <pre><code>#!/usr/bin/env bash\nntp_ts=\"time.nist.gov\"\nntp_fb=\"time-a-g.nist.gov time-b-g.nist.gov time-c-g.nist.gov\"\ndisfile=\"/etc/systemd/timesyncd.conf.d/50-timesyncd.conf\"\nif ! find /etc/systemd -type f -name '*.conf' -exec grep -Ph '^\\h*NTP=\\H+' {} +; then\n[ ! -d /etc/systemd/timesyncd.conf.d ] &amp;&amp; mkdir /etc/systemd/timesyncd.conf.d\n ! grep -Pqs '^\\h*\\[Time\\]' \"$disfile\" &amp;&amp; echo \"[Time]\" &gt;&gt; \"$disfile\"\necho \"NTP=$ntp_ts\" &gt;&gt; \"$disfile\"\nfi\nif ! find /etc/systemd -type f -name '*.conf' -exec grep -Ph '^\\h*FallbackNTP=\\H+' {} +; then\n[ ! -d /etc/systemd/timesyncd.conf.d ] &amp;&amp; mkdir /etc/systemd/timesyncd.conf.d\n ! grep -Pqs '^\\h*\\[Time\\]' \"$disfile\" &amp;&amp; echo \"[Time]\" &gt;&gt; \"$disfile\"\necho \"FallbackNTP=$ntp_fb\" &gt;&gt; \"$disfile\"\nfi\n</code></pre></p> <p>Run the following command to reload the systemd-timesyncd configuration: <pre><code># systemctl try-reload-or-restart systemd-timesyncd\n</code></pre></p> <p>OR</p> <p>If another time synchronization service is in use on the system, run the following command to stop and mask systemd-timesyncd: <pre><code># systemctl --now mask systemd-timesyncd\n</code></pre></p> <p>Default Value: <pre><code>#NTP=\n#FallbackNTP=\n</code></pre></p>","tags":["Level 1","Workstation","Server","Services","Configure Time Synchronization","Configure systemd-timesyncd","Manual","IG2","IG3","8.4 Standardize Time Synchronization","T1070","T1070.002","T1562","T1562.001"]},{"location":"2-Services/2.1-Configure-Time-Synchronization/2.1.3-Configure-systemd-timesyncd/2.1.3.2-Ensure-systemd-timesyncd-is-enabled-and-running/","title":"2.1.3.2 Ensure systemd-timesyncd is enabled and running","text":"","tags":["Level 1","Workstation","Server","Services","Configure Time Synchronization","Configure systemd-timesyncd","Automated","IG2","IG3","8.4 Standardize Time Synchronization"]},{"location":"2-Services/2.1-Configure-Time-Synchronization/2.1.3-Configure-systemd-timesyncd/2.1.3.2-Ensure-systemd-timesyncd-is-enabled-and-running/#audit","title":"Audit","text":"<p>IF systemd-timesyncd is in use on the system, run the following commands:</p> <p>Run the following command to verify that the systemd-timesyncd service is enabled: <pre><code># systemctl is-enabled systemd-timesyncd.service\nenabled\n</code></pre></p> <p>Run the following command to verify that the systemd-timesyncd service is active: <pre><code># systemctl is-active systemd-timesyncd.service\nactive\n</code></pre></p>","tags":["Level 1","Workstation","Server","Services","Configure Time Synchronization","Configure systemd-timesyncd","Automated","IG2","IG3","8.4 Standardize Time Synchronization"]},{"location":"2-Services/2.1-Configure-Time-Synchronization/2.1.3-Configure-systemd-timesyncd/2.1.3.2-Ensure-systemd-timesyncd-is-enabled-and-running/#remediation","title":"Remediation","text":"<p>IF systemd-timesyncd is in use on the system, run the following commands:</p> <p>Run the following command to unmask systemd-timesyncd.service: <pre><code># systemctl unmask systemd-timesyncd.service\n</code></pre></p> <p>Run the following command to enable and start systemd-timesyncd.service: <pre><code># systemctl --now enable systemd-timesyncd.service\n</code></pre></p> <p>OR</p> <p>If another time synchronization service is in use on the system, run the following command to stop and mask systemd-timesyncd: <pre><code># systemctl --now mask systemd-timesyncd.service\n</code></pre></p>","tags":["Level 1","Workstation","Server","Services","Configure Time Synchronization","Configure systemd-timesyncd","Automated","IG2","IG3","8.4 Standardize Time Synchronization"]},{"location":"2-Services/2.1-Configure-Time-Synchronization/2.1.4-Configure-ntp/2.1.4.1-Ensure-ntp-access-control-is-configured/","title":"2.1.4.1 Ensure ntp access control is configured","text":"","tags":["Level 1","Workstation","Server","Services","Configure Time Synchronization","Configure ntp","Automated","IG2","IG3","8.4 Standardize Time Synchronization"]},{"location":"2-Services/2.1-Configure-Time-Synchronization/2.1.4-Configure-ntp/2.1.4.1-Ensure-ntp-access-control-is-configured/#audit","title":"Audit","text":"<p>IF ntp is in use on the system, run the following command to verify the restrict lines: <pre><code># grep -P -- '^\\h*restrict\\h+((-4\\h+)?|-6\\h+)default\\h+(?:[^#\\n\\r]+\\h+)*(?!(?:\\2|\\3|\\4|\\5))(\\h*\\bkod\\b\\h*|\\h*\\bnomodify\\b\\h*|\\h*\\bnotrap\\b\\h*\\h*\\bnopeer\\b\\h*|\\h*\\bnoquery\\b\\h*)\\h+(?:[^#\\n\\r]+\\h+)*(?!(?:\\1|\\3|\\4|\\5))(\\h*\\bkod\\b\\h*|\\h*\\bnomodify\\b\\h*|\\h*\\bnotrap\\b\\h*|\\h*\\bnopeer\\b\\h* \\h*\\bnoquery\\b\\h*)\\h+(?:[^#\\n\\r]+\\h+)*(?!(?:\\1|\\2|\\4|\\5))(\\h*\\bkod\\b\\h*|\\h*\\bnomodify\\b\\h*|\\h*\\bnotrap\\b\\h*|\\h*\\bnopeer\\b\\h*|\\h*\\bnoquery\\b\\h*)\\h+(?:[^#\\n\\r]+\\h+)*(?!(?:\\1|\\2|\\3|\\5))(\\h*\\bkod\\b\\h*|\\h*\\bnomodify\\b\\h*|\\h*\\bnotrap\\b\\h*|\\h*\\bnopeer\\b\\h*|\\h*\\bnoquery\\b\\h*)\\h+(?:[^#\\n\\r]+\\h+)*(?!(?:\\1|\\2|\\3|\\4))(\\h*\\bkod\\b\\h*|\\h*\\bnomodify\\b\\h*|\\h*\\bnotrap\\b\\h*|\\h*\\bnopeer\\b\\h*|\\h*\\bnoquery\\b\\h*)\\h*(?:\\h+\\H+\\h*)*(?:\\h+#.*)?$' /etc/ntp.conf\n</code></pre></p> <p>Output should be similar to: <pre><code>restrict -4 default kod notrap nomodify nopeer noquery\nrestrict -6 default kod notrap nomodify nopeer noquery\n</code></pre></p> <p>Verify that the output includes two lines, and both lines include: default, kod, nomodify, notrap, nopeer and noquery.</p> <p>Note: The -4 in the first line is optional, options after default may appear in any order, and additional options may exist.</p>","tags":["Level 1","Workstation","Server","Services","Configure Time Synchronization","Configure ntp","Automated","IG2","IG3","8.4 Standardize Time Synchronization"]},{"location":"2-Services/2.1-Configure-Time-Synchronization/2.1.4-Configure-ntp/2.1.4.1-Ensure-ntp-access-control-is-configured/#remediation","title":"Remediation","text":"<p>Add or edit restrict lines in /etc/ntp.conf to match the following: <pre><code>restrict -4 default kod nomodify notrap nopeer noquery\nrestrict -6 default kod nomodify notrap nopeer noquery\n</code></pre></p> <p>OR</p> <p>If another time synchronization service is in use on the system, run the following command to remove ntp from the system: <pre><code># apt purge ntp\n</code></pre></p> <p>Default Value: <pre><code>restrict -4 default kod notrap nomodify nopeer noquery limited\nrestrict -6 default kod notrap nomodify nopeer noquery limited\n</code></pre></p>","tags":["Level 1","Workstation","Server","Services","Configure Time Synchronization","Configure ntp","Automated","IG2","IG3","8.4 Standardize Time Synchronization"]},{"location":"2-Services/2.1-Configure-Time-Synchronization/2.1.4-Configure-ntp/2.1.4.2-Ensure-ntp-is-configured-with-authorized-timeserver/","title":"2.1.4.2 Ensure ntp is configured with authorized timeserver","text":"","tags":["Level 1","Workstation","Server","Services","Configure Time Synchronization","Configure ntp","Manual","IG2","IG3","8.4 Standardize Time Synchronization","T1070","T1070.002","T1498","T1498.002","T1562","T1562.001","TA0002","M1022"]},{"location":"2-Services/2.1-Configure-Time-Synchronization/2.1.4-Configure-ntp/2.1.4.2-Ensure-ntp-is-configured-with-authorized-timeserver/#audit","title":"Audit","text":"<p>IF ntp is in use on the system, run the following command to display the server and/or pool mode: <pre><code># grep -P -- '^\\h*(server|pool)\\h+\\H+' /etc/ntp.conf\n</code></pre></p> <p>Verify that at least one pool line and/or at least three server lines are returned, and the timeserver on the returned lines follows local site policy.</p> <p>Output examples:</p> <p>pool mode: <pre><code>pool time.nist.gov iburst maxsources 4 #The maxsources option is unique to the pool directive\n</code></pre></p> <p>server mode: <pre><code>server time-a-g.nist.gov iburst\nserver 132.163.97.3 iburst\nserver time-d-b.nist.gov iburst\n</code></pre></p>","tags":["Level 1","Workstation","Server","Services","Configure Time Synchronization","Configure ntp","Manual","IG2","IG3","8.4 Standardize Time Synchronization","T1070","T1070.002","T1498","T1498.002","T1562","T1562.001","TA0002","M1022"]},{"location":"2-Services/2.1-Configure-Time-Synchronization/2.1.4-Configure-ntp/2.1.4.2-Ensure-ntp-is-configured-with-authorized-timeserver/#remediation","title":"Remediation","text":"<p>Edit /etc/ntp.conf and add or edit server or pool lines as appropriate according to local site policy: <pre><code>&lt;[server|pool]&gt; &lt;[remote-server|remote-pool]&gt;\n</code></pre></p> <p>Examples:</p> <p>pool mode: <pre><code>pool time.nist.gov iburst\n</code></pre></p> <p>server mode: <pre><code>server time-a-g.nist.gov iburst\nserver 132.163.97.3 iburst\nserver time-d-b.nist.gov iburst\n</code></pre></p> <p>Run the following command to load the updated time sources into ntp running config: <pre><code># systemctl restart ntp\n</code></pre></p> <p>OR</p> <p>If another time synchronization service is in use on the system, run the following command to remove ntp from the system: <pre><code># apt purge ntp\n</code></pre></p>","tags":["Level 1","Workstation","Server","Services","Configure Time Synchronization","Configure ntp","Manual","IG2","IG3","8.4 Standardize Time Synchronization","T1070","T1070.002","T1498","T1498.002","T1562","T1562.001","TA0002","M1022"]},{"location":"2-Services/2.1-Configure-Time-Synchronization/2.1.4-Configure-ntp/2.1.4.3-Ensure-ntp-is-running-as-user-ntp/","title":"2.1.4.3 Ensure ntp is running as user ntp","text":"","tags":["Level 1","Workstation","Server","Services","Configure Time Synchronization","Configure ntp","Automated","IG2","IG3","8.4 Standardize Time Synchronization"]},{"location":"2-Services/2.1-Configure-Time-Synchronization/2.1.4-Configure-ntp/2.1.4.3-Ensure-ntp-is-running-as-user-ntp/#audit","title":"Audit","text":"<p>IF ntp is in use on the system run the following command to verify the ntpd daemon is being run as the user ntp: <pre><code># ps -ef | awk '(/[n]tpd/ &amp;&amp; $1!=\"ntp\") { print $1 }'\n</code></pre></p> <p>Nothing should be returned</p> <p>Run the following command to verify the RUNASUSER= is set to ntp in /etc/init.d/ntp: <pre><code># grep -P -- '^\\h*RUNASUSER=' /etc/init.d/ntp\nRUNASUSER=ntp\n</code></pre></p>","tags":["Level 1","Workstation","Server","Services","Configure Time Synchronization","Configure ntp","Automated","IG2","IG3","8.4 Standardize Time Synchronization"]},{"location":"2-Services/2.1-Configure-Time-Synchronization/2.1.4-Configure-ntp/2.1.4.3-Ensure-ntp-is-running-as-user-ntp/#remediation","title":"Remediation","text":"<p>Add or edit the following line in /etc/init.d/ntp: <pre><code>RUNASUSER=ntp\n</code></pre></p> <p>Run the following command to restart ntp.servocee: <pre><code># systemctl restart ntp.service\n</code></pre></p> <p>OR</p> <p>If another time synchronization service is in use on the system, run the following command to remove ntp from the system: <pre><code># apt purge ntp\n</code></pre></p> <p>Default Value:</p> <p>user ntp</p>","tags":["Level 1","Workstation","Server","Services","Configure Time Synchronization","Configure ntp","Automated","IG2","IG3","8.4 Standardize Time Synchronization"]},{"location":"2-Services/2.1-Configure-Time-Synchronization/2.1.4-Configure-ntp/2.1.4.4-Ensure-ntp-is-enabled-and-running/","title":"Ensure mounting of cramfs filesystems is disabled","text":"","tags":["Level 1","Workstation","Server","Services","Configure Time Synchronization","Configure ntp","Automated","IG2","IG3","8.4 Standardize Time Synchronization"]},{"location":"2-Services/2.1-Configure-Time-Synchronization/2.1.4-Configure-ntp/2.1.4.4-Ensure-ntp-is-enabled-and-running/#audit","title":"Audit","text":"<p>IF ntp is in use on the system, run the following commands:</p> <p>Run the following command to verify that the ntp service is enabled: <pre><code># systemctl is-enabled ntp.service\nenabled\n</code></pre></p> <p>Run the following command to verify that the ntp service is active: <pre><code># systemctl is-active ntp.service\nactive\n</code></pre></p>","tags":["Level 1","Workstation","Server","Services","Configure Time Synchronization","Configure ntp","Automated","IG2","IG3","8.4 Standardize Time Synchronization"]},{"location":"2-Services/2.1-Configure-Time-Synchronization/2.1.4-Configure-ntp/2.1.4.4-Ensure-ntp-is-enabled-and-running/#remediation","title":"Remediation","text":"<p>IF ntp is in use on the system, run the following commands:</p> <p>Run the following command to unmask ntp.service: <pre><code># systemctl unmask ntp.service\n</code></pre></p> <p>Run the following command to enable and start ntp.service: <pre><code># systemctl --now enable ntp.service\n</code></pre></p> <p>OR</p> <p>If another time synchronization service is in use on the system, run the following command to remove ntp: <pre><code># apt purge ntp\n</code></pre></p>","tags":["Level 1","Workstation","Server","Services","Configure Time Synchronization","Configure ntp","Automated","IG2","IG3","8.4 Standardize Time Synchronization"]},{"location":"2-Services/2.2-Special-Purpose-Services/2.2.1-Ensure-x-window-system-is-not-installed/","title":"2.2.1 Ensure X Window System is not installed","text":"","tags":["Level 1","Server","Services","Special Purpose Services","Automated","IG2","IG3","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","T1203","T1210","T1543","T1543.002","TA0008","M1042"]},{"location":"2-Services/2.2-Special-Purpose-Services/2.2.1-Ensure-x-window-system-is-not-installed/#audit","title":"Audit","text":"<p>Verify X Windows System is not installed: <pre><code>dpkg-query -W -f='${binary:Package}\\t${Status}\\t${db:Status-Status}\\n' xserver-xorg* | grep -Pi '\\h+installed\\b'\n</code></pre></p> <p>Nothing should be returned.</p>","tags":["Level 1","Server","Services","Special Purpose Services","Automated","IG2","IG3","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","T1203","T1210","T1543","T1543.002","TA0008","M1042"]},{"location":"2-Services/2.2-Special-Purpose-Services/2.2.1-Ensure-x-window-system-is-not-installed/#remediation","title":"Remediation","text":"<p>Remove the X Windows System packages: <pre><code>apt purge xserver-xorg*\n</code></pre></p>","tags":["Level 1","Server","Services","Special Purpose Services","Automated","IG2","IG3","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","T1203","T1210","T1543","T1543.002","TA0008","M1042"]},{"location":"2-Services/2.2-Special-Purpose-Services/2.2.10-Ensure-imap-and-pop3-server-are-not-installed/","title":"2.2.10 Ensure IMAP and POP3 server are not installed","text":"","tags":["Level 1","Workstation","Server","Services","Special Purpose Services","Automated","IG2","IG3","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","T1203","T1210","T1543","T1543.002","TA0008","M1042"]},{"location":"2-Services/2.2-Special-Purpose-Services/2.2.10-Ensure-imap-and-pop3-server-are-not-installed/#audit","title":"Audit","text":"<p>Run the following command to verify dovecot-imapd and dovecot-pop3d are not installed: <pre><code># dpkg-query -W -f='${binary:Package}\\t${Status}\\t${db:Status-Status}\\n' dovecot-imapd dovecot-pop3d\ndovecot-imapd unknown ok not-installed not-installed\ndovecot-pop3d unknown ok not-installed not-installed\n</code></pre></p>","tags":["Level 1","Workstation","Server","Services","Special Purpose Services","Automated","IG2","IG3","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","T1203","T1210","T1543","T1543.002","TA0008","M1042"]},{"location":"2-Services/2.2-Special-Purpose-Services/2.2.10-Ensure-imap-and-pop3-server-are-not-installed/#remediation","title":"Remediation","text":"<p>Run one of the following commands to remove dovecot-imapd and dovecot-pop3d: <pre><code># apt purge dovecot-imapd dovecot-pop3d\n</code></pre></p>","tags":["Level 1","Workstation","Server","Services","Special Purpose Services","Automated","IG2","IG3","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","T1203","T1210","T1543","T1543.002","TA0008","M1042"]},{"location":"2-Services/2.2-Special-Purpose-Services/2.2.11-Ensure-samba-is-not-installed/","title":"2.2.11 Ensure Samba is not installed","text":"","tags":["Level 1","Workstation","Server","Services","Special Purpose Services","Automated","IG2","IG3","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","T1005","T1039","T1083","T1135","T1203","T1210","T1543","T1543.002","TA0008"]},{"location":"2-Services/2.2-Special-Purpose-Services/2.2.11-Ensure-samba-is-not-installed/#audit","title":"Audit","text":"<p>Run the following command to verify samba is not installed: <pre><code># dpkg-query -W -f='${binary:Package}\\t${Status}\\t${db:Status-Status}\\n' samba\nsamba unknown ok not-installed not-installed\n</code></pre></p>","tags":["Level 1","Workstation","Server","Services","Special Purpose Services","Automated","IG2","IG3","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","T1005","T1039","T1083","T1135","T1203","T1210","T1543","T1543.002","TA0008"]},{"location":"2-Services/2.2-Special-Purpose-Services/2.2.11-Ensure-samba-is-not-installed/#remediation","title":"Remediation","text":"<p>Run the following command to remove samba: <pre><code># apt purge samba\n</code></pre></p>","tags":["Level 1","Workstation","Server","Services","Special Purpose Services","Automated","IG2","IG3","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","T1005","T1039","T1083","T1135","T1203","T1210","T1543","T1543.002","TA0008"]},{"location":"2-Services/2.2-Special-Purpose-Services/2.2.12-Ensure-http-proxy-server-is-not-installed/","title":"2.2.12 Ensure HTTP Proxy Server is not installed","text":"","tags":["Level 1","Workstation","Server","Services","Special Purpose Services","Automated","IG2","IG3","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","T1203","T1210","T1543","T1543.002","TA0008","M1042"]},{"location":"2-Services/2.2-Special-Purpose-Services/2.2.12-Ensure-http-proxy-server-is-not-installed/#audit","title":"Audit","text":"<p>Run the following command to verify squid is not installed: <pre><code># dpkg-query -W -f='${binary:Package}\\t${Status}\\t${db:Status-Status}\\n' squid\nsquid unknown ok not-installed not-installed\n</code></pre></p>","tags":["Level 1","Workstation","Server","Services","Special Purpose Services","Automated","IG2","IG3","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","T1203","T1210","T1543","T1543.002","TA0008","M1042"]},{"location":"2-Services/2.2-Special-Purpose-Services/2.2.12-Ensure-http-proxy-server-is-not-installed/#remediation","title":"Remediation","text":"<p>Run the following command to remove squid: <pre><code># apt purge squid\n</code></pre></p>","tags":["Level 1","Workstation","Server","Services","Special Purpose Services","Automated","IG2","IG3","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","T1203","T1210","T1543","T1543.002","TA0008","M1042"]},{"location":"2-Services/2.2-Special-Purpose-Services/2.2.13-Ensure-snmp-server-is-not-installed/","title":"2.2.13 Ensure SNMP Server is not installed","text":"","tags":["Level 1","Workstation","Server","Services","Special Purpose Services","Automated","IG2","IG3","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","T1203","T1210","T1543","T1543.002","TA0008","M1042"]},{"location":"2-Services/2.2-Special-Purpose-Services/2.2.13-Ensure-snmp-server-is-not-installed/#audit","title":"Audit","text":"<p>Run the following command to verify snmpd is not installed: <pre><code># dpkg-query -W -f='${binary:Package}\\t${Status}\\t${db:Status-Status}\\n' snmp\nsnmp unknown ok not-installed not-installed\n</code></pre></p>","tags":["Level 1","Workstation","Server","Services","Special Purpose Services","Automated","IG2","IG3","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","T1203","T1210","T1543","T1543.002","TA0008","M1042"]},{"location":"2-Services/2.2-Special-Purpose-Services/2.2.13-Ensure-snmp-server-is-not-installed/#remediation","title":"Remediation","text":"<p>Run the following command to remove snmp: <pre><code># apt purge snmp\n</code></pre></p>","tags":["Level 1","Workstation","Server","Services","Special Purpose Services","Automated","IG2","IG3","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","T1203","T1210","T1543","T1543.002","TA0008","M1042"]},{"location":"2-Services/2.2-Special-Purpose-Services/2.2.14-Ensure-nis-server-is-not-installed/","title":"2.2.14 Ensure NIS Server is not installed","text":"","tags":["Level 1","Workstation","Server","Services","Special Purpose Services","Automated","IG2","IG3","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","T1203","T1210","T1543","T1543.002","TA0008","M1042"]},{"location":"2-Services/2.2-Special-Purpose-Services/2.2.14-Ensure-nis-server-is-not-installed/#audit","title":"Audit","text":"<p>Run the following command to verify nis is not installed: <pre><code># dpkg-query -W -f='${binary:Package}\\t${Status}\\t${db:Status-Status}\\n' nis\nnis unknown ok not-installed not-installed\n</code></pre></p>","tags":["Level 1","Workstation","Server","Services","Special Purpose Services","Automated","IG2","IG3","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","T1203","T1210","T1543","T1543.002","TA0008","M1042"]},{"location":"2-Services/2.2-Special-Purpose-Services/2.2.14-Ensure-nis-server-is-not-installed/#remediation","title":"Remediation","text":"<p>Run the following command to remove nis: <pre><code># apt purge nis\n</code></pre></p>","tags":["Level 1","Workstation","Server","Services","Special Purpose Services","Automated","IG2","IG3","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","T1203","T1210","T1543","T1543.002","TA0008","M1042"]},{"location":"2-Services/2.2-Special-Purpose-Services/2.2.15-Ensure-mail-transfer-agent-is-configured-for-local-only-mode/","title":"2.2.15 Ensure mail transfer agent is configured for local-only mode","text":"","tags":["Level 1","Workstation","Server","Services","Special Purpose Services","Automated","IG2","IG3","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","T1018","T1210","TA0008","M1042"]},{"location":"2-Services/2.2-Special-Purpose-Services/2.2.15-Ensure-mail-transfer-agent-is-configured-for-local-only-mode/#audit","title":"Audit","text":"<p>Run the following command to verify that the MTA is not listening on any non-loopback address (127.0.0.1 or::1). <pre><code># ss -lntu | grep -E ':25\\s' | grep -E -v '\\s(127.0.0.1|::1):25\\s'\n</code></pre></p> <p>Nothing should be returned</p>","tags":["Level 1","Workstation","Server","Services","Special Purpose Services","Automated","IG2","IG3","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","T1018","T1210","TA0008","M1042"]},{"location":"2-Services/2.2-Special-Purpose-Services/2.2.15-Ensure-mail-transfer-agent-is-configured-for-local-only-mode/#remediation","title":"Remediation","text":"<p>Edit /etc/postfix/main.cf and add the following line to the RECEIVING MAIL section.</p> <p>If the line already exists, change it to look like the line below: <pre><code>inet_interfaces = loopback-only\n</code></pre></p> <p>Run the following command to restart postfix: <pre><code># systemctl restart postfix\n</code></pre></p>","tags":["Level 1","Workstation","Server","Services","Special Purpose Services","Automated","IG2","IG3","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","T1018","T1210","TA0008","M1042"]},{"location":"2-Services/2.2-Special-Purpose-Services/2.2.16-Ensure-rsync-service-is-either-not-installed-or-masked/","title":"2.2.16 Ensure rsync service is either not installed or masked","text":"","tags":["Level 1","Workstation","Server","Services","Special Purpose Services","Automated","IG2","IG3","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","T1105","T1203","T1210","T1543","T1543.002","T1570","TA0008","M1042"]},{"location":"2-Services/2.2-Special-Purpose-Services/2.2.16-Ensure-rsync-service-is-either-not-installed-or-masked/#audit","title":"Audit","text":"<p>Run the following command to verify rsync is not installed: <pre><code>dpkg-query -W -f='${binary:Package}\\t${Status}\\t${db:Status-Status}\\n' rsync\nrsync unknown ok not-installed not-installed\n</code></pre></p> <p>OR</p> <p>Run the following commands to verify that rsync is inactive and masked: <pre><code># systemctl is-active rsync\ninactive\n# systemctl is-enabled rsync\nmasked\n</code></pre></p>","tags":["Level 1","Workstation","Server","Services","Special Purpose Services","Automated","IG2","IG3","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","T1105","T1203","T1210","T1543","T1543.002","T1570","TA0008","M1042"]},{"location":"2-Services/2.2-Special-Purpose-Services/2.2.16-Ensure-rsync-service-is-either-not-installed-or-masked/#remediation","title":"Remediation","text":"<p>Run the following command to remove rsync: <pre><code># apt purge rsync\n</code></pre></p> <p>OR</p> <p>Run the following commands to stop and mask rsync: <pre><code># systemctl stop rsync\n# systemctl mask rsync\n</code></pre></p>","tags":["Level 1","Workstation","Server","Services","Special Purpose Services","Automated","IG2","IG3","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","T1105","T1203","T1210","T1543","T1543.002","T1570","TA0008","M1042"]},{"location":"2-Services/2.2-Special-Purpose-Services/2.2.2-Ensure-avahi-server-is-not-installed/","title":"2.2.2 Ensure Avahi Server is not installed","text":"","tags":["Level 1","Workstation","Server","Services","Special Purpose Services","Automated","IG2","IG3","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","T1203","T1210","T1543","T1543.002","TA0008","M1042"]},{"location":"2-Services/2.2-Special-Purpose-Services/2.2.2-Ensure-avahi-server-is-not-installed/#audit","title":"Audit","text":"<p>Run the following command to verify avahi-daemon is not installed: <pre><code># dpkg-query -W -f='${binary:Package}\\t${Status}\\t${db:Status-Status}\\n' avahi-daemon\navahi-daemon unknown ok not-installed not-installed\n</code></pre></p>","tags":["Level 1","Workstation","Server","Services","Special Purpose Services","Automated","IG2","IG3","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","T1203","T1210","T1543","T1543.002","TA0008","M1042"]},{"location":"2-Services/2.2-Special-Purpose-Services/2.2.2-Ensure-avahi-server-is-not-installed/#remediation","title":"Remediation","text":"<p>Run the following commands to remove avahi-daemon: <pre><code># systemctl stop avahi-daaemon.service\n# systemctl stop avahi-daemon.socket\n# apt purge avahi-daemon\n</code></pre></p>","tags":["Level 1","Workstation","Server","Services","Special Purpose Services","Automated","IG2","IG3","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","T1203","T1210","T1543","T1543.002","TA0008","M1042"]},{"location":"2-Services/2.2-Special-Purpose-Services/2.2.3-Ensure-cups-is-not-installed/","title":"2.2.3 Ensure CUPS is not installed","text":"","tags":["Level 1","Level 2","Workstation","Server","Services","Special Purpose Services","Automated","IG2","IG3","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","T1203","T1210","T1543","T1543.002","TA0008","M1042"]},{"location":"2-Services/2.2-Special-Purpose-Services/2.2.3-Ensure-cups-is-not-installed/#audit","title":"Audit","text":"<p>Run the following command to verify cups is not Installed: <pre><code># dpkg-query -W -f='${binary:Package}\\t${Status}\\t${db:Status-Status}\\n' cups\ncups unknown ok not-installed not-installed\n</code></pre></p>","tags":["Level 1","Level 2","Workstation","Server","Services","Special Purpose Services","Automated","IG2","IG3","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","T1203","T1210","T1543","T1543.002","TA0008","M1042"]},{"location":"2-Services/2.2-Special-Purpose-Services/2.2.3-Ensure-cups-is-not-installed/#remediation","title":"Remediation","text":"<p>Run one of the following commands to remove cups: <pre><code># apt purge cups\n</code></pre></p>","tags":["Level 1","Level 2","Workstation","Server","Services","Special Purpose Services","Automated","IG2","IG3","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","T1203","T1210","T1543","T1543.002","TA0008","M1042"]},{"location":"2-Services/2.2-Special-Purpose-Services/2.2.4-Ensure-dhcp-server-is-not-installed/","title":"2.2.4 Ensure DHCP Server is not installed","text":"","tags":["Level 1","Workstation","Server","Services","Special Purpose Services","Automated","IG2","IG3","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","T1203","T1210","T1543","T1543.002","TA0008","M1042"]},{"location":"2-Services/2.2-Special-Purpose-Services/2.2.4-Ensure-dhcp-server-is-not-installed/#audit","title":"Audit","text":"<p>Run the following commands to verify isc-dhcp-server is not installed: <pre><code># dpkg-query -W -f='${binary:Package}\\t${Status}\\t${db:Status-Status}\\n' iscdhcp-server\nisc-dhcp-server unknown ok not-installed not-installed\n</code></pre></p>","tags":["Level 1","Workstation","Server","Services","Special Purpose Services","Automated","IG2","IG3","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","T1203","T1210","T1543","T1543.002","TA0008","M1042"]},{"location":"2-Services/2.2-Special-Purpose-Services/2.2.4-Ensure-dhcp-server-is-not-installed/#remediation","title":"Remediation","text":"<p>Run the following command to remove isc-dhcp-server: <pre><code># apt purge isc-dhcp-server\n</code></pre></p>","tags":["Level 1","Workstation","Server","Services","Special Purpose Services","Automated","IG2","IG3","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","T1203","T1210","T1543","T1543.002","TA0008","M1042"]},{"location":"2-Services/2.2-Special-Purpose-Services/2.2.5-Ensure-ldap-server-is-not-installed/","title":"2.2.5 Ensure LDAP server is not installed","text":"","tags":["Level 1","Workstation","Server","Services","Special Purpose Services","Automated","IG2","IG3","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","T1203","T1210","T1543","T1543.002","TA0008","M1042"]},{"location":"2-Services/2.2-Special-Purpose-Services/2.2.5-Ensure-ldap-server-is-not-installed/#audit","title":"Audit","text":"<p>Run the following command to verify slapd is not installed: <pre><code># dpkg-query -W -f='${binary:Package}\\t${Status}\\t${db:Status-Status}\\n' slapd\nslapd unknown ok not-installed not-installed\n</code></pre></p>","tags":["Level 1","Workstation","Server","Services","Special Purpose Services","Automated","IG2","IG3","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","T1203","T1210","T1543","T1543.002","TA0008","M1042"]},{"location":"2-Services/2.2-Special-Purpose-Services/2.2.5-Ensure-ldap-server-is-not-installed/#remediation","title":"Remediation","text":"<p>Run one of the following commands to remove slapd: <pre><code># apt purge slapd\n</code></pre></p>","tags":["Level 1","Workstation","Server","Services","Special Purpose Services","Automated","IG2","IG3","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","T1203","T1210","T1543","T1543.002","TA0008","M1042"]},{"location":"2-Services/2.2-Special-Purpose-Services/2.2.6-Ensure-nfs-is-not-installed/","title":"2.2.6 Ensure NFS is not installed","text":"","tags":["Level 1","Workstation","Server","Services","Special Purpose Services","Automated","IG2","IG3","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software"]},{"location":"2-Services/2.2-Special-Purpose-Services/2.2.6-Ensure-nfs-is-not-installed/#audit","title":"Audit","text":"<p>Run the following command to verify nfs is not installed: <pre><code># dpkg-query -W -f='${binary:Package}\\t${Status}\\t${db:Status-Status}\\n' nfskernel-server\nnfs-kernel-server unknown ok not-installed not-installed\n</code></pre></p>","tags":["Level 1","Workstation","Server","Services","Special Purpose Services","Automated","IG2","IG3","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software"]},{"location":"2-Services/2.2-Special-Purpose-Services/2.2.6-Ensure-nfs-is-not-installed/#remediation","title":"Remediation","text":"<p>Run the following command to remove nfs: <pre><code># apt purge nfs-kernel-server\n</code></pre></p>","tags":["Level 1","Workstation","Server","Services","Special Purpose Services","Automated","IG2","IG3","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software"]},{"location":"2-Services/2.2-Special-Purpose-Services/2.2.7-Ensure-dns-server-is-not-installed/","title":"2.2.7 Ensure DNS Server is not installed","text":"","tags":["Level 1","Workstation","Server","Services","Special Purpose Services","Automated","IG2","IG3","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","T1203","T1210","T1543","T1543.002","TA0008","M1042"]},{"location":"2-Services/2.2-Special-Purpose-Services/2.2.7-Ensure-dns-server-is-not-installed/#audit","title":"Audit","text":"<p>Run the following command to verify DNS server is not installed: <pre><code># dpkg-query -W -f='${binary:Package}\\t${Status}\\t${db:Status-Status}\\n' bind9\nbind9 unknown ok not-installed not-installed\n</code></pre></p>","tags":["Level 1","Workstation","Server","Services","Special Purpose Services","Automated","IG2","IG3","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","T1203","T1210","T1543","T1543.002","TA0008","M1042"]},{"location":"2-Services/2.2-Special-Purpose-Services/2.2.7-Ensure-dns-server-is-not-installed/#remediation","title":"Remediation","text":"<p>Run the following commands to disable DNS server: <pre><code># apt purge bind9\n</code></pre></p>","tags":["Level 1","Workstation","Server","Services","Special Purpose Services","Automated","IG2","IG3","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","T1203","T1210","T1543","T1543.002","TA0008","M1042"]},{"location":"2-Services/2.2-Special-Purpose-Services/2.2.8-Ensure-ftp-server-is-not-installed/","title":"2.2.8 Ensure FTP Server is not installed","text":"","tags":["Level 1","Workstation","Server","Services","Special Purpose Services","Automated","IG2","IG3","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","T1203","T1210","T1543","T1543.002","TA0008","M1042"]},{"location":"2-Services/2.2-Special-Purpose-Services/2.2.8-Ensure-ftp-server-is-not-installed/#audit","title":"Audit","text":"<p>Run the following command to verify vsftpd is not installed: <pre><code># dpkg-query -W -f='${binary:Package}\\t${Status}\\t${db:Status-Status}\\n' vsftpd\nvsftpd unknown ok not-installed not-installed\n</code></pre></p>","tags":["Level 1","Workstation","Server","Services","Special Purpose Services","Automated","IG2","IG3","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","T1203","T1210","T1543","T1543.002","TA0008","M1042"]},{"location":"2-Services/2.2-Special-Purpose-Services/2.2.8-Ensure-ftp-server-is-not-installed/#remediation","title":"Remediation","text":"<p>Run the following command to remove vsftpd: <pre><code># apt purge vsftpd\n</code></pre></p>","tags":["Level 1","Workstation","Server","Services","Special Purpose Services","Automated","IG2","IG3","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","T1203","T1210","T1543","T1543.002","TA0008","M1042"]},{"location":"2-Services/2.2-Special-Purpose-Services/2.2.9-Ensure-http-server-is-not-installed/","title":"2.2.9 Ensure HTTP server is not installed","text":"","tags":["Level 1","Workstation","Server","Services","Special Purpose Services","Automated","IG2","IG3","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","T1203","T1210","T1543","T1543.002","TA0008","M1042"]},{"location":"2-Services/2.2-Special-Purpose-Services/2.2.9-Ensure-http-server-is-not-installed/#audit","title":"Audit","text":"<p>Run the following command to verify apache is not installed: <pre><code># dpkg-query -W -f='${binary:Package}\\t${Status}\\t${db:Status-Status}\\n' apache2\napache2 unknown ok not-installed not-installed\n</code></pre></p>","tags":["Level 1","Workstation","Server","Services","Special Purpose Services","Automated","IG2","IG3","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","T1203","T1210","T1543","T1543.002","TA0008","M1042"]},{"location":"2-Services/2.2-Special-Purpose-Services/2.2.9-Ensure-http-server-is-not-installed/#remediation","title":"Remediation","text":"<p>Run the following command to remove apache: <pre><code># apt purge apache2\n</code></pre></p>","tags":["Level 1","Workstation","Server","Services","Special Purpose Services","Automated","IG2","IG3","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","T1203","T1210","T1543","T1543.002","TA0008","M1042"]},{"location":"2-Services/2.3-Service-Clients/2.3.1-Ensure-nis-client-is-not-installed/","title":"2.3.1 Ensure NIS Client is not installed","text":"","tags":["Level 1","Workstation","Server","Services","Service Clients","Automated","IG2","IG3","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","T1203","T1543","T1543.002","T1570","TA0008","M1042"]},{"location":"2-Services/2.3-Service-Clients/2.3.1-Ensure-nis-client-is-not-installed/#audit","title":"Audit","text":"<p>Verify nis is not installed. Use the following command to provide the needed information: <pre><code># dpkg-query -W -f='${binary:Package}\\t${Status}\\t${db:Status-Status}\\n' nis\nnis unknown ok not-installed not-installed\n</code></pre></p>","tags":["Level 1","Workstation","Server","Services","Service Clients","Automated","IG2","IG3","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","T1203","T1543","T1543.002","T1570","TA0008","M1042"]},{"location":"2-Services/2.3-Service-Clients/2.3.1-Ensure-nis-client-is-not-installed/#remediation","title":"Remediation","text":"<p>Uninstall nis: <pre><code># apt purge nis\n</code></pre></p>","tags":["Level 1","Workstation","Server","Services","Service Clients","Automated","IG2","IG3","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","T1203","T1543","T1543.002","T1570","TA0008","M1042"]},{"location":"2-Services/2.3-Service-Clients/2.3.2-Ensure-rsh-client-is-not-installed/","title":"2.3.2 Ensure rsh client is not installed","text":"","tags":["Level 1","Workstation","Server","Services","Service Clients","Automated","IG2","IG3","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","T1040","T1203","T1543","T1543.002","T1570","TA0008","M1041","M1042"]},{"location":"2-Services/2.3-Service-Clients/2.3.2-Ensure-rsh-client-is-not-installed/#audit","title":"Audit","text":"<p>Verify rsh-client is not installed. Use the following command to provide the needed information: <pre><code># dpkg-query -W -f='${binary:Package}\\t${Status}\\t${db:Status-Status}\\n' rshclient\nrsh-client unknown ok not-installed not-installed\n</code></pre></p>","tags":["Level 1","Workstation","Server","Services","Service Clients","Automated","IG2","IG3","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","T1040","T1203","T1543","T1543.002","T1570","TA0008","M1041","M1042"]},{"location":"2-Services/2.3-Service-Clients/2.3.2-Ensure-rsh-client-is-not-installed/#remediation","title":"Remediation","text":"<p>Uninstall rsh: <pre><code># apt purge rsh-client\n</code></pre></p>","tags":["Level 1","Workstation","Server","Services","Service Clients","Automated","IG2","IG3","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","T1040","T1203","T1543","T1543.002","T1570","TA0008","M1041","M1042"]},{"location":"2-Services/2.3-Service-Clients/2.3.3-Ensure-talk-client-is-not-installed/","title":"2.3.3 Ensure talk client is not installed","text":"","tags":["Level 1","Workstation","Server","Services","Service Clients","Automated","IG2","IG3","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","T1203","T1543","T1543.002","TA0006","TA0008","M1041","M1042"]},{"location":"2-Services/2.3-Service-Clients/2.3.3-Ensure-talk-client-is-not-installed/#audit","title":"Audit","text":"<p>Verify talk is not installed. The following command may provide the needed information: <pre><code># dpkg-query -W -f='${binary:Package}\\t${Status}\\t${db:Status-Status}\\n' talk\ntalk unknown ok not-installed not-installed\n</code></pre></p>","tags":["Level 1","Workstation","Server","Services","Service Clients","Automated","IG2","IG3","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","T1203","T1543","T1543.002","TA0006","TA0008","M1041","M1042"]},{"location":"2-Services/2.3-Service-Clients/2.3.3-Ensure-talk-client-is-not-installed/#remediation","title":"Remediation","text":"<p>Uninstall talk: <pre><code># apt purge talk\n</code></pre></p>","tags":["Level 1","Workstation","Server","Services","Service Clients","Automated","IG2","IG3","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","T1203","T1543","T1543.002","TA0006","TA0008","M1041","M1042"]},{"location":"2-Services/2.3-Service-Clients/2.3.4-Ensure-telnet-client-is-not-installed/","title":"2.3.4 Ensure telnet client is not installed","text":"","tags":["Level 1","Workstation","Server","Services","Service Clients","Automated","IG2","IG3","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","T1040","T1203","T1543","T1543.002","TA0006","TA0008","M1041","M1042"]},{"location":"2-Services/2.3-Service-Clients/2.3.4-Ensure-telnet-client-is-not-installed/#audit","title":"Audit","text":"<p>Verify telnet is not installed. Use the following command to provide the needed information: <pre><code># dpkg-query -W -f='${binary:Package}\\t${Status}\\t${db:Status-Status}\\n' telnet\ntelnet unknown ok not-installed not-installed\n</code></pre></p>","tags":["Level 1","Workstation","Server","Services","Service Clients","Automated","IG2","IG3","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","T1040","T1203","T1543","T1543.002","TA0006","TA0008","M1041","M1042"]},{"location":"2-Services/2.3-Service-Clients/2.3.4-Ensure-telnet-client-is-not-installed/#remediation","title":"Remediation","text":"<p>Uninstall telnet: <pre><code># apt purge telnet\n</code></pre></p>","tags":["Level 1","Workstation","Server","Services","Service Clients","Automated","IG2","IG3","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","T1040","T1203","T1543","T1543.002","TA0006","TA0008","M1041","M1042"]},{"location":"2-Services/2.3-Service-Clients/2.3.5-Ensure-ldap-client-is-not-installed/","title":"2.3.5 Ensure LDAP client is not installed","text":"","tags":["Level 1","Workstation","Server","Services","Service Clients","Automated","IG2","IG3","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","T1203","T1543","T1543.002","TA0008","M1042"]},{"location":"2-Services/2.3-Service-Clients/2.3.5-Ensure-ldap-client-is-not-installed/#audit","title":"Audit","text":"<p>Verify that ldap-utils is not installed. Use the following command to provide the needed information: <pre><code># dpkg-query -W -f='${binary:Package}\\t${Status}\\t${db:Status-Status}\\n' ldap-utils\nldap-utils unknown ok not-installed not-installed\n</code></pre></p>","tags":["Level 1","Workstation","Server","Services","Service Clients","Automated","IG2","IG3","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","T1203","T1543","T1543.002","TA0008","M1042"]},{"location":"2-Services/2.3-Service-Clients/2.3.5-Ensure-ldap-client-is-not-installed/#remediation","title":"Remediation","text":"<p>Uninstall ldap-utils: <pre><code># apt purge ldap-utils\n</code></pre></p>","tags":["Level 1","Workstation","Server","Services","Service Clients","Automated","IG2","IG3","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","T1203","T1543","T1543.002","TA0008","M1042"]},{"location":"2-Services/2.3-Service-Clients/2.3.6-Ensure-rpc-is-not-installed/","title":"2.3.6 Ensure RPC is not installed","text":"","tags":["Level 1","Workstation","Server","Services","Service Clients","Automated","IG2","IG3","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","T1203","T1543","T1543.002","TA0008","M1042"]},{"location":"2-Services/2.3-Service-Clients/2.3.6-Ensure-rpc-is-not-installed/#audit","title":"Audit","text":"<p>Run the following command to verify rpcbind is not installed: <pre><code># dpkg-query -W -f='${binary:Package}\\t${Status}\\t${db:Status-Status}\\n' rpcbind\nrpcbind unknown ok not-installed not-installed\n</code></pre></p>","tags":["Level 1","Workstation","Server","Services","Service Clients","Automated","IG2","IG3","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","T1203","T1543","T1543.002","TA0008","M1042"]},{"location":"2-Services/2.3-Service-Clients/2.3.6-Ensure-rpc-is-not-installed/#remediation","title":"Remediation","text":"<p>Run the following command to remove rpcbind: <pre><code># apt purge rpcbind\n</code></pre></p>","tags":["Level 1","Workstation","Server","Services","Service Clients","Automated","IG2","IG3","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","T1203","T1543","T1543.002","TA0008","M1042"]},{"location":"3-Network-Configuration/3.1-Disable-unused-network-protocols-and-devices/3.1.1-Ensure-system-is-checked-to-determine-if-ipv6-is-enabled/","title":"3.1.1 Ensure system is checked to determine if IPv6 is enabled","text":"","tags":["Level 1","Workstation","Server","Network Configuration","Disable unused network protocols and devices","Manual","IG2","IG3","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","T1557","T1595","T1595.001","T1595.002","TA0008","M1042"]},{"location":"3-Network-Configuration/3.1-Disable-unused-network-protocols-and-devices/3.1.1-Ensure-system-is-checked-to-determine-if-ipv6-is-enabled/#audit","title":"Audit","text":"<p>Run the following script to verify IPv6 status on the system: <pre><code>#!/usr/bin/env bash\n{\noutput=\"\"\ngrubfile=$(find /boot -type f \\( -name 'grubenv' -o -name 'grub.conf' -o -name 'grub.cfg' \\) -exec grep -Pl -- '^\\h*(kernelopts=|linux|kernel)' {} \\;)\nsearchloc=\"/run/sysctl.d/*.conf /etc/sysctl.d/*.conf /usr/local/lib/sysctl.d/*.conf /usr/lib/sysctl.d/*.conf /lib/sysctl.d/*.conf /etc/sysctl.conf\"\nif [ -s \"$grubfile\" ]; then\n! grep -P -- \"^\\h*(kernelopts=|linux|kernel)\" \"$grubfile\" | grep -vq -- ipv6.disable=1 &amp;&amp; output=\"IPv6 Disabled in \\\"$grubfile\\\"\"\nfi\nif grep -Pqs -- \"^\\h*net\\.ipv6\\.conf\\.all\\.disable_ipv6\\h*=\\h*1\\h*(#.*)?$\" $searchloc &amp;&amp; \\\ngrep -Pqs -- \"^\\h*net\\.ipv6\\.conf\\.default\\.disable_ipv6\\h*=\\h*1\\h*(#.*)?$\" $searchloc &amp;&amp;\n\\\nsysctl net.ipv6.conf.all.disable_ipv6 | grep -Pqs -- \"^\\h*net\\.ipv6\\.conf\\.all\\.disable_ipv6\\h*=\\h*1\\h*(#.*)?$\" &amp;&amp; \\\nsysctl net.ipv6.conf.default.disable_ipv6 | grep -Pqs -- \"^\\h*net\\.ipv6\\.conf\\.default\\.disable_ipv6\\h*=\\h*1\\h*(#.*)?$\"; then\n[ -n \"$output\" ] &amp;&amp; output=\"$output, and in sysctl config\" || output=\"ipv6 disabled in sysctl config\"\nfi\n[ -n \"$output\" ] &amp;&amp; echo -e \"\\n$output\\n\" || echo -e \"\\nIPv6 is enabled on the system\\n\"\n}\n</code></pre></p>","tags":["Level 1","Workstation","Server","Network Configuration","Disable unused network protocols and devices","Manual","IG2","IG3","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","T1557","T1595","T1595.001","T1595.002","TA0008","M1042"]},{"location":"3-Network-Configuration/3.1-Disable-unused-network-protocols-and-devices/3.1.1-Ensure-system-is-checked-to-determine-if-ipv6-is-enabled/#remediation","title":"Remediation","text":"<p>It is recommended that IPv6 be enabled and configured in accordance with Benchmark recommendations. If IPv6 is to be disabled, use one of the two following methods to disable IPv6 on the system:</p> <p>To disable IPv6 through the GRUB2 config, run the following command to add ipv6.disable=1 to the GRUB_CMDLINE_LINUX parameters:</p> <p>Edit /etc/default/grub and add ipv6.disable=1 to the GRUB_CMDLINE_LINUX parameters:</p> <p>Example: <pre><code>GRUB_CMDLINE_LINUX=\"ipv6.disable=1\"\n</code></pre></p> <p>Run the following command to update the grub2 configuration: <pre><code># update-grub\n</code></pre></p> <p>OR To disable IPv6 through sysctl settings, set the following parameters in /etc/sysctl.conf or a /etc/sysctl.d/* file:</p> <p>Example: <pre><code># printf \"\nnet.ipv6.conf.all.disable_ipv6 = 1\nnet.ipv6.conf.default.disable_ipv6 = 1\n\" &gt;&gt; /etc/sysctl.d/60-disable_ipv6.conf\n</code></pre></p> <p>Run the following command to set the active kernel parameters: <pre><code># {\nsysctl -w net.ipv6.conf.all.disable_ipv6=1\nsysctl -w net.ipv6.conf.default.disable_ipv6=1\nsysctl -w net.ipv6.route.flush=1\n}\n</code></pre></p> <p>Default Value:</p> <p>IPv6 is enabled</p>","tags":["Level 1","Workstation","Server","Network Configuration","Disable unused network protocols and devices","Manual","IG2","IG3","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","T1557","T1595","T1595.001","T1595.002","TA0008","M1042"]},{"location":"3-Network-Configuration/3.1-Disable-unused-network-protocols-and-devices/3.1.2-Ensure-wireless-interfaces-are-disabled/","title":"3.1.2 Ensure wireless interfaces are disabled","text":"","tags":["Level 1","Level 2","Workstation","Server","Network Configuration","Disable unused network protocols and devices","Automated","IG2","IG3","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","T1011","T1595","T1595.001","T1595.002","TA0010","M1028"]},{"location":"3-Network-Configuration/3.1-Disable-unused-network-protocols-and-devices/3.1.2-Ensure-wireless-interfaces-are-disabled/#audit","title":"Audit","text":"<p>Run the following script to verify no wireless interfaces are active on the system: <pre><code>#!/bin/bash\nif command -v nmcli &gt;/dev/null 2&gt;&amp;1 ; then\nif nmcli radio all | grep -Eq '\\s*\\S+\\s+disabled\\s+\\S+\\s+disabled\\b'; then\necho \"Wireless is not enabled\"\nelse\nnmcli radio all\n fi\nelif [ -n \"$(find /sys/class/net/*/ -type d -name wireless)\" ]; then\nt=0\nmname=$(for driverdir in $(find /sys/class/net/*/ -type d -name wireless | xargs -0 dirname); do basename \"$(readlink -f \"$driverdir\"/device/driver/module)\";done | sort -u)\nfor dm in $mname; do\nif grep -Eq \"^\\s*install\\s+$dm\\s+/bin/(true|false)\" /etc/modprobe.d/*.conf; then\n/bin/true\n else\necho \"$dm is not disabled\"\nt=1\nfi\ndone\n[ \"$t\" -eq 0 ] &amp;&amp; echo \"Wireless is not enabled\"\nelse\necho \"Wireless is not enabled\"\nfi\n</code></pre></p> <p>Output should be: <pre><code>Wireless is not enabled\n</code></pre></p>","tags":["Level 1","Level 2","Workstation","Server","Network Configuration","Disable unused network protocols and devices","Automated","IG2","IG3","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","T1011","T1595","T1595.001","T1595.002","TA0010","M1028"]},{"location":"3-Network-Configuration/3.1-Disable-unused-network-protocols-and-devices/3.1.2-Ensure-wireless-interfaces-are-disabled/#remediation","title":"Remediation","text":"<p>Run the following script to disable any wireless interfaces: <pre><code>#!/bin/bash\nif command -v nmcli &gt;/dev/null 2&gt;&amp;1 ; then\nnmcli radio all off\nelse\nif [ -n \"$(find /sys/class/net/*/ -type d -name wireless)\" ]; then\nmname=$(for driverdir in $(find /sys/class/net/*/ -type d -name wireless | xargs -0 dirname); do basename \"$(readlink -f \"$driverdir\"/device/driver/module)\";done | sort -u)\nfor dm in $mname; do\necho \"install $dm /bin/true\" &gt;&gt; /etc/modprobe.d/disable_wireless.conf\n done\nfi\nfi\n</code></pre></p>","tags":["Level 1","Level 2","Workstation","Server","Network Configuration","Disable unused network protocols and devices","Automated","IG2","IG3","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","T1011","T1595","T1595.001","T1595.002","TA0010","M1028"]},{"location":"3-Network-Configuration/3.1-Disable-unused-network-protocols-and-devices/3.1.3-Ensure-dccp-is-disabled/","title":"3.1.3 Ensure DCCP is disabled","text":"","tags":["Level 2","Workstation","Server","Network Configuration","Disable unused network protocols and devices","Automated","IG2","IG3","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","T1068","T1210","TA0008","M1042"]},{"location":"3-Network-Configuration/3.1-Disable-unused-network-protocols-and-devices/3.1.3-Ensure-dccp-is-disabled/#audit","title":"Audit","text":"<p>Run the following script to verify dccp is disabled: <pre><code>#!/usr/bin/env bash\n{\nl_output=\"\" l_output2=\"\"\nl_mname=\"dccp\" # set module name\n# Check if the module exists on the system\nif [ -z \"$(modprobe -n -v \"$l_mname\" 2&gt;&amp;1 | grep -Pi -- \"\\h*modprobe:\\h+FATAL:\\h+Module\\h+$l_mname\\h+not\\h+found\\h+in\\h+directory\")\" ]; then\n# Check how module will be loaded\nl_loadable=\"$(modprobe -n -v \"$l_mname\")\"\n[ \"$(wc -l &lt;&lt;&lt; \"$l_loadable\")\" -gt \"1\" ] &amp;&amp; l_loadable=\"$(grep -P -- \"(^\\h*install \\b$l_mname)\\b\" &lt;&lt;&lt; \"$l_loadable\")\"\nif grep -Pq -- '^\\h*install \\/bin\\/(true|false)' &lt;&lt;&lt; \"$l_loadable\"; then\nl_output=\"$l_output\\n - module: \\\"$l_mname\\\" is not loadable: \\\"$l_loadable\\\"\"\nelse\nl_output2=\"$l_output2\\n - module: \\\"$l_mname\\\" is loadable: \\\"$l_loadable\\\"\"\nfi\n# Check is the module currently loaded\nif ! lsmod | grep \"$l_mname\" &gt; /dev/null 2&gt;&amp;1; then\nl_output=\"$l_output\\n - module: \\\"$l_mname\\\" is not loaded\"\nelse\nl_output2=\"$l_output2\\n - module: \\\"$l_mname\\\" is loaded\"\nfi\n# Check if the module is deny listed\nif modprobe --showconfig | grep -Pq -- \"^\\h*blacklist\\h+$(tr '-' '_' &lt;&lt;&lt; \"$l_mname\")\\b\"; then\nl_output=\"$l_output\\n - module: \\\"$l_mname\\\" is deny listed in: \\\"$(grep -Pl -- \"^\\h*blacklist\\h+$l_mname\\b\" /etc/modprobe.d/*)\\\"\"\nelse\nl_output2=\"$l_output2\\n - module: \\\"$l_mname\\\" is not deny listed\"\nfi\nelse\nl_output=\"$l_output\\n - Module \\\"$l_mname\\\" doesn't exist on the system\"\nfi\n# Report results. If no failures output in l_output2, we pass\nif [ -z \"$l_output2\" ]; then\necho -e \"\\n- Audit Result:\\n ** PASS **\\n$l_output\\n\"\nelse\necho -e \"\\n- Audit Result:\\n ** FAIL **\\n - Reason(s) for audit failure:\\n$l_output2\\n\"\n[ -n \"$l_output\" ] &amp;&amp; echo -e \"\\n- Correctly set:\\n$l_output\\n\"\nfi\n}\n</code></pre></p>","tags":["Level 2","Workstation","Server","Network Configuration","Disable unused network protocols and devices","Automated","IG2","IG3","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","T1068","T1210","TA0008","M1042"]},{"location":"3-Network-Configuration/3.1-Disable-unused-network-protocols-and-devices/3.1.3-Ensure-dccp-is-disabled/#remediation","title":"Remediation","text":"<p>Run the following script to disable dccp: <pre><code>#!/usr/bin/env bash\n{\nl_mname=\"dccp\" # set module name\n# Check if the module exists on the system\nif [ -z \"$(modprobe -n -v \"$l_mname\" 2&gt;&amp;1 | grep -Pi -- \"\\h*modprobe:\\h+FATAL:\\h+Module\\h+$l_mname\\h+not\\h+found\\h+in\\h+directory\")\" ]; then\n# Remediate loadable\nl_loadable=\"$(modprobe -n -v \"$l_mname\")\"\n[ \"$(wc -l &lt;&lt;&lt; \"$l_loadable\")\" -gt \"1\" ] &amp;&amp; l_loadable=\"$(grep -P -- \"(^\\h*install|\\b$l_mname)\\b\" &lt;&lt;&lt; \"$l_loadable\")\"\nif ! grep -Pq -- '^\\h*install \\/bin\\/(true|false)' &lt;&lt;&lt; \"$l_loadable\"; then\necho -e \" - setting module: \\\"$l_mname\\\" to be not loadable\"\necho -e \"install $l_mname /bin/false\" &gt;&gt; /etc/modprobe.d/\"$l_mname\".conf\n fi\n# Remediate loaded\nif lsmod | grep \"$l_mname\" &gt; /dev/null 2&gt;&amp;1; then\necho -e \" - unloading module \\\"$l_mname\\\"\"\nmodprobe -r \"$l_mname\"\nfi\n# Remediate deny list\nif ! modprobe --showconfig | grep -Pq -- \"^\\h*blacklist\\h+$(tr '-' '_' &lt;&lt;&lt; \"$l_mname\")\\b\"; then\necho -e \" - deny listing \\\"$l_mname\\\"\"\necho -e \"blacklist $l_mname\" &gt;&gt; /etc/modprobe.d/\"$l_mname\".conf\n fi\nelse\necho -e \" - Nothing to remediate\\n - Module \\\"$l_mname\\\" doesn't exist on the system\"\nfi\n}\n</code></pre></p>","tags":["Level 2","Workstation","Server","Network Configuration","Disable unused network protocols and devices","Automated","IG2","IG3","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","T1068","T1210","TA0008","M1042"]},{"location":"3-Network-Configuration/3.1-Disable-unused-network-protocols-and-devices/3.1.4-Ensure-sctp-is-disabled/","title":"3.1.4 Ensure SCTP is disabled","text":"","tags":["Level 2","Workstation","Server","Network Configuration","Disable unused network protocols and devices","Automated","IG2","IG3","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","T1068","T1210","TA0008","M1042"]},{"location":"3-Network-Configuration/3.1-Disable-unused-network-protocols-and-devices/3.1.4-Ensure-sctp-is-disabled/#audit","title":"Audit","text":"<p>Run the following script to verify sctp is disabled: <pre><code>#!/usr/bin/env bash\n{\nl_output=\"\" l_output2=\"\"\nl_mname=\"sctp\" # set module name\n# Check if the module exists on the system\nif [ -z \"$(modprobe -n -v \"$l_mname\" 2&gt;&amp;1 | grep -Pi -- \"\\h*modprobe:\\h+FATAL:\\h+Module\\h+$l_mname\\h+not\\h+found\\h+in\\h+directory\")\" ]; then\n# Check how module will be loaded\nl_loadable=\"$(modprobe -n -v \"$l_mname\")\"\n[ \"$(wc -l &lt;&lt;&lt; \"$l_loadable\")\" -gt \"1\" ] &amp;&amp; l_loadable=\"$(grep -P -- \"(^\\h*install|\\b$l_mname)\\b\" &lt;&lt;&lt; \"$l_loadable\")\"\nif grep -Pq -- '^\\h*install \\/bin\\/(true|false)' &lt;&lt;&lt; \"$l_loadable\"; then\nl_output=\"$l_output\\n - module: \\\"$l_mname\\\" is not loadable: \\\"$l_loadable\\\"\"\nelse\nl_output2=\"$l_output2\\n - module: \\\"$l_mname\\\" is loadable: \\\"$l_loadable\\\"\"\nfi\n# Check is the module currently loaded\nif ! lsmod | grep \"$l_mname\" &gt; /dev/null 2&gt;&amp;1; then\nl_output=\"$l_output\\n - module: \\\"$l_mname\\\" is not loaded\"\nelse\nl_output2=\"$l_output2\\n - module: \\\"$l_mname\\\" is loaded\"\nfi\n# Check if the module is deny listed\nif modprobe --showconfig | grep -Pq -- \"^\\h*blacklist\\h+$l_mname\\b\"; then\nl_output=\"$l_output\\n - module: \\\"$l_mname\\\" is deny listed in: \\\"$(grep -Pl -- \"^\\h*blacklist\\h+$l_mname\\b\" /etc/modprobe.d/*)\\\"\"\nelse\nl_output2=\"$l_output2\\n - module: \\\"$l_mname\\\" is not deny listed\"\nfi\nelse\nl_output=\"$l_output\\n - Module \\\"$l_mname\\\" doesn't exist on the system\"\nfi\n# Report results. If no failures output in l_output2, we pass\nif [ -z \"$l_output2\" ]; then\necho -e \"\\n- Audit Result:\\n ** PASS **\\n$l_output\\n\"\nelse\necho -e \"\\n- Audit Result:\\n ** FAIL **\\n - Reason(s) for audit failure:\\n$l_output2\\n\"\n[ -n \"$l_output\" ] &amp;&amp; echo -e \"\\n- Correctly set:\\n$l_output\\n\"\nfi\n}\n</code></pre></p>","tags":["Level 2","Workstation","Server","Network Configuration","Disable unused network protocols and devices","Automated","IG2","IG3","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","T1068","T1210","TA0008","M1042"]},{"location":"3-Network-Configuration/3.1-Disable-unused-network-protocols-and-devices/3.1.4-Ensure-sctp-is-disabled/#remediation","title":"Remediation","text":"<p>Run the following script to disable sctp: <pre><code>#!/usr/bin/env bash\n{\nl_mname=\"sctp\" # set module name\n# Check if the module exists on the system\nif [ -z \"$(modprobe -n -v \"$l_mname\" 2&gt;&amp;1 | grep -Pi -- \"\\h*modprobe:\\h+FATAL:\\h+Module\\h+$l_mname\\h+not\\h+found\\h+in\\h+directory\")\" ]; then\n# Remediate loadable\nl_loadable=\"$(modprobe -n -v \"$l_mname\")\"\n[ \"$(wc -l &lt;&lt;&lt; \"$l_loadable\")\" -gt \"1\" ] &amp;&amp; l_loadable=\"$(grep -P -- \"(^\\h*install|\\b$l_mname)\\b\" &lt;&lt;&lt; \"$l_loadable\")\"\nif ! grep -Pq -- '^\\h*install \\/bin\\/(true|false)' &lt;&lt;&lt; \"$l_loadable\"; then\necho -e \" - setting module: \\\"$l_mname\\\" to be not loadable\"\necho -e \"install $l_mname /bin/false\" &gt;&gt; /etc/modprobe.d/\"$l_mname\".conf\n fi\n# Remediate loaded\nif lsmod | grep \"$l_mname\" &gt; /dev/null 2&gt;&amp;1; then\necho -e \" - unloading module \\\"$l_mname\\\"\"\nmodprobe -r \"$l_mname\"\nfi\n# Remediate deny list\nif ! modprobe --showconfig | grep -Pq -- \"^\\h*blacklist\\h+$l_mname\\b\"; then\necho -e \" - deny listing \\\"$l_mname\\\"\"\necho -e \"blacklist $l_mname\" &gt;&gt; /etc/modprobe.d/\"$l_mname\".conf\n fi\nelse\necho -e \" - Nothing to remediate\\n - Module \\\"$l_mname\\\" doesn't exist on the system\"\nfi\n}\n</code></pre></p>","tags":["Level 2","Workstation","Server","Network Configuration","Disable unused network protocols and devices","Automated","IG2","IG3","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","T1068","T1210","TA0008","M1042"]},{"location":"3-Network-Configuration/3.1-Disable-unused-network-protocols-and-devices/3.1.5-Ensure-rds-is-disabled/","title":"3.1.5 Ensure RDS is disabled","text":"","tags":["Level 2","Workstation","Server","Network Configuration","Disable unused network protocols and devices","Automated","IG2","IG3","T1068","T1210","TA0008","M1042"]},{"location":"3-Network-Configuration/3.1-Disable-unused-network-protocols-and-devices/3.1.5-Ensure-rds-is-disabled/#audit","title":"Audit","text":"<p>Run the following script to verify rds is disabled: <pre><code>#!/usr/bin/env bash\n{\nl_output=\"\" l_output2=\"\"\nl_mname=\"rds\" # set module name\n# Check if the module exists on the system\nif [ -z \"$(modprobe -n -v \"$l_mname\" 2&gt;&amp;1 | grep -Pi -- \"\\h*modprobe:\\h+FATAL:\\h+Module\\h+$l_mname\\h+not\\h+found\\h+in\\h+directory\")\" ]; then\n# Check how module will be loaded\nl_loadable=\"$(modprobe -n -v \"$l_mname\")\"\n[ \"$(wc -l &lt;&lt;&lt; \"$l_loadable\")\" -gt \"1\" ] &amp;&amp; l_loadable=\"$(grep -P -- \"(^\\h*install|\\b$l_mname)\\b\" &lt;&lt;&lt; \"$l_loadable\")\"\nif grep -Pq -- '^\\h*install \\/bin\\/(true|false)' &lt;&lt;&lt; \"$l_loadable\"; then\nl_output=\"$l_output\\n - module: \\\"$l_mname\\\" is not loadable: \\\"$l_loadable\\\"\"\nelse\nl_output2=\"$l_output2\\n - module: \\\"$l_mname\\\" is loadable: \\\"$l_loadable\\\"\"\nfi\n# Check is the module currently loaded\nif ! lsmod | grep \"$l_mname\" &gt; /dev/null 2&gt;&amp;1; then\nl_output=\"$l_output\\n - module: \\\"$l_mname\\\" is not loaded\"\nelse\nl_output2=\"$l_output2\\n - module: \\\"$l_mname\\\" is loaded\"\nfi\n# Check if the module is deny listed\nif modprobe --showconfig | grep -Pq -- \"^\\h*blacklist\\h+$l_mname\\b\"; then\nl_output=\"$l_output\\n - module: \\\"$l_mname\\\" is deny listed in: \\\"$(grep -Pl -- \"^\\h*blacklist\\h+$l_mname\\b\" /etc/modprobe.d/*)\\\"\"\nelse\nl_output2=\"$l_output2\\n - module: \\\"$l_mname\\\" is not deny listed\"\nfi\nelse\nl_output=\"$l_output\\n - Module \\\"$l_mname\\\" doesn't exist on the system\"\nfi\n# Report results. If no failures output in l_output2, we pass\nif [ -z \"$l_output2\" ]; then\necho -e \"\\n- Audit Result:\\n ** PASS **\\n$l_output\\n\"\nelse\necho -e \"\\n- Audit Result:\\n ** FAIL **\\n - Reason(s) for audit failure:\\n$l_output2\\n\"\n[ -n \"$l_output\" ] &amp;&amp; echo -e \"\\n- Correctly set:\\n$l_output\\n\"\nfi\n}\n</code></pre></p>","tags":["Level 2","Workstation","Server","Network Configuration","Disable unused network protocols and devices","Automated","IG2","IG3","T1068","T1210","TA0008","M1042"]},{"location":"3-Network-Configuration/3.1-Disable-unused-network-protocols-and-devices/3.1.5-Ensure-rds-is-disabled/#remediation","title":"Remediation","text":"<p>Run the following script to disable rds: <pre><code>#!/usr/bin/env bash\n{\nl_mname=\"rds\" # set module name\n# Check if the module exists on the system\nif [ -z \"$(modprobe -n -v \"$l_mname\" 2&gt;&amp;1 | grep -Pi -- \"\\h*modprobe:\\h+FATAL:\\h+Module\\h+$l_mname\\h+not\\h+found\\h+in\\h+directory\")\" ]; then\n# Remediate loadable\nl_loadable=\"$(modprobe -n -v \"$l_mname\")\"\n[ \"$(wc -l &lt;&lt;&lt; \"$l_loadable\")\" -gt \"1\" ] &amp;&amp; l_loadable=\"$(grep -P -- \"(^\\h*install|\\b$l_mname)\\b\" &lt;&lt;&lt; \"$l_loadable\")\"\nif ! grep -Pq -- '^\\h*install \\/bin\\/(true|false)' &lt;&lt;&lt; \"$l_loadable\"; then\necho -e \" - setting module: \\\"$l_mname\\\" to be not loadable\"\necho -e \"install $l_mname /bin/false\" &gt;&gt; /etc/modprobe.d/\"$l_mname\".conf\n fi\n# Remediate loaded\nif lsmod | grep \"$l_mname\" &gt; /dev/null 2&gt;&amp;1; then\necho -e \" - unloading module \\\"$l_mname\\\"\"\nmodprobe -r \"$l_mname\"\nfi\n# Remediate deny list\nif ! modprobe --showconfig | grep -Pq -- \"^\\h*blacklist\\h+$l_mname\\b\"; then\necho -e \" - deny listing \\\"$l_mname\\\"\"\necho -e \"blacklist $l_mname\" &gt;&gt; /etc/modprobe.d/\"$l_mname\".conf\n fi\nelse\necho -e \" - Nothing to remediate\\n - Module \\\"$l_mname\\\" doesn't exist on the system\"\nfi\n}\n</code></pre></p>","tags":["Level 2","Workstation","Server","Network Configuration","Disable unused network protocols and devices","Automated","IG2","IG3","T1068","T1210","TA0008","M1042"]},{"location":"3-Network-Configuration/3.1-Disable-unused-network-protocols-and-devices/3.1.6-Ensure-tipc-is-disabled/","title":"3.1.6 Ensure TIPC is disabled","text":"","tags":["Level 2","Workstation","Server","Network Configuration","Disable unused network protocols and devices","Automated","IG2","IG3","T1068","T1210","TA0008","M1042"]},{"location":"3-Network-Configuration/3.1-Disable-unused-network-protocols-and-devices/3.1.6-Ensure-tipc-is-disabled/#audit","title":"Audit","text":"<p>Run the following script to verify tipc is disabled: <pre><code>#!/usr/bin/env bash\n{\nl_output=\"\" l_output2=\"\"\nl_mname=\"tipc\" # set module name\n# Check if the module exists on the system\nif [ -z \"$(modprobe -n -v \"$l_mname\" 2&gt;&amp;1 | grep -Pi -- \"\\h*modprobe:\\h+FATAL:\\h+Module\\h+$l_mname\\h+not\\h+found\\h+in\\h+directory\")\" ]; then\n# Check how module will be loaded\nl_loadable=\"$(modprobe -n -v \"$l_mname\")\"\n[ \"$(wc -l &lt;&lt;&lt; \"$l_loadable\")\" -gt \"1\" ] &amp;&amp; l_loadable=\"$(grep -P -- \"(^\\h*install|\\b$l_mname)\\b\" &lt;&lt;&lt; \"$l_loadable\")\"\nif grep -Pq -- '^\\h*install \\/bin\\/(true|false)' &lt;&lt;&lt; \"$l_loadable\"; then\nl_output=\"$l_output\\n - module: \\\"$l_mname\\\" is not loadable: \\\"$l_loadable\\\"\"\nelse\nl_output2=\"$l_output2\\n - module: \\\"$l_mname\\\" is loadable: \\\"$l_loadable\\\"\"\nfi\n# Check is the module currently loaded\nif ! lsmod | grep \"$l_mname\" &gt; /dev/null 2&gt;&amp;1; then\nl_output=\"$l_output\\n - module: \\\"$l_mname\\\" is not loaded\"\nelse\nl_output2=\"$l_output2\\n - module: \\\"$l_mname\\\" is loaded\"\nfi\n# Check if the module is deny listed\nif modprobe --showconfig | grep -Pq -- \"^\\h*blacklist\\h+$l_mname\\b\"; then\nl_output=\"$l_output\\n - module: \\\"$l_mname\\\" is deny listed in: \\\"$(grep -Pl -- \"^\\h*blacklist\\h+$l_mname\\b\" /etc/modprobe.d/*)\\\"\"\nelse\nl_output2=\"$l_output2\\n - module: \\\"$l_mname\\\" is not deny listed\"\nfi\nelse\nl_output=\"$l_output\\n - Module \\\"$l_mname\\\" doesn't exist on the system\"\nfi\n# Report results. If no failures output in l_output2, we pass\nif [ -z \"$l_output2\" ]; then\necho -e \"\\n- Audit Result:\\n ** PASS **\\n$l_output\\n\"\nelse\necho -e \"\\n- Audit Result:\\n ** FAIL **\\n - Reason(s) for audit failure:\\n$l_output2\\n\"\n[ -n \"$l_output\" ] &amp;&amp; echo -e \"\\n- Correctly set:\\n$l_output\\n\"\nfi\n}\n</code></pre></p>","tags":["Level 2","Workstation","Server","Network Configuration","Disable unused network protocols and devices","Automated","IG2","IG3","T1068","T1210","TA0008","M1042"]},{"location":"3-Network-Configuration/3.1-Disable-unused-network-protocols-and-devices/3.1.6-Ensure-tipc-is-disabled/#remediation","title":"Remediation","text":"<p>Run the following script to disable tipc: <pre><code>#!/usr/bin/env bash\n{\nl_mname=\"tipc\" # set module name\n# Check if the module exists on the system\nif [ -z \"$(modprobe -n -v \"$l_mname\" 2&gt;&amp;1 | grep -Pi -- \"\\h*modprobe:\\h+FATAL:\\h+Module\\h+$l_mname\\h+not\\h+found\\h+in\\h+directory\")\" ]; then\n# Remediate loadable\nl_loadable=\"$(modprobe -n -v \"$l_mname\")\"\n[ \"$(wc -l &lt;&lt;&lt; \"$l_loadable\")\" -gt \"1\" ] &amp;&amp; l_loadable=\"$(grep -P -- \"(^\\h*install|\\b$l_mname)\\b\" &lt;&lt;&lt; \"$l_loadable\")\"\nif ! grep -Pq -- '^\\h*install \\/bin\\/(true|false)' &lt;&lt;&lt; \"$l_loadable\"; then\necho -e \" - setting module: \\\"$l_mname\\\" to be not loadable\"\necho -e \"install $l_mname /bin/false\" &gt;&gt; /etc/modprobe.d/\"$l_mname\".conf\n fi\n# Remediate loaded\nif lsmod | grep \"$l_mname\" &gt; /dev/null 2&gt;&amp;1; then\necho -e \" - unloading module \\\"$l_mname\\\"\"\nmodprobe -r \"$l_mname\"\nfi\n# Remediate deny list\nif ! modprobe --showconfig | grep -Pq -- \"^\\h*blacklist\\h+$l_mname\\b\"; then\necho -e \" - deny listing \\\"$l_mname\\\"\"\necho -e \"blacklist $l_mname\" &gt;&gt; /etc/modprobe.d/\"$l_mname\".conf\n fi\nelse\necho -e \" - Nothing to remediate\\n - Module \\\"$l_mname\\\" doesn't exist on the system\"\nfi\n}\n</code></pre></p>","tags":["Level 2","Workstation","Server","Network Configuration","Disable unused network protocols and devices","Automated","IG2","IG3","T1068","T1210","TA0008","M1042"]},{"location":"3-Network-Configuration/3.2-Network-Parameters-%28Host-Only%29/3.2.1-Ensure-packet-redirect-sending-is-disabled/","title":"3.2.1 Ensure packet redirect sending is disabled","text":"","tags":["Level 1","Workstation","Server","Network Configuration","Network Parameters (Host Only)","Automated","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","IG2","IG3","T1557","TA0006","TA0009","M1030","M1042"]},{"location":"3-Network-Configuration/3.2-Network-Parameters-%28Host-Only%29/3.2.1-Ensure-packet-redirect-sending-is-disabled/#audit","title":"Audit","text":"<p>Run the following script to verify:</p> <p>net.ipv4.conf.all.send_redirects = 0</p> <p>net.ipv4.conf.default.send_redirects = 0</p> <pre><code>#!/usr/bin/env bash\n{\nl_output=\"\" l_output2=\"\"\nl_parlist=\"net.ipv4.conf.all.send_redirects=0 net.ipv4.conf.default.send_redirects=0\"\nl_searchloc=\"/run/sysctl.d/*.conf /etc/sysctl.d/*.conf /usr/local/lib/sysctl.d/*.conf /usr/lib/sysctl.d/*.conf /lib/sysctl.d/*.conf /etc/sysctl.conf $([ -f /etc/default/ufw ] &amp;&amp; awk -F= '/^\\s*IPT_SYSCTL=/{print $2}' /etc/default/ufw)\"\nKPC()\n{\nl_krp=\"$(sysctl \"$l_kpname\" | awk -F= '{print $2}' | xargs)\"\nl_pafile=\"$(grep -Psl -- \"^\\h*$l_kpname\\h*=\\h*$l_kpvalue\\b\\h*(#.*)?$\" $l_searchloc)\"\nl_fafile=\"$(grep -s -- \"^\\s*$l_kpname\" $l_searchloc | grep -Pv -- \"\\h*=\\h*$l_kpvalue\\b\\h*\" | awk -F: '{print $1}')\"\nif [ \"$l_krp\" = \"$l_kpvalue\" ]; then\nl_output=\"$l_output\\n - \\\"$l_kpname\\\" is set to \\\"$l_kpvalue\\\" in the running configuration\"\nelse\nl_output2=\"$l_output2\\n - \\\"$l_kpname\\\" is set to \\\"$l_krp\\\" in the running configuration\"\nfi\nif [ -n \"$l_pafile\" ]; then\nl_output=\"$l_output\\n - \\\"$l_kpname\\\" is set to \\\"$l_kpvalue\\\" in \\\"$l_pafile\\\"\"\nelse\nl_output2=\"$l_output2\\n - \\\"$l_kpname = $l_kpvalue\\\" is not set in a kernel parameter configuration file\"\nfi\n[ -n \"$l_fafile\" ] &amp;&amp; l_output2=\"$l_output2\\n - \\\"$l_kpname\\\" is set incorrectly in \\\"$l_fafile\\\"\"\n}\nfor l_kpe in $l_parlist; do\nl_kpname=\"$(awk -F= '{print $1}' &lt;&lt;&lt; \"$l_kpe\")\"\nl_kpvalue=\"$(awk -F= '{print $2}' &lt;&lt;&lt; \"$l_kpe\")\"\nKPC\n done\nif [ -z \"$l_output2\" ]; then\necho -e \"\\n- Audit Result:\\n ** PASS **\\n$l_output\\n\"\nelse\necho -e \"\\n- Audit Result:\\n ** FAIL **\\n - Reason(s) for audit failure:\\n$l_output2\\n\"\n[ -n \"$l_output\" ] &amp;&amp; echo -e \"\\n- Correctly set:\\n$l_output\\n\"\nfi\n}\n</code></pre>","tags":["Level 1","Workstation","Server","Network Configuration","Network Parameters (Host Only)","Automated","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","IG2","IG3","T1557","TA0006","TA0009","M1030","M1042"]},{"location":"3-Network-Configuration/3.2-Network-Parameters-%28Host-Only%29/3.2.1-Ensure-packet-redirect-sending-is-disabled/#remediation","title":"Remediation","text":"<p>Run the following script to set:</p> <p>net.ipv4.conf.all.send_redirects = 0</p> <p>net.ipv4.conf.default.send_redirects = 0</p> <pre><code>#!/usr/bin/env bash\n{\nl_output=\"\" l_output2=\"\"\nl_parlist=\"net.ipv4.conf.all.send_redirects=0 net.ipv4.conf.default.send_redirects=0\"\nl_searchloc=\"/run/sysctl.d/*.conf /etc/sysctl.d/*.conf /usr/local/lib/sysctl.d/*.conf /usr/lib/sysctl.d/*.conf /lib/sysctl.d/*.conf /etc/sysctl.conf $([ -f /etc/default/ufw ] &amp;&amp; awk -F= '/^\\s*IPT_SYSCTL=/{print $2}' /etc/default/ufw)\"\nl_kpfile=\"/etc/sysctl.d/60-netipv4_sysctl.conf\"\nKPF()\n{\n# comment out incorrect parameter(s) in kernel parameter file(s)\nl_fafile=\"$(grep -s -- \"^\\s*$l_kpname\" $l_searchloc | grep -Pv -- \"\\h*=\\h*$l_kpvalue\\b\\h*\" | awk -F: '{print $1}')\"\nfor l_bkpf in $l_fafile; do\necho -e \"\\n - Commenting out \\\"$l_kpname\\\" in \\\"$l_bkpf\\\"\"\nsed -ri \"/$l_kpname/s/^/# /\" \"$l_bkpf\"\ndone\n# Set correct parameter in a kernel parameter file\nif ! grep -Pslq -- \"^\\h*$l_kpname\\h*=\\h*$l_kpvalue\\b\\h*(#.*)?$\" $l_searchloc; then\necho -e \"\\n - Setting \\\"$l_kpname\\\" to \\\"$l_kpvalue\\\" in \\\"$l_kpfile\\\"\"\necho \"$l_kpname = $l_kpvalue\" &gt;&gt; \"$l_kpfile\"\nfi\n# Set correct parameter in active kernel parameters\nl_krp=\"$(sysctl \"$l_kpname\" | awk -F= '{print $2}' | xargs)\"\nif [ \"$l_krp\" != \"$l_kpvalue\" ]; then\necho -e \"\\n - Updating \\\"$l_kpname\\\" to \\\"$l_kpvalue\\\" in the active kernel parameters\"\nsysctl -w \"$l_kpname=$l_kpvalue\"\nsysctl -w \"$(awk -F'.' '{print $1\".\"$2\".route.flush=1\"}' &lt;&lt;&lt; \"$l_kpname\")\"\nfi\n}\nfor l_kpe in $l_parlist; do\nl_kpname=\"$(awk -F= '{print $1}' &lt;&lt;&lt; \"$l_kpe\")\"\nl_kpvalue=\"$(awk -F= '{print $2}' &lt;&lt;&lt; \"$l_kpe\")\"\nKPF\n done\n}\n</code></pre> <p>Default Value:</p> <p>net.ipv4.conf.all.send_redirects = 1</p> <p>net.ipv4.conf.default.send_redirects = 1</p>","tags":["Level 1","Workstation","Server","Network Configuration","Network Parameters (Host Only)","Automated","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","IG2","IG3","T1557","TA0006","TA0009","M1030","M1042"]},{"location":"3-Network-Configuration/3.2-Network-Parameters-%28Host-Only%29/3.2.2-Ensure-ip-forwarding-is-disabled/","title":"3.2.2 Ensure IP forwarding is disabled","text":"","tags":["Level 1","Workstation","Server","Network Configuration","Network Parameters (Host Only)","Automated","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","IG2","IG3","T1557","TA0006","TA0009","M1030","M1042"]},{"location":"3-Network-Configuration/3.2-Network-Parameters-%28Host-Only%29/3.2.2-Ensure-ip-forwarding-is-disabled/#audit","title":"Audit","text":"<p>Run the following script to verify:</p> <p>net.ipv4.ip_forward = 0</p> <p>net.ipv6.conf.all.forwarding = 0</p> <pre><code>#!/usr/bin/env bash\n{\nl_output=\"\" l_output2=\"\"\nl_parlist=\"net.ipv4.ip_forward=0 net.ipv6.conf.all.forwarding=0\"\nl_searchloc=\"/run/sysctl.d/*.conf /etc/sysctl.d/*.conf /usr/local/lib/sysctl.d/*.conf /usr/lib/sysctl.d/*.conf /lib/sysctl.d/*.conf /etc/sysctl.conf $([ -f /etc/default/ufw ] &amp;&amp; awk -F= '/^\\s*IPT_SYSCTL=/{print $2}' /etc/default/ufw)\"\nKPC()\n{\nl_krp=\"$(sysctl \"$l_kpname\" | awk -F= '{print $2}' | xargs)\"\nl_pafile=\"$(grep -Psl -- \"^\\h*$l_kpname\\h*=\\h*$l_kpvalue\\b\\h*(#.*)?$\" $l_searchloc)\"\nl_fafile=\"$(grep -s -- \"^\\s*$l_kpname\" $l_searchloc | grep -Pv -- \"\\h*=\\h*$l_kpvalue\\b\\h*\" | awk -F: '{print $1}')\"\nif [ \"$l_krp\" = \"$l_kpvalue\" ]; then\nl_output=\"$l_output\\n - \\\"$l_kpname\\\" is set to \\\"$l_kpvalue\\\" in the running configuration\"\nelse\nl_output2=\"$l_output2\\n - \\\"$l_kpname\\\" is set to \\\"$l_krp\\\" in the running configuration\"\nfi\nif [ -n \"$l_pafile\" ]; then\nl_output=\"$l_output\\n - \\\"$l_kpname\\\" is set to \\\"$l_kpvalue\\\" in \\\"$l_pafile\\\"\"\nelse\nl_output2=\"$l_output2\\n - \\\"$l_kpname = $l_kpvalue\\\" is not set in a kernel parameter configuration file\"\nfi\n[ -n \"$l_fafile\" ] &amp;&amp; l_output2=\"$l_output2\\n - \\\"$l_kpname\\\" is set incorrectly in \\\"$l_fafile\\\"\"\n}\nipv6_chk()\n{\nl_ipv6s=\"\"\ngrubfile=$(find /boot -type f \\( -name 'grubenv' -o -name 'grub.conf' -o -name 'grub.cfg' \\) -exec grep -Pl -- '^\\h*(kernelopts=|linux|kernel)' {} \\;)\nif [ -s \"$grubfile\" ]; then\n! grep -P -- \"^\\h*(kernelopts=|linux|kernel)\" \"$grubfile\" | grep -vq -- ipv6.disable=1 &amp;&amp; l_ipv6s=\"disabled\"\nfi\nif grep -Pqs -- \"^\\h*net\\.ipv6\\.conf\\.all\\.disable_ipv6\\h*=\\h*1\\h*(#.*)?$\" $l_searchloc &amp;&amp; grep -Pqs -- \"^\\h*net\\.ipv6\\.conf\\.default\\.disable_ipv6\\h*=\\h*1\\h*(#.*)?$\" $l_searchloc &amp;&amp; sysctl net.ipv6.conf.all.disable_ipv6 | grep -Pqs -- \"^\\h*net\\.ipv6\\.conf\\.all\\.disable_ipv6\\h*=\\h*1\\h*(#.*)?$\" &amp;&amp; sysctl net.ipv6.conf.default.disable_ipv6 | grep -Pqs -- \"^\\h*net\\.ipv6\\.conf\\.default\\.disable_ipv6\\h*=\\h*1\\h*(#.*)?$\"; then\nl_ipv6s=\"disabled\"\nfi\nif [ -n \"$l_ipv6s\" ]; then\nl_output=\"$l_output\\n - IPv6 is disabled on the system, \\\"$l_kpname\\\" is not applicable\"\nelse\nKPC\n fi\n}\nfor l_kpe in $l_parlist; do\nl_kpname=\"$(awk -F= '{print $1}' &lt;&lt;&lt; \"$l_kpe\")\"\nl_kpvalue=\"$(awk -F= '{print $2}' &lt;&lt;&lt; \"$l_kpe\")\"\nif grep -q '^net.ipv6.' &lt;&lt;&lt; \"$l_kpe\"; then\nipv6_chk\n else\nKPC\n fi\ndone\nif [ -z \"$l_output2\" ]; then\necho -e \"\\n- Audit Result:\\n ** PASS **\\n$l_output\\n\"\nelse\necho -e \"\\n- Audit Result:\\n ** FAIL **\\n - Reason(s) for audit failure:\\n$l_output2\\n\"\n[ -n \"$l_output\" ] &amp;&amp; echo -e \"\\n- Correctly set:\\n$l_output\\n\"\nfi\n}\n</code></pre>","tags":["Level 1","Workstation","Server","Network Configuration","Network Parameters (Host Only)","Automated","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","IG2","IG3","T1557","TA0006","TA0009","M1030","M1042"]},{"location":"3-Network-Configuration/3.2-Network-Parameters-%28Host-Only%29/3.2.2-Ensure-ip-forwarding-is-disabled/#remediation","title":"Remediation","text":"<p>Run the following script to set:</p> <p>net.ipv4.ip_forward = 0</p> <p>net.ipv6.conf.all.forwarding = 0</p> <pre><code>#!/usr/bin/env bash\n{\nl_output=\"\" l_output2=\"\"\nl_parlist=\"net.ipv4.ip_forward=0 net.ipv6.conf.all.forwarding=0\"\nl_searchloc=\"/run/sysctl.d/*.conf /etc/sysctl.d/*.conf /usr/local/lib/sysctl.d/*.conf /usr/lib/sysctl.d/*.conf /lib/sysctl.d/*.conf /etc/sysctl.conf $([ -f /etc/default/ufw ] &amp;&amp; awk -F= '/^\\s*IPT_SYSCTL=/{print $2}' /etc/default/ufw)\"\nKPF()\n{\n# comment out incorrect parameter(s) in kernel parameter file(s)\nl_fafile=\"$(grep -s -- \"^\\s*$l_kpname\" $l_searchloc | grep -Pv -- \"\\h*=\\h*$l_kpvalue\\b\\h*\" | awk -F: '{print $1}')\"\nfor l_bkpf in $l_fafile; do\necho -e \"\\n - Commenting out \\\"$l_kpname\\\" in \\\"$l_bkpf\\\"\"\nsed -ri \"/$l_kpname/s/^/# /\" \"$l_bkpf\"\ndone\n# Set correct parameter in a kernel parameter file\nif ! grep -Pslq -- \"^\\h*$l_kpname\\h*=\\h*$l_kpvalue\\b\\h*(#.*)?$\" $l_searchloc; then\necho -e \"\\n - Setting \\\"$l_kpname\\\" to \\\"$l_kpvalue\\\" in \\\"$l_kpfile\\\"\"\necho \"$l_kpname = $l_kpvalue\" &gt;&gt; \"$l_kpfile\"\nfi\n# Set correct parameter in active kernel parameters\nl_krp=\"$(sysctl \"$l_kpname\" | awk -F= '{print $2}' | xargs)\"\nif [ \"$l_krp\" != \"$l_kpvalue\" ]; then\necho -e \"\\n - Updating \\\"$l_kpname\\\" to \\\"$l_kpvalue\\\" in the active kernel parameters\"\nsysctl -w \"$l_kpname=$l_kpvalue\"\nsysctl -w \"$(awk -F'.' '{print $1\".\"$2\".route.flush=1\"}' &lt;&lt;&lt; \"$l_kpname\")\"\nfi\n}\nIPV6F_CHK()\n{\nl_ipv6s=\"\"\ngrubfile=$(find /boot -type f \\( -name 'grubenv' -o -name 'grub.conf' -o -name 'grub.cfg' \\) -exec grep -Pl -- '^\\h*(kernelopts=|linux|kernel)' {} \\;)\nif [ -s \"$grubfile\" ]; then\n! grep -P -- \"^\\h*(kernelopts=|linux|kernel)\" \"$grubfile\" | grep -vq -- ipv6.disable=1 &amp;&amp; l_ipv6s=\"disabled\"\nfi\nif grep -Pqs -- \"^\\h*net\\.ipv6\\.conf\\.all\\.disable_ipv6\\h*=\\h*1\\h*(#.*)?$\" $l_searchloc &amp;&amp; \\\ngrep -Pqs -- \"^\\h*net\\.ipv6\\.conf\\.default\\.disable_ipv6\\h*=\\h*1\\h*(#.*)?$\" $l_searchloc &amp;&amp; \\\nsysctl net.ipv6.conf.all.disable_ipv6 | grep -Pqs -- \"^\\h*net\\.ipv6\\.conf\\.all\\.disable_ipv6\\h*=\\h*1\\h*(#.*)?$\" &amp;&amp; \\\nsysctl net.ipv6.conf.default.disable_ipv6 | grep -Pqs -- \"^\\h*net\\.ipv6\\.conf\\.default\\.disable_ipv6\\h*=\\h*1\\h*(#.*)?$\"; then\nl_ipv6s=\"disabled\"\nfi\nif [ -n \"$l_ipv6s\" ]; then\necho -e \"\\n - IPv6 is disabled on the system, \\\"$l_kpname\\\" is not applicable\"\nelse\nKPF\n fi\n}\nfor l_kpe in $l_parlist; do\nl_kpname=\"$(awk -F= '{print $1}' &lt;&lt;&lt; \"$l_kpe\")\"\nl_kpvalue=\"$(awk -F= '{print $2}' &lt;&lt;&lt; \"$l_kpe\")\"\nif grep -q '^net.ipv6.' &lt;&lt;&lt; \"$l_kpe\"; then\nl_kpfile=\"/etc/sysctl.d/60-netipv6_sysctl.conf\"\nIPV6F_CHK\n else\nl_kpfile=\"/etc/sysctl.d/60-netipv4_sysctl.conf\"\nKPF\n fi\ndone\n}\n</code></pre> <p>Default Value:</p> <p>net.ipv4.ip_forward = 0</p> <p>net.ipv6.conf.all.forwarding = 0</p>","tags":["Level 1","Workstation","Server","Network Configuration","Network Parameters (Host Only)","Automated","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","IG2","IG3","T1557","TA0006","TA0009","M1030","M1042"]},{"location":"3-Network-Configuration/3.3-Network-Parameters-%28Host-and-Router%29/3.3.1-Ensure-source-routed-packets-are-not-accepted/","title":"3.3.1 Ensure source routed packets are not accepted","text":"","tags":["Level 1","Workstation","Server","Network Configuration","Network Parameters (Host and Router)","Automated","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","IG2","IG3","T1590","T1590.005","TA0007"]},{"location":"3-Network-Configuration/3.3-Network-Parameters-%28Host-and-Router%29/3.3.1-Ensure-source-routed-packets-are-not-accepted/#audit","title":"Audit","text":"<p>Run the following script to verify:</p> <p>net.ipv4.conf.all.accept_source_route = 0</p> <p>net.ipv4.conf.default.accept_source_route = 0</p> <p>net.ipv6.conf.all.accept_source_route = 0</p> <p>net.ipv6.conf.default.accept_source_route = 0</p> <pre><code>#!/usr/bin/env bash\n{\nl_output=\"\" l_output2=\"\"\nl_parlist=\"net.ipv4.conf.all.accept_source_route=0 net.ipv4.conf.default.accept_source_route=0 net.ipv6.conf.all.accept_source_route=0 net.ipv6.conf.default.accept_source_route=0\"\nl_searchloc=\"/run/sysctl.d/*.conf /etc/sysctl.d/*.conf /usr/local/lib/sysctl.d/*.conf /usr/lib/sysctl.d/*.conf /lib/sysctl.d/*.conf /etc/sysctl.conf $([ -f /etc/default/ufw ] &amp;&amp; awk -F= '/^\\s*IPT_SYSCTL=/{print $2}' /etc/default/ufw)\"\nKPC()\n{\nl_krp=\"$(sysctl \"$l_kpname\" | awk -F= '{print $2}' | xargs)\"\nl_pafile=\"$(grep -Psl -- \"^\\h*$l_kpname\\h*=\\h*$l_kpvalue\\b\\h*(#.*)?$\" $l_searchloc)\"\nl_fafile=\"$(grep -s -- \"^\\s*$l_kpname\" $l_searchloc | grep -Pv -- \"\\h*=\\h*$l_kpvalue\\b\\h*\" | awk -F: '{print $1}')\"\nif [ \"$l_krp\" = \"$l_kpvalue\" ]; then\nl_output=\"$l_output\\n - \\\"$l_kpname\\\" is set to \\\"$l_kpvalue\\\" in the running configuration\"\nelse\nl_output2=\"$l_output2\\n - \\\"$l_kpname\\\" is set to \\\"$l_krp\\\" in the running configuration\"\nfi\nif [ -n \"$l_pafile\" ]; then\nl_output=\"$l_output\\n - \\\"$l_kpname\\\" is set to \\\"$l_kpvalue\\\" in \\\"$l_pafile\\\"\"\nelse\nl_output2=\"$l_output2\\n - \\\"$l_kpname = $l_kpvalue\\\" is not set in a kernel parameter configuration file\"\nfi\n[ -n \"$l_fafile\" ] &amp;&amp; l_output2=\"$l_output2\\n - \\\"$l_kpname\\\" is set incorrectly in \\\"$l_fafile\\\"\"\n}\nipv6_chk()\n{\nl_ipv6s=\"\"\ngrubfile=$(find /boot -type f \\( -name 'grubenv' -o -name 'grub.conf' -o -name 'grub.cfg' \\) -exec grep -Pl -- '^\\h*(kernelopts=|linux|kernel)' {} \\;)\nif [ -s \"$grubfile\" ]; then\n! grep -P -- \"^\\h*(kernelopts=|linux|kernel)\" \"$grubfile\" | grep -vq -- ipv6.disable=1 &amp;&amp; l_ipv6s=\"disabled\"\nfi\nif grep -Pqs -- \"^\\h*net\\.ipv6\\.conf\\.all\\.disable_ipv6\\h*=\\h*1\\h*(#.*)?$\" $l_searchloc &amp;&amp; grep -Pqs -- \"^\\h*net\\.ipv6\\.conf\\.default\\.disable_ipv6\\h*=\\h*1\\h*(#.*)?$\" $l_searchloc &amp;&amp; sysctl net.ipv6.conf.all.disable_ipv6 | grep -Pqs -- \"^\\h*net\\.ipv6\\.conf\\.all\\.disable_ipv6\\h*=\\h*1\\h*(#.*)?$\" &amp;&amp; sysctl net.ipv6.conf.default.disable_ipv6 | grep -Pqs -- \"^\\h*net\\.ipv6\\.conf\\.default\\.disable_ipv6\\h*=\\h*1\\h*(#.*)?$\"; then\nl_ipv6s=\"disabled\"\nfi\nif [ -n \"$l_ipv6s\" ]; then\nl_output=\"$l_output\\n - IPv6 is disabled on the system, \\\"$l_kpname\\\" is not applicable\"\nelse\nKPC\n fi\n}\nfor l_kpe in $l_parlist; do\nl_kpname=\"$(awk -F= '{print $1}' &lt;&lt;&lt; \"$l_kpe\")\"\nl_kpvalue=\"$(awk -F= '{print $2}' &lt;&lt;&lt; \"$l_kpe\")\"\nif grep -q '^net.ipv6.' &lt;&lt;&lt; \"$l_kpe\"; then\nipv6_chk\n else\nKPC\n fi\ndone\nif [ -z \"$l_output2\" ]; then\necho -e \"\\n- Audit Result:\\n ** PASS **\\n$l_output\\n\"\nelse\necho -e \"\\n- Audit Result:\\n ** FAIL **\\n - Reason(s) for audit failure:\\n$l_output2\\n\"\n[ -n \"$l_output\" ] &amp;&amp; echo -e \"\\n- Correctly set:\\n$l_output\\n\"\nfi\n}\n</code></pre>","tags":["Level 1","Workstation","Server","Network Configuration","Network Parameters (Host and Router)","Automated","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","IG2","IG3","T1590","T1590.005","TA0007"]},{"location":"3-Network-Configuration/3.3-Network-Parameters-%28Host-and-Router%29/3.3.1-Ensure-source-routed-packets-are-not-accepted/#remediation","title":"Remediation","text":"<p>Run the following script to set:</p> <p>net.ipv4.conf.all.accept_source_route = 0</p> <p>net.ipv4.conf.default.accept_source_route = 0</p> <p>net.ipv6.conf.all.accept_source_route = 0</p> <p>net.ipv6.conf.default.accept_source_route = 0</p> <pre><code>#!/usr/bin/env bash\n{\nl_output=\"\" l_output2=\"\"\nl_parlist=\"net.ipv4.conf.all.accept_source_route=0 net.ipv4.conf.default.accept_source_route=0 net.ipv6.conf.all.accept_source_route=0\nnet.ipv6.conf.default.accept_source_route=0\"\nl_searchloc=\"/run/sysctl.d/*.conf /etc/sysctl.d/*.conf /usr/local/lib/sysctl.d/*.conf /usr/lib/sysctl.d/*.conf /lib/sysctl.d/*.conf /etc/sysctl.conf $([ -f /etc/default/ufw ] &amp;&amp; awk -F= '/^\\s*IPT_SYSCTL=/{print $2}' /etc/default/ufw)\"\nKPF()\n{\n# comment out incorrect parameter(s) in kernel parameter file(s)\nl_fafile=\"$(grep -s -- \"^\\s*$l_kpname\" $l_searchloc | grep -Pv -- \"\\h*=\\h*$l_kpvalue\\b\\h*\" | awk -F: '{print $1}')\"\nfor l_bkpf in $l_fafile; do\necho -e \"\\n - Commenting out \\\"$l_kpname\\\" in \\\"$l_bkpf\\\"\"\nsed -ri \"/$l_kpname/s/^/# /\" \"$l_bkpf\"\ndone\n# Set correct parameter in a kernel parameter file\nif ! grep -Pslq -- \"^\\h*$l_kpname\\h*=\\h*$l_kpvalue\\b\\h*(#.*)?$\" $l_searchloc; then\necho -e \"\\n - Setting \\\"$l_kpname\\\" to \\\"$l_kpvalue\\\" in \\\"$l_kpfile\\\"\"\necho \"$l_kpname = $l_kpvalue\" &gt;&gt; \"$l_kpfile\"\nfi\n# Set correct parameter in active kernel parameters\nl_krp=\"$(sysctl \"$l_kpname\" | awk -F= '{print $2}' | xargs)\"\nif [ \"$l_krp\" != \"$l_kpvalue\" ]; then\necho -e \"\\n - Updating \\\"$l_kpname\\\" to \\\"$l_kpvalue\\\" in the active kernel parameters\"\nsysctl -w \"$l_kpname=$l_kpvalue\"\nsysctl -w \"$(awk -F'.' '{print $1\".\"$2\".route.flush=1\"}' &lt;&lt;&lt; \"$l_kpname\")\"\nfi\n}\nIPV6F_CHK()\n{\nl_ipv6s=\"\"\ngrubfile=$(find /boot -type f \\( -name 'grubenv' -o -name 'grub.conf' -o -name 'grub.cfg' \\) -exec grep -Pl -- '^\\h*(kernelopts=|linux|kernel)' {} \\;)\nif [ -s \"$grubfile\" ]; then\n! grep -P -- \"^\\h*(kernelopts=|linux|kernel)\" \"$grubfile\" | grep -vq -- ipv6.disable=1 &amp;&amp; l_ipv6s=\"disabled\"\nfi\nif grep -Pqs -- \"^\\h*net\\.ipv6\\.conf\\.all\\.disable_ipv6\\h*=\\h*1\\h*(#.*)?$\" $l_searchloc &amp;&amp; \\\ngrep -Pqs -- \"^\\h*net\\.ipv6\\.conf\\.default\\.disable_ipv6\\h*=\\h*1\\h*(#.*)?$\" $l_searchloc\n&amp;&amp; \\\nsysctl net.ipv6.conf.all.disable_ipv6 | grep -Pqs -- \"^\\h*net\\.ipv6\\.conf\\.all\\.disable_ipv6\\h*=\\h*1\\h*(#.*)?$\" &amp;&amp; \\\nsysctl net.ipv6.conf.default.disable_ipv6 | grep -Pqs --\n\"^\\h*net\\.ipv6\\.conf\\.default\\.disable_ipv6\\h*=\\h*1\\h*(#.*)?$\"; then\nl_ipv6s=\"disabled\"\nfi\nif [ -n \"$l_ipv6s\" ]; then\necho -e \"\\n - IPv6 is disabled on the system, \\\"$l_kpname\\\" is not applicable\"\nelse\nKPF\n fi\n}\nfor l_kpe in $l_parlist; do\nl_kpname=\"$(awk -F= '{print $1}' &lt;&lt;&lt; \"$l_kpe\")\"\nl_kpvalue=\"$(awk -F= '{print $2}' &lt;&lt;&lt; \"$l_kpe\")\"\nif grep -q '^net.ipv6.' &lt;&lt;&lt; \"$l_kpe\"; then\nl_kpfile=\"/etc/sysctl.d/60-netipv6_sysctl.conf\"\nIPV6F_CHK\n else\nl_kpfile=\"/etc/sysctl.d/60-netipv4_sysctl.conf\"\nKPF\n fi\ndone\n}\n</code></pre> <p>Default Value:</p> <p>net.ipv4.conf.all.accept_source_route = 0</p> <p>net.ipv4.conf.default.accept_source_route = 0</p> <p>net.ipv6.conf.all.accept_source_route = 0</p> <p>net.ipv6.conf.default.accept_source_route = 0</p>","tags":["Level 1","Workstation","Server","Network Configuration","Network Parameters (Host and Router)","Automated","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","IG2","IG3","T1590","T1590.005","TA0007"]},{"location":"3-Network-Configuration/3.3-Network-Parameters-%28Host-and-Router%29/3.3.2-Ensure-icmp-redirects-are-not-accepted/","title":"3.3.2 Ensure ICMP redirects are not accepted","text":"","tags":["Level 1","Workstation","Server","Network Configuration","Network Parameters (Host and Router)","Automated","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","IG2","IG3","T1557","TA0006","TA0007","M1030","M1042"]},{"location":"3-Network-Configuration/3.3-Network-Parameters-%28Host-and-Router%29/3.3.2-Ensure-icmp-redirects-are-not-accepted/#audit","title":"Audit","text":"<p>Run the following script to verify:</p> <p>net.ipv4.conf.all.accept_redirects = 0</p> <p>net.ipv4.conf.default.accept_redirects = 0</p> <p>net.ipv6.conf.all.accept_redirects = 0</p> <p>net.ipv6.conf.default.accept_redirects = 0</p> <pre><code>#!/usr/bin/env bash\n{\nl_output=\"\" l_output2=\"\"\nl_parlist=\"net.ipv4.conf.all.accept_redirects=0 net.ipv4.conf.default.accept_redirects=0 net.ipv6.conf.all.accept_redirects=0 net.ipv6.conf.default.accept_redirects=0\"\nl_searchloc=\"/run/sysctl.d/*.conf /etc/sysctl.d/*.conf /usr/local/lib/sysctl.d/*.conf /usr/lib/sysctl.d/*.conf /lib/sysctl.d/*.conf /etc/sysctl.conf $([ -f /etc/default/ufw ] &amp;&amp; awk -F= '/^\\s*IPT_SYSCTL=/{print $2}' /etc/default/ufw)\"\nKPC()\n{\nl_krp=\"$(sysctl \"$l_kpname\" | awk -F= '{print $2}' | xargs)\"\nl_pafile=\"$(grep -Psl -- \"^\\h*$l_kpname\\h*=\\h*$l_kpvalue\\b\\h*(#.*)?$\" $l_searchloc)\"\nl_fafile=\"$(grep -s -- \"^\\s*$l_kpname\" $l_searchloc | grep -Pv -- \"\\h*=\\h*$l_kpvalue\\b\\h*\" | awk -F: '{print $1}')\"\nif [ \"$l_krp\" = \"$l_kpvalue\" ]; then\nl_output=\"$l_output\\n - \\\"$l_kpname\\\" is set to \\\"$l_kpvalue\\\" in the running configuration\"\nelse\nl_output2=\"$l_output2\\n - \\\"$l_kpname\\\" is set to \\\"$l_krp\\\" in the running configuration\"\nfi\nif [ -n \"$l_pafile\" ]; then\nl_output=\"$l_output\\n - \\\"$l_kpname\\\" is set to \\\"$l_kpvalue\\\" in \\\"$l_pafile\\\"\"\nelse\nl_output2=\"$l_output2\\n - \\\"$l_kpname = $l_kpvalue\\\" is not set in a kernel parameter configuration file\"\nfi\n[ -n \"$l_fafile\" ] &amp;&amp; l_output2=\"$l_output2\\n - \\\"$l_kpname\\\" is set incorrectly in \\\"$l_fafile\\\"\"\n}\nipv6_chk()\n{\nl_ipv6s=\"\"\ngrubfile=$(find /boot -type f \\( -name 'grubenv' -o -name 'grub.conf' -o -name 'grub.cfg' \\) -exec grep -Pl -- '^\\h*(kernelopts=|linux|kernel)' {} \\;)\nif [ -s \"$grubfile\" ]; then\n! grep -P -- \"^\\h*(kernelopts=|linux|kernel)\" \"$grubfile\" | grep -vq -- ipv6.disable=1 &amp;&amp; l_ipv6s=\"disabled\"\nfi\nif grep -Pqs -- \"^\\h*net\\.ipv6\\.conf\\.all\\.disable_ipv6\\h*=\\h*1\\h*(#.*)?$\" $l_searchloc &amp;&amp; grep -Pqs -- \"^\\h*net\\.ipv6\\.conf\\.default\\.disable_ipv6\\h*=\\h*1\\h*(#.*)?$\" $l_searchloc &amp;&amp; sysctl net.ipv6.conf.all.disable_ipv6 | grep -Pqs -- \"^\\h*net\\.ipv6\\.conf\\.all\\.disable_ipv6\\h*=\\h*1\\h*(#.*)?$\" &amp;&amp; sysctl net.ipv6.conf.default.disable_ipv6 | grep -Pqs -- \"^\\h*net\\.ipv6\\.conf\\.default\\.disable_ipv6\\h*=\\h*1\\h*(#.*)?$\"; then\nl_ipv6s=\"disabled\"\nfi\nif [ -n \"$l_ipv6s\" ]; then\nl_output=\"$l_output\\n - IPv6 is disabled on the system, \\\"$l_kpname\\\" is not applicable\"\nelse\nKPC\n fi\n}\nfor l_kpe in $l_parlist; do\nl_kpname=\"$(awk -F= '{print $1}' &lt;&lt;&lt; \"$l_kpe\")\"\nl_kpvalue=\"$(awk -F= '{print $2}' &lt;&lt;&lt; \"$l_kpe\")\"\nif grep -q '^net.ipv6.' &lt;&lt;&lt; \"$l_kpe\"; then\nipv6_chk\n else\nKPC\n fi\ndone\nif [ -z \"$l_output2\" ]; then\necho -e \"\\n- Audit Result:\\n ** PASS **\\n$l_output\\n\"\nelse\necho -e \"\\n- Audit Result:\\n ** FAIL **\\n - Reason(s) for audit failure:\\n$l_output2\\n\"\n[ -n \"$l_output\" ] &amp;&amp; echo -e \"\\n- Correctly set:\\n$l_output\\n\"\nfi\n}\n</code></pre>","tags":["Level 1","Workstation","Server","Network Configuration","Network Parameters (Host and Router)","Automated","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","IG2","IG3","T1557","TA0006","TA0007","M1030","M1042"]},{"location":"3-Network-Configuration/3.3-Network-Parameters-%28Host-and-Router%29/3.3.2-Ensure-icmp-redirects-are-not-accepted/#remediation","title":"Remediation","text":"<p>Run the following script to set:</p> <p>net.ipv4.conf.all.accept_redirects = 0</p> <p>net.ipv4.conf.default.accept_redirects = 0</p> <p>net.ipv6.conf.all.accept_redirects = 0</p> <p>net.ipv6.conf.default.accept_redirects = 0</p> <pre><code>#!/usr/bin/env bash\n{\nl_output=\"\" l_output2=\"\"\nl_parlist=\"net.ipv4.conf.all.accept_redirects=0 net.ipv4.conf.default.accept_redirects=0 net.ipv6.conf.all.accept_redirects=0 net.ipv6.conf.default.accept_redirects=0\"\nl_searchloc=\"/run/sysctl.d/*.conf /etc/sysctl.d/*.conf /usr/local/lib/sysctl.d/*.conf /usr/lib/sysctl.d/*.conf /lib/sysctl.d/*.conf /etc/sysctl.conf $([ -f /etc/default/ufw ] &amp;&amp; awk -F= '/^\\s*IPT_SYSCTL=/{print $2}' /etc/default/ufw)\"\nKPF()\n{\n# comment out incorrect parameter(s) in kernel parameter file(s)\nl_fafile=\"$(grep -s -- \"^\\s*$l_kpname\" $l_searchloc | grep -Pv -- \"\\h*=\\h*$l_kpvalue\\b\\h*\" | awk -F: '{print $1}')\"\nfor l_bkpf in $l_fafile; do\necho -e \"\\n - Commenting out \\\"$l_kpname\\\" in \\\"$l_bkpf\\\"\"\nsed -ri \"/$l_kpname/s/^/# /\" \"$l_bkpf\"\ndone\n# Set correct parameter in a kernel parameter file\nif ! grep -Pslq -- \"^\\h*$l_kpname\\h*=\\h*$l_kpvalue\\b\\h*(#.*)?$\" $l_searchloc; then\necho -e \"\\n - Setting \\\"$l_kpname\\\" to \\\"$l_kpvalue\\\" in \\\"$l_kpfile\\\"\"\necho \"$l_kpname = $l_kpvalue\" &gt;&gt; \"$l_kpfile\"\nfi\n# Set correct parameter in active kernel parameters\nl_krp=\"$(sysctl \"$l_kpname\" | awk -F= '{print $2}' | xargs)\"\nif [ \"$l_krp\" != \"$l_kpvalue\" ]; then\necho -e \"\\n - Updating \\\"$l_kpname\\\" to \\\"$l_kpvalue\\\" in the active kernel parameters\"\nsysctl -w \"$l_kpname=$l_kpvalue\"\nsysctl -w \"$(awk -F'.' '{print $1\".\"$2\".route.flush=1\"}' &lt;&lt;&lt; \"$l_kpname\")\"\nfi\n}\nIPV6F_CHK()\n{\nl_ipv6s=\"\"\ngrubfile=$(find /boot -type f \\( -name 'grubenv' -o -name 'grub.conf' -o -name 'grub.cfg' \\) -exec grep -Pl -- '^\\h*(kernelopts=|linux|kernel)' {} \\;)\nif [ -s \"$grubfile\" ]; then\n! grep -P -- \"^\\h*(kernelopts=|linux|kernel)\" \"$grubfile\" | grep -vq -- ipv6.disable=1 &amp;&amp; l_ipv6s=\"disabled\"\nfi\nif grep -Pqs -- \"^\\h*net\\.ipv6\\.conf\\.all\\.disable_ipv6\\h*=\\h*1\\h*(#.*)?$\" $l_searchloc &amp;&amp; \\\ngrep -Pqs --\n\"^\\h*net\\.ipv6\\.conf\\.default\\.disable_ipv6\\h*=\\h*1\\h*(#.*)?$\" $l_searchloc\n&amp;&amp; \\\nsysctl net.ipv6.conf.all.disable_ipv6 | grep -Pqs -- \"^\\h*net\\.ipv6\\.conf\\.all\\.disable_ipv6\\h*=\\h*1\\h*(#.*)?$\" &amp;&amp; \\\nsysctl net.ipv6.conf.default.disable_ipv6 | grep -Pqs -- \"^\\h*net\\.ipv6\\.conf\\.default\\.disable_ipv6\\h*=\\h*1\\h*(#.*)?$\"; then\nl_ipv6s=\"disabled\"\nfi\nif [ -n \"$l_ipv6s\" ]; then\necho -e \"\\n - IPv6 is disabled on the system, \\\"$l_kpname\\\" is not applicable\"\nelse\nKPF\n fi\n}\nfor l_kpe in $l_parlist; do\nl_kpname=\"$(awk -F= '{print $1}' &lt;&lt;&lt; \"$l_kpe\")\"\nl_kpvalue=\"$(awk -F= '{print $2}' &lt;&lt;&lt; \"$l_kpe\")\"\nif grep -q '^net.ipv6.' &lt;&lt;&lt; \"$l_kpe\"; then\nl_kpfile=\"/etc/sysctl.d/60-netipv6_sysctl.conf\"\nIPV6F_CHK\n else\nl_kpfile=\"/etc/sysctl.d/60-netipv4_sysctl.conf\"\nKPF\n fi\ndone\n}\n</code></pre> <p>Default Value:</p> <p>net.ipv4.conf.all.accept_redirects = 1</p> <p>net.ipv4.conf.default.accept_redirects = 1</p> <p>net.ipv6.conf.all.accept_redirects = 1</p> <p>net.ipv6.conf.default.accept_redirects = 1</p>","tags":["Level 1","Workstation","Server","Network Configuration","Network Parameters (Host and Router)","Automated","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","IG2","IG3","T1557","TA0006","TA0007","M1030","M1042"]},{"location":"3-Network-Configuration/3.3-Network-Parameters-%28Host-and-Router%29/3.3.3-Ensure-secure-icmp-redirects-are-not-accepted/","title":"3.3.3 Ensure secure ICMP redirects are not accepted","text":"","tags":["Level 1","Workstation","Server","Network Configuration","Network Parameters (Host and Router)","Automated","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","IG2","IG3","T1557","TA0006","TA0009","M1030","M1042"]},{"location":"3-Network-Configuration/3.3-Network-Parameters-%28Host-and-Router%29/3.3.3-Ensure-secure-icmp-redirects-are-not-accepted/#audit","title":"Audit","text":"<p>Run the following script to verify:</p> <p>net.ipv4.conf.default.secure_redirects = 0</p> <p>net.ipv4.conf.all.secure_redirects = 0</p> <pre><code>#!/usr/bin/env bash\n{\nl_output=\"\" l_output2=\"\"\nl_parlist=\"net.ipv4.conf.default.secure_redirects=0 net.ipv4.conf.all.secure_redirects=0\"\nl_searchloc=\"/run/sysctl.d/*.conf /etc/sysctl.d/*.conf /usr/local/lib/sysctl.d/*.conf /usr/lib/sysctl.d/*.conf /lib/sysctl.d/*.conf /etc/sysctl.conf $([ -f /etc/default/ufw ] &amp;&amp; awk -F= '/^\\s*IPT_SYSCTL=/{print $2}' /etc/default/ufw)\"\nKPC()\n{\nl_krp=\"$(sysctl \"$l_kpname\" | awk -F= '{print $2}' | xargs)\"\nl_pafile=\"$(grep -Psl -- \"^\\h*$l_kpname\\h*=\\h*$l_kpvalue\\b\\h*(#.*)?$\" $l_searchloc)\"\nl_fafile=\"$(grep -s -- \"^\\s*$l_kpname\" $l_searchloc | grep -Pv -- \"\\h*=\\h*$l_kpvalue\\b\\h*\" | awk -F: '{print $1}')\"\nif [ \"$l_krp\" = \"$l_kpvalue\" ]; then\nl_output=\"$l_output\\n - \\\"$l_kpname\\\" is set to \\\"$l_kpvalue\\\" in the running configuration\"\nelse\nl_output2=\"$l_output2\\n - \\\"$l_kpname\\\" is set to \\\"$l_krp\\\" in the running configuration\"\nfi\nif [ -n \"$l_pafile\" ]; then\nl_output=\"$l_output\\n - \\\"$l_kpname\\\" is set to \\\"$l_kpvalue\\\" in \\\"$l_pafile\\\"\"\nelse\nl_output2=\"$l_output2\\n - \\\"$l_kpname = $l_kpvalue\\\" is not set in a kernel parameter configuration file\"\nfi\n[ -n \"$l_fafile\" ] &amp;&amp; l_output2=\"$l_output2\\n - \\\"$l_kpname\\\" is set incorrectly in \\\"$l_fafile\\\"\"\n}\nfor l_kpe in $l_parlist; do\nl_kpname=\"$(awk -F= '{print $1}' &lt;&lt;&lt; \"$l_kpe\")\"\nl_kpvalue=\"$(awk -F= '{print $2}' &lt;&lt;&lt; \"$l_kpe\")\"\nKPC\n done\nif [ -z \"$l_output2\" ]; then\necho -e \"\\n- Audit Result:\\n ** PASS **\\n$l_output\\n\"\nelse\necho -e \"\\n- Audit Result:\\n ** FAIL **\\n - Reason(s) for audit failure:\\n$l_output2\\n\"\n[ -n \"$l_output\" ] &amp;&amp; echo -e \"\\n- Correctly set:\\n$l_output\\n\"\nfi\n}\n</code></pre>","tags":["Level 1","Workstation","Server","Network Configuration","Network Parameters (Host and Router)","Automated","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","IG2","IG3","T1557","TA0006","TA0009","M1030","M1042"]},{"location":"3-Network-Configuration/3.3-Network-Parameters-%28Host-and-Router%29/3.3.3-Ensure-secure-icmp-redirects-are-not-accepted/#remediation","title":"Remediation","text":"<p>Run the following script to set:</p> <p>net.ipv4.conf.default.secure_redirects = 0</p> <p>net.ipv4.conf.all.secure_redirects = 0</p> <pre><code>#!/usr/bin/env bash\n{\nl_output=\"\" l_output2=\"\"\nl_parlist=\"net.ipv4.conf.default.secure_redirects=0 net.ipv4.conf.all.secure_redirects=0\"\nl_searchloc=\"/run/sysctl.d/*.conf /etc/sysctl.d/*.conf /usr/local/lib/sysctl.d/*.conf /usr/lib/sysctl.d/*.conf /lib/sysctl.d/*.conf /etc/sysctl.conf $([ -f /etc/default/ufw ] &amp;&amp; awk -F= '/^\\s*IPT_SYSCTL=/{print $2}' /etc/default/ufw)\"\nl_kpfile=\"/etc/sysctl.d/60-netipv4_sysctl.conf\"\nKPF()\n{\n# comment out incorrect parameter(s) in kernel parameter file(s)\nl_fafile=\"$(grep -s -- \"^\\s*$l_kpname\" $l_searchloc | grep -Pv -- \"\\h*=\\h*$l_kpvalue\\b\\h*\" | awk -F: '{print $1}')\"\nfor l_bkpf in $l_fafile; do\necho -e \"\\n - Commenting out \\\"$l_kpname\\\" in \\\"$l_bkpf\\\"\"\nsed -ri \"/$l_kpname/s/^/# /\" \"$l_bkpf\"\ndone\n# Set correct parameter in a kernel parameter file\nif ! grep -Pslq -- \"^\\h*$l_kpname\\h*=\\h*$l_kpvalue\\b\\h*(#.*)?$\" $l_searchloc; then\necho -e \"\\n - Setting \\\"$l_kpname\\\" to \\\"$l_kpvalue\\\" in \\\"$l_kpfile\\\"\"\necho \"$l_kpname = $l_kpvalue\" &gt;&gt; \"$l_kpfile\"\nfi\n# Set correct parameter in active kernel parameters\nl_krp=\"$(sysctl \"$l_kpname\" | awk -F= '{print $2}' | xargs)\"\nif [ \"$l_krp\" != \"$l_kpvalue\" ]; then\necho -e \"\\n - Updating \\\"$l_kpname\\\" to \\\"$l_kpvalue\\\" in the active kernel parameters\"\nsysctl -w \"$l_kpname=$l_kpvalue\"\nsysctl -w \"$(awk -F'.' '{print $1\".\"$2\".route.flush=1\"}' &lt;&lt;&lt; \"$l_kpname\")\"\nfi\n}\nfor l_kpe in $l_parlist; do\nl_kpname=\"$(awk -F= '{print $1}' &lt;&lt;&lt; \"$l_kpe\")\"\nl_kpvalue=\"$(awk -F= '{print $2}' &lt;&lt;&lt; \"$l_kpe\")\"\nKPF\n done\n}\n</code></pre> <p>Default Value:</p> <p>net.ipv4.conf.all.secure_redirects = 1</p> <p>net.ipv4.conf.default.secure_redirects = 1</p>","tags":["Level 1","Workstation","Server","Network Configuration","Network Parameters (Host and Router)","Automated","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","IG2","IG3","T1557","TA0006","TA0009","M1030","M1042"]},{"location":"3-Network-Configuration/3.3-Network-Parameters-%28Host-and-Router%29/3.3.4-Ensure-suspicious-packets-are-logged/","title":"3.3.4 Ensure suspicious packets are logged","text":"","tags":["Level 1","Workstation","Server","Network Configuration","Network Parameters (Host and Router)","Automated","8.5 Collect Detailed Audit Logs","IG2","IG3","T1562","T1562.006","TA0005"]},{"location":"3-Network-Configuration/3.3-Network-Parameters-%28Host-and-Router%29/3.3.4-Ensure-suspicious-packets-are-logged/#audit","title":"Audit","text":"<p>Run the following script to verify:</p> <p>net.ipv4.conf.all.log_martians = 1</p> <p>net.ipv4.conf.default.log_martians = 1</p> <pre><code>#!/usr/bin/env bash\n{\nl_output=\"\" l_output2=\"\"\nl_parlist=\"net.ipv4.conf.all.log_martians=1 net.ipv4.conf.default.log_martians=1\"\nl_searchloc=\"/run/sysctl.d/*.conf /etc/sysctl.d/*.conf /usr/local/lib/sysctl.d/*.conf /usr/lib/sysctl.d/*.conf /lib/sysctl.d/*.conf /etc/sysctl.conf $([ -f /etc/default/ufw ] &amp;&amp; awk -F= '/^\\s*IPT_SYSCTL=/{print $2}' /etc/default/ufw)\"\nKPC()\n{\nl_krp=\"$(sysctl \"$l_kpname\" | awk -F= '{print $2}' | xargs)\"\nl_pafile=\"$(grep -Psl -- \"^\\h*$l_kpname\\h*=\\h*$l_kpvalue\\b\\h*(#.*)?$\" $l_searchloc)\"\nl_fafile=\"$(grep -s -- \"^\\s*$l_kpname\" $l_searchloc | grep -Pv -- \"\\h*=\\h*$l_kpvalue\\b\\h*\" | awk -F: '{print $1}')\"\nif [ \"$l_krp\" = \"$l_kpvalue\" ]; then\nl_output=\"$l_output\\n - \\\"$l_kpname\\\" is set to \\\"$l_kpvalue\\\" in the running configuration\"\nelse\nl_output2=\"$l_output2\\n - \\\"$l_kpname\\\" is set to \\\"$l_krp\\\" in the running configuration\"\nfi\nif [ -n \"$l_pafile\" ]; then\nl_output=\"$l_output\\n - \\\"$l_kpname\\\" is set to \\\"$l_kpvalue\\\" in \\\"$l_pafile\\\"\"\nelse\nl_output2=\"$l_output2\\n - \\\"$l_kpname = $l_kpvalue\\\" is not set in a kernel parameter configuration file\"\nfi\n[ -n \"$l_fafile\" ] &amp;&amp; l_output2=\"$l_output2\\n - \\\"$l_kpname\\\" is set incorrectly in \\\"$l_fafile\\\"\"\n}\nfor l_kpe in $l_parlist; do\nl_kpname=\"$(awk -F= '{print $1}' &lt;&lt;&lt; \"$l_kpe\")\"\nl_kpvalue=\"$(awk -F= '{print $2}' &lt;&lt;&lt; \"$l_kpe\")\"\nKPC\n done\nif [ -z \"$l_output2\" ]; then\necho -e \"\\n- Audit Result:\\n ** PASS **\\n$l_output\\n\"\nelse\necho -e \"\\n- Audit Result:\\n ** FAIL **\\n - Reason(s) for audit failure:\\n$l_output2\\n\"\n[ -n \"$l_output\" ] &amp;&amp; echo -e \"\\n- Correctly set:\\n$l_output\\n\"\nfi\n}\n</code></pre>","tags":["Level 1","Workstation","Server","Network Configuration","Network Parameters (Host and Router)","Automated","8.5 Collect Detailed Audit Logs","IG2","IG3","T1562","T1562.006","TA0005"]},{"location":"3-Network-Configuration/3.3-Network-Parameters-%28Host-and-Router%29/3.3.4-Ensure-suspicious-packets-are-logged/#remediation","title":"Remediation","text":"<p>Run the following script to set:</p> <p>net.ipv4.conf.all.log_martians = 1</p> <p>net.ipv4.conf.default.log_martians = 1</p> <pre><code>#!/usr/bin/env bash\n{\nl_output=\"\" l_output2=\"\"\nl_parlist=\"net.ipv4.conf.all.log_martians=1 net.ipv4.conf.default.log_martians=1\"\nl_searchloc=\"/run/sysctl.d/*.conf /etc/sysctl.d/*.conf /usr/local/lib/sysctl.d/*.conf /usr/lib/sysctl.d/*.conf /lib/sysctl.d/*.conf /etc/sysctl.conf $([ -f /etc/default/ufw ] &amp;&amp; awk -F= '/^\\s*IPT_SYSCTL=/{print $2}' /etc/default/ufw)\"\nl_kpfile=\"/etc/sysctl.d/60-netipv4_sysctl.conf\"\nKPF()\n{\n# comment out incorrect parameter(s) in kernel parameter file(s)\nl_fafile=\"$(grep -s -- \"^\\s*$l_kpname\" $l_searchloc | grep -Pv -- \"\\h*=\\h*$l_kpvalue\\b\\h*\" | awk -F: '{print $1}')\"\nfor l_bkpf in $l_fafile; do\necho -e \"\\n - Commenting out \\\"$l_kpname\\\" in \\\"$l_bkpf\\\"\"\nsed -ri \"/$l_kpname/s/^/# /\" \"$l_bkpf\"\ndone\n# Set correct parameter in a kernel parameter file\nif ! grep -Pslq -- \"^\\h*$l_kpname\\h*=\\h*$l_kpvalue\\b\\h*(#.*)?$\" $l_searchloc; then\necho -e \"\\n - Setting \\\"$l_kpname\\\" to \\\"$l_kpvalue\\\" in \\\"$l_kpfile\\\"\"\necho \"$l_kpname = $l_kpvalue\" &gt;&gt; \"$l_kpfile\"\nfi\n# Set correct parameter in active kernel parameters\nl_krp=\"$(sysctl \"$l_kpname\" | awk -F= '{print $2}' | xargs)\"\nif [ \"$l_krp\" != \"$l_kpvalue\" ]; then\necho -e \"\\n - Updating \\\"$l_kpname\\\" to \\\"$l_kpvalue\\\" in the active kernel parameters\"\nsysctl -w \"$l_kpname=$l_kpvalue\"\nsysctl -w \"$(awk -F'.' '{print $1\".\"$2\".route.flush=1\"}' &lt;&lt;&lt; \"$l_kpname\")\"\nfi\n}\nfor l_kpe in $l_parlist; do\nl_kpname=\"$(awk -F= '{print $1}' &lt;&lt;&lt; \"$l_kpe\")\"\nl_kpvalue=\"$(awk -F= '{print $2}' &lt;&lt;&lt; \"$l_kpe\")\"\nKPF\n done\n}\n</code></pre> <p>Default Value:</p> <p>net.ipv4.conf.all.log_martians = 0</p> <p>net.ipv4.conf.default.log_martians = 0</p>","tags":["Level 1","Workstation","Server","Network Configuration","Network Parameters (Host and Router)","Automated","8.5 Collect Detailed Audit Logs","IG2","IG3","T1562","T1562.006","TA0005"]},{"location":"3-Network-Configuration/3.3-Network-Parameters-%28Host-and-Router%29/3.3.5-Ensure-broadcast-icmp-requests-are-ignored/","title":"3.3.5 Ensure broadcast ICMP requests are ignored","text":"","tags":["Level 1","Workstation","Server","Network Configuration","Network Parameters (Host and Router)","Automated","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","IG2","IG3","T1498","T1498.001","TA0040","M1037"]},{"location":"3-Network-Configuration/3.3-Network-Parameters-%28Host-and-Router%29/3.3.5-Ensure-broadcast-icmp-requests-are-ignored/#audit","title":"Audit","text":"<p>Run the following script to verify net.ipv4.icmp_echo_ignore_broadcasts = 1: <pre><code>#!/usr/bin/env bash\n{\nl_output=\"\" l_output2=\"\"\nl_parlist=\"net.ipv4.icmp_echo_ignore_broadcasts=1\"\nl_searchloc=\"/run/sysctl.d/*.conf /etc/sysctl.d/*.conf /usr/local/lib/sysctl.d/*.conf /usr/lib/sysctl.d/*.conf /lib/sysctl.d/*.conf /etc/sysctl.conf $([ -f /etc/default/ufw ] &amp;&amp; awk -F= '/^\\s*IPT_SYSCTL=/{print $2}' /etc/default/ufw)\"\nKPC()\n{\nl_krp=\"$(sysctl \"$l_kpname\" | awk -F= '{print $2}' | xargs)\"\nl_pafile=\"$(grep -Psl -- \"^\\h*$l_kpname\\h*=\\h*$l_kpvalue\\b\\h*(#.*)?$\" $l_searchloc)\"\nl_fafile=\"$(grep -s -- \"^\\s*$l_kpname\" $l_searchloc | grep -Pv -- \"\\h*=\\h*$l_kpvalue\\b\\h*\" | awk -F: '{print $1}')\"\nif [ \"$l_krp\" = \"$l_kpvalue\" ]; then\nl_output=\"$l_output\\n - \\\"$l_kpname\\\" is set to \\\"$l_kpvalue\\\" in the running configuration\"\nelse\nl_output2=\"$l_output2\\n - \\\"$l_kpname\\\" is set to \\\"$l_krp\\\" in the running configuration\"\nfi\nif [ -n \"$l_pafile\" ]; then\nl_output=\"$l_output\\n - \\\"$l_kpname\\\" is set to \\\"$l_kpvalue\\\" in \\\"$l_pafile\\\"\"\nelse\nl_output2=\"$l_output2\\n - \\\"$l_kpname = $l_kpvalue\\\" is not set in a kernel parameter configuration file\"\nfi\n[ -n \"$l_fafile\" ] &amp;&amp; l_output2=\"$l_output2\\n - \\\"$l_kpname\\\" is set incorrectly in \\\"$l_fafile\\\"\"\n}\nfor l_kpe in $l_parlist; do\nl_kpname=\"$(awk -F= '{print $1}' &lt;&lt;&lt; \"$l_kpe\")\"\nl_kpvalue=\"$(awk -F= '{print $2}' &lt;&lt;&lt; \"$l_kpe\")\"\nKPC\n done\nif [ -z \"$l_output2\" ]; then\necho -e \"\\n- Audit Result:\\n ** PASS **\\n$l_output\\n\"\nelse\necho -e \"\\n- Audit Result:\\n ** FAIL **\\n - Reason(s) for audit failure:\\n$l_output2\\n\"\n[ -n \"$l_output\" ] &amp;&amp; echo -e \"\\n- Correctly set:\\n$l_output\\n\"\nfi\n}\n</code></pre></p>","tags":["Level 1","Workstation","Server","Network Configuration","Network Parameters (Host and Router)","Automated","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","IG2","IG3","T1498","T1498.001","TA0040","M1037"]},{"location":"3-Network-Configuration/3.3-Network-Parameters-%28Host-and-Router%29/3.3.5-Ensure-broadcast-icmp-requests-are-ignored/#remediation","title":"Remediation","text":"<p>Run the following script to set net.ipv4.icmp_echo_ignore_broadcasts = 1: <pre><code>#!/usr/bin/env bash\n{\nl_output=\"\" l_output2=\"\"\nl_parlist=\"net.ipv4.icmp_echo_ignore_broadcasts=1\"\nl_searchloc=\"/run/sysctl.d/*.conf /etc/sysctl.d/*.conf /usr/local/lib/sysctl.d/*.conf /usr/lib/sysctl.d/*.conf /lib/sysctl.d/*.conf /etc/sysctl.conf $([ -f /etc/default/ufw ] &amp;&amp; awk -F= '/^\\s*IPT_SYSCTL=/{print $2}' /etc/default/ufw)\"\nl_kpfile=\"/etc/sysctl.d/60-netipv4_sysctl.conf\"\nKPF()\n{\n# comment out incorrect parameter(s) in kernel parameter file(s)\nl_fafile=\"$(grep -s -- \"^\\s*$l_kpname\" $l_searchloc | grep -Pv -- \"\\h*=\\h*$l_kpvalue\\b\\h*\" | awk -F: '{print $1}')\"\nfor l_bkpf in $l_fafile; do\necho -e \"\\n - Commenting out \\\"$l_kpname\\\" in \\\"$l_bkpf\\\"\"\nsed -ri \"/$l_kpname/s/^/# /\" \"$l_bkpf\"\ndone\n# Set correct parameter in a kernel parameter file\nif ! grep -Pslq -- \"^\\h*$l_kpname\\h*=\\h*$l_kpvalue\\b\\h*(#.*)?$\" $l_searchloc; then\necho -e \"\\n - Setting \\\"$l_kpname\\\" to \\\"$l_kpvalue\\\" in \\\"$l_kpfile\\\"\"\necho \"$l_kpname = $l_kpvalue\" &gt;&gt; \"$l_kpfile\"\nfi\n# Set correct parameter in active kernel parameters\nl_krp=\"$(sysctl \"$l_kpname\" | awk -F= '{print $2}' | xargs)\"\nif [ \"$l_krp\" != \"$l_kpvalue\" ]; then\necho -e \"\\n - Updating \\\"$l_kpname\\\" to \\\"$l_kpvalue\\\" in the active kernel parameters\"\nsysctl -w \"$l_kpname=$l_kpvalue\"\nsysctl -w \"$(awk -F'.' '{print $1\".\"$2\".route.flush=1\"}' &lt;&lt;&lt; \"$l_kpname\")\"\nfi\n}\nfor l_kpe in $l_parlist; do\nl_kpname=\"$(awk -F= '{print $1}' &lt;&lt;&lt; \"$l_kpe\")\"\nl_kpvalue=\"$(awk -F= '{print $2}' &lt;&lt;&lt; \"$l_kpe\")\"\nKPF\n done\n}\n</code></pre></p> <p>Default Value:</p> <p>net.ipv4.conf.default.log_martians = 0</p>","tags":["Level 1","Workstation","Server","Network Configuration","Network Parameters (Host and Router)","Automated","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","IG2","IG3","T1498","T1498.001","TA0040","M1037"]},{"location":"3-Network-Configuration/3.3-Network-Parameters-%28Host-and-Router%29/3.3.6-Ensure-bogus-icmp-responses-are-ignored/","title":"3.3.6 Ensure bogus ICMP responses are ignored","text":"","tags":["Level 1","Workstation","Server","Network Configuration","Network Parameters (Host and Router)","Automated","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","IG2","IG3","T1562","T1562.006","TA0040","M1053"]},{"location":"3-Network-Configuration/3.3-Network-Parameters-%28Host-and-Router%29/3.3.6-Ensure-bogus-icmp-responses-are-ignored/#audit","title":"Audit","text":"<p>Run the following script to verify icmp_ignore_bogus_error_responses = 1: <pre><code>#!/usr/bin/env bash\n{\nl_output=\"\" l_output2=\"\"\nl_parlist=\"net.ipv4.icmp_ignore_bogus_error_responses=1\"\nl_searchloc=\"/run/sysctl.d/*.conf /etc/sysctl.d/*.conf /usr/local/lib/sysctl.d/*.conf /usr/lib/sysctl.d/*.conf /lib/sysctl.d/*.conf /etc/sysctl.conf $([ -f /etc/default/ufw ] &amp;&amp; awk -F= '/^\\s*IPT_SYSCTL=/{print $2}' /etc/default/ufw)\"\nKPC()\n{\nl_krp=\"$(sysctl \"$l_kpname\" | awk -F= '{print $2}' | xargs)\"\nl_pafile=\"$(grep -Psl -- \"^\\h*$l_kpname\\h*=\\h*$l_kpvalue\\b\\h*(#.*)?$\" $l_searchloc)\"\nl_fafile=\"$(grep -s -- \"^\\s*$l_kpname\" $l_searchloc | grep -Pv -- \"\\h*=\\h*$l_kpvalue\\b\\h*\" | awk -F: '{print $1}')\"\nif [ \"$l_krp\" = \"$l_kpvalue\" ]; then\nl_output=\"$l_output\\n - \\\"$l_kpname\\\" is set to \\\"$l_kpvalue\\\" in the running configuration\"\nelse\nl_output2=\"$l_output2\\n - \\\"$l_kpname\\\" is set to \\\"$l_krp\\\" in the running configuration\"\nfi\nif [ -n \"$l_pafile\" ]; then\nl_output=\"$l_output\\n - \\\"$l_kpname\\\" is set to \\\"$l_kpvalue\\\" in \\\"$l_pafile\\\"\"\nelse\nl_output2=\"$l_output2\\n - \\\"$l_kpname = $l_kpvalue\\\" is not set in a kernel parameter configuration file\"\nfi\n[ -n \"$l_fafile\" ] &amp;&amp; l_output2=\"$l_output2\\n - \\\"$l_kpname\\\" is set incorrectly in \\\"$l_fafile\\\"\"\n}\nfor l_kpe in $l_parlist; do\nl_kpname=\"$(awk -F= '{print $1}' &lt;&lt;&lt; \"$l_kpe\")\"\nl_kpvalue=\"$(awk -F= '{print $2}' &lt;&lt;&lt; \"$l_kpe\")\"\nKPC\n done\nif [ -z \"$l_output2\" ]; then\necho -e \"\\n- Audit Result:\\n ** PASS **\\n$l_output\\n\"\nelse\necho -e \"\\n- Audit Result:\\n ** FAIL **\\n - Reason(s) for audit failure:\\n$l_output2\\n\"\n[ -n \"$l_output\" ] &amp;&amp; echo -e \"\\n- Correctly set:\\n$l_output\\n\"\nfi\n}\n</code></pre></p>","tags":["Level 1","Workstation","Server","Network Configuration","Network Parameters (Host and Router)","Automated","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","IG2","IG3","T1562","T1562.006","TA0040","M1053"]},{"location":"3-Network-Configuration/3.3-Network-Parameters-%28Host-and-Router%29/3.3.6-Ensure-bogus-icmp-responses-are-ignored/#remediation","title":"Remediation","text":"<p>Run the following script to set icmp_ignore_bogus_error_responses = 1: <pre><code>#!/usr/bin/env bash\n{\nl_output=\"\" l_output2=\"\"\nl_parlist=\"net.ipv4.icmp_ignore_bogus_error_responses=1\"\nl_searchloc=\"/run/sysctl.d/*.conf /etc/sysctl.d/*.conf /usr/local/lib/sysctl.d/*.conf /usr/lib/sysctl.d/*.conf /lib/sysctl.d/*.conf /etc/sysctl.conf $([ -f /etc/default/ufw ] &amp;&amp; awk -F= '/^\\s*IPT_SYSCTL=/{print $2}' /etc/default/ufw)\"\nl_kpfile=\"/etc/sysctl.d/60-netipv4_sysctl.conf\"\nKPF()\n{\n# comment out incorrect parameter(s) in kernel parameter file(s)\nl_fafile=\"$(grep -s -- \"^\\s*$l_kpname\" $l_searchloc | grep -Pv -- \"\\h*=\\h*$l_kpvalue\\b\\h*\" | awk -F: '{print $1}')\"\nfor l_bkpf in $l_fafile; do\necho -e \"\\n - Commenting out \\\"$l_kpname\\\" in \\\"$l_bkpf\\\"\"\nsed -ri \"/$l_kpname/s/^/# /\" \"$l_bkpf\"\ndone\n# Set correct parameter in a kernel parameter file\nif ! grep -Pslq -- \"^\\h*$l_kpname\\h*=\\h*$l_kpvalue\\b\\h*(#.*)?$\" $l_searchloc; then\necho -e \"\\n - Setting \\\"$l_kpname\\\" to \\\"$l_kpvalue\\\" in \\\"$l_kpfile\\\"\"\necho \"$l_kpname = $l_kpvalue\" &gt;&gt; \"$l_kpfile\"\nfi\n# Set correct parameter in active kernel parameters\nl_krp=\"$(sysctl \"$l_kpname\" | awk -F= '{print $2}' | xargs)\"\nif [ \"$l_krp\" != \"$l_kpvalue\" ]; then\necho -e \"\\n - Updating \\\"$l_kpname\\\" to \\\"$l_kpvalue\\\" in the active kernel parameters\"\nsysctl -w \"$l_kpname=$l_kpvalue\"\nsysctl -w \"$(awk -F'.' '{print $1\".\"$2\".route.flush=1\"}' &lt;&lt;&lt; \"$l_kpname\")\"\nfi\n}\nfor l_kpe in $l_parlist; do\nl_kpname=\"$(awk -F= '{print $1}' &lt;&lt;&lt; \"$l_kpe\")\"\nl_kpvalue=\"$(awk -F= '{print $2}' &lt;&lt;&lt; \"$l_kpe\")\"\nKPF\n done\n}\n</code></pre></p> <p>Default Value:</p> <p>net.ipv4.icmp_ignore_bogus_error_responses = 1</p>","tags":["Level 1","Workstation","Server","Network Configuration","Network Parameters (Host and Router)","Automated","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","IG2","IG3","T1562","T1562.006","TA0040","M1053"]},{"location":"3-Network-Configuration/3.3-Network-Parameters-%28Host-and-Router%29/3.3.7-Ensure-reverse-path-filtering-is-enabled/","title":"3.3.7 Ensure Reverse Path Filtering is enabled","text":"","tags":["Level 1","Workstation","Server","Network Configuration","Network Parameters (Host and Router)","Automated","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","IG2","IG3","T1498","T1498.001","TA0006","TA0040","M1030","M1042"]},{"location":"3-Network-Configuration/3.3-Network-Parameters-%28Host-and-Router%29/3.3.7-Ensure-reverse-path-filtering-is-enabled/#audit","title":"Audit","text":"<p>Run the following script to verify:</p> <p>net.ipv4.conf.all.rp_filter = 1</p> <p>net.ipv4.conf.default.rp_filter = 1</p> <pre><code>#!/usr/bin/env bash\n{\nl_output=\"\" l_output2=\"\"\nl_parlist=\"net.ipv4.conf.all.rp_filter=1 net.ipv4.conf.default.rp_filter=1\"\nl_searchloc=\"/run/sysctl.d/*.conf /etc/sysctl.d/*.conf /usr/local/lib/sysctl.d/*.conf /usr/lib/sysctl.d/*.conf /lib/sysctl.d/*.conf /etc/sysctl.conf $([ -f /etc/default/ufw ] &amp;&amp; awk -F= '/^\\s*IPT_SYSCTL=/{print $2}' /etc/default/ufw)\"\nKPC()\n{\nl_krp=\"$(sysctl \"$l_kpname\" | awk -F= '{print $2}' | xargs)\"\nl_pafile=\"$(grep -Psl -- \"^\\h*$l_kpname\\h*=\\h*$l_kpvalue\\b\\h*(#.*)?$\" $l_searchloc)\"\nl_fafile=\"$(grep -s -- \"^\\s*$l_kpname\" $l_searchloc | grep -Pv -- \"\\h*=\\h*$l_kpvalue\\b\\h*\" | awk -F: '{print $1}')\"\nif [ \"$l_krp\" = \"$l_kpvalue\" ]; then\nl_output=\"$l_output\\n - \\\"$l_kpname\\\" is set to \\\"$l_kpvalue\\\" in the running configuration\"\nelse\nl_output2=\"$l_output2\\n - \\\"$l_kpname\\\" is set to \\\"$l_krp\\\" in the running configuration\"\nfi\nif [ -n \"$l_pafile\" ]; then\nl_output=\"$l_output\\n - \\\"$l_kpname\\\" is set to \\\"$l_kpvalue\\\" in \\\"$l_pafile\\\"\"\nelse\nl_output2=\"$l_output2\\n - \\\"$l_kpname = $l_kpvalue\\\" is not set in a kernel parameter configuration file\"\nfi\n[ -n \"$l_fafile\" ] &amp;&amp; l_output2=\"$l_output2\\n - \\\"$l_kpname\\\" is set incorrectly in \\\"$l_fafile\\\"\"\n}\nfor l_kpe in $l_parlist; do\nl_kpname=\"$(awk -F= '{print $1}' &lt;&lt;&lt; \"$l_kpe\")\"\nl_kpvalue=\"$(awk -F= '{print $2}' &lt;&lt;&lt; \"$l_kpe\")\"\nKPC\n done\nif [ -z \"$l_output2\" ]; then\necho -e \"\\n- Audit Result:\\n ** PASS **\\n$l_output\\n\"\nelse\necho -e \"\\n- Audit Result:\\n ** FAIL **\\n - Reason(s) for audit failure:\\n$l_output2\\n\"\n[ -n \"$l_output\" ] &amp;&amp; echo -e \"\\n- Correctly set:\\n$l_output\\n\"\nfi\n}\n</code></pre>","tags":["Level 1","Workstation","Server","Network Configuration","Network Parameters (Host and Router)","Automated","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","IG2","IG3","T1498","T1498.001","TA0006","TA0040","M1030","M1042"]},{"location":"3-Network-Configuration/3.3-Network-Parameters-%28Host-and-Router%29/3.3.7-Ensure-reverse-path-filtering-is-enabled/#remediation","title":"Remediation","text":"<p>Run the following script to set:</p> <p>net.ipv4.conf.all.rp_filter = 1</p> <p>net.ipv4.conf.default.rp_filter = 1</p> <pre><code>#!/usr/bin/env bash\n{\nl_output=\"\" l_output2=\"\"\nl_parlist=\"net.ipv4.conf.all.rp_filter=1 net.ipv4.conf.default.rp_filter=1\"\nl_searchloc=\"/run/sysctl.d/*.conf /etc/sysctl.d/*.conf /usr/local/lib/sysctl.d/*.conf /usr/lib/sysctl.d/*.conf /lib/sysctl.d/*.conf /etc/sysctl.conf $([ -f /etc/default/ufw ] &amp;&amp; awk -F= '/^\\s*IPT_SYSCTL=/{print $2}' /etc/default/ufw)\"\nl_kpfile=\"/etc/sysctl.d/60-netipv4_sysctl.conf\"\nKPF()\n{\n# comment out incorrect parameter(s) in kernel parameter file(s)\nl_fafile=\"$(grep -s -- \"^\\s*$l_kpname\" $l_searchloc | grep -Pv -- \"\\h*=\\h*$l_kpvalue\\b\\h*\" | awk -F: '{print $1}')\"\nfor l_bkpf in $l_fafile; do\necho -e \"\\n - Commenting out \\\"$l_kpname\\\" in \\\"$l_bkpf\\\"\"\nsed -ri \"/$l_kpname/s/^/# /\" \"$l_bkpf\"\ndone\n# Set correct parameter in a kernel parameter file\nif ! grep -Pslq -- \"^\\h*$l_kpname\\h*=\\h*$l_kpvalue\\b\\h*(#.*)?$\" $l_searchloc; then\necho -e \"\\n - Setting \\\"$l_kpname\\\" to \\\"$l_kpvalue\\\" in \\\"$l_kpfile\\\"\"\necho \"$l_kpname = $l_kpvalue\" &gt;&gt; \"$l_kpfile\"\nfi\n# Set correct parameter in active kernel parameters\nl_krp=\"$(sysctl \"$l_kpname\" | awk -F= '{print $2}' | xargs)\"\nif [ \"$l_krp\" != \"$l_kpvalue\" ]; then\necho -e \"\\n - Updating \\\"$l_kpname\\\" to \\\"$l_kpvalue\\\" in the active kernel parameters\"\nsysctl -w \"$l_kpname=$l_kpvalue\"\nsysctl -w \"$(awk -F'.' '{print $1\".\"$2\".route.flush=1\"}' &lt;&lt;&lt; \"$l_kpname\")\"\nfi\n}\nfor l_kpe in $l_parlist; do\nl_kpname=\"$(awk -F= '{print $1}' &lt;&lt;&lt; \"$l_kpe\")\"\nl_kpvalue=\"$(awk -F= '{print $2}' &lt;&lt;&lt; \"$l_kpe\")\"\nKPF\n done\n}\n</code></pre> <p>Default Value:</p> <p>net.ipv4.conf.all.rp_filter = 2</p> <p>net.ipv4.conf.default.rp_filter = 1</p>","tags":["Level 1","Workstation","Server","Network Configuration","Network Parameters (Host and Router)","Automated","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","IG2","IG3","T1498","T1498.001","TA0006","TA0040","M1030","M1042"]},{"location":"3-Network-Configuration/3.3-Network-Parameters-%28Host-and-Router%29/3.3.8-Ensure-tcp-syn-cookies-is-enabled/","title":"3.3.8 Ensure TCP SYN Cookies is enabled","text":"","tags":["Level 1","Workstation","Server","Network Configuration","Network Parameters (Host and Router)","Automated","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","IG2","IG3","T1499","T1499.001","TA0040","M1037"]},{"location":"3-Network-Configuration/3.3-Network-Parameters-%28Host-and-Router%29/3.3.8-Ensure-tcp-syn-cookies-is-enabled/#audit","title":"Audit","text":"<p>Run the following script to verify net.ipv4.tcp_syncookies = 1:</p> <pre><code>#!/usr/bin/env bash\n{\nl_output=\"\" l_output2=\"\"\nl_parlist=\"net.ipv4.tcp_syncookies=1\"\nl_searchloc=\"/run/sysctl.d/*.conf /etc/sysctl.d/*.conf /usr/local/lib/sysctl.d/*.conf /usr/lib/sysctl.d/*.conf /lib/sysctl.d/*.conf /etc/sysctl.conf $([ -f /etc/default/ufw ] &amp;&amp; awk -F= '/^\\s*IPT_SYSCTL=/{print $2}' /etc/default/ufw)\"\nKPC()\n{\nl_krp=\"$(sysctl \"$l_kpname\" | awk -F= '{print $2}' | xargs)\"\nl_pafile=\"$(grep -Psl -- \"^\\h*$l_kpname\\h*=\\h*$l_kpvalue\\b\\h*(#.*)?$\" $l_searchloc)\"\nl_fafile=\"$(grep -s -- \"^\\s*$l_kpname\" $l_searchloc | grep -Pv -- \"\\h*=\\h*$l_kpvalue\\b\\h*\" | awk -F: '{print $1}')\"\nif [ \"$l_krp\" = \"$l_kpvalue\" ]; then\nl_output=\"$l_output\\n - \\\"$l_kpname\\\" is set to \\\"$l_kpvalue\\\" in the running configuration\"\nelse\nl_output2=\"$l_output2\\n - \\\"$l_kpname\\\" is set to \\\"$l_krp\\\" in the running configuration\"\nfi\nif [ -n \"$l_pafile\" ]; then\nl_output=\"$l_output\\n - \\\"$l_kpname\\\" is set to \\\"$l_kpvalue\\\" in \\\"$l_pafile\\\"\"\nelse\nl_output2=\"$l_output2\\n - \\\"$l_kpname = $l_kpvalue\\\" is not set in a kernel parameter configuration file\"\nfi\n[ -n \"$l_fafile\" ] &amp;&amp; l_output2=\"$l_output2\\n - \\\"$l_kpname\\\" is set incorrectly in \\\"$l_fafile\\\"\"\n}\nfor l_kpe in $l_parlist; do\nl_kpname=\"$(awk -F= '{print $1}' &lt;&lt;&lt; \"$l_kpe\")\"\nl_kpvalue=\"$(awk -F= '{print $2}' &lt;&lt;&lt; \"$l_kpe\")\"\nKPC\n done\nif [ -z \"$l_output2\" ]; then\necho -e \"\\n- Audit Result:\\n ** PASS **\\n$l_output\\n\"\nelse\necho -e \"\\n- Audit Result:\\n ** FAIL **\\n - Reason(s) for audit failure:\\n$l_output2\\n\"\n[ -n \"$l_output\" ] &amp;&amp; echo -e \"\\n- Correctly set:\\n$l_output\\n\"\nfi\n}\n</code></pre>","tags":["Level 1","Workstation","Server","Network Configuration","Network Parameters (Host and Router)","Automated","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","IG2","IG3","T1499","T1499.001","TA0040","M1037"]},{"location":"3-Network-Configuration/3.3-Network-Parameters-%28Host-and-Router%29/3.3.8-Ensure-tcp-syn-cookies-is-enabled/#remediation","title":"Remediation","text":"<p>Run the following script to set net.ipv4.tcp_syncookies = 1: <pre><code>#!/usr/bin/env bash\n{\nl_output=\"\" l_output2=\"\"\nl_parlist=\"net.ipv4.tcp_syncookies=1\"\nl_searchloc=\"/run/sysctl.d/*.conf /etc/sysctl.d/*.conf /usr/local/lib/sysctl.d/*.conf /usr/lib/sysctl.d/*.conf /lib/sysctl.d/*.conf /etc/sysctl.conf $([ -f /etc/default/ufw ] &amp;&amp; awk -F= '/^\\s*IPT_SYSCTL=/{print $2}' /etc/default/ufw)\"\nl_kpfile=\"/etc/sysctl.d/60-netipv4_sysctl.conf\"\nKPF()\n{\n# comment out incorrect parameter(s) in kernel parameter file(s)\nl_fafile=\"$(grep -s -- \"^\\s*$l_kpname\" $l_searchloc | grep -Pv -- \"\\h*=\\h*$l_kpvalue\\b\\h*\" | awk -F: '{print $1}')\"\nfor l_bkpf in $l_fafile; do\necho -e \"\\n - Commenting out \\\"$l_kpname\\\" in \\\"$l_bkpf\\\"\"\nsed -ri \"/$l_kpname/s/^/# /\" \"$l_bkpf\"\ndone\n# Set correct parameter in a kernel parameter file\nif ! grep -Pslq -- \"^\\h*$l_kpname\\h*=\\h*$l_kpvalue\\b\\h*(#.*)?$\" $l_searchloc; then\necho -e \"\\n - Setting \\\"$l_kpname\\\" to \\\"$l_kpvalue\\\" in \\\"$l_kpfile\\\"\"\necho \"$l_kpname = $l_kpvalue\" &gt;&gt; \"$l_kpfile\"\nfi\n# Set correct parameter in active kernel parameters\nl_krp=\"$(sysctl \"$l_kpname\" | awk -F= '{print $2}' | xargs)\"\nif [ \"$l_krp\" != \"$l_kpvalue\" ]; then\necho -e \"\\n - Updating \\\"$l_kpname\\\" to \\\"$l_kpvalue\\\" in the active kernel parameters\"\nsysctl -w \"$l_kpname=$l_kpvalue\"\nsysctl -w \"$(awk -F'.' '{print $1\".\"$2\".route.flush=1\"}' &lt;&lt;&lt; \"$l_kpname\")\"\nfi\n}\nfor l_kpe in $l_parlist; do\nl_kpname=\"$(awk -F= '{print $1}' &lt;&lt;&lt; \"$l_kpe\")\"\nl_kpvalue=\"$(awk -F= '{print $2}' &lt;&lt;&lt; \"$l_kpe\")\"\nKPF\n done\n}\n</code></pre></p> <p>Default Value:</p> <p>net.ipv4.tcp_syncookies = 1</p>","tags":["Level 1","Workstation","Server","Network Configuration","Network Parameters (Host and Router)","Automated","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","IG2","IG3","T1499","T1499.001","TA0040","M1037"]},{"location":"3-Network-Configuration/3.3-Network-Parameters-%28Host-and-Router%29/3.3.9-Ensure-ipv6-router-advertisements-are-not-accepted/","title":"3.3.9 Ensure IPv6 router advertisements are not accepted","text":"","tags":["Level 1","Workstation","Server","Network Configuration","Network Parameters (Host and Router)","Automated","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","IG2","IG3","T1557","TA0006","TA0040","M1030","M1042"]},{"location":"3-Network-Configuration/3.3-Network-Parameters-%28Host-and-Router%29/3.3.9-Ensure-ipv6-router-advertisements-are-not-accepted/#audit","title":"Audit","text":"<p>Run the following script to verify:</p> <p>net.ipv6.conf.all.accept_ra = 0</p> <p>net.ipv6.conf.default.accept_ra = 0</p> <pre><code>#!/usr/bin/env bash\n{\nl_output=\"\" l_output2=\"\"\nl_parlist=\"net.ipv6.conf.all.accept_ra=0 net.ipv6.conf.default.accept_ra=0\"\nl_searchloc=\"/run/sysctl.d/*.conf /etc/sysctl.d/*.conf /usr/local/lib/sysctl.d/*.conf /usr/lib/sysctl.d/*.conf /lib/sysctl.d/*.conf /etc/sysctl.conf $([ -f /etc/default/ufw ] &amp;&amp; awk -F= '/^\\s*IPT_SYSCTL=/{print $2}' /etc/default/ufw)\"\nKPC()\n{\nl_krp=\"$(sysctl \"$l_kpname\" | awk -F= '{print $2}' | xargs)\"\nl_pafile=\"$(grep -Psl -- \"^\\h*$l_kpname\\h*=\\h*$l_kpvalue\\b\\h*(#.*)?$\" $l_searchloc)\"\nl_fafile=\"$(grep -s -- \"^\\s*$l_kpname\" $l_searchloc | grep -Pv -- \"\\h*=\\h*$l_kpvalue\\b\\h*\" | awk -F: '{print $1}')\"\nif [ \"$l_krp\" = \"$l_kpvalue\" ]; then\nl_output=\"$l_output\\n - \\\"$l_kpname\\\" is set to \\\"$l_kpvalue\\\" in the running configuration\"\nelse\nl_output2=\"$l_output2\\n - \\\"$l_kpname\\\" is set to \\\"$l_krp\\\" in the running configuration\"\nfi\nif [ -n \"$l_pafile\" ]; then\nl_output=\"$l_output\\n - \\\"$l_kpname\\\" is set to \\\"$l_kpvalue\\\" in \\\"$l_pafile\\\"\"\nelse\nl_output2=\"$l_output2\\n - \\\"$l_kpname = $l_kpvalue\\\" is not set in a kernel parameter configuration file\"\nfi\n[ -n \"$l_fafile\" ] &amp;&amp; l_output2=\"$l_output2\\n - \\\"$l_kpname\\\" is set incorrectly in \\\"$l_fafile\\\"\"\n}\nipv6_chk()\n{\nl_ipv6s=\"\"\ngrubfile=$(find /boot -type f \\( -name 'grubenv' -o -name 'grub.conf' -o -name 'grub.cfg' \\) -exec grep -Pl -- '^\\h*(kernelopts=|linux|kernel)' {} \\;)\nif [ -s \"$grubfile\" ]; then\n! grep -P -- \"^\\h*(kernelopts=|linux|kernel)\" \"$grubfile\" | grep -vq -- ipv6.disable=1 &amp;&amp; l_ipv6s=\"disabled\"\nfi\nif grep -Pqs -- \"^\\h*net\\.ipv6\\.conf\\.all\\.disable_ipv6\\h*=\\h*1\\h*(#.*)?$\" $l_searchloc &amp;&amp; grep -Pqs -- \"^\\h*net\\.ipv6\\.conf\\.default\\.disable_ipv6\\h*=\\h*1\\h*(#.*)?$\" $l_searchloc &amp;&amp; sysctl net.ipv6.conf.all.disable_ipv6 | grep -Pqs -- \"^\\h*net\\.ipv6\\.conf\\.all\\.disable_ipv6\\h*=\\h*1\\h*(#.*)?$\" &amp;&amp; sysctl net.ipv6.conf.default.disable_ipv6 | grep -Pqs -- \"^\\h*net\\.ipv6\\.conf\\.default\\.disable_ipv6\\h*=\\h*1\\h*(#.*)?$\"; then\nl_ipv6s=\"disabled\"\nfi\nif [ -n \"$l_ipv6s\" ]; then\nl_output=\"$l_output\\n - IPv6 is disabled on the system, \\\"$l_kpname\\\" is not applicable\"\nelse\nKPC\n fi\n}\nfor l_kpe in $l_parlist; do\nl_kpname=\"$(awk -F= '{print $1}' &lt;&lt;&lt; \"$l_kpe\")\"\nl_kpvalue=\"$(awk -F= '{print $2}' &lt;&lt;&lt; \"$l_kpe\")\"\nif grep -q '^net.ipv6.' &lt;&lt;&lt; \"$l_kpe\"; then\nipv6_chk\n else\nKPC\n fi\ndone\nif [ -z \"$l_output2\" ]; then\necho -e \"\\n- Audit Result:\\n ** PASS **\\n$l_output\\n\"\nelse\necho -e \"\\n- Audit Result:\\n ** FAIL **\\n - Reason(s) for audit failure:\\n$l_output2\\n\"\n[ -n \"$l_output\" ] &amp;&amp; echo -e \"\\n- Correctly set:\\n$l_output\\n\"\nfi\n}\n</code></pre>","tags":["Level 1","Workstation","Server","Network Configuration","Network Parameters (Host and Router)","Automated","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","IG2","IG3","T1557","TA0006","TA0040","M1030","M1042"]},{"location":"3-Network-Configuration/3.3-Network-Parameters-%28Host-and-Router%29/3.3.9-Ensure-ipv6-router-advertisements-are-not-accepted/#remediation","title":"Remediation","text":"<p>Run the following script to set:</p> <p>net.ipv6.conf.all.accept_ra = 0</p> <p>net.ipv6.conf.default.accept_ra = 0</p> <pre><code>#!/usr/bin/env bash\n{\nl_output=\"\" l_output2=\"\"\nl_parlist=\"net.ipv6.conf.all.accept_ra=0 net.ipv6.conf.default.accept_ra=0\"\nl_searchloc=\"/run/sysctl.d/*.conf /etc/sysctl.d/*.conf /usr/local/lib/sysctl.d/*.conf /usr/lib/sysctl.d/*.conf /lib/sysctl.d/*.conf /etc/sysctl.conf $([ -f /etc/default/ufw ] &amp;&amp; awk -F= '/^\\s*IPT_SYSCTL=/{print $2}' /etc/default/ufw)\"\nKPF()\n{\n# comment out incorrect parameter(s) in kernel parameter file(s)\nl_fafile=\"$(grep -s -- \"^\\s*$l_kpname\" $l_searchloc | grep -Pv -- \"\\h*=\\h*$l_kpvalue\\b\\h*\" | awk -F: '{print $1}')\"\nfor l_bkpf in $l_fafile; do\necho -e \"\\n - Commenting out \\\"$l_kpname\\\" in \\\"$l_bkpf\\\"\"\nsed -ri \"/$l_kpname/s/^/# /\" \"$l_bkpf\"\ndone\n# Set correct parameter in a kernel parameter file\nif ! grep -Pslq -- \"^\\h*$l_kpname\\h*=\\h*$l_kpvalue\\b\\h*(#.*)?$\" $l_searchloc; then\necho -e \"\\n - Setting \\\"$l_kpname\\\" to \\\"$l_kpvalue\\\" in \\\"$l_kpfile\\\"\"\necho \"$l_kpname = $l_kpvalue\" &gt;&gt; \"$l_kpfile\"\nfi\n# Set correct parameter in active kernel parameters\nl_krp=\"$(sysctl \"$l_kpname\" | awk -F= '{print $2}' | xargs)\"\nif [ \"$l_krp\" != \"$l_kpvalue\" ]; then\necho -e \"\\n - Updating \\\"$l_kpname\\\" to \\\"$l_kpvalue\\\" in the active kernel parameters\"\nsysctl -w \"$l_kpname=$l_kpvalue\"\nsysctl -w \"$(awk -F'.' '{print $1\".\"$2\".route.flush=1\"}' &lt;&lt;&lt; \"$l_kpname\")\"\nfi\n}\nIPV6F_CHK()\n{\nl_ipv6s=\"\"\ngrubfile=$(find /boot -type f \\( -name 'grubenv' -o -name 'grub.conf' -o -name 'grub.cfg' \\) -exec grep -Pl -- '^\\h*(kernelopts=|linux|kernel)' {} \\;)\nif [ -s \"$grubfile\" ]; then\n! grep -P -- \"^\\h*(kernelopts=|linux|kernel)\" \"$grubfile\" | grep -vq -- ipv6.disable=1 &amp;&amp; l_ipv6s=\"disabled\"\nfi\nif grep -Pqs -- \"^\\h*net\\.ipv6\\.conf\\.all\\.disable_ipv6\\h*=\\h*1\\h*(#.*)?$\" $l_searchloc &amp;&amp; \\\ngrep -Pqs -- \"^\\h*net\\.ipv6\\.conf\\.default\\.disable_ipv6\\h*=\\h*1\\h*(#.*)?$\" $l_searchloc &amp;&amp; \\\nsysctl net.ipv6.conf.all.disable_ipv6 | grep -Pqs -- \"^\\h*net\\.ipv6\\.conf\\.all\\.disable_ipv6\\h*=\\h*1\\h*(#.*)?$\" &amp;&amp; \\\nsysctl net.ipv6.conf.default.disable_ipv6 | grep -Pqs -- \"^\\h*net\\.ipv6\\.conf\\.default\\.disable_ipv6\\h*=\\h*1\\h*(#.*)?$\"; then\nl_ipv6s=\"disabled\"\nfi\nif [ -n \"$l_ipv6s\" ]; then\necho -e \"\\n - IPv6 is disabled on the system, \\\"$l_kpname\\\" is not applicable\"\nelse\nKPF\n fi\n}\nfor l_kpe in $l_parlist; do\nl_kpname=\"$(awk -F= '{print $1}' &lt;&lt;&lt; \"$l_kpe\")\"\nl_kpvalue=\"$(awk -F= '{print $2}' &lt;&lt;&lt; \"$l_kpe\")\"\nif grep -q '^net.ipv6.' &lt;&lt;&lt; \"$l_kpe\"; then\nl_kpfile=\"/etc/sysctl.d/60-netipv6_sysctl.conf\"\nIPV6F_CHK\n else\nl_kpfile=\"/etc/sysctl.d/60-netipv4_sysctl.conf\"\nKPF\n fi\ndone\n}\n</code></pre> <p>Default Value:</p> <p>net.ipv6.conf.all.accept_ra = 1</p> <p>net.ipv6.conf.default.accept_ra = 1</p>","tags":["Level 1","Workstation","Server","Network Configuration","Network Parameters (Host and Router)","Automated","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","IG2","IG3","T1557","TA0006","TA0040","M1030","M1042"]},{"location":"3-Network-Configuration/3.5-Firewall-Configuration/3.5.1-Configure-UncomplicatedFirewall/3.5.1.1-Ensure-ufw-is-installed/","title":"3.5.1.1 Ensure ufw is installed","text":"","tags":["Level 1","Workstation","Server","Network Configuration","Firewall Configuration","Configure UncomplicatedFirewall","Automated","4.4 Implement and Manage a Firewall on Servers","4.5 Implement and Manage a Firewall on End-User Devices","IG1","IG2","IG3","T1562","T1562.004","TA0011","M1031","M1037"]},{"location":"3-Network-Configuration/3.5-Firewall-Configuration/3.5.1-Configure-UncomplicatedFirewall/3.5.1.1-Ensure-ufw-is-installed/#audit","title":"Audit","text":"<p>Run the following command to verify that Uncomplicated Firewall (UFW) is installed: <pre><code># dpkg-query -W -f='${binary:Package}\\t${Status}\\t${db:Status-Status}\\n' ufw\nufw install ok installed installed\n</code></pre></p>","tags":["Level 1","Workstation","Server","Network Configuration","Firewall Configuration","Configure UncomplicatedFirewall","Automated","4.4 Implement and Manage a Firewall on Servers","4.5 Implement and Manage a Firewall on End-User Devices","IG1","IG2","IG3","T1562","T1562.004","TA0011","M1031","M1037"]},{"location":"3-Network-Configuration/3.5-Firewall-Configuration/3.5.1-Configure-UncomplicatedFirewall/3.5.1.1-Ensure-ufw-is-installed/#remediation","title":"Remediation","text":"<p>Run the following command to install Uncomplicated Firewall (UFW): <pre><code>apt install ufw\n</code></pre></p>","tags":["Level 1","Workstation","Server","Network Configuration","Firewall Configuration","Configure UncomplicatedFirewall","Automated","4.4 Implement and Manage a Firewall on Servers","4.5 Implement and Manage a Firewall on End-User Devices","IG1","IG2","IG3","T1562","T1562.004","TA0011","M1031","M1037"]},{"location":"3-Network-Configuration/3.5-Firewall-Configuration/3.5.1-Configure-UncomplicatedFirewall/3.5.1.2-Ensure-iptables-persistent-is-not-installed-with-ufw/","title":"3.5.1.2 Ensure iptables-persistent is not installed with ufw","text":"","tags":["Level 1","Workstation","Server","Network Configuration","Firewall Configuration","Configure UncomplicatedFirewall","Automated","4.4 Implement and Manage a Firewall on Servers","4.5 Implement and Manage a Firewall on End-User Devices","IG1","IG2","IG3","T1562","T1562.004","TA0005"]},{"location":"3-Network-Configuration/3.5-Firewall-Configuration/3.5.1-Configure-UncomplicatedFirewall/3.5.1.2-Ensure-iptables-persistent-is-not-installed-with-ufw/#audit","title":"Audit","text":"<p>Run the following command to verify that the iptables-persistent package is not installed: <pre><code>dpkg-query -s iptables-persistent\npackage 'iptables-persistent' is not installed and no information is available\n</code></pre></p>","tags":["Level 1","Workstation","Server","Network Configuration","Firewall Configuration","Configure UncomplicatedFirewall","Automated","4.4 Implement and Manage a Firewall on Servers","4.5 Implement and Manage a Firewall on End-User Devices","IG1","IG2","IG3","T1562","T1562.004","TA0005"]},{"location":"3-Network-Configuration/3.5-Firewall-Configuration/3.5.1-Configure-UncomplicatedFirewall/3.5.1.2-Ensure-iptables-persistent-is-not-installed-with-ufw/#remediation","title":"Remediation","text":"<p>Run the following command to remove the iptables-persistent package: <pre><code># apt purge iptables-persistent\n</code></pre></p>","tags":["Level 1","Workstation","Server","Network Configuration","Firewall Configuration","Configure UncomplicatedFirewall","Automated","4.4 Implement and Manage a Firewall on Servers","4.5 Implement and Manage a Firewall on End-User Devices","IG1","IG2","IG3","T1562","T1562.004","TA0005"]},{"location":"3-Network-Configuration/3.5-Firewall-Configuration/3.5.1-Configure-UncomplicatedFirewall/3.5.1.3-Ensure-ufw-service-is-enabled/","title":"3.5.1.3 Ensure ufw service is enabled","text":"","tags":["Level 1","Workstation","Server","Network Configuration","Firewall Configuration","Configure UncomplicatedFirewall","Automated","4.4 Implement and Manage a Firewall on Servers","4.5 Implement and Manage a Firewall on End-User Devices","IG1","IG2","IG3","T1562","T1562.004","TA0005"]},{"location":"3-Network-Configuration/3.5-Firewall-Configuration/3.5.1-Configure-UncomplicatedFirewall/3.5.1.3-Ensure-ufw-service-is-enabled/#audit","title":"Audit","text":"<p>Run the following command to verify that the ufw daemon is enabled: <pre><code># systemctl is-enabled ufw.service\nenabled\n</code></pre></p> <p>Run the following command to verify that the ufw daemon is active: <pre><code># systemctl is-active ufw\nactive\n</code></pre></p> <p>Run the following command to verify ufw is active <pre><code># ufw status\nStatus: active\n</code></pre></p>","tags":["Level 1","Workstation","Server","Network Configuration","Firewall Configuration","Configure UncomplicatedFirewall","Automated","4.4 Implement and Manage a Firewall on Servers","4.5 Implement and Manage a Firewall on End-User Devices","IG1","IG2","IG3","T1562","T1562.004","TA0005"]},{"location":"3-Network-Configuration/3.5-Firewall-Configuration/3.5.1-Configure-UncomplicatedFirewall/3.5.1.3-Ensure-ufw-service-is-enabled/#remediation","title":"Remediation","text":"<p>Run the following command to unmask the ufw daemon: <pre><code># systemctl unmask ufw.service\n</code></pre></p> <p>Run the following command to enable and start the ufw daemon: <pre><code># systemctl --now enable ufw.service\nactive\n</code></pre></p> <p>Run the following command to enable ufw: <pre><code># ufw enable\n</code></pre></p>","tags":["Level 1","Workstation","Server","Network Configuration","Firewall Configuration","Configure UncomplicatedFirewall","Automated","4.4 Implement and Manage a Firewall on Servers","4.5 Implement and Manage a Firewall on End-User Devices","IG1","IG2","IG3","T1562","T1562.004","TA0005"]},{"location":"3-Network-Configuration/3.5-Firewall-Configuration/3.5.1-Configure-UncomplicatedFirewall/3.5.1.4-Ensure-ufw-loopback-traffic-is-configured/","title":"3.5.1.4 Ensure ufw loopback traffic is configured","text":"","tags":["Level 1","Workstation","Server","Network Configuration","Firewall Configuration","Configure UncomplicatedFirewall","Automated","4.4 Implement and Manage a Firewall on Servers","4.5 Implement and Manage a Firewall on End-User Devices","IG1","IG2","IG3","T1562","T1562.004","TA0011","M1031","M1037"]},{"location":"3-Network-Configuration/3.5-Firewall-Configuration/3.5.1-Configure-UncomplicatedFirewall/3.5.1.4-Ensure-ufw-loopback-traffic-is-configured/#audit","title":"Audit","text":"<p>Run the following commands and verify output includes the listed rules in order: <pre><code># ufw status verbose\nTo          Action      From\n--          ------      ----\nAnywhere on lo      ALLOW IN    Anywhere\nAnywhere        DENY IN     127.0.0.0/8\nAnywhere (v6) on lo     ALLOW IN    Anywhere (v6)\nAnywhere (v6)       DENY IN     ::1\nAnywhere        ALLOW OUT   Anywhere on lo\nAnywhere (v6)       ALLOW OUT   Anywhere (v6) on lo\n</code></pre></p>","tags":["Level 1","Workstation","Server","Network Configuration","Firewall Configuration","Configure UncomplicatedFirewall","Automated","4.4 Implement and Manage a Firewall on Servers","4.5 Implement and Manage a Firewall on End-User Devices","IG1","IG2","IG3","T1562","T1562.004","TA0011","M1031","M1037"]},{"location":"3-Network-Configuration/3.5-Firewall-Configuration/3.5.1-Configure-UncomplicatedFirewall/3.5.1.4-Ensure-ufw-loopback-traffic-is-configured/#remediation","title":"Remediation","text":"<p>Run the following commands to implement the loopback rules: <pre><code># ufw allow in on lo\n# ufw allow out on lo\n# ufw deny in from 127.0.0.0/8\n# ufw deny in from ::1\n</code></pre></p>","tags":["Level 1","Workstation","Server","Network Configuration","Firewall Configuration","Configure UncomplicatedFirewall","Automated","4.4 Implement and Manage a Firewall on Servers","4.5 Implement and Manage a Firewall on End-User Devices","IG1","IG2","IG3","T1562","T1562.004","TA0011","M1031","M1037"]},{"location":"3-Network-Configuration/3.5-Firewall-Configuration/3.5.1-Configure-UncomplicatedFirewall/3.5.1.5-Ensure-ufw-outbound-connections-are-configured/","title":"3.5.1.5 Ensure ufw outbound connections are configured","text":"","tags":["Level 1","Workstation","Server","Network Configuration","Firewall Configuration","Configure UncomplicatedFirewall","Manual","4.4 Implement and Manage a Firewall on Servers","4.5 Implement and Manage a Firewall on End-User Devices","IG1","IG2","IG3","TA0011","M1031","M1037"]},{"location":"3-Network-Configuration/3.5-Firewall-Configuration/3.5.1-Configure-UncomplicatedFirewall/3.5.1.5-Ensure-ufw-outbound-connections-are-configured/#audit","title":"Audit","text":"<p>Run the following command and verify all rules for new outbound connections match site policy: <pre><code># ufw status numbered\n</code></pre></p>","tags":["Level 1","Workstation","Server","Network Configuration","Firewall Configuration","Configure UncomplicatedFirewall","Manual","4.4 Implement and Manage a Firewall on Servers","4.5 Implement and Manage a Firewall on End-User Devices","IG1","IG2","IG3","TA0011","M1031","M1037"]},{"location":"3-Network-Configuration/3.5-Firewall-Configuration/3.5.1-Configure-UncomplicatedFirewall/3.5.1.5-Ensure-ufw-outbound-connections-are-configured/#remediation","title":"Remediation","text":"<p>Configure ufw in accordance with site policy. The following commands will implement a policy to allow all outbound connections on all interfaces: <pre><code># ufw allow out on all\n</code></pre></p>","tags":["Level 1","Workstation","Server","Network Configuration","Firewall Configuration","Configure UncomplicatedFirewall","Manual","4.4 Implement and Manage a Firewall on Servers","4.5 Implement and Manage a Firewall on End-User Devices","IG1","IG2","IG3","TA0011","M1031","M1037"]},{"location":"3-Network-Configuration/3.5-Firewall-Configuration/3.5.1-Configure-UncomplicatedFirewall/3.5.1.6-Ensure-ufw-firewall-rules-exist-for-all-open-ports/","title":"3.5.1.6 Ensure ufw firewall rules exist for all open ports","text":"","tags":["Level 1","Workstation","Server","Network Configuration","Firewall Configuration","Configure UncomplicatedFirewall","Automated","4.4 Implement and Manage a Firewall on Servers","IG1","IG2","IG3","T1562","T1562.004","TA0011","M1031","M1037"]},{"location":"3-Network-Configuration/3.5-Firewall-Configuration/3.5.1-Configure-UncomplicatedFirewall/3.5.1.6-Ensure-ufw-firewall-rules-exist-for-all-open-ports/#audit","title":"Audit","text":"<p>Run the following script to verify a firewall rule exists for all open ports: <pre><code>#!/usr/bin/env bash\nufw_out=\"$(ufw status verbose)\"\nss -tuln | awk '($5!~/%lo:/ &amp;&amp; $5!~/127.0.0.1:/ &amp;&amp; $5!~/::1/) {split($5, a, \":\"); print a[2]}' | sort | uniq | while read -r lpn; do\n! grep -Pq \"^\\h*$lpn\\b\" &lt;&lt;&lt; \"$ufw_out\" &amp;&amp; echo \"- Port: \\\"$lpn\\\" is missing a firewall rule\"\ndone\n</code></pre></p> <p>Nothing should be returned</p>","tags":["Level 1","Workstation","Server","Network Configuration","Firewall Configuration","Configure UncomplicatedFirewall","Automated","4.4 Implement and Manage a Firewall on Servers","IG1","IG2","IG3","T1562","T1562.004","TA0011","M1031","M1037"]},{"location":"3-Network-Configuration/3.5-Firewall-Configuration/3.5.1-Configure-UncomplicatedFirewall/3.5.1.6-Ensure-ufw-firewall-rules-exist-for-all-open-ports/#remediation","title":"Remediation","text":"<p>For each port identified in the audit which does not have a firewall rule, add rule for accepting or denying inbound connections:</p> <p>Example: <pre><code># ufw allow in &lt;port&gt;/&lt;tcp or udp protocol&gt;\n</code></pre></p>","tags":["Level 1","Workstation","Server","Network Configuration","Firewall Configuration","Configure UncomplicatedFirewall","Automated","4.4 Implement and Manage a Firewall on Servers","IG1","IG2","IG3","T1562","T1562.004","TA0011","M1031","M1037"]},{"location":"3-Network-Configuration/3.5-Firewall-Configuration/3.5.1-Configure-UncomplicatedFirewall/3.5.1.7-Ensure-ufw-default-deny-firewall-policy/","title":"3.5.1.7 Ensure ufw default deny firewall policy","text":"","tags":["Level 1","Workstation","Server","Network Configuration","Firewall Configuration","Configure UncomplicatedFirewall","Automated","4.4 Implement and Manage a Firewall on Servers","4.5 Implement and Manage a Firewall on End-User Devices","IG1","IG2","IG3","T1562","T1562.004","TA0011","M1031","M1037"]},{"location":"3-Network-Configuration/3.5-Firewall-Configuration/3.5.1-Configure-UncomplicatedFirewall/3.5.1.7-Ensure-ufw-default-deny-firewall-policy/#audit","title":"Audit","text":"<p>Run the following command and verify that the default policy for incoming, outgoing, and routed directions is deny , reject , or disabled: <pre><code># ufw status verbose | grep Default:\n</code></pre></p> <p>Example output: <pre><code>Default: deny (incoming), deny (outgoing), disabled (routed)\n</code></pre></p>","tags":["Level 1","Workstation","Server","Network Configuration","Firewall Configuration","Configure UncomplicatedFirewall","Automated","4.4 Implement and Manage a Firewall on Servers","4.5 Implement and Manage a Firewall on End-User Devices","IG1","IG2","IG3","T1562","T1562.004","TA0011","M1031","M1037"]},{"location":"3-Network-Configuration/3.5-Firewall-Configuration/3.5.1-Configure-UncomplicatedFirewall/3.5.1.7-Ensure-ufw-default-deny-firewall-policy/#remediation","title":"Remediation","text":"<p>Run the following commands to implement a default deny policy: <pre><code># ufw default deny incoming\n# ufw default deny outgoing\n# ufw default deny routed\n</code></pre></p>","tags":["Level 1","Workstation","Server","Network Configuration","Firewall Configuration","Configure UncomplicatedFirewall","Automated","4.4 Implement and Manage a Firewall on Servers","4.5 Implement and Manage a Firewall on End-User Devices","IG1","IG2","IG3","T1562","T1562.004","TA0011","M1031","M1037"]},{"location":"3-Network-Configuration/3.5-Firewall-Configuration/3.5.2-Configure-nftables/3.5.2.1-Ensure-nftables-is-installed/","title":"3.5.2.1 Ensure nftables is installed","text":"","tags":["Level 1","Workstation","Server","Network Configuration","Firewall Configuration","Configure nftables","Automated","4.4 Implement and Manage a Firewall on Servers","4.5 Implement and Manage a Firewall on End-User Devices","IG1","IG2","IG3","T1562","T1562.004","TA0011","M1031","M1037"]},{"location":"3-Network-Configuration/3.5-Firewall-Configuration/3.5.2-Configure-nftables/3.5.2.1-Ensure-nftables-is-installed/#audit","title":"Audit","text":"<p>Run the following command to verify that nftables is installed: <pre><code># dpkg-query -s nftables | grep 'Status: install ok installed'\nStatus: install ok installed\n</code></pre></p>","tags":["Level 1","Workstation","Server","Network Configuration","Firewall Configuration","Configure nftables","Automated","4.4 Implement and Manage a Firewall on Servers","4.5 Implement and Manage a Firewall on End-User Devices","IG1","IG2","IG3","T1562","T1562.004","TA0011","M1031","M1037"]},{"location":"3-Network-Configuration/3.5-Firewall-Configuration/3.5.2-Configure-nftables/3.5.2.1-Ensure-nftables-is-installed/#remediation","title":"Remediation","text":"<p>Run the following command to install nftables: <pre><code># apt install nftables\n</code></pre></p>","tags":["Level 1","Workstation","Server","Network Configuration","Firewall Configuration","Configure nftables","Automated","4.4 Implement and Manage a Firewall on Servers","4.5 Implement and Manage a Firewall on End-User Devices","IG1","IG2","IG3","T1562","T1562.004","TA0011","M1031","M1037"]},{"location":"3-Network-Configuration/3.5-Firewall-Configuration/3.5.2-Configure-nftables/3.5.2.10-Ensure-nftables-rules-are-permanent/","title":"3.5.2.10 Ensure nftables rules are permanent","text":"","tags":["Level 1","Workstation","Server","Network Configuration","Firewall Configuration","Configure nftables","Automated","4.4 Implement and Manage a Firewall on Servers","4.5 Implement and Manage a Firewall on End-User Devices","IG1","IG2","IG3","T1562","T1562.004","TA0011","M1031"]},{"location":"3-Network-Configuration/3.5-Firewall-Configuration/3.5.2-Configure-nftables/3.5.2.10-Ensure-nftables-rules-are-permanent/#audit","title":"Audit","text":"<p>Run the following commands to verify that input, forward, and output base chains are configured to be applied to a nftables ruleset on boot:</p> <p>Run the following command to verify the input base chain: <pre><code># [ -n \"$(grep -E '^\\s*include' /etc/nftables.conf)\" ] &amp;&amp; awk '/hook input/,/}/' $(awk '$1 ~ /^\\s*include/ { gsub(\"\\\"\",\"\",$2);print $2 }' /etc/nftables.conf)\n</code></pre></p> <p>Output should be similar to: <pre><code> type filter hook input priority 0; policy drop;\n# Ensure loopback traffic is configured\niif \"lo\" accept\n ip saddr 127.0.0.0/8 counter packets 0 bytes 0 drop\n ip6 saddr ::1 counter packets 0 bytes 0 drop\n\n# Ensure established connections are configured\nip protocol tcp ct state established accept\n ip protocol udp ct state established accept\n ip protocol icmp ct state established accept\n\n# Accept port 22(SSH) traffic from anywhere\ntcp dport ssh accept\n\n# Accept ICMP and IGMP from anywhere\nicmpv6 type { destination-unreachable, packet-too-big, timeexceeded, parameter-problem, mld-listener-query, mld-listener-report, mldlistener-done, nd-router-solicit, nd-router-advert, nd-neighbor-solicit, ndneighbor-advert, ind-neighbor-solicit, ind-neighbor-advert, mld2-listenerreport } accept\n</code></pre></p> <p>Review the input base chain to ensure that it follows local site policy</p> <p>Run the following command to verify the forward base chain: <pre><code># [ -n \"$(grep -E '^\\s*include' /etc/nftables.conf)\" ] &amp;&amp; awk '/hook forward/,/}/' $(awk '$1 ~ /^\\s*include/ { gsub(\"\\\"\",\"\",$2);print $2 }' /etc/nftables.conf)\n</code></pre></p> <p>Output should be similar to: <pre><code> # Base chain for hook forward named forward (Filters forwarded network packets)\nchain forward {\ntype filter hook forward priority 0; policy drop;\n}\n</code></pre></p> <p>Review the forward base chain to ensure that it follows local site policy.</p> <p>Run the following command to verify the forward base chain: <pre><code># [ -n \"$(grep -E '^\\s*include' /etc/nftables.conf)\" ] &amp;&amp; awk '/hook output/,/}/' $(awk '$1 ~ /^\\s*include/ { gsub(\"\\\"\",\"\",$2);print $2 }' /etc/nftables.conf)\n</code></pre></p> <p>Output should be similar to: <pre><code> # Base chain for hook output named output (Filters outbound network packets)\nchain output {\ntype filter hook output priority 0; policy drop;\n# Ensure outbound and established connections are configured\nip protocol tcp ct state established,related,new accept\n ip protocol tcp ct state established,related,new accept\n ip protocol udp ct state established,related,new accept\n ip protocol icmp ct state established,related,new accept\n }\n</code></pre></p> <p>Review the output base chain to ensure that it follows local site policy.</p>","tags":["Level 1","Workstation","Server","Network Configuration","Firewall Configuration","Configure nftables","Automated","4.4 Implement and Manage a Firewall on Servers","4.5 Implement and Manage a Firewall on End-User Devices","IG1","IG2","IG3","T1562","T1562.004","TA0011","M1031"]},{"location":"3-Network-Configuration/3.5-Firewall-Configuration/3.5.2-Configure-nftables/3.5.2.10-Ensure-nftables-rules-are-permanent/#remediation","title":"Remediation","text":"<p>Edit the /etc/nftables.conf file and un-comment or add a line with <code>include &lt;Absolute path to nftables rules file&gt;</code> for each nftables file you want included in the nftables ruleset on boot</p> <p>Example: <pre><code># vi /etc/nftables.conf\n</code></pre></p> <p>Add the line: <pre><code>include \"/etc/nftables.rules\"\n</code></pre></p>","tags":["Level 1","Workstation","Server","Network Configuration","Firewall Configuration","Configure nftables","Automated","4.4 Implement and Manage a Firewall on Servers","4.5 Implement and Manage a Firewall on End-User Devices","IG1","IG2","IG3","T1562","T1562.004","TA0011","M1031"]},{"location":"3-Network-Configuration/3.5-Firewall-Configuration/3.5.2-Configure-nftables/3.5.2.2-Ensure-ufw-is-uninstalled-or-disabled-with-nftables/","title":"3.5.2.2 Ensure ufw is uninstalled or disabled with nftables","text":"","tags":["Level 1","Workstation","Server","Network Configuration","Firewall Configuration","Configure nftables","Automated","4.4 Implement and Manage a Firewall on Servers","4.5 Implement and Manage a Firewall on End-User Devices","IG1","IG2","IG3","T1562","T1562.004","TA0005"]},{"location":"3-Network-Configuration/3.5-Firewall-Configuration/3.5.2-Configure-nftables/3.5.2.2-Ensure-ufw-is-uninstalled-or-disabled-with-nftables/#audit","title":"Audit","text":"<p>Run the following commands to verify that ufw is either not installed or inactive. Only one of the following needs to pass.</p> <p>Run the following command to verify that ufw is not installed: <pre><code># dpkg-query -s ufw | grep 'Status: install ok installed'\npackage 'ufw' is not installed and no information is available\n</code></pre></p> <p>Run the following command to verify ufw is disabled: <pre><code># ufw status\nStatus: inactive\n</code></pre></p>","tags":["Level 1","Workstation","Server","Network Configuration","Firewall Configuration","Configure nftables","Automated","4.4 Implement and Manage a Firewall on Servers","4.5 Implement and Manage a Firewall on End-User Devices","IG1","IG2","IG3","T1562","T1562.004","TA0005"]},{"location":"3-Network-Configuration/3.5-Firewall-Configuration/3.5.2-Configure-nftables/3.5.2.2-Ensure-ufw-is-uninstalled-or-disabled-with-nftables/#remediation","title":"Remediation","text":"<p>Run one of the following commands to either remove ufw or disable ufw</p> <p>Run the following command to remove ufw: <pre><code># apt purge ufw\n</code></pre></p> <p>Run the following command to disable ufw: <pre><code># ufw disable\n</code></pre></p>","tags":["Level 1","Workstation","Server","Network Configuration","Firewall Configuration","Configure nftables","Automated","4.4 Implement and Manage a Firewall on Servers","4.5 Implement and Manage a Firewall on End-User Devices","IG1","IG2","IG3","T1562","T1562.004","TA0005"]},{"location":"3-Network-Configuration/3.5-Firewall-Configuration/3.5.2-Configure-nftables/3.5.2.3-Ensure-iptables-are-flushed-with-nftables/","title":"3.5.2.3 Ensure iptables are flushed with nftables","text":"","tags":["Level 1","Workstation","Server","Network Configuration","Firewall Configuration","Configure nftables","Manual","4.4 Implement and Manage a Firewall on Servers","4.5 Implement and Manage a Firewall on End-User Devices","IG1","IG2","IG3","T1562","T1562.004","TA0005"]},{"location":"3-Network-Configuration/3.5-Firewall-Configuration/3.5.2-Configure-nftables/3.5.2.3-Ensure-iptables-are-flushed-with-nftables/#audit","title":"Audit","text":"<p>Run the following commands to ensure no iptables rules exist</p> <p>For iptables: <pre><code># iptables -L\n</code></pre></p> <p>No rules should be returned</p> <p>For ip6tables: <pre><code># ip6tables -L\n</code></pre></p> <p>No rules should be returned</p>","tags":["Level 1","Workstation","Server","Network Configuration","Firewall Configuration","Configure nftables","Manual","4.4 Implement and Manage a Firewall on Servers","4.5 Implement and Manage a Firewall on End-User Devices","IG1","IG2","IG3","T1562","T1562.004","TA0005"]},{"location":"3-Network-Configuration/3.5-Firewall-Configuration/3.5.2-Configure-nftables/3.5.2.3-Ensure-iptables-are-flushed-with-nftables/#remediation","title":"Remediation","text":"<p>Run the following commands to flush iptables:</p> <p>For iptables: <pre><code># iptables -F\n</code></pre></p> <p>For ip6tables: <pre><code># ip6tables -F\n</code></pre></p>","tags":["Level 1","Workstation","Server","Network Configuration","Firewall Configuration","Configure nftables","Manual","4.4 Implement and Manage a Firewall on Servers","4.5 Implement and Manage a Firewall on End-User Devices","IG1","IG2","IG3","T1562","T1562.004","TA0005"]},{"location":"3-Network-Configuration/3.5-Firewall-Configuration/3.5.2-Configure-nftables/3.5.2.4-Ensure-a-nftables-table-exists/","title":"3.5.2.4 Ensure a nftables table exists","text":"","tags":["Level 1","Workstation","Server","Network Configuration","Firewall Configuration","Configure nftables","Automated","4.4 Implement and Manage a Firewall on Servers","4.5 Implement and Manage a Firewall on End-User Devices","IG1","IG2","IG3","T1562","T1562.004","TA0011","M1031","M1037"]},{"location":"3-Network-Configuration/3.5-Firewall-Configuration/3.5.2-Configure-nftables/3.5.2.4-Ensure-a-nftables-table-exists/#audit","title":"Audit","text":"<p>Run the following command to verify that a nftables table exists: <pre><code># nft list tables\n</code></pre></p> <p>Return should include a list of nftables:</p> <p>Example: <pre><code>table inet filter\n</code></pre></p>","tags":["Level 1","Workstation","Server","Network Configuration","Firewall Configuration","Configure nftables","Automated","4.4 Implement and Manage a Firewall on Servers","4.5 Implement and Manage a Firewall on End-User Devices","IG1","IG2","IG3","T1562","T1562.004","TA0011","M1031","M1037"]},{"location":"3-Network-Configuration/3.5-Firewall-Configuration/3.5.2-Configure-nftables/3.5.2.4-Ensure-a-nftables-table-exists/#remediation","title":"Remediation","text":"<p>Run the following command to create a table in nftables <pre><code># nft create table inet &lt;table name&gt;\n</code></pre></p> <p>Example: <pre><code># nft create table inet filter\n</code></pre></p>","tags":["Level 1","Workstation","Server","Network Configuration","Firewall Configuration","Configure nftables","Automated","4.4 Implement and Manage a Firewall on Servers","4.5 Implement and Manage a Firewall on End-User Devices","IG1","IG2","IG3","T1562","T1562.004","TA0011","M1031","M1037"]},{"location":"3-Network-Configuration/3.5-Firewall-Configuration/3.5.2-Configure-nftables/3.5.2.5-Ensure-nftables-base-chains-exist/","title":"3.5.2.5 Ensure nftables base chains exist","text":"","tags":["Level 1","Workstation","Server","Network Configuration","Firewall Configuration","Configure nftables","Automated","4.4 Implement and Manage a Firewall on Servers","4.5 Implement and Manage a Firewall on End-User Devices","IG1","IG2","IG3","T1562","T1562.004","TA0005"]},{"location":"3-Network-Configuration/3.5-Firewall-Configuration/3.5.2-Configure-nftables/3.5.2.5-Ensure-nftables-base-chains-exist/#audit","title":"Audit","text":"<p>Run the following commands and verify that base chains exist for INPUT. <pre><code># nft list ruleset | grep 'hook input'\ntype filter hook input priority 0;\n</code></pre></p> <p>Run the following commands and verify that base chains exist for FORWARD. <pre><code># nft list ruleset | grep 'hook forward'\ntype filter hook forward priority 0;\n</code></pre></p> <p>Run the following commands and verify that base chains exist for OUTPUT. <pre><code># nft list ruleset | grep 'hook output'\ntype filter hook output priority 0;\n</code></pre></p>","tags":["Level 1","Workstation","Server","Network Configuration","Firewall Configuration","Configure nftables","Automated","4.4 Implement and Manage a Firewall on Servers","4.5 Implement and Manage a Firewall on End-User Devices","IG1","IG2","IG3","T1562","T1562.004","TA0005"]},{"location":"3-Network-Configuration/3.5-Firewall-Configuration/3.5.2-Configure-nftables/3.5.2.5-Ensure-nftables-base-chains-exist/#remediation","title":"Remediation","text":"<p>Run the following command to create the base chains: <pre><code># nft create chain inet &lt;table name&gt; &lt;base chain name&gt; { type filter hook &lt;(input|forward|output)&gt; priority 0 \\; }\n</code></pre></p> <p>Example: <pre><code># nft create chain inet filter input { type filter hook input priority 0 \\; }\n# nft create chain inet filter forward { type filter hook forward priority 0 \\; }\n# nft create chain inet filter output { type filter hook output priority 0 \\; }\n</code></pre></p>","tags":["Level 1","Workstation","Server","Network Configuration","Firewall Configuration","Configure nftables","Automated","4.4 Implement and Manage a Firewall on Servers","4.5 Implement and Manage a Firewall on End-User Devices","IG1","IG2","IG3","T1562","T1562.004","TA0005"]},{"location":"3-Network-Configuration/3.5-Firewall-Configuration/3.5.2-Configure-nftables/3.5.2.6-Ensure-nftables-loopback-traffic-is-configured/","title":"3.5.2.6 Ensure nftables loopback traffic is configured","text":"","tags":["Level 1","Workstation","Server","Network Configuration","Firewall Configuration","Configure nftables","Automated","4.4 Implement and Manage a Firewall on Servers","4.5 Implement and Manage a Firewall on End-User Devices","IG1","IG2","IG3","T1562","T1562.004","TA0005"]},{"location":"3-Network-Configuration/3.5-Firewall-Configuration/3.5.2-Configure-nftables/3.5.2.6-Ensure-nftables-loopback-traffic-is-configured/#audit","title":"Audit","text":"<p>Run the following commands to verify that the loopback interface is configured: <pre><code># nft list ruleset | awk '/hook input/,/}/' | grep 'iif \"lo\" accept'\niif \"lo\" accept\n\n# nft list ruleset | awk '/hook input/,/}/' | grep 'ip saddr'\nip saddr 127.0.0.0/8 counter packets 0 bytes 0 drop\n</code></pre></p> <p>IF IPv6 is enabled on the system:</p> <p>Run the following command to verify that the IPv6 loopback interface is configured: <pre><code># nft list ruleset | awk '/hook input/,/}/' | grep 'ip6 saddr'\nip6 saddr ::1 counter packets 0 bytes 0 drop\n</code></pre></p>","tags":["Level 1","Workstation","Server","Network Configuration","Firewall Configuration","Configure nftables","Automated","4.4 Implement and Manage a Firewall on Servers","4.5 Implement and Manage a Firewall on End-User Devices","IG1","IG2","IG3","T1562","T1562.004","TA0005"]},{"location":"3-Network-Configuration/3.5-Firewall-Configuration/3.5.2-Configure-nftables/3.5.2.6-Ensure-nftables-loopback-traffic-is-configured/#remediation","title":"Remediation","text":"<p>Run the following commands to implement the loopback rules: <pre><code># nft add rule inet filter input iif lo accept\n# nft create rule inet filter input ip saddr 127.0.0.0/8 counter drop\n</code></pre></p> <p>IF IPv6 is enabled on the system:</p> <p>Run the following command to implement the IPv6 loopback rule: <pre><code># nft add rule inet filter input ip6 saddr ::1 counter drop\n</code></pre></p>","tags":["Level 1","Workstation","Server","Network Configuration","Firewall Configuration","Configure nftables","Automated","4.4 Implement and Manage a Firewall on Servers","4.5 Implement and Manage a Firewall on End-User Devices","IG1","IG2","IG3","T1562","T1562.004","TA0005"]},{"location":"3-Network-Configuration/3.5-Firewall-Configuration/3.5.2-Configure-nftables/3.5.2.7-Ensure-nftables-outbound-and-established-connections-are-configured/","title":"3.5.2.7 Ensure nftables outbound and established connections are configured","text":"","tags":["Level 1","Workstation","Server","Network Configuration","Firewall Configuration","Configure nftables","Manual","4.4 Implement and Manage a Firewall on Servers","4.5 Implement and Manage a Firewall on End-User Devices","IG1","IG2","IG3","T1562","TA0011","M1031","M1037"]},{"location":"3-Network-Configuration/3.5-Firewall-Configuration/3.5.2-Configure-nftables/3.5.2.7-Ensure-nftables-outbound-and-established-connections-are-configured/#audit","title":"Audit","text":"<p>Run the following commands and verify all rules for established incoming connections match site policy: site policy: <pre><code># nft list ruleset | awk '/hook input/,/}/' | grep -E 'ip protocol (tcp|udp|icmp) ct state'\n</code></pre></p> <p>Output should be similar to: <pre><code>ip protocol tcp ct state established accept\nip protocol udp ct state established accept\nip protocol icmp ct state established accept\n</code></pre></p> <p>Run the folllowing command and verify all rules for new and established outbound connections match site policy <pre><code># nft list ruleset | awk '/hook output/,/}/' | grep -E 'ip protocol (tcp|udp|icmp) ct state'\n</code></pre></p> <p>Output should be similar to: <pre><code>ip protocol tcp ct state established,related,new accept\nip protocol udp ct state established,related,new accept\nip protocol icmp ct state established,related,new accept\n</code></pre></p>","tags":["Level 1","Workstation","Server","Network Configuration","Firewall Configuration","Configure nftables","Manual","4.4 Implement and Manage a Firewall on Servers","4.5 Implement and Manage a Firewall on End-User Devices","IG1","IG2","IG3","T1562","TA0011","M1031","M1037"]},{"location":"3-Network-Configuration/3.5-Firewall-Configuration/3.5.2-Configure-nftables/3.5.2.7-Ensure-nftables-outbound-and-established-connections-are-configured/#remediation","title":"Remediation","text":"<p>Configure nftables in accordance with site policy. The following commands will implement a policy to allow all outbound connections and all established connections: <pre><code># nft add rule inet filter input ip protocol tcp ct state established accept\n# nft add rule inet filter input ip protocol udp ct state established accept\n# nft add rule inet filter input ip protocol icmp ct state established accept\n# nft add rule inet filter output ip protocol tcp ct state new,related,established accept\n# nft add rule inet filter output ip protocol udp ct state new,related,established accept\n# nft add rule inet filter output ip protocol icmp ct state new,related,established accept\n</code></pre></p>","tags":["Level 1","Workstation","Server","Network Configuration","Firewall Configuration","Configure nftables","Manual","4.4 Implement and Manage a Firewall on Servers","4.5 Implement and Manage a Firewall on End-User Devices","IG1","IG2","IG3","T1562","TA0011","M1031","M1037"]},{"location":"3-Network-Configuration/3.5-Firewall-Configuration/3.5.2-Configure-nftables/3.5.2.8-Ensure-nftables-default-deny-firewall-policy/","title":"3.5.2.8 Ensure nftables default deny firewall policy","text":"","tags":["Level 1","Workstation","Server","Network Configuration","Firewall Configuration","Configure nftables","Automated","4.4 Implement and Manage a Firewall on Servers","4.5 Implement and Manage a Firewall on End-User Devices","IG1","IG2","IG3","T1562","T1562.004","TA0011","M1031","M1037"]},{"location":"3-Network-Configuration/3.5-Firewall-Configuration/3.5.2-Configure-nftables/3.5.2.8-Ensure-nftables-default-deny-firewall-policy/#audit","title":"Audit","text":"<p>Run the following commands and verify that base chains contain a policy of DROP. <pre><code># nft list ruleset | grep 'hook input'\ntype filter hook input priority 0; policy drop;\n# nft list ruleset | grep 'hook forward'\ntype filter hook forward priority 0; policy drop;\n# nft list ruleset | grep 'hook output'\ntype filter hook output priority 0; policy drop;\n</code></pre></p>","tags":["Level 1","Workstation","Server","Network Configuration","Firewall Configuration","Configure nftables","Automated","4.4 Implement and Manage a Firewall on Servers","4.5 Implement and Manage a Firewall on End-User Devices","IG1","IG2","IG3","T1562","T1562.004","TA0011","M1031","M1037"]},{"location":"3-Network-Configuration/3.5-Firewall-Configuration/3.5.2-Configure-nftables/3.5.2.8-Ensure-nftables-default-deny-firewall-policy/#remediation","title":"Remediation","text":"<p>Run the following command for the base chains with the input, forward, and output hooks to implement a default DROP policy: <pre><code># nft chain &lt;table family&gt; &lt;table name&gt; &lt;chain name&gt; { policy drop \\; }\n</code></pre></p> <p>Example: <pre><code># nft chain inet filter input { policy drop \\; }\n# nft chain inet filter forward { policy drop \\; }\n# nft chain inet filter output { policy drop \\; }\n</code></pre></p> <p>Default Value:</p> <p>accept</p>","tags":["Level 1","Workstation","Server","Network Configuration","Firewall Configuration","Configure nftables","Automated","4.4 Implement and Manage a Firewall on Servers","4.5 Implement and Manage a Firewall on End-User Devices","IG1","IG2","IG3","T1562","T1562.004","TA0011","M1031","M1037"]},{"location":"3-Network-Configuration/3.5-Firewall-Configuration/3.5.2-Configure-nftables/3.5.2.9-Ensure-nftables-service-is-enabled/","title":"3.5.2.9 Ensure nftables service is enabled","text":"","tags":["Level 1","Workstation","Server","Network Configuration","Firewall Configuration","Configure nftables","Automated","4.4 Implement and Manage a Firewall on Servers","4.5 Implement and Manage a Firewall on End-User Devices","IG1","IG2","IG3","T1562","T1562.004","TA0011","M1031","M1037"]},{"location":"3-Network-Configuration/3.5-Firewall-Configuration/3.5.2-Configure-nftables/3.5.2.9-Ensure-nftables-service-is-enabled/#audit","title":"Audit","text":"<p>Run the following command and verify that the nftables service is enabled: <pre><code># systemctl is-enabled nftables\nenabled\n</code></pre></p>","tags":["Level 1","Workstation","Server","Network Configuration","Firewall Configuration","Configure nftables","Automated","4.4 Implement and Manage a Firewall on Servers","4.5 Implement and Manage a Firewall on End-User Devices","IG1","IG2","IG3","T1562","T1562.004","TA0011","M1031","M1037"]},{"location":"3-Network-Configuration/3.5-Firewall-Configuration/3.5.2-Configure-nftables/3.5.2.9-Ensure-nftables-service-is-enabled/#remediation","title":"Remediation","text":"<p>Run the following command to enable the nftables service: <pre><code># systemctl enable nftables\n</code></pre></p>","tags":["Level 1","Workstation","Server","Network Configuration","Firewall Configuration","Configure nftables","Automated","4.4 Implement and Manage a Firewall on Servers","4.5 Implement and Manage a Firewall on End-User Devices","IG1","IG2","IG3","T1562","T1562.004","TA0011","M1031","M1037"]},{"location":"3-Network-Configuration/3.5-Firewall-Configuration/3.5.3-Configure-iptables/3.5.3.1-configure-iptables-software/3.5.3.1.1-Ensure-iptables-packages-are-installed/","title":"3.5.3.1.1 Ensure iptables packages are installed","text":"","tags":["Level 1","Workstation","Server","Network Configuration","Firewall Configuration","Configure iptables","Configure iptables software","Automated","4.4 Implement and Manage a Firewall on Servers","4.5 Implement and Manage a Firewall on End-User Devices","IG1","IG2","IG3","T1562","T1562.004","TA0011","M1031","M1037"]},{"location":"3-Network-Configuration/3.5-Firewall-Configuration/3.5.3-Configure-iptables/3.5.3.1-configure-iptables-software/3.5.3.1.1-Ensure-iptables-packages-are-installed/#audit","title":"Audit","text":"<p>Run the following command to verify that iptables and iptables-persistent are installed: <pre><code># apt list iptables iptables-persistent | grep installed\niptables-persistent/&lt;version&gt; [installed,automatic]\niptables/&lt;version&gt; [installed,automatic]\n</code></pre></p>","tags":["Level 1","Workstation","Server","Network Configuration","Firewall Configuration","Configure iptables","Configure iptables software","Automated","4.4 Implement and Manage a Firewall on Servers","4.5 Implement and Manage a Firewall on End-User Devices","IG1","IG2","IG3","T1562","T1562.004","TA0011","M1031","M1037"]},{"location":"3-Network-Configuration/3.5-Firewall-Configuration/3.5.3-Configure-iptables/3.5.3.1-configure-iptables-software/3.5.3.1.1-Ensure-iptables-packages-are-installed/#remediation","title":"Remediation","text":"<p>Run the following command to install iptables and iptables-persistent <pre><code># apt install iptables iptables-persistent\n</code></pre></p>","tags":["Level 1","Workstation","Server","Network Configuration","Firewall Configuration","Configure iptables","Configure iptables software","Automated","4.4 Implement and Manage a Firewall on Servers","4.5 Implement and Manage a Firewall on End-User Devices","IG1","IG2","IG3","T1562","T1562.004","TA0011","M1031","M1037"]},{"location":"3-Network-Configuration/3.5-Firewall-Configuration/3.5.3-Configure-iptables/3.5.3.1-configure-iptables-software/3.5.3.1.2-Ensure-nftables-is-not-installed-with-iptables/","title":"3.5.3.1.2 Ensure nftables is not installed with iptables","text":"","tags":["Level 1","Workstation","Server","Network Configuration","Firewall Configuration","Configure iptables","Configure iptables software","Automated","4.4 Implement and Manage a Firewall on Servers","4.5 Implement and Manage a Firewall on End-User Devices","IG1","IG2","IG3","T1562","T1562.004","TA0011"]},{"location":"3-Network-Configuration/3.5-Firewall-Configuration/3.5.3-Configure-iptables/3.5.3.1-configure-iptables-software/3.5.3.1.2-Ensure-nftables-is-not-installed-with-iptables/#audit","title":"Audit","text":"<p>Run the following commend to verify that nftables is not installed: <pre><code># dpkg-query -W -f='${binary:Package}\\t${Status}\\t${db:Status-Status}\\n' nftables\nnftables unknown ok not-installed not-installed\n</code></pre></p>","tags":["Level 1","Workstation","Server","Network Configuration","Firewall Configuration","Configure iptables","Configure iptables software","Automated","4.4 Implement and Manage a Firewall on Servers","4.5 Implement and Manage a Firewall on End-User Devices","IG1","IG2","IG3","T1562","T1562.004","TA0011"]},{"location":"3-Network-Configuration/3.5-Firewall-Configuration/3.5.3-Configure-iptables/3.5.3.1-configure-iptables-software/3.5.3.1.2-Ensure-nftables-is-not-installed-with-iptables/#remediation","title":"Remediation","text":"<p>Run the following command to remove nftables: <pre><code># apt purge nftables\n</code></pre></p>","tags":["Level 1","Workstation","Server","Network Configuration","Firewall Configuration","Configure iptables","Configure iptables software","Automated","4.4 Implement and Manage a Firewall on Servers","4.5 Implement and Manage a Firewall on End-User Devices","IG1","IG2","IG3","T1562","T1562.004","TA0011"]},{"location":"3-Network-Configuration/3.5-Firewall-Configuration/3.5.3-Configure-iptables/3.5.3.1-configure-iptables-software/3.5.3.1.3-Ensure-ufw-is-uninstalled-or-disabled-with-iptables/","title":"3.5.3.1.3 Ensure ufw is uninstalled or disabled with iptables","text":"","tags":["Level 1","Workstation","Server","Network Configuration","Firewall Configuration","Configure iptables","Configure iptables software","Automated","4.4 Implement and Manage a Firewall on Servers","4.5 Implement and Manage a Firewall on End-User Devices","IG1","IG2","IG3","T1562","T1562.004","TA0011"]},{"location":"3-Network-Configuration/3.5-Firewall-Configuration/3.5.3-Configure-iptables/3.5.3.1-configure-iptables-software/3.5.3.1.3-Ensure-ufw-is-uninstalled-or-disabled-with-iptables/#audit","title":"Audit","text":"<p>Run the following commands to verify that ufw is either not installed or disabled. Only one of the following needs to pass.</p> <p>Run the following command to verify that ufw is not installed: <pre><code># dpkg-query -W -f='${binary:Package}\\t${Status}\\t${db:Status-Status}\\n' ufw\nufw unknown ok not-installed not-installed\n</code></pre></p> <p>Run the following command to verify ufw is disabled: <pre><code># ufw status\nStatus: inactive\n</code></pre></p> <p>Run the following commands to verify that the ufw service is masked: <pre><code># systemctl is-enabled ufw\nmasked\n</code></pre></p>","tags":["Level 1","Workstation","Server","Network Configuration","Firewall Configuration","Configure iptables","Configure iptables software","Automated","4.4 Implement and Manage a Firewall on Servers","4.5 Implement and Manage a Firewall on End-User Devices","IG1","IG2","IG3","T1562","T1562.004","TA0011"]},{"location":"3-Network-Configuration/3.5-Firewall-Configuration/3.5.3-Configure-iptables/3.5.3.1-configure-iptables-software/3.5.3.1.3-Ensure-ufw-is-uninstalled-or-disabled-with-iptables/#remediation","title":"Remediation","text":"<p>Run one of the following commands to either remove ufw or stop and mask ufw</p> <p>Run the following command to remove ufw: <pre><code># apt purge ufw\n</code></pre></p> <p>OR</p> <p>Run the following commands to disable ufw: <pre><code># ufw disable\n# systemctl stop ufw\n# systemctl mask ufw\n</code></pre></p>","tags":["Level 1","Workstation","Server","Network Configuration","Firewall Configuration","Configure iptables","Configure iptables software","Automated","4.4 Implement and Manage a Firewall on Servers","4.5 Implement and Manage a Firewall on End-User Devices","IG1","IG2","IG3","T1562","T1562.004","TA0011"]},{"location":"3-Network-Configuration/3.5-Firewall-Configuration/3.5.3-Configure-iptables/3.5.3.2-configure-ipv4-iptables/3.5.3.2.1-Ensure-iptables-default-deny-firewall-policy/","title":"3.5.3.2.1 Ensure iptables default deny firewall policy","text":"","tags":["Level 1","Workstation","Server","Network Configuration","Firewall Configuration","Configure iptables","Configure IPv4 iptables","Automated","4.4 Implement and Manage a Firewall on Servers","4.5 Implement and Manage a Firewall on End-User Devices","IG1","IG2","IG3","T1562","T1562.004","TA0011","M1031","M1037"]},{"location":"3-Network-Configuration/3.5-Firewall-Configuration/3.5.3-Configure-iptables/3.5.3.2-configure-ipv4-iptables/3.5.3.2.1-Ensure-iptables-default-deny-firewall-policy/#audit","title":"Audit","text":"<p>Run the following command and verify that the policy for the INPUT, OUTPUT, and FORWARD chains is DROP or REJECT: <pre><code># iptables -L\nChain INPUT (policy DROP)\nChain FORWARD (policy DROP)\nChain OUTPUT (policy DROP)\n</code></pre></p>","tags":["Level 1","Workstation","Server","Network Configuration","Firewall Configuration","Configure iptables","Configure IPv4 iptables","Automated","4.4 Implement and Manage a Firewall on Servers","4.5 Implement and Manage a Firewall on End-User Devices","IG1","IG2","IG3","T1562","T1562.004","TA0011","M1031","M1037"]},{"location":"3-Network-Configuration/3.5-Firewall-Configuration/3.5.3-Configure-iptables/3.5.3.2-configure-ipv4-iptables/3.5.3.2.1-Ensure-iptables-default-deny-firewall-policy/#remediation","title":"Remediation","text":"<p>Run the following commands to implement a default DROP policy: <pre><code># iptables -P INPUT DROP\n# iptables -P OUTPUT DROP\n# iptables -P FORWARD DROP\n</code></pre></p>","tags":["Level 1","Workstation","Server","Network Configuration","Firewall Configuration","Configure iptables","Configure IPv4 iptables","Automated","4.4 Implement and Manage a Firewall on Servers","4.5 Implement and Manage a Firewall on End-User Devices","IG1","IG2","IG3","T1562","T1562.004","TA0011","M1031","M1037"]},{"location":"3-Network-Configuration/3.5-Firewall-Configuration/3.5.3-Configure-iptables/3.5.3.2-configure-ipv4-iptables/3.5.3.2.2-Ensure-iptables-loopback-traffic-is-configured/","title":"3.5.3.2.2 Ensure iptables loopback traffic is configured","text":"","tags":["Level 1","Workstation","Server","Network Configuration","Firewall Configuration","Configure iptables","Configure IPv4 iptables","Automated","4.4 Implement and Manage a Firewall on Servers","4.5 Implement and Manage a Firewall on End-User Devices","IG1","IG2","IG3","T1562","T1562.004","TA0011","M1031","M1037"]},{"location":"3-Network-Configuration/3.5-Firewall-Configuration/3.5.3-Configure-iptables/3.5.3.2-configure-ipv4-iptables/3.5.3.2.2-Ensure-iptables-loopback-traffic-is-configured/#audit","title":"Audit","text":"<p>Run the following commands and verify output includes the listed rules in order (packet and byte counts may differ): <pre><code># iptables -L INPUT -v -n\nChain INPUT (policy DROP 0 packets, 0 bytes)\npkts bytes target prot opt in out source destination\n 0 0 ACCEPT all -- lo * 0.0.0.0/0 0.0.0.0/0\n 0 0 DROP all -- * * 127.0.0.0/8 0.0.0.0/0\n\n# iptables -L OUTPUT -v -n\nChain OUTPUT (policy DROP 0 packets, 0 bytes)\npkts bytes target prot opt in out source destination\n 0 0 ACCEPT all -- * lo 0.0.0.0/0 0.0.0.0/0\n</code></pre></p>","tags":["Level 1","Workstation","Server","Network Configuration","Firewall Configuration","Configure iptables","Configure IPv4 iptables","Automated","4.4 Implement and Manage a Firewall on Servers","4.5 Implement and Manage a Firewall on End-User Devices","IG1","IG2","IG3","T1562","T1562.004","TA0011","M1031","M1037"]},{"location":"3-Network-Configuration/3.5-Firewall-Configuration/3.5.3-Configure-iptables/3.5.3.2-configure-ipv4-iptables/3.5.3.2.2-Ensure-iptables-loopback-traffic-is-configured/#remediation","title":"Remediation","text":"<p>Run the following commands to implement the loopback rules: <pre><code># iptables -A INPUT -i lo -j ACCEPT\n# iptables -A OUTPUT -o lo -j ACCEPT\n# iptables -A INPUT -s 127.0.0.0/8 -j DROP\n</code></pre></p>","tags":["Level 1","Workstation","Server","Network Configuration","Firewall Configuration","Configure iptables","Configure IPv4 iptables","Automated","4.4 Implement and Manage a Firewall on Servers","4.5 Implement and Manage a Firewall on End-User Devices","IG1","IG2","IG3","T1562","T1562.004","TA0011","M1031","M1037"]},{"location":"3-Network-Configuration/3.5-Firewall-Configuration/3.5.3-Configure-iptables/3.5.3.2-configure-ipv4-iptables/3.5.3.2.3-Ensure-iptables-outbound-and-established-connections-are-configured/","title":"3.5.3.2.3 Ensure iptables outbound and established connections are configured","text":"<p>title: Ensure iptables outbound and established connections are configured tags:   - Level 1   - Workstation   - Server   - Network Configuration   - Firewall Configuration   - Configure iptables   - Configure IPv4 iptables   - Manual   - 4.4 Implement and Manage a Firewall on Servers   - 4.5 Implement and Manage a Firewall on End-User Devices   - IG1   - IG2   - IG3   - TA0011   - M1031   - M1037</p>"},{"location":"3-Network-Configuration/3.5-Firewall-Configuration/3.5.3-Configure-iptables/3.5.3.2-configure-ipv4-iptables/3.5.3.2.3-Ensure-iptables-outbound-and-established-connections-are-configured/#audit","title":"Audit","text":"<p>Run the following command and verify all rules for new outbound, and established connections match site policy: <pre><code># iptables -L -v -n\n</code></pre></p>"},{"location":"3-Network-Configuration/3.5-Firewall-Configuration/3.5.3-Configure-iptables/3.5.3.2-configure-ipv4-iptables/3.5.3.2.3-Ensure-iptables-outbound-and-established-connections-are-configured/#remediation","title":"Remediation","text":"<p>Configure iptables in accordance with site policy. The following commands will implement a policy to allow all outbound connections and all established connections: <pre><code># iptables -A OUTPUT -p tcp -m state --state NEW,ESTABLISHED -j ACCEPT\n# iptables -A OUTPUT -p udp -m state --state NEW,ESTABLISHED -j ACCEPT\n# iptables -A OUTPUT -p icmp -m state --state NEW,ESTABLISHED -j ACCEPT\n# iptables -A INPUT -p tcp -m state --state ESTABLISHED -j ACCEPT\n# iptables -A INPUT -p udp -m state --state ESTABLISHED -j ACCEPT\n# iptables -A INPUT -p icmp -m state --state ESTABLISHED -j ACCEPT\n</code></pre></p>"},{"location":"3-Network-Configuration/3.5-Firewall-Configuration/3.5.3-Configure-iptables/3.5.3.2-configure-ipv4-iptables/3.5.3.2.4-Ensure-iptables-firewall-rules-exist-for-all-open-ports/","title":"3.5.3.2.4 Ensure iptables firewall rules exist for all open ports","text":"","tags":["Level 1","Workstation","Server","Network Configuration","Firewall Configuration","Configure iptables","Configure IPv4 iptables","Automated","4.4 Implement and Manage a Firewall on Servers","4.5 Implement and Manage a Firewall on End-User Devices","IG1","IG2","IG3","T1562","T1562.004","TA0011","M1031","M1037"]},{"location":"3-Network-Configuration/3.5-Firewall-Configuration/3.5.3-Configure-iptables/3.5.3.2-configure-ipv4-iptables/3.5.3.2.4-Ensure-iptables-firewall-rules-exist-for-all-open-ports/#audit","title":"Audit","text":"<p>Run the following command to determine open ports: <pre><code># ss -4tuln\nNetid State Recv-Q Send-Q Local Address:Port Peer Address:Port\nudp UNCONN 0 0 *:68 *:*\nudp UNCONN 0 0 *:123 *:*\ntcp LISTEN 0 128 *:22 *:*\n</code></pre></p> <p>Run the following command to determine firewall rules: <pre><code># iptables -L INPUT -v -n\nChain INPUT (policy DROP 0 packets, 0 bytes)\npkts bytes target prot opt in out source destination\n 0 0 ACCEPT all -- lo * 0.0.0.0/0 0.0.0.0/0\n 0 0 DROP all -- * * 127.0.0.0/8 0.0.0.0/0\n 0 0 ACCEPT tcp -- * * 0.0.0.0/0 0.0.0.0/0\ntcp dpt:22 state NEW\n</code></pre></p> <p>Verify all open ports listening on non-localhost addresses have at least one firewall rule. The last line identified by the \"tcp dpt:22 state NEW\" identifies it as a firewall rule for new connections on tcp port 22.</p>","tags":["Level 1","Workstation","Server","Network Configuration","Firewall Configuration","Configure iptables","Configure IPv4 iptables","Automated","4.4 Implement and Manage a Firewall on Servers","4.5 Implement and Manage a Firewall on End-User Devices","IG1","IG2","IG3","T1562","T1562.004","TA0011","M1031","M1037"]},{"location":"3-Network-Configuration/3.5-Firewall-Configuration/3.5.3-Configure-iptables/3.5.3.2-configure-ipv4-iptables/3.5.3.2.4-Ensure-iptables-firewall-rules-exist-for-all-open-ports/#remediation","title":"Remediation","text":"<p>For each port identified in the audit which does not have a firewall rule establish a proper rule for accepting inbound connections: <pre><code># iptables -A INPUT -p &lt;protocol&gt; --dport &lt;port&gt; -m state --state NEW -j ACCEPT\n</code></pre></p>","tags":["Level 1","Workstation","Server","Network Configuration","Firewall Configuration","Configure iptables","Configure IPv4 iptables","Automated","4.4 Implement and Manage a Firewall on Servers","4.5 Implement and Manage a Firewall on End-User Devices","IG1","IG2","IG3","T1562","T1562.004","TA0011","M1031","M1037"]},{"location":"3-Network-Configuration/3.5-Firewall-Configuration/3.5.3-Configure-iptables/3.5.3.3-Configure-IPv6-ip6tables/3.5.3.3.1-Ensure-ip6tables-default-deny-firewall-policy/","title":"3.5.3.3.1 Ensure ip6tables default deny firewall policy","text":"","tags":["Level 1","Workstation","Server","Network Configuration","Firewall Configuration","Configure iptables","Configure IPv6 ip6tables","Automated","4.4 Implement and Manage a Firewall on Servers","4.5 Implement and Manage a Firewall on End-User Devices","IG1","IG2","IG3","T1562","T1562.004","TA0011","M1031","M1037"]},{"location":"3-Network-Configuration/3.5-Firewall-Configuration/3.5.3-Configure-iptables/3.5.3.3-Configure-IPv6-ip6tables/3.5.3.3.1-Ensure-ip6tables-default-deny-firewall-policy/#audit","title":"Audit","text":"<p>Run the following command and verify that the policy for the INPUT, OUTPUT, and FORWARD chains is DROP or REJECT: <pre><code># ip6tables -L\nChain INPUT (policy DROP)\nChain FORWARD (policy DROP)\nChain OUTPUT (policy DROP)\n</code></pre></p> <p>OR verify IPv6 is disabled:</p> <p>Run the following script. Output will confirm if IPv6 is disabled on the system. <pre><code>#!/usr/bin/bash\noutput=\"\"\ngrubfile=\"$(find -L /boot -name 'grub.cfg' -type f)\"\n[ -f \"$grubfile\" ] &amp;&amp; ! grep \"^\\s*linux\" \"$grubfile\" | grep -vq ipv6.disable=1 &amp;&amp; output=\"ipv6 disabled in grub config\"\ngrep -Eqs \"^\\s*net\\.ipv6\\.conf\\.all\\.disable_ipv6\\s*=\\s*1\\b\" /etc/sysctl.conf /etc/sysctl.d/*.conf /usr/lib/sysctl.d/*.conf \\\n/run/sysctl.d/*.conf &amp;&amp; grep -Eqs \"^\\s*net\\.ipv6\\.conf\\.default\\.disable_ipv6\\s*=\\s*1\\b\" /etc/sysctl.conf /etc/sysctl.d/*.conf \\\n/usr/lib/sysctl.d/*.conf /run/sysctl.d/*.conf &amp;&amp; sysctl net.ipv6.conf.all.disable_ipv6 | grep -Eq \\\n\"^\\s*net\\.ipv6\\.conf\\.all\\.disable_ipv6\\s*=\\s*1\\b\" &amp;&amp; sysctl net.ipv6.conf.default.disable_ipv6 | \\\ngrep -Eq \"^\\s*net\\.ipv6\\.conf\\.default\\.disable_ipv6\\s*=\\s*1\\b\" &amp;&amp; output=\"ipv6 disabled in sysctl config\"\n[ -n \"$output\" ] &amp;&amp; echo -e \"\\n$output\" || echo -e \"\\n*** IPv6 is enabled on the system ***\"\n</code></pre></p>","tags":["Level 1","Workstation","Server","Network Configuration","Firewall Configuration","Configure iptables","Configure IPv6 ip6tables","Automated","4.4 Implement and Manage a Firewall on Servers","4.5 Implement and Manage a Firewall on End-User Devices","IG1","IG2","IG3","T1562","T1562.004","TA0011","M1031","M1037"]},{"location":"3-Network-Configuration/3.5-Firewall-Configuration/3.5.3-Configure-iptables/3.5.3.3-Configure-IPv6-ip6tables/3.5.3.3.1-Ensure-ip6tables-default-deny-firewall-policy/#remediation","title":"Remediation","text":"<p>Run the following commands to implement a default DROP policy: <pre><code># ip6tables -P INPUT DROP\n# ip6tables -P OUTPUT DROP\n# ip6tables -P FORWARD DROP\n</code></pre></p>","tags":["Level 1","Workstation","Server","Network Configuration","Firewall Configuration","Configure iptables","Configure IPv6 ip6tables","Automated","4.4 Implement and Manage a Firewall on Servers","4.5 Implement and Manage a Firewall on End-User Devices","IG1","IG2","IG3","T1562","T1562.004","TA0011","M1031","M1037"]},{"location":"3-Network-Configuration/3.5-Firewall-Configuration/3.5.3-Configure-iptables/3.5.3.3-Configure-IPv6-ip6tables/3.5.3.3.2-Ensure-ip6tables-loopback-traffic-is-configured/","title":"3.5.3.3.2 Ensure ip6tables loopback traffic is configured","text":"","tags":["Level 1","Workstation","Server","Network Configuration","Firewall Configuration","Configure iptables","Configure IPv6 ip6tables","Automated","4.4 Implement and Manage a Firewall on Servers","4.5 Implement and Manage a Firewall on End-User Devices","IG1","IG2","IG3","T1562","T1562.004","TA0011","M1031","M1037"]},{"location":"3-Network-Configuration/3.5-Firewall-Configuration/3.5.3-Configure-iptables/3.5.3.3-Configure-IPv6-ip6tables/3.5.3.3.2-Ensure-ip6tables-loopback-traffic-is-configured/#audit","title":"Audit","text":"<p>Run the following commands and verify output includes the listed rules in order (packet and byte counts may differ): <pre><code># ip6tables -L INPUT -v -n\nChain INPUT (policy DROP 0 packets, 0 bytes)\npkts bytes target prot opt in out source destination\n 0 0 ACCEPT all lo * ::/0 ::/0\n 0 0 DROP all * * ::1 ::/0\n\n# ip6tables -L OUTPUT -v -n\nChain OUTPUT (policy DROP 0 packets, 0 bytes)\npkts bytes target prot opt in out source destination\n 0 0 ACCEPT all * lo ::/0 ::/0\n</code></pre></p> <p>OR verify IPv6 is disabled:</p> <p>Run the following script. Output will confirm if IPv6 is disabled on the system. <pre><code>#!/usr/bin/bash\noutput=\"\"\ngrubfile=\"$(find -L /boot -name 'grub.cfg' -type f)\"\n[ -f \"$grubfile\" ] &amp;&amp; ! grep \"^\\s*linux\" \"$grubfile\" | grep -vq ipv6.disable=1 &amp;&amp; output=\"ipv6 disabled in grub config\"\ngrep -Eqs \"^\\s*net\\.ipv6\\.conf\\.all\\.disable_ipv6\\s*=\\s*1\\b\" /etc/sysctl.conf /etc/sysctl.d/*.conf /usr/lib/sysctl.d/*.conf \\\n/run/sysctl.d/*.conf &amp;&amp; grep -Eqs \"^\\s*net\\.ipv6\\.conf\\.default\\.disable_ipv6\\s*=\\s*1\\b\" /etc/sysctl.conf /etc/sysctl.d/*.conf \\\n/usr/lib/sysctl.d/*.conf /run/sysctl.d/*.conf &amp;&amp; sysctl net.ipv6.conf.all.disable_ipv6 | grep -Eq \\\n\"^\\s*net\\.ipv6\\.conf\\.all\\.disable_ipv6\\s*=\\s*1\\b\" &amp;&amp; sysctl net.ipv6.conf.default.disable_ipv6 | \\\ngrep -Eq \"^\\s*net\\.ipv6\\.conf\\.default\\.disable_ipv6\\s*=\\s*1\\b\" &amp;&amp; output=\"ipv6 disabled in sysctl config\"\n[ -n \"$output\" ] &amp;&amp; echo -e \"\\n$output\" || echo -e \"\\n*** IPv6 is enabled on the system ***\"\n</code></pre></p>","tags":["Level 1","Workstation","Server","Network Configuration","Firewall Configuration","Configure iptables","Configure IPv6 ip6tables","Automated","4.4 Implement and Manage a Firewall on Servers","4.5 Implement and Manage a Firewall on End-User Devices","IG1","IG2","IG3","T1562","T1562.004","TA0011","M1031","M1037"]},{"location":"3-Network-Configuration/3.5-Firewall-Configuration/3.5.3-Configure-iptables/3.5.3.3-Configure-IPv6-ip6tables/3.5.3.3.2-Ensure-ip6tables-loopback-traffic-is-configured/#remediation","title":"Remediation","text":"<p>Run the following commands to implement the loopback rules: <pre><code># ip6tables -A INPUT -i lo -j ACCEPT\n# ip6tables -A OUTPUT -o lo -j ACCEPT\n# ip6tables -A INPUT -s ::1 -j DROP\n</code></pre></p>","tags":["Level 1","Workstation","Server","Network Configuration","Firewall Configuration","Configure iptables","Configure IPv6 ip6tables","Automated","4.4 Implement and Manage a Firewall on Servers","4.5 Implement and Manage a Firewall on End-User Devices","IG1","IG2","IG3","T1562","T1562.004","TA0011","M1031","M1037"]},{"location":"3-Network-Configuration/3.5-Firewall-Configuration/3.5.3-Configure-iptables/3.5.3.3-Configure-IPv6-ip6tables/3.5.3.3.3-Ensure-ip6tables-outbound-and-established-connections-are-configured/","title":"3.5.3.3.3 Ensure ip6tables outbound and established connections are configured","text":"","tags":["Level 1","Workstation","Server","Network Configuration","Firewall Configuration","Configure iptables","Configure IPv6 ip6tables","Manual","4.4 Implement and Manage a Firewall on Servers","4.5 Implement and Manage a Firewall on End-User Devices","IG1","IG2","IG3","TA0011","M1031","M1037"]},{"location":"3-Network-Configuration/3.5-Firewall-Configuration/3.5.3-Configure-iptables/3.5.3.3-Configure-IPv6-ip6tables/3.5.3.3.3-Ensure-ip6tables-outbound-and-established-connections-are-configured/#audit","title":"Audit","text":"<p>Run the following command and verify all rules for new outbound, and established connections match site policy: <pre><code># ip6tables -L -v -n\n</code></pre></p> <p>OR verify IPv6 is disabled:</p> <p>Run the following script. Output will confirm if IPv6 is disabled on the system. <pre><code>#!/usr/bin/bash\noutput=\"\"\ngrubfile=\"$(find -L /boot -name 'grub.cfg' -type f)\"\n[ -f \"$grubfile\" ] &amp;&amp; ! grep \"^\\s*linux\" \"$grubfile\" | grep -vq ipv6.disable=1 &amp;&amp; output=\"ipv6 disabled in grub config\"\ngrep -Eqs \"^\\s*net\\.ipv6\\.conf\\.all\\.disable_ipv6\\s*=\\s*1\\b\" /etc/sysctl.conf /etc/sysctl.d/*.conf /usr/lib/sysctl.d/*.conf \\\n/run/sysctl.d/*.conf &amp;&amp; grep -Eqs \"^\\s*net\\.ipv6\\.conf\\.default\\.disable_ipv6\\s*=\\s*1\\b\" /etc/sysctl.conf /etc/sysctl.d/*.conf \\\n/usr/lib/sysctl.d/*.conf /run/sysctl.d/*.conf &amp;&amp; sysctl net.ipv6.conf.all.disable_ipv6 | grep -Eq \\\n\"^\\s*net\\.ipv6\\.conf\\.all\\.disable_ipv6\\s*=\\s*1\\b\" &amp;&amp; sysctl net.ipv6.conf.default.disable_ipv6 | \\\ngrep -Eq \"^\\s*net\\.ipv6\\.conf\\.default\\.disable_ipv6\\s*=\\s*1\\b\" &amp;&amp; output=\"ipv6 disabled in sysctl config\"\n[ -n \"$output\" ] &amp;&amp; echo -e \"\\n$output\" || echo -e \"\\n*** IPv6 is enabled on the system ***\"\n</code></pre></p>","tags":["Level 1","Workstation","Server","Network Configuration","Firewall Configuration","Configure iptables","Configure IPv6 ip6tables","Manual","4.4 Implement and Manage a Firewall on Servers","4.5 Implement and Manage a Firewall on End-User Devices","IG1","IG2","IG3","TA0011","M1031","M1037"]},{"location":"3-Network-Configuration/3.5-Firewall-Configuration/3.5.3-Configure-iptables/3.5.3.3-Configure-IPv6-ip6tables/3.5.3.3.3-Ensure-ip6tables-outbound-and-established-connections-are-configured/#remediation","title":"Remediation","text":"<p>Configure iptables in accordance with site policy. The following commands will implement a policy to allow all outbound connections and all established connections: <pre><code># ip6tables -A OUTPUT -p tcp -m state --state NEW,ESTABLISHED -j ACCEPT\n# ip6tables -A OUTPUT -p udp -m state --state NEW,ESTABLISHED -j ACCEPT\n# ip6tables -A OUTPUT -p icmp -m state --state NEW,ESTABLISHED -j ACCEPT\n# ip6tables -A INPUT -p tcp -m state --state ESTABLISHED -j ACCEPT\n# ip6tables -A INPUT -p udp -m state --state ESTABLISHED -j ACCEPT\n# ip6tables -A INPUT -p icmp -m state --state ESTABLISHED -j ACCEPT\n</code></pre></p>","tags":["Level 1","Workstation","Server","Network Configuration","Firewall Configuration","Configure iptables","Configure IPv6 ip6tables","Manual","4.4 Implement and Manage a Firewall on Servers","4.5 Implement and Manage a Firewall on End-User Devices","IG1","IG2","IG3","TA0011","M1031","M1037"]},{"location":"3-Network-Configuration/3.5-Firewall-Configuration/3.5.3-Configure-iptables/3.5.3.3-Configure-IPv6-ip6tables/3.5.3.3.4-Ensure-ip6tables-firewall-rules-exist-for-all-open-ports/","title":"3.5.3.3.4 Ensure ip6tables firewall rules exist for all open ports","text":"","tags":["Level 1","Workstation","Server","Network Configuration","Firewall Configuration","Configure iptables","Configure IPv6 ip6tables","Automated","4.4 Implement and Manage a Firewall on Servers","4.5 Implement and Manage a Firewall on End-User Devices","IG1","IG2","IG3","T1562","T1562.004","TA0011","M1031","M1037"]},{"location":"3-Network-Configuration/3.5-Firewall-Configuration/3.5.3-Configure-iptables/3.5.3.3-Configure-IPv6-ip6tables/3.5.3.3.4-Ensure-ip6tables-firewall-rules-exist-for-all-open-ports/#audit","title":"Audit","text":"<p>Run the following command to determine open ports: <pre><code># ss -6tuln\nNetid State Recv-Q Send-Q Local Address:Port Peer Address:Port\nudp UNCONN 0 0 ::1:123 :::*\nudp UNCONN 0 0 :::123 :::*\ntcp LISTEN 0 128 :::22 :::*\ntcp LISTEN 0 20 ::1:25 :::*\n</code></pre></p> <p>Run the following command to determine firewall rules: <pre><code># ip6tables -L INPUT -v -n\nChain INPUT (policy DROP 0 packets, 0 bytes)\npkts bytes target prot opt in out source destination\n 0 0 ACCEPT all lo * ::/0 ::/0\n 0 0 DROP all * * ::1 ::/0\n 0 0 ACCEPT tcp * * ::/0 ::/0\ntcp dpt:22 state NEW\n</code></pre></p> <p>Verify all open ports listening on non-localhost addresses have at least one firewall rule.</p> <p>The last line identified by the \"tcp dpt:22 state NEW\" identifies it as a firewall rule for new connections on tcp port 22.</p> <p>OR verify IPv6 is disabled:</p> <p>Run the following script. Output will confirm if IPv6 is disabled on the system. <pre><code>#!/usr/bin/bash\noutput=\"\"\ngrubfile=\"$(find -L /boot -name 'grub.cfg' -type f)\"\n[ -f \"$grubfile\" ] &amp;&amp; ! grep \"^\\s*linux\" \"$grubfile\" | grep -vq ipv6.disable=1 &amp;&amp; output=\"ipv6 disabled in grub config\"\ngrep -Eqs \"^\\s*net\\.ipv6\\.conf\\.all\\.disable_ipv6\\s*=\\s*1\\b\" /etc/sysctl.conf /etc/sysctl.d/*.conf /usr/lib/sysctl.d/*.conf \\\n/run/sysctl.d/*.conf &amp;&amp; grep -Eqs \"^\\s*net\\.ipv6\\.conf\\.default\\.disable_ipv6\\s*=\\s*1\\b\" /etc/sysctl.conf /etc/sysctl.d/*.conf \\\n/usr/lib/sysctl.d/*.conf /run/sysctl.d/*.conf &amp;&amp; sysctl net.ipv6.conf.all.disable_ipv6 | grep -Eq \\\n\"^\\s*net\\.ipv6\\.conf\\.all\\.disable_ipv6\\s*=\\s*1\\b\" &amp;&amp; sysctl net.ipv6.conf.default.disable_ipv6 | \\\ngrep -Eq \"^\\s*net\\.ipv6\\.conf\\.default\\.disable_ipv6\\s*=\\s*1\\b\" &amp;&amp; output=\"ipv6 disabled in sysctl config\"\n[ -n \"$output\" ] &amp;&amp; echo -e \"\\n$output\" || echo -e \"\\n*** IPv6 is enabled on the system ***\"\n</code></pre></p>","tags":["Level 1","Workstation","Server","Network Configuration","Firewall Configuration","Configure iptables","Configure IPv6 ip6tables","Automated","4.4 Implement and Manage a Firewall on Servers","4.5 Implement and Manage a Firewall on End-User Devices","IG1","IG2","IG3","T1562","T1562.004","TA0011","M1031","M1037"]},{"location":"3-Network-Configuration/3.5-Firewall-Configuration/3.5.3-Configure-iptables/3.5.3.3-Configure-IPv6-ip6tables/3.5.3.3.4-Ensure-ip6tables-firewall-rules-exist-for-all-open-ports/#remediation","title":"Remediation","text":"<p>For each port identified in the audit which does not have a firewall rule establish a proper rule for accepting inbound connections: <pre><code># ip6tables -A INPUT -p &lt;protocol&gt; --dport &lt;port&gt; -m state --state NEW -j ACCEPT\n</code></pre></p>","tags":["Level 1","Workstation","Server","Network Configuration","Firewall Configuration","Configure iptables","Configure IPv6 ip6tables","Automated","4.4 Implement and Manage a Firewall on Servers","4.5 Implement and Manage a Firewall on End-User Devices","IG1","IG2","IG3","T1562","T1562.004","TA0011","M1031","M1037"]},{"location":"4-Logging-and-Auditing/4.1-Configure-System-Accounting-%28auditd%29/4.1.1-Ensure-auditing-is-enabled/4.1.1.1-Ensure-auditd-is-installed/","title":"4.1.1.1 Ensure auditd is installed","text":"","tags":["Level 2","Workstation","Server","Logging and Auditing","Configure System Accounting (auditd)","Ensure auditing is enabled","Automated","IG2","IG3","8.5 Collect Detailed Audit Logs","T1562","T1562.001","TA0005"]},{"location":"4-Logging-and-Auditing/4.1-Configure-System-Accounting-%28auditd%29/4.1.1-Ensure-auditing-is-enabled/4.1.1.1-Ensure-auditd-is-installed/#audit","title":"Audit","text":"<p>Run the following command and verify auditd and audispd-plugins are installed: <pre><code># dpkg-query -W -f='${binary:Package}\\t${Status}\\t${db:Status-Status}\\n' auditd audispd-plugins\naudispd-plugins install ok installed installed\nauditd install ok installed installed\n</code></pre></p>","tags":["Level 2","Workstation","Server","Logging and Auditing","Configure System Accounting (auditd)","Ensure auditing is enabled","Automated","IG2","IG3","8.5 Collect Detailed Audit Logs","T1562","T1562.001","TA0005"]},{"location":"4-Logging-and-Auditing/4.1-Configure-System-Accounting-%28auditd%29/4.1.1-Ensure-auditing-is-enabled/4.1.1.1-Ensure-auditd-is-installed/#remediation","title":"Remediation","text":"<p>Run the following command to Install auditd <pre><code># apt install auditd audispd-plugins\n</code></pre></p>","tags":["Level 2","Workstation","Server","Logging and Auditing","Configure System Accounting (auditd)","Ensure auditing is enabled","Automated","IG2","IG3","8.5 Collect Detailed Audit Logs","T1562","T1562.001","TA0005"]},{"location":"4-Logging-and-Auditing/4.1-Configure-System-Accounting-%28auditd%29/4.1.1-Ensure-auditing-is-enabled/4.1.1.2-Ensure-auditd-service-is-enabled-and-active/","title":"4.1.1.2 Ensure auditd service is enabled and active","text":"","tags":["Level 2","Workstation","Server","Logging and Auditing","Configure System Accounting (auditd)","Ensure auditing is enabled","Automated","IG1","IG2","IG3","8.2 Collect Audit Logs","T1562","T1562.001","TA0005"]},{"location":"4-Logging-and-Auditing/4.1-Configure-System-Accounting-%28auditd%29/4.1.1-Ensure-auditing-is-enabled/4.1.1.2-Ensure-auditd-service-is-enabled-and-active/#audit","title":"Audit","text":"<p>Run the following command to verify auditd is enabled: <pre><code># systemctl is-enabled auditd\nenabled\n</code></pre></p> <p>Verify result is \"enabled\".</p> <p>Run the following command to verify auditd is active: <pre><code># systemctl is-active auditd\nactive\n</code></pre></p> <p>Verify result is active</p>","tags":["Level 2","Workstation","Server","Logging and Auditing","Configure System Accounting (auditd)","Ensure auditing is enabled","Automated","IG1","IG2","IG3","8.2 Collect Audit Logs","T1562","T1562.001","TA0005"]},{"location":"4-Logging-and-Auditing/4.1-Configure-System-Accounting-%28auditd%29/4.1.1-Ensure-auditing-is-enabled/4.1.1.2-Ensure-auditd-service-is-enabled-and-active/#remediation","title":"Remediation","text":"<p>Run the following command to enable and start auditd: <pre><code># systemctl --now enable auditd\n</code></pre></p>","tags":["Level 2","Workstation","Server","Logging and Auditing","Configure System Accounting (auditd)","Ensure auditing is enabled","Automated","IG1","IG2","IG3","8.2 Collect Audit Logs","T1562","T1562.001","TA0005"]},{"location":"4-Logging-and-Auditing/4.1-Configure-System-Accounting-%28auditd%29/4.1.1-Ensure-auditing-is-enabled/4.1.1.3-Ensure-auditing-for-processes-that-start-prior-to-auditd-is-enabled/","title":"4.1.1.3 Ensure auditing for processes that start prior to auditd is enabled","text":"","tags":["Level 2","Workstation","Server","Logging and Auditing","Configure System Accounting (auditd)","Ensure auditing is enabled","Automated","IG1","IG2","IG3","8.2 Collect Audit Logs","T1562","T1562.001","TA0005"]},{"location":"4-Logging-and-Auditing/4.1-Configure-System-Accounting-%28auditd%29/4.1.1-Ensure-auditing-is-enabled/4.1.1.3-Ensure-auditing-for-processes-that-start-prior-to-auditd-is-enabled/#audit","title":"Audit","text":"<p>Run the following command: <pre><code># find /boot -type f -name 'grub.cfg' -exec grep -Ph -- '^\\h*linux' {} + | grep -v 'audit=1'\n</code></pre></p> <p>Nothing should be returned.</p>","tags":["Level 2","Workstation","Server","Logging and Auditing","Configure System Accounting (auditd)","Ensure auditing is enabled","Automated","IG1","IG2","IG3","8.2 Collect Audit Logs","T1562","T1562.001","TA0005"]},{"location":"4-Logging-and-Auditing/4.1-Configure-System-Accounting-%28auditd%29/4.1.1-Ensure-auditing-is-enabled/4.1.1.3-Ensure-auditing-for-processes-that-start-prior-to-auditd-is-enabled/#remediation","title":"Remediation","text":"<p>Edit /etc/default/grub and add audit=1 to GRUB_CMDLINE_LINUX:</p> <p>Example: <pre><code>GRUB_CMDLINE_LINUX=\"audit=1\"\n</code></pre></p> <p>Run the following command to update the grub2 configuration: <pre><code># update-grub\n</code></pre></p>","tags":["Level 2","Workstation","Server","Logging and Auditing","Configure System Accounting (auditd)","Ensure auditing is enabled","Automated","IG1","IG2","IG3","8.2 Collect Audit Logs","T1562","T1562.001","TA0005"]},{"location":"4-Logging-and-Auditing/4.1-Configure-System-Accounting-%28auditd%29/4.1.1-Ensure-auditing-is-enabled/4.1.1.4-Ensure-audit_backlog_limit-is-sufficient/","title":"4.1.1.4 Ensure audit_backlog_limit is sufficient","text":"","tags":["Level 2","Workstation","Server","Logging and Auditing","Configure System Accounting (auditd)","Ensure auditing is enabled","Automated","IG1","IG2","IG3","8.2 Collect Audit Logs","T1562","T1562.001","TA0005"]},{"location":"4-Logging-and-Auditing/4.1-Configure-System-Accounting-%28auditd%29/4.1.1-Ensure-auditing-is-enabled/4.1.1.4-Ensure-audit_backlog_limit-is-sufficient/#audit","title":"Audit","text":"<p>Run the following command and verify the audit_backlog_limit= parameter is set: <pre><code># find /boot -type f -name 'grub.cfg' -exec grep -Ph -- '^\\h*linux' {} + | grep -Pv 'audit_backlog_limit=\\d+\\b'\n</code></pre></p> <p>Nothing should be returned.</p>","tags":["Level 2","Workstation","Server","Logging and Auditing","Configure System Accounting (auditd)","Ensure auditing is enabled","Automated","IG1","IG2","IG3","8.2 Collect Audit Logs","T1562","T1562.001","TA0005"]},{"location":"4-Logging-and-Auditing/4.1-Configure-System-Accounting-%28auditd%29/4.1.1-Ensure-auditing-is-enabled/4.1.1.4-Ensure-audit_backlog_limit-is-sufficient/#remediation","title":"Remediation","text":"<p>Edit /etc/default/grub and add audit_backlog_limit=N to GRUB_CMDLINE_LINUX.</p> <p>The recommended size for N is 8192 or larger.</p> <p>Example: <pre><code>GRUB_CMDLINE_LINUX=\"audit_backlog_limit=8192\"\n</code></pre></p> <p>Run the following command to update the grub2 configuration: <pre><code># update-grub\n</code></pre></p> <p>Default Value:</p> <p>If audit_backlog_limit is not set, the system defaults to audit_backlog_limit=64</p>","tags":["Level 2","Workstation","Server","Logging and Auditing","Configure System Accounting (auditd)","Ensure auditing is enabled","Automated","IG1","IG2","IG3","8.2 Collect Audit Logs","T1562","T1562.001","TA0005"]},{"location":"4-Logging-and-Auditing/4.1-Configure-System-Accounting-%28auditd%29/4.1.2-Configure-Data-Retention/4.1.2.1-Ensure-audit-log-storage-size-is-configured/","title":"4.1.2.1 Ensure audit log storage size is configured","text":"","tags":["Level 2","Workstation","Server","Logging and Auditing","Configure System Accounting (auditd)","Configure Data Retention","Automated","IG1","IG2","IG3","8.3 Ensure Adequate Audit Log Storage","T1562","T1562.006","TA0040","M1053"]},{"location":"4-Logging-and-Auditing/4.1-Configure-System-Accounting-%28auditd%29/4.1.2-Configure-Data-Retention/4.1.2.1-Ensure-audit-log-storage-size-is-configured/#audit","title":"Audit","text":"<p>Run the following command and ensure output is in compliance with site policy: <pre><code># grep -Po -- '^\\h*max_log_file\\h*=\\h*\\d+\\b' /etc/audit/auditd.conf\nmax_log_file = &lt;MB&gt;\n</code></pre></p>","tags":["Level 2","Workstation","Server","Logging and Auditing","Configure System Accounting (auditd)","Configure Data Retention","Automated","IG1","IG2","IG3","8.3 Ensure Adequate Audit Log Storage","T1562","T1562.006","TA0040","M1053"]},{"location":"4-Logging-and-Auditing/4.1-Configure-System-Accounting-%28auditd%29/4.1.2-Configure-Data-Retention/4.1.2.1-Ensure-audit-log-storage-size-is-configured/#remediation","title":"Remediation","text":"<p>Set the following parameter in /etc/audit/auditd.conf in accordance with site policy: <pre><code>max_log_file = &lt;MB&gt;\n</code></pre></p> <p>Default Value:</p> <p>max_log_file = 8</p>","tags":["Level 2","Workstation","Server","Logging and Auditing","Configure System Accounting (auditd)","Configure Data Retention","Automated","IG1","IG2","IG3","8.3 Ensure Adequate Audit Log Storage","T1562","T1562.006","TA0040","M1053"]},{"location":"4-Logging-and-Auditing/4.1-Configure-System-Accounting-%28auditd%29/4.1.2-Configure-Data-Retention/4.1.2.2-Ensure-audit-logs-are-not-automatically-deleted/","title":"4.1.2.2 Ensure audit logs are not automatically deleted","text":"","tags":["Level 2","Workstation","Server","Logging and Auditing","Configure System Accounting (auditd)","Configure Data Retention","Automated","IG1","IG2","IG3","8.3 Ensure Adequate Audit Log Storage","T1562","T1562.006","TA0040","M1053"]},{"location":"4-Logging-and-Auditing/4.1-Configure-System-Accounting-%28auditd%29/4.1.2-Configure-Data-Retention/4.1.2.2-Ensure-audit-logs-are-not-automatically-deleted/#audit","title":"Audit","text":"<p>Run the following command and verify output matches: <pre><code># grep max_log_file_action /etc/audit/auditd.conf\nmax_log_file_action = keep_logs\n</code></pre></p>","tags":["Level 2","Workstation","Server","Logging and Auditing","Configure System Accounting (auditd)","Configure Data Retention","Automated","IG1","IG2","IG3","8.3 Ensure Adequate Audit Log Storage","T1562","T1562.006","TA0040","M1053"]},{"location":"4-Logging-and-Auditing/4.1-Configure-System-Accounting-%28auditd%29/4.1.2-Configure-Data-Retention/4.1.2.2-Ensure-audit-logs-are-not-automatically-deleted/#remediation","title":"Remediation","text":"<p>Set the following parameter in /etc/audit/auditd.conf: <pre><code>max_log_file_action = keep_logs\n</code></pre></p>","tags":["Level 2","Workstation","Server","Logging and Auditing","Configure System Accounting (auditd)","Configure Data Retention","Automated","IG1","IG2","IG3","8.3 Ensure Adequate Audit Log Storage","T1562","T1562.006","TA0040","M1053"]},{"location":"4-Logging-and-Auditing/4.1-Configure-System-Accounting-%28auditd%29/4.1.2-Configure-Data-Retention/4.1.2.3-Ensure-system-is-disabled-when-audit-logs-are-full/","title":"4.1.2.3 Ensure system is disabled when audit logs are full","text":"","tags":["Level 2","Workstation","Server","Logging and Auditing","Configure System Accounting (auditd)","Configure Data Retention","Automated","IG1","IG2","IG3","8.2 Collect Audit Logs","T1562","T1562.006","TA0005"]},{"location":"4-Logging-and-Auditing/4.1-Configure-System-Accounting-%28auditd%29/4.1.2-Configure-Data-Retention/4.1.2.3-Ensure-system-is-disabled-when-audit-logs-are-full/#audit","title":"Audit","text":"<p>Run the following commands and verify output matches: <pre><code># grep space_left_action /etc/audit/auditd.conf\nspace_left_action = email\n\n# grep action_mail_acct /etc/audit/auditd.conf\naction_mail_acct = root\n</code></pre></p> <p>Run the following command and verify the output is either halt or single: <pre><code># grep -E 'admin_space_left_action\\s*=\\s*(halt|single)' /etc/audit/auditd.conf\nadmin_space_left_action = &lt;halt|single&gt;\n</code></pre></p>","tags":["Level 2","Workstation","Server","Logging and Auditing","Configure System Accounting (auditd)","Configure Data Retention","Automated","IG1","IG2","IG3","8.2 Collect Audit Logs","T1562","T1562.006","TA0005"]},{"location":"4-Logging-and-Auditing/4.1-Configure-System-Accounting-%28auditd%29/4.1.2-Configure-Data-Retention/4.1.2.3-Ensure-system-is-disabled-when-audit-logs-are-full/#remediation","title":"Remediation","text":"<p>Set the following parameters in /etc/audit/auditd.conf: <pre><code>space_left_action = email\naction_mail_acct = root\n</code></pre></p> <p>set admin_space_left_action to either halt or single in /etc/audit/auditd.conf.</p> <p>Example: <pre><code>admin_space_left_action = halt\n</code></pre></p>","tags":["Level 2","Workstation","Server","Logging and Auditing","Configure System Accounting (auditd)","Configure Data Retention","Automated","IG1","IG2","IG3","8.2 Collect Audit Logs","T1562","T1562.006","TA0005"]},{"location":"4-Logging-and-Auditing/4.1-Configure-System-Accounting-%28auditd%29/4.1.3-Configure-auditd-rules/4.1.3.1-Ensure-changes-to-system-administration-scope-%28sudoers%29-is-collected/","title":"4.1.3.1 Ensure changes to system administration scope (sudoers) is collected","text":"","tags":["Level 2","Workstation","Server","Logging and Auditing","Configure System Accounting (auditd)","Configure auditd rules","Automated","IG2","IG3","8.5 Collect Detailed Audit Logs","T1562","T1562.006","TA0004","M1047"]},{"location":"4-Logging-and-Auditing/4.1-Configure-System-Accounting-%28auditd%29/4.1.3-Configure-auditd-rules/4.1.3.1-Ensure-changes-to-system-administration-scope-%28sudoers%29-is-collected/#audit","title":"Audit","text":"<p>Run the following command to check the on disk rules: <pre><code># awk '/^ *-w/ \\\n&amp;&amp;/\\/etc\\/sudoers/ \\\n&amp;&amp;/ +-p *wa/ \\\n&amp;&amp;(/ key= *[!-~]* *$/||/ -k *[!-~]* *$/)' /etc/audit/rules.d/*.rules\n</code></pre></p> <p>Verify the output matches: <pre><code>-w /etc/sudoers -p wa -k scope\n-w /etc/sudoers.d -p wa -k scope\n</code></pre></p> <p>Running configuration</p> <p>Run the following command to check loaded rules: <pre><code># auditctl -l | awk '/^ *-w/ \\\n&amp;&amp;/\\/etc\\/sudoers/ \\\n&amp;&amp;/ +-p *wa/ \\\n&amp;&amp;(/ key= *[!-~]* *$/||/ -k *[!-~]* *$/)'\n</code></pre></p> <p>Verify the output matches: <pre><code>-w /etc/sudoers -p wa -k scope\n-w /etc/sudoers.d -p wa -k scope\n</code></pre></p>","tags":["Level 2","Workstation","Server","Logging and Auditing","Configure System Accounting (auditd)","Configure auditd rules","Automated","IG2","IG3","8.5 Collect Detailed Audit Logs","T1562","T1562.006","TA0004","M1047"]},{"location":"4-Logging-and-Auditing/4.1-Configure-System-Accounting-%28auditd%29/4.1.3-Configure-auditd-rules/4.1.3.1-Ensure-changes-to-system-administration-scope-%28sudoers%29-is-collected/#remediation","title":"Remediation","text":"<p>Edit or create a file in the /etc/audit/rules.d/ directory, ending in .rules extension, with the relevant rules to monitor scope changes for system administrators.</p> <p>Example: <pre><code># printf \"\n-w /etc/sudoers -p wa -k scope\n-w /etc/sudoers.d -p wa -k scope\n\" &gt;&gt; /etc/audit/rules.d/50-scope.rules\n</code></pre></p> <p>Merge and load the rules into active configuration: <pre><code># augenrules --load\n</code></pre></p> <p>Check if reboot is required. <pre><code># if [[ $(auditctl -s | grep \"enabled\") =~ \"2\" ]]; then printf \"Reboot required to load rules\\n\"; fi\n</code></pre></p>","tags":["Level 2","Workstation","Server","Logging and Auditing","Configure System Accounting (auditd)","Configure auditd rules","Automated","IG2","IG3","8.5 Collect Detailed Audit Logs","T1562","T1562.006","TA0004","M1047"]},{"location":"4-Logging-and-Auditing/4.1-Configure-System-Accounting-%28auditd%29/4.1.3-Configure-auditd-rules/4.1.3.10-Ensure-successful-file-system-mounts-are-collected/","title":"4.1.3.10 Ensure successful file system mounts are collected","text":"","tags":["Level 2","Workstation","Server","Logging and Auditing","Configure System Accounting (auditd)","Configure auditd rules","Automated","IG2","IG3","8.5 Collect Detailed Audit Logs","T1562","T1562.006","TA0010","M1034"]},{"location":"4-Logging-and-Auditing/4.1-Configure-System-Accounting-%28auditd%29/4.1.3-Configure-auditd-rules/4.1.3.10-Ensure-successful-file-system-mounts-are-collected/#audit","title":"Audit","text":"<p>64 Bit systems</p> <p>On disk configuration</p> <p>Run the following command to check the on disk rules: <pre><code># {\nUID_MIN=$(awk '/^\\s*UID_MIN/{print $2}' /etc/login.defs)\n[ -n \"${UID_MIN}\" ] &amp;&amp; awk \"/^ *-a *always,exit/ \\\n&amp;&amp;/ -F *arch=b[2346]{2}/ \\\n&amp;&amp;(/ -F *auid!=unset/||/ -F *auid!=-1/||/ -F *auid!=4294967295/) \\\n&amp;&amp;/ -F *auid&gt;=${UID_MIN}/ \\\n&amp;&amp;/ -S/ \\\n&amp;&amp;/mount/ \\\n&amp;&amp;(/ key= *[!-~]* *$/||/ -k *[!-~]* *$/)\" /etc/audit/rules.d/*.rules \\\n|| printf \"ERROR: Variable 'UID_MIN' is unset.\\n\"\n}\n</code></pre></p> <p>Verify the output matches: <pre><code>-a always,exit -F arch=b64 -S mount -F auid&gt;=1000 -F auid!=unset -k mounts\n-a always,exit -F arch=b32 -S mount -F auid&gt;=1000 -F auid!=unset -k mounts\n</code></pre></p> <p>Running configuration</p> <p>Run the following command to check loaded rules: <pre><code># {\nUID_MIN=$(awk '/^\\s*UID_MIN/{print $2}' /etc/login.defs)\n[ -n \"${UID_MIN}\" ] &amp;&amp; auditctl -l | awk \"/^ *-a *always,exit/ \\\n&amp;&amp;/ -F *arch=b[2346]{2}/ \\\n&amp;&amp;(/ -F *auid!=unset/||/ -F *auid!=-1/||/ -F *auid!=4294967295/) \\\n&amp;&amp;/ -F *auid&gt;=${UID_MIN}/ \\\n&amp;&amp;/ -S/ \\\n&amp;&amp;/mount/ \\\n&amp;&amp;(/ key= *[!-~]* *$/||/ -k *[!-~]* *$/)\" \\\n|| printf \"ERROR: Variable 'UID_MIN' is unset.\\n\"\n}\n</code></pre></p> <p>Verify the output matches: <pre><code>-a always,exit -F arch=b64 -S mount -F auid&gt;=1000 -F auid!=-1 -F key=mounts\n-a always,exit -F arch=b32 -S mount -F auid&gt;=1000 -F auid!=-1 -F key=mounts\n</code></pre></p> <p>32 Bit systems</p> <p>Follow the same procedures as for 64 bit systems and ignore any entries with b64.</p>","tags":["Level 2","Workstation","Server","Logging and Auditing","Configure System Accounting (auditd)","Configure auditd rules","Automated","IG2","IG3","8.5 Collect Detailed Audit Logs","T1562","T1562.006","TA0010","M1034"]},{"location":"4-Logging-and-Auditing/4.1-Configure-System-Accounting-%28auditd%29/4.1.3-Configure-auditd-rules/4.1.3.10-Ensure-successful-file-system-mounts-are-collected/#remediation","title":"Remediation","text":"<p>Create audit rules</p> <p>Edit or create a file in the /etc/audit/rules.d/ directory, ending in .rules extension, with the relevant rules to monitor successful file system mounts.</p> <p>64 Bit systems</p> <p>Example: <pre><code># {\nUID_MIN=$(awk '/^\\s*UID_MIN/{print $2}' /etc/login.defs)\n[ -n \"${UID_MIN}\" ] &amp;&amp; printf \"\n-a always,exit -F arch=b32 -S mount -F auid&gt;=$UID_MIN -F auid!=unset -k mounts\n-a always,exit -F arch=b64 -S mount -F auid&gt;=$UID_MIN -F auid!=unset -k mounts\n\" &gt;&gt; /etc/audit/rules.d/50-mounts.rules || printf \"ERROR: Variable 'UID_MIN' is unset.\\n\"\n}\n</code></pre></p> <p>Load audit rules</p> <p>Merge and load the rules into active configuration: <pre><code># augenrules --load\n</code></pre></p> <p>Check if reboot is required. <pre><code># if [[ $(auditctl -s | grep \"enabled\") =~ \"2\" ]]; then printf \"Reboot required to load rules\\n\"; fi\n</code></pre></p> <p>32 Bit systems</p> <p>Follow the same procedures as for 64 bit systems and ignore any entries with b64</p>","tags":["Level 2","Workstation","Server","Logging and Auditing","Configure System Accounting (auditd)","Configure auditd rules","Automated","IG2","IG3","8.5 Collect Detailed Audit Logs","T1562","T1562.006","TA0010","M1034"]},{"location":"4-Logging-and-Auditing/4.1-Configure-System-Accounting-%28auditd%29/4.1.3-Configure-auditd-rules/4.1.3.11-Ensure-session-initiation-information-is-collected/","title":"4.1.3.11 Ensure session initiation information is collected","text":"","tags":["Level 2","Workstation","Server","Logging and Auditing","Configure System Accounting (auditd)","Configure auditd rules","Automated","IG2","IG3","8.5 Collect Detailed Audit Logs","T1562","T1562.006","TA0001"]},{"location":"4-Logging-and-Auditing/4.1-Configure-System-Accounting-%28auditd%29/4.1.3-Configure-auditd-rules/4.1.3.11-Ensure-session-initiation-information-is-collected/#audit","title":"Audit","text":"<p>On disk configuration</p> <p>Run the following command to check the on disk rules: <pre><code># awk '/^ *-w/ \\\n&amp;&amp;(/\\/var\\/run\\/utmp/ \\\n||/\\/var\\/log\\/wtmp/ \\\n||/\\/var\\/log\\/btmp/) \\\n&amp;&amp;/ +-p *wa/ \\\n&amp;&amp;(/ key= *[!-~]* *$/||/ -k *[!-~]* *$/)' /etc/audit/rules.d/*.rules\n</code></pre></p> <p>Verify the output matches: <pre><code>-w /var/run/utmp -p wa -k session\n-w /var/log/wtmp -p wa -k session\n-w /var/log/btmp -p wa -k session\n</code></pre></p> <p>Running configuration</p> <p>Run the following command to check loaded rules: <pre><code># auditctl -l | awk '/^ *-w/ \\\n&amp;&amp;(/\\/var\\/run\\/utmp/ \\\n||/\\/var\\/log\\/wtmp/ \\\n||/\\/var\\/log\\/btmp/) \\\n&amp;&amp;/ +-p *wa/ \\\n&amp;&amp;(/ key= *[!-~]* *$/||/ -k *[!-~]* *$/)'\n</code></pre></p> <p>Verify the output matches: <pre><code>-w /var/run/utmp -p wa -k session\n-w /var/log/wtmp -p wa -k session\n-w /var/log/btmp -p wa -k session\n</code></pre></p>","tags":["Level 2","Workstation","Server","Logging and Auditing","Configure System Accounting (auditd)","Configure auditd rules","Automated","IG2","IG3","8.5 Collect Detailed Audit Logs","T1562","T1562.006","TA0001"]},{"location":"4-Logging-and-Auditing/4.1-Configure-System-Accounting-%28auditd%29/4.1.3-Configure-auditd-rules/4.1.3.11-Ensure-session-initiation-information-is-collected/#remediation","title":"Remediation","text":"<p>Edit or create a file in the /etc/audit/rules.d/ directory, ending in .rules extension, with the relevant rules to monitor session initiation information.</p> <p>Example: <pre><code># printf \"\n-w /var/run/utmp -p wa -k session\n-w /var/log/wtmp -p wa -k session\n-w /var/log/btmp -p wa -k session\n\" &gt;&gt; /etc/audit/rules.d/50-session.rules\n</code></pre></p> <p>Merge and load the rules into active configuration: <pre><code># augenrules --load\n</code></pre></p> <p>Check if reboot is required. <pre><code># if [[ $(auditctl -s | grep \"enabled\") =~ \"2\" ]]; then printf \"Reboot required to load rules\\n\"; fi\n</code></pre></p>","tags":["Level 2","Workstation","Server","Logging and Auditing","Configure System Accounting (auditd)","Configure auditd rules","Automated","IG2","IG3","8.5 Collect Detailed Audit Logs","T1562","T1562.006","TA0001"]},{"location":"4-Logging-and-Auditing/4.1-Configure-System-Accounting-%28auditd%29/4.1.3-Configure-auditd-rules/4.1.3.12-Ensure-login-and-logout-events-are-collected/","title":"4.1.3.12 Ensure login and logout events are collected","text":"","tags":["Level 2","Workstation","Server","Logging and Auditing","Configure System Accounting (auditd)","Configure auditd rules","Automated","IG2","IG3","8.5 Collect Detailed Audit Logs","T1562","T1562.006","TA0001"]},{"location":"4-Logging-and-Auditing/4.1-Configure-System-Accounting-%28auditd%29/4.1.3-Configure-auditd-rules/4.1.3.12-Ensure-login-and-logout-events-are-collected/#audit","title":"Audit","text":"<p>On disk configuration</p> <p>Run the following command to check the on disk rules: <pre><code># awk '/^ *-w/ \\\n&amp;&amp;(/\\/var\\/log\\/lastlog/ \\\n||/\\/var\\/run\\/faillock/) \\\n&amp;&amp;/ +-p *wa/ \\\n&amp;&amp;(/ key= *[!-~]* *$/||/ -k *[!-~]* *$/)' /etc/audit/rules.d/*.rules\n</code></pre></p> <p>Verify the output matches: <pre><code>-w /var/log/lastlog -p wa -k logins\n-w /var/run/faillock -p wa -k logins\n</code></pre></p> <p>Running configuration</p> <p>Run the following command to check loaded rules: <pre><code># auditctl -l | awk '/^ *-w/ \\\n&amp;&amp;(/\\/var\\/log\\/lastlog/ \\\n||/\\/var\\/run\\/faillock/) \\\n&amp;&amp;/ +-p *wa/ \\\n&amp;&amp;(/ key= *[!-~]* *$/||/ -k *[!-~]* *$/)'\n</code></pre></p> <p>Verify the output matches: <pre><code>-w /var/log/lastlog -p wa -k logins\n-w /var/run/faillock -p wa -k logins\n</code></pre></p>","tags":["Level 2","Workstation","Server","Logging and Auditing","Configure System Accounting (auditd)","Configure auditd rules","Automated","IG2","IG3","8.5 Collect Detailed Audit Logs","T1562","T1562.006","TA0001"]},{"location":"4-Logging-and-Auditing/4.1-Configure-System-Accounting-%28auditd%29/4.1.3-Configure-auditd-rules/4.1.3.12-Ensure-login-and-logout-events-are-collected/#remediation","title":"Remediation","text":"<p>Edit or create a file in the /etc/audit/rules.d/ directory, ending in .rules extension, with the relevant rules to monitor login and logout events.</p> <p>Example: <pre><code># printf \"\n-w /var/log/lastlog -p wa -k logins\n-w /var/run/faillock -p wa -k logins\n\" &gt;&gt; /etc/audit/rules.d/50-login.rules\n</code></pre></p> <p>Merge and load the rules into active configuration: <pre><code># augenrules --load\n</code></pre></p> <p>Check if reboot is required. <pre><code># if [[ $(auditctl -s | grep \"enabled\") =~ \"2\" ]]; then printf \"Reboot required to load rules\\n\"; fi\n</code></pre></p>","tags":["Level 2","Workstation","Server","Logging and Auditing","Configure System Accounting (auditd)","Configure auditd rules","Automated","IG2","IG3","8.5 Collect Detailed Audit Logs","T1562","T1562.006","TA0001"]},{"location":"4-Logging-and-Auditing/4.1-Configure-System-Accounting-%28auditd%29/4.1.3-Configure-auditd-rules/4.1.3.13-Ensure-file-deletion-events-by-users-are-collected/","title":"4.1.3.13 Ensure file deletion events by users are collected","text":"","tags":["Level 2","Workstation","Server","Logging and Auditing","Configure System Accounting (auditd)","Configure auditd rules","Automated","IG2","IG3","8.5 Collect Detailed Audit Logs","T1562","T1562.006","TA0005"]},{"location":"4-Logging-and-Auditing/4.1-Configure-System-Accounting-%28auditd%29/4.1.3-Configure-auditd-rules/4.1.3.13-Ensure-file-deletion-events-by-users-are-collected/#audit","title":"Audit","text":"<p>64 Bit systems</p> <p>On disk configuration</p> <p>Run the following command to check the on disk rules: <pre><code># {\nUID_MIN=$(awk '/^\\s*UID_MIN/{print $2}' /etc/login.defs)\n[ -n \"${UID_MIN}\" ] &amp;&amp; awk \"/^ *-a *always,exit/ \\\n&amp;&amp;/ -F *arch=b[2346]{2}/ \\\n&amp;&amp;(/ -F *auid!=unset/||/ -F *auid!=-1/||/ -F *auid!=4294967295/) \\\n&amp;&amp;/ -F *auid&gt;=${UID_MIN}/ \\\n&amp;&amp;/ -S/ \\\n&amp;&amp;(/unlink/||/rename/||/unlinkat/||/renameat/) \\\n&amp;&amp;(/ key= *[!-~]* *$/||/ -k *[!-~]* *$/)\" /etc/audit/rules.d/*.rules \\\n|| printf \"ERROR: Variable 'UID_MIN' is unset.\\n\"\n}\n</code></pre></p> <p>Verify the output matches: <pre><code>-a always,exit -F arch=b64 -S unlink,unlinkat,rename,renameat -F auid&gt;=1000 -F auid!=unset -k delete\n-a always,exit -F arch=b32 -S unlink,unlinkat,rename,renameat -F auid&gt;=1000 -F auid!=unset -k delete\n</code></pre></p> <p>Running configuration</p> <p>Run the following command to check loaded rules: <pre><code># {\nUID_MIN=$(awk '/^\\s*UID_MIN/{print $2}' /etc/login.defs)\n[ -n \"${UID_MIN}\" ] &amp;&amp; auditctl -l | awk \"/^ *-a *always,exit/ \\\n&amp;&amp;/ -F *arch=b[2346]{2}/ \\\n&amp;&amp;(/ -F *auid!=unset/||/ -F *auid!=-1/||/ -F *auid!=4294967295/) \\\n&amp;&amp;/ -F *auid&gt;=${UID_MIN}/ \\\n&amp;&amp;/ -S/ \\\n&amp;&amp;(/unlink/||/rename/||/unlinkat/||/renameat/) \\\n&amp;&amp;(/ key= *[!-~]* *$/||/ -k *[!-~]* *$/)\" \\\n|| printf \"ERROR: Variable 'UID_MIN' is unset.\\n\"\n}\n</code></pre></p> <p>Verify the output matches: <pre><code>-a always,exit -F arch=b64 -S rename,unlink,unlinkat,renameat -F auid&gt;=1000 -F auid!=-1 -F key=delete\n-a always,exit -F arch=b32 -S unlink,rename,unlinkat,renameat -F auid&gt;=1000 -F auid!=-1 -F key=delete\n</code></pre></p> <p>32 Bit systems</p> <p>Follow the same procedures as for 64 bit systems and ignore any entries with b64.</p>","tags":["Level 2","Workstation","Server","Logging and Auditing","Configure System Accounting (auditd)","Configure auditd rules","Automated","IG2","IG3","8.5 Collect Detailed Audit Logs","T1562","T1562.006","TA0005"]},{"location":"4-Logging-and-Auditing/4.1-Configure-System-Accounting-%28auditd%29/4.1.3-Configure-auditd-rules/4.1.3.13-Ensure-file-deletion-events-by-users-are-collected/#remediation","title":"Remediation","text":"<p>Create audit rules</p> <p>Edit or create a file in the /etc/audit/rules.d/ directory, ending in .rules extension, with the relevant rules to monitor file deletion events by users.</p> <p>64 Bit systems</p> <p>Example: <pre><code># {\nUID_MIN=$(awk '/^\\s*UID_MIN/{print $2}' /etc/login.defs)\n[ -n \"${UID_MIN}\" ] &amp;&amp; printf \"\n-a always,exit -F arch=b64 -S rename,unlink,unlinkat,renameat -F auid&gt;=${UID_MIN} -F auid!=unset -F key=delete\n-a always,exit -F arch=b32 -S rename,unlink,unlinkat,renameat -F auid&gt;=${UID_MIN} -F auid!=unset -F key=delete\n\" &gt;&gt; /etc/audit/rules.d/50-delete.rules || printf \"ERROR: Variable 'UID_MIN' is unset.\\n\"\n}\n</code></pre></p> <p>Load audit rules</p> <p>Merge and load the rules into active configuration: <pre><code># augenrules --load\n</code></pre></p> <p>Check if reboot is required. <pre><code># if [[ $(auditctl -s | grep \"enabled\") =~ \"2\" ]]; then printf \"Reboot required to load rules\\n\"; fi\n</code></pre></p> <p>32 Bit systems</p> <p>Follow the same procedures as for 64 bit systems and ignore any entries with b64.</p>","tags":["Level 2","Workstation","Server","Logging and Auditing","Configure System Accounting (auditd)","Configure auditd rules","Automated","IG2","IG3","8.5 Collect Detailed Audit Logs","T1562","T1562.006","TA0005"]},{"location":"4-Logging-and-Auditing/4.1-Configure-System-Accounting-%28auditd%29/4.1.3-Configure-auditd-rules/4.1.3.14-Ensure-events-that-modify-the-system%27s-mandatory-access-controls-are-collected/","title":"4.1.3.14 Ensure events that modify the system's Mandatory Access Controls are collected","text":"","tags":["Level 2","Workstation","Server","Logging and Auditing","Configure System Accounting (auditd)","Configure auditd rules","Automated","IG2","IG3","8.5 Collect Detailed Audit Logs","T1562","T1562.006","TA0004","M1022"]},{"location":"4-Logging-and-Auditing/4.1-Configure-System-Accounting-%28auditd%29/4.1.3-Configure-auditd-rules/4.1.3.14-Ensure-events-that-modify-the-system%27s-mandatory-access-controls-are-collected/#audit","title":"Audit","text":"<p>On disk configuration</p> <p>Run the following command to check the on disk rules: <pre><code># awk '/^ *-w/ \\\n&amp;&amp;(/\\/etc\\/apparmor/ \\\n||/\\/etc\\/apparmor.d/) \\\n&amp;&amp;/ +-p *wa/ \\\n&amp;&amp;(/ key= *[!-~]* *$/||/ -k *[!-~]* *$/)' /etc/audit/rules.d/*.rules\n</code></pre></p> <p>Verify the output matches: <pre><code>-w /etc/apparmor/ -p wa -k MAC-policy\n-w /etc/apparmor.d/ -p wa -k MAC-policy\n</code></pre></p> <p>Running configuration</p> <p>Run the following command to check loaded rules: <pre><code># auditctl -l | awk '/^ *-w/ \\\n&amp;&amp;(/\\/etc\\/apparmor/ \\\n||/\\/etc\\/apparmor.d/) \\\n&amp;&amp;/ +-p *wa/ \\\n&amp;&amp;(/ key= *[!-~]* *$/||/ -k *[!-~]* *$/)'\n</code></pre></p> <p>Verify the output matches: <pre><code>-w /etc/apparmor/ -p wa -k MAC-policy\n-w /etc/apparmor.d/ -p wa -k MAC-policy\n</code></pre></p>","tags":["Level 2","Workstation","Server","Logging and Auditing","Configure System Accounting (auditd)","Configure auditd rules","Automated","IG2","IG3","8.5 Collect Detailed Audit Logs","T1562","T1562.006","TA0004","M1022"]},{"location":"4-Logging-and-Auditing/4.1-Configure-System-Accounting-%28auditd%29/4.1.3-Configure-auditd-rules/4.1.3.14-Ensure-events-that-modify-the-system%27s-mandatory-access-controls-are-collected/#remediation","title":"Remediation","text":"<p>Edit or create a file in the /etc/audit/rules.d/ directory, ending in .rules extension, with the relevant rules to monitor events that modify the system's Mandatory Access Controls.</p> <p>Example: <pre><code># printf \"\n-w /etc/apparmor/ -p wa -k MAC-policy\n-w /etc/apparmor.d/ -p wa -k MAC-policy\n\" &gt;&gt; /etc/audit/rules.d/50-MAC-policy.rules\n</code></pre></p> <p>Merge and load the rules into active configuration: <pre><code># augenrules --load\n</code></pre></p> <p>Check if reboot is required. <pre><code># if [[ $(auditctl -s | grep \"enabled\") =~ \"2\" ]]; then printf \"Reboot required to load rules\\n\"; fi\n</code></pre></p>","tags":["Level 2","Workstation","Server","Logging and Auditing","Configure System Accounting (auditd)","Configure auditd rules","Automated","IG2","IG3","8.5 Collect Detailed Audit Logs","T1562","T1562.006","TA0004","M1022"]},{"location":"4-Logging-and-Auditing/4.1-Configure-System-Accounting-%28auditd%29/4.1.3-Configure-auditd-rules/4.1.3.15-Ensure-successful-and-unsuccessful-attempts-to-use-the-chcon-command-are-recorded/","title":"4.1.3.15 Ensure successful and unsuccessful attempts to use the chcon command are recorded","text":"","tags":["Level 2","Workstation","Server","Logging and Auditing","Configure System Accounting (auditd)","Configure auditd rules","Automated","IG1","IG2","IG3","8.2 Collect Audit Logs"]},{"location":"4-Logging-and-Auditing/4.1-Configure-System-Accounting-%28auditd%29/4.1.3-Configure-auditd-rules/4.1.3.15-Ensure-successful-and-unsuccessful-attempts-to-use-the-chcon-command-are-recorded/#audit","title":"Audit","text":"<p>64 Bit systems</p> <p>On disk configuration</p> <p>Run the following command to check the on disk rules: <pre><code># {\nUID_MIN=$(awk '/^\\s*UID_MIN/{print $2}' /etc/login.defs)\n[ -n \"${UID_MIN}\" ] &amp;&amp; awk \"/^ *-a *always,exit/ \\\n&amp;&amp;(/ -F *auid!=unset/||/ -F *auid!=-1/||/ -F *auid!=4294967295/) \\\n&amp;&amp;/ -F *auid&gt;=${UID_MIN}/ \\\n&amp;&amp;/ -F *perm=x/ \\\n&amp;&amp;/ -F *path=\\/usr\\/bin\\/chcon/ \\\n&amp;&amp;(/ key= *[!-~]* *$/||/ -k *[!-~]* *$/)\" /etc/audit/rules.d/*.rules \\\n|| printf \"ERROR: Variable 'UID_MIN' is unset.\\n\"\n}\n</code></pre></p> <p>Verify the output matches: <pre><code>-a always,exit -F path=/usr/bin/chcon -F perm=x -F auid&gt;=1000 -F auid!=unset -k perm_chng\n</code></pre></p> <p>Running configuration</p> <p>Run the following command to check loaded rules: <pre><code># {\nUID_MIN=$(awk '/^\\s*UID_MIN/{print $2}' /etc/login.defs)\n[ -n \"${UID_MIN}\" ] &amp;&amp; auditctl -l | awk \"/^ *-a *always,exit/ \\\n&amp;&amp;(/ -F *auid!=unset/||/ -F *auid!=-1/||/ -F *auid!=4294967295/) \\\n&amp;&amp;/ -F *auid&gt;=${UID_MIN}/ \\\n&amp;&amp;/ -F *perm=x/ \\\n&amp;&amp;/ -F *path=\\/usr\\/bin\\/chcon/ \\\n&amp;&amp;(/ key= *[!-~]* *$/||/ -k *[!-~]* *$/)\" \\\n|| printf \"ERROR: Variable 'UID_MIN' is unset.\\n\"\n}\n</code></pre></p> <p>Verify the output matches: <pre><code>-a always,exit -S all -F path=/usr/bin/chcon -F perm=x -F auid&gt;=1000 -F auid!=-1 -F key=perm_chng\n</code></pre></p> <p>32 Bit systems</p> <p>Follow the same procedures as for 64 bit systems and ignore any entries with b64.</p>","tags":["Level 2","Workstation","Server","Logging and Auditing","Configure System Accounting (auditd)","Configure auditd rules","Automated","IG1","IG2","IG3","8.2 Collect Audit Logs"]},{"location":"4-Logging-and-Auditing/4.1-Configure-System-Accounting-%28auditd%29/4.1.3-Configure-auditd-rules/4.1.3.15-Ensure-successful-and-unsuccessful-attempts-to-use-the-chcon-command-are-recorded/#remediation","title":"Remediation","text":"<p>Create audit rules</p> <p>Edit or create a file in the /etc/audit/rules.d/ directory, ending in .rules extension, with the relevant rules to monitor successful and unsuccessful attempts to use the chcon command.</p> <p>64 Bit systems</p> <p>Example: <pre><code># {\nUID_MIN=$(awk '/^\\s*UID_MIN/{print $2}' /etc/login.defs)\n[ -n \"${UID_MIN}\" ] &amp;&amp; printf \"\n-a always,exit -F path=/usr/bin/chcon -F perm=x -F auid&gt;=${UID_MIN} -F auid!=unset -k perm_chng\n\" &gt;&gt; /etc/audit/rules.d/50-perm_chng.rules || printf \"ERROR: Variable\n'UID_MIN' is unset.\\n\"\n}\n</code></pre></p> <p>Load audit rules</p> <p>Merge and load the rules into active configuration: <pre><code># augenrules --load\n</code></pre></p> <p>Check if reboot is required. <pre><code># if [[ $(auditctl -s | grep \"enabled\") =~ \"2\" ]]; then printf \"Reboot required to load rules\\n\"; fi\n</code></pre></p> <p>32 Bit systems</p> <p>Follow the same procedures as for 64 bit systems and ignore any entries with b64.</p>","tags":["Level 2","Workstation","Server","Logging and Auditing","Configure System Accounting (auditd)","Configure auditd rules","Automated","IG1","IG2","IG3","8.2 Collect Audit Logs"]},{"location":"4-Logging-and-Auditing/4.1-Configure-System-Accounting-%28auditd%29/4.1.3-Configure-auditd-rules/4.1.3.16-Ensure-successful-and-unsuccessful-attempts-to-use-the-setfacl-command-are-recorded/","title":"4.1.3.16 Ensure successful and unsuccessful attempts to use the setfacl command are recorded","text":"","tags":["Level 2","Workstation","Server","Logging and Auditing","Configure System Accounting (auditd)","Configure auditd rules","Automated","IG1","IG2","IG3","8.2 Collect Audit Logs"]},{"location":"4-Logging-and-Auditing/4.1-Configure-System-Accounting-%28auditd%29/4.1.3-Configure-auditd-rules/4.1.3.16-Ensure-successful-and-unsuccessful-attempts-to-use-the-setfacl-command-are-recorded/#audit","title":"Audit","text":"<p>64 Bit systems</p> <p>On disk configuration</p> <p>Run the following command to check the on disk rules: <pre><code># {\nUID_MIN=$(awk '/^\\s*UID_MIN/{print $2}' /etc/login.defs)\n[ -n \"${UID_MIN}\" ] &amp;&amp; awk \"/^ *-a *always,exit/ \\\n&amp;&amp;(/ -F *auid!=unset/||/ -F *auid!=-1/||/ -F *auid!=4294967295/) \\\n&amp;&amp;/ -F *auid&gt;=${UID_MIN}/ \\\n&amp;&amp;/ -F *perm=x/ \\\n&amp;&amp;/ -F *path=\\/usr\\/bin\\/setfacl/ \\\n&amp;&amp;(/ key= *[!-~]* *$/||/ -k *[!-~]* *$/)\" /etc/audit/rules.d/*.rules ||\nprintf \"ERROR: Variable 'UID_MIN' is unset.\\n\"\n}\n</code></pre></p> <p>Verify the output matches: <pre><code>-a always,exit -F path=/usr/bin/setfacl -F perm=x -F auid&gt;=1000 -F auid!=unset -k perm_chng\n</code></pre></p> <p>Running configuration Run the following command to check loaded rules: <pre><code># {\nUID_MIN=$(awk '/^\\s*UID_MIN/{print $2}' /etc/login.defs)\n[ -n \"${UID_MIN}\" ] &amp;&amp; auditctl -l | awk \"/^ *-a *always,exit/ \\\n&amp;&amp;(/ -F *auid!=unset/||/ -F *auid!=-1/||/ -F *auid!=4294967295/) \\\n&amp;&amp;/ -F *auid&gt;=${UID_MIN}/ \\\n&amp;&amp;/ -F *perm=x/ \\\n&amp;&amp;/ -F *path=\\/usr\\/bin\\/setfacl/ \\\n&amp;&amp;(/ key= *[!-~]* *$/||/ -k *[!-~]* *$/)\" \\\n|| printf \"ERROR: Variable 'UID_MIN' is unset.\\n\"\n}\n</code></pre></p> <p>Verify the output matches: <pre><code>-a always,exit -S all -F path=/usr/bin/setfacl -F perm=x -F auid&gt;=1000 -F auid!=-1 -F key=perm_chng\n</code></pre></p> <p>32 Bit systems</p> <p>Follow the same procedures as for 64 bit systems and ignore any entries with b64</p>","tags":["Level 2","Workstation","Server","Logging and Auditing","Configure System Accounting (auditd)","Configure auditd rules","Automated","IG1","IG2","IG3","8.2 Collect Audit Logs"]},{"location":"4-Logging-and-Auditing/4.1-Configure-System-Accounting-%28auditd%29/4.1.3-Configure-auditd-rules/4.1.3.16-Ensure-successful-and-unsuccessful-attempts-to-use-the-setfacl-command-are-recorded/#remediation","title":"Remediation","text":"<p>Create audit rules</p> <p>Edit or create a file in the /etc/audit/rules.d/ directory, ending in .rules extension, with the relevant rules to monitor successful and unsuccessful attempts to use the setfacl command.</p> <p>64 Bit systems</p> <p>Example: <pre><code># {\nUID_MIN=$(awk '/^\\s*UID_MIN/{print $2}' /etc/login.defs)\n[ -n \"${UID_MIN}\" ] &amp;&amp; printf \"\n-a always,exit -F path=/usr/bin/setfacl -F perm=x -F auid&gt;=${UID_MIN} -F auid!=unset -k perm_chng\n\" &gt;&gt; /etc/audit/rules.d/50-perm_chng.rules || printf \"ERROR: Variable 'UID_MIN' is unset.\\n\"\n}\n</code></pre></p> <p>Load audit rules</p> <p>Merge and load the rules into active configuration: <pre><code># augenrules --load\n</code></pre></p> <p>Check if reboot is required. <pre><code># if [[ $(auditctl -s | grep \"enabled\") =~ \"2\" ]]; then printf \"Reboot required to load rules\\n\"; fi\n</code></pre></p> <p>32 Bit systems</p> <p>Follow the same procedures as for 64 bit systems and ignore any entries with b64.</p>","tags":["Level 2","Workstation","Server","Logging and Auditing","Configure System Accounting (auditd)","Configure auditd rules","Automated","IG1","IG2","IG3","8.2 Collect Audit Logs"]},{"location":"4-Logging-and-Auditing/4.1-Configure-System-Accounting-%28auditd%29/4.1.3-Configure-auditd-rules/4.1.3.17-Ensure-successful-and-unsuccessful-attempts-to-use-the-chacl-command-are-recorded/","title":"4.1.3.17 Ensure successful and unsuccessful attempts to use the chacl command are recorde","text":"","tags":["Level 2","Workstation","Server","Logging and Auditing","Configure System Accounting (auditd)","Configure auditd rules","Automated","IG1","IG2","IG3","8.2 Collect Audit Logs"]},{"location":"4-Logging-and-Auditing/4.1-Configure-System-Accounting-%28auditd%29/4.1.3-Configure-auditd-rules/4.1.3.17-Ensure-successful-and-unsuccessful-attempts-to-use-the-chacl-command-are-recorded/#audit","title":"Audit","text":"<p>64 Bit systems</p> <p>On disk configuration</p> <p>Run the following command to check the on disk rules: <pre><code># {\nUID_MIN=$(awk '/^\\s*UID_MIN/{print $2}' /etc/login.defs)\n[ -n \"${UID_MIN}\" ] &amp;&amp; awk \"/^ *-a *always,exit/ \\\n&amp;&amp;(/ -F *auid!=unset/||/ -F *auid!=-1/||/ -F *auid!=4294967295/) \\\n&amp;&amp;/ -F *auid&gt;=${UID_MIN}/ \\\n&amp;&amp;/ -F *perm=x/ \\\n&amp;&amp;/ -F *path=\\/usr\\/bin\\/chacl/ \\\n&amp;&amp;(/ key= *[!-~]* *$/||/ -k *[!-~]* *$/)\" /etc/audit/rules.d/*.rules \\\n|| printf \"ERROR: Variable 'UID_MIN' is unset.\\n\"\n}\n</code></pre></p> <p>Verify the output matches: <pre><code>-a always,exit -F path=/usr/bin/chacl -F perm=x -F auid&gt;=1000 -F auid!=unset -k priv_cmd\n</code></pre></p> <p>Running configuration</p> <p>Run the following command to check loaded rules: <pre><code># {\nUID_MIN=$(awk '/^\\s*UID_MIN/{print $2}' /etc/login.defs)\n[ -n \"${UID_MIN}\" ] &amp;&amp; auditctl -l | awk \"/^ *-a *always,exit/ \\\n&amp;&amp;(/ -F *auid!=unset/||/ -F *auid!=-1/||/ -F *auid!=4294967295/) \\\n&amp;&amp;/ -F *auid&gt;=${UID_MIN}/ \\\n&amp;&amp;/ -F *perm=x/ \\\n&amp;&amp;/ -F *path=\\/usr\\/bin\\/chacl/ \\\n&amp;&amp;(/ key= *[!-~]* *$/||/ -k *[!-~]* *$/)\" \\\n|| printf \"ERROR: Variable 'UID_MIN' is unset.\\n\"\n}\n</code></pre></p> <p>Verify the output matches: <pre><code>-a always,exit -S all -F path=/usr/bin/chacl -F perm=x -F auid&gt;=1000 -F auid!=-1 -F key=priv_cmd\n</code></pre></p> <p>32 Bit systems</p> <p>Follow the same procedures as for 64 bit systems and ignore any entries with b64.</p>","tags":["Level 2","Workstation","Server","Logging and Auditing","Configure System Accounting (auditd)","Configure auditd rules","Automated","IG1","IG2","IG3","8.2 Collect Audit Logs"]},{"location":"4-Logging-and-Auditing/4.1-Configure-System-Accounting-%28auditd%29/4.1.3-Configure-auditd-rules/4.1.3.17-Ensure-successful-and-unsuccessful-attempts-to-use-the-chacl-command-are-recorded/#remediation","title":"Remediation","text":"<p>Create audit rules</p> <p>Edit or create a file in the /etc/audit/rules.d/ directory, ending in .rules extension, with the relevant rules to monitor successful and unsuccessful attempts to use the chacl command.</p> <p>64 Bit systems</p> <p>Example: <pre><code># {\nUID_MIN=$(awk '/^\\s*UID_MIN/{print $2}' /etc/login.defs)\n[ -n \"${UID_MIN}\" ] &amp;&amp; printf \"\n-a always,exit -F path=/usr/bin/chacl -F perm=x -F auid&gt;=${UID_MIN} -F auid!=unset -k perm_chng\n\" &gt;&gt; /etc/audit/rules.d/50-perm_chng.rules || printf \"ERROR: Variable 'UID_MIN' is unset.\\n\"\n}\n</code></pre></p> <p>Load audit rules</p> <p>Merge and load the rules into active configuration: <pre><code># augenrules --load\n</code></pre></p> <p>Check if reboot is required. <pre><code># if [[ $(auditctl -s | grep \"enabled\") =~ \"2\" ]]; then printf \"Reboot required to load rules\\n\"; fi\n</code></pre></p> <p>32 Bit systems</p> <p>Follow the same procedures as for 64 bit systems and ignore any entries with b64.</p>","tags":["Level 2","Workstation","Server","Logging and Auditing","Configure System Accounting (auditd)","Configure auditd rules","Automated","IG1","IG2","IG3","8.2 Collect Audit Logs"]},{"location":"4-Logging-and-Auditing/4.1-Configure-System-Accounting-%28auditd%29/4.1.3-Configure-auditd-rules/4.1.3.18-Ensure-successful-and-unsuccessful-attempts-to-use-the-usermod-command-are-recorded/","title":"4.1.3.18 Ensure successful and unsuccessful attempts to use the usermod command are recorded","text":"","tags":["Level 2","Workstation","Server","Logging and Auditing","Configure System Accounting (auditd)","Configure auditd rules","Automated","IG1","IG2","IG3","8.2 Collect Audit Logs"]},{"location":"4-Logging-and-Auditing/4.1-Configure-System-Accounting-%28auditd%29/4.1.3-Configure-auditd-rules/4.1.3.18-Ensure-successful-and-unsuccessful-attempts-to-use-the-usermod-command-are-recorded/#audit","title":"Audit","text":"<p>64 Bit systems</p> <p>On disk configuration</p> <p>Run the following command to check the on disk rules: <pre><code># {\nUID_MIN=$(awk '/^\\s*UID_MIN/{print $2}' /etc/login.defs)\n[ -n \"${UID_MIN}\" ] &amp;&amp; awk \"/^ *-a *always,exit/ \\\n&amp;&amp;(/ -F *auid!=unset/||/ -F *auid!=-1/||/ -F *auid!=4294967295/) \\\n&amp;&amp;/ -F *auid&gt;=${UID_MIN}/ \\\n&amp;&amp;/ -F *perm=x/ \\\n&amp;&amp;/ -F *path=\\/usr\\/sbin\\/usermod/ \\\n&amp;&amp;(/ key= *[!-~]* *$/||/ -k *[!-~]* *$/)\" /etc/audit/rules.d/*.rules \\\n|| printf \"ERROR: Variable 'UID_MIN' is unset.\\n\"\n}\n</code></pre></p> <p>Verify the output matches: <pre><code>-a always,exit -F path=/usr/sbin/usermod -F perm=x -F auid&gt;=1000 -F auid!=unset -k usermod\n</code></pre></p> <p>Running configuration</p> <p>Run the following command to check loaded rules: <pre><code># {\nUID_MIN=$(awk '/^\\s*UID_MIN/{print $2}' /etc/login.defs)\n[ -n \"${UID_MIN}\" ] &amp;&amp; auditctl -l | awk \"/^ *-a *always,exit/ \\\n&amp;&amp;(/ -F *auid!=unset/||/ -F *auid!=-1/||/ -F *auid!=4294967295/) \\\n&amp;&amp;/ -F *auid&gt;=${UID_MIN}/ \\\n&amp;&amp;/ -F *perm=x/ \\\n&amp;&amp;/ -F *path=\\/usr\\/sbin\\/usermod/ \\\n&amp;&amp;(/ key= *[!-~]* *$/||/ -k *[!-~]* *$/)\" \\\n|| printf \"ERROR: Variable 'UID_MIN' is unset.\\n\"\n}\n</code></pre></p> <p>Verify the output matches: <pre><code>-a always,exit -S all -F path=/usr/sbin/usermod -F perm=x -F auid&gt;=1000 -F auid!=-1 -F key=usermod\n</code></pre></p> <p>32 Bit systems</p> <p>Follow the same procedures as for 64 bit systems and ignore any entries with b64.</p>","tags":["Level 2","Workstation","Server","Logging and Auditing","Configure System Accounting (auditd)","Configure auditd rules","Automated","IG1","IG2","IG3","8.2 Collect Audit Logs"]},{"location":"4-Logging-and-Auditing/4.1-Configure-System-Accounting-%28auditd%29/4.1.3-Configure-auditd-rules/4.1.3.18-Ensure-successful-and-unsuccessful-attempts-to-use-the-usermod-command-are-recorded/#remediation","title":"Remediation","text":"<p>Create audit rules</p> <p>Edit or create a file in the /etc/audit/rules.d/ directory, ending in .rules extension, with the relevant rules to monitor successful and unsuccessful attempts to use the usermod command.</p> <p>64 Bit systems</p> <p>Example: <pre><code># {\nUID_MIN=$(awk '/^\\s*UID_MIN/{print $2}' /etc/login.defs)\n[ -n \"${UID_MIN}\" ] &amp;&amp; printf \"\n-a always,exit -F path=/usr/sbin/usermod -F perm=x -F auid&gt;=${UID_MIN} -F auid!=unset -k usermod\n\" &gt;&gt; /etc/audit/rules.d/50-usermod.rules || printf \"ERROR: Variable 'UID_MIN' is unset.\\n\"\n}\n</code></pre></p> <p>Load audit rules</p> <p>Merge and load the rules into active configuration: <pre><code># augenrules --load\n</code></pre></p> <p>Check if reboot is required. <pre><code># if [[ $(auditctl -s | grep \"enabled\") =~ \"2\" ]]; then printf \"Reboot required to load rules\\n\"; fi\n</code></pre></p> <p>32 Bit systems</p> <p>Follow the same procedures as for 64 bit systems and ignore any entries with b64.</p>","tags":["Level 2","Workstation","Server","Logging and Auditing","Configure System Accounting (auditd)","Configure auditd rules","Automated","IG1","IG2","IG3","8.2 Collect Audit Logs"]},{"location":"4-Logging-and-Auditing/4.1-Configure-System-Accounting-%28auditd%29/4.1.3-Configure-auditd-rules/4.1.3.19-Ensure-kernel-module-loading-unloading-and-modification-is-collected/","title":"4.1.3.19 Ensure kernel module loading unloading and modification is collected","text":"","tags":["Level 2","Workstation","Server","Logging and Auditing","Configure System Accounting (auditd)","Configure auditd rules","Automated","IG2","IG3","8.5 Collect Detailed Audit Logs","T1562","T1562.006","TA0004","M1047"]},{"location":"4-Logging-and-Auditing/4.1-Configure-System-Accounting-%28auditd%29/4.1.3-Configure-auditd-rules/4.1.3.19-Ensure-kernel-module-loading-unloading-and-modification-is-collected/#audit","title":"Audit","text":"<p>64 Bit systems</p> <p>On disk configuration</p> <p>Run the following commands to check the on disk rules: <pre><code># {\nawk '/^ *-a *always,exit/ \\\n&amp;&amp;/ -F *arch=b[2346]{2}/ \\\n&amp;&amp;(/ -F auid!=unset/||/ -F auid!=-1/||/ -F auid!=4294967295/) \\\n&amp;&amp;/ -S/ \\\n&amp;&amp;(/init_module/ \\\n ||/finit_module/ \\\n ||/delete_module/ \\\n ||/create_module/ \\\n ||/query_module/) \\\n&amp;&amp;(/ key= *[!-~]* *$/||/ -k *[!-~]* *$/)' /etc/audit/rules.d/*.rules\nUID_MIN=$(awk '/^\\s*UID_MIN/{print $2}' /etc/login.defs)\n[ -n \"${UID_MIN}\" ] &amp;&amp; awk \"/^ *-a *always,exit/ \\\n&amp;&amp;(/ -F *auid!=unset/||/ -F *auid!=-1/||/ -F *auid!=4294967295/) \\\n&amp;&amp;/ -F *auid&gt;=${UID_MIN}/ \\\n&amp;&amp;/ -F *perm=x/ \\\n&amp;&amp;/ -F *path=\\/usr\\/bin\\/kmod/ \\\n&amp;&amp;(/ key= *[!-~]* *$/||/ -k *[!-~]* *$/)\" /etc/audit/rules.d/*.rules \\\n|| printf \"ERROR: Variable 'UID_MIN' is unset.\\n\"\n}\n</code></pre></p> <p>Verify the output matches: <pre><code>-a always,exit -F arch=b64 -S init_module,finit_module,delete_module,create_module,query_module -F auid&gt;=1000 -F auid!=unset -k kernel_modules\n-a always,exit -F path=/usr/bin/kmod -F perm=x -F auid&gt;=1000 -F auid!=unset -k kernel_modules\n</code></pre></p> <p>Running configuration</p> <p>Run the following command to check loaded rules: <pre><code># {\nauditctl -l | awk '/^ *-a *always,exit/ \\\n&amp;&amp;/ -F *arch=b[2346]{2}/ \\\n&amp;&amp;(/ -F auid!=unset/||/ -F auid!=-1/||/ -F auid!=4294967295/) \\\n&amp;&amp;/ -S/ \\\n&amp;&amp;(/init_module/ \\\n ||/finit_module/ \\\n ||/delete_module/ \\\n ||/create_module/ \\\n ||/query_module/) \\\n&amp;&amp;(/ key= *[!-~]* *$/||/ -k *[!-~]* *$/)'\nUID_MIN=$(awk '/^\\s*UID_MIN/{print $2}' /etc/login.defs)\n[ -n \"${UID_MIN}\" ] &amp;&amp; auditctl -l | awk \"/^ *-a *always,exit/ \\\n&amp;&amp;(/ -F *auid!=unset/||/ -F *auid!=-1/||/ -F *auid!=4294967295/) \\\n&amp;&amp;/ -F *auid&gt;=${UID_MIN}/ \\\n&amp;&amp;/ -F *perm=x/ \\\n&amp;&amp;/ -F *path=\\/usr\\/bin\\/kmod/ \\\n&amp;&amp;(/ key= *[!-~]* *$/||/ -k *[!-~]* *$/)\" \\\n|| printf \"ERROR: Variable 'UID_MIN' is unset.\\n\"\n}\n</code></pre></p> <p>Verify the output includes: <pre><code>-a always,exit -F arch=b64 -S\ncreate_module,init_module,delete_module,query_module,finit_module -F auid&gt;=1000 -F auid!=-1 -F key=kernel_modules\n-a always,exit -S all -F path=/usr/bin/kmod -F perm=x -F auid&gt;=1000 -F auid!=-1 -F key=kernel_modules\n</code></pre></p> <p>Symlink audit</p> <p>Audit if the symlinks that kmod accepts is indeed pointing at it: <pre><code># S_LINKS=$(ls -l /usr/sbin/lsmod /usr/sbin/rmmod /usr/sbin/insmod /usr/sbin/modinfo /usr/sbin/modprobe /usr/sbin/depmod | grep -v \" -&gt; ../bin/kmod\" || true) \\\n&amp;&amp; if [[ \"${S_LINKS}\" != \"\" ]]; then printf \"Issue with symlinks: ${S_LINKS}\\n\"; else printf \"OK\\n\"; fi\n</code></pre></p> <p>Verify the output states OK. If there is a symlink pointing to a different location it should be investigated.</p>","tags":["Level 2","Workstation","Server","Logging and Auditing","Configure System Accounting (auditd)","Configure auditd rules","Automated","IG2","IG3","8.5 Collect Detailed Audit Logs","T1562","T1562.006","TA0004","M1047"]},{"location":"4-Logging-and-Auditing/4.1-Configure-System-Accounting-%28auditd%29/4.1.3-Configure-auditd-rules/4.1.3.19-Ensure-kernel-module-loading-unloading-and-modification-is-collected/#remediation","title":"Remediation","text":"<p>Create audit rules</p> <p>Edit or create a file in the /etc/audit/rules.d/ directory, ending in .rules extension, with the relevant rules to monitor kernel module modification.</p> <p>64 Bit systems</p> <p>Example: <pre><code># {\nUID_MIN=$(awk '/^\\s*UID_MIN/{print $2}' /etc/login.defs)\n[ -n \"${UID_MIN}\" ] &amp;&amp; printf \"\n-a always,exit -F arch=b64 -S\ninit_module,finit_module,delete_module,create_module,query_module -F auid&gt;=${UID_MIN} -F auid!=unset -k kernel_modules\n-a always,exit -F path=/usr/bin/kmod -F perm=x -F auid&gt;=${UID_MIN} -F auid!=unset -k kernel_modules\n\" &gt;&gt; /etc/audit/rules.d/50-kernel_modules.rules || printf \"ERROR: Variable 'UID_MIN' is unset.\\n\"\n}\n</code></pre></p> <p>Load audit rules</p> <p>Merge and load the rules into active configuration: <pre><code># augenrules --load\n</code></pre></p> <p>Check if reboot is required. <pre><code># if [[ $(auditctl -s | grep \"enabled\") =~ \"2\" ]]; then printf \"Reboot required to load rules\\n\"; fi\n</code></pre></p>","tags":["Level 2","Workstation","Server","Logging and Auditing","Configure System Accounting (auditd)","Configure auditd rules","Automated","IG2","IG3","8.5 Collect Detailed Audit Logs","T1562","T1562.006","TA0004","M1047"]},{"location":"4-Logging-and-Auditing/4.1-Configure-System-Accounting-%28auditd%29/4.1.3-Configure-auditd-rules/4.1.3.2-Ensure-actions-as-another-user-are-always-logged/","title":"4.1.3.2 Ensure actions as another user are always logged","text":"","tags":["Level 2","Workstation","Server","Logging and Auditing","Configure System Accounting (auditd)","Configure auditd rules","Automated","IG2","IG3","8.5 Collect Detailed Audit Logs","T1562","T1562.006","TA0004","M1047"]},{"location":"4-Logging-and-Auditing/4.1-Configure-System-Accounting-%28auditd%29/4.1.3-Configure-auditd-rules/4.1.3.2-Ensure-actions-as-another-user-are-always-logged/#audit","title":"Audit","text":"<p>64 Bit systems</p> <p>On disk configuration</p> <p>Run the following command to check the on disk rules: <pre><code># awk '/^ *-a *always,exit/ \\\n&amp;&amp;/ -F *arch=b[2346]{2}/ \\\n&amp;&amp;(/ -F *auid!=unset/||/ -F *auid!=-1/||/ -F *auid!=4294967295/) \\\n&amp;&amp;(/ -C *euid!=uid/||/ -C *uid!=euid/) \\\n&amp;&amp;/ -S *execve/ \\\n&amp;&amp;(/ key= *[!-~]* *$/||/ -k *[!-~]* *$/)' /etc/audit/rules.d/*.rules\n</code></pre></p> <p>Verify the output matches: <pre><code>-a always,exit -F arch=b64 -C euid!=uid -F auid!=unset -S execve -k user_emulation\n-a always,exit -F arch=b32 -C euid!=uid -F auid!=unset -S execve -k user_emulation\n</code></pre></p> <p>Running configuration</p> <p>Run the following command to check loaded rules: <pre><code># auditctl -l | awk '/^ *-a *always,exit/ \\\n&amp;&amp;/ -F *arch=b[2346]{2}/ \\\n&amp;&amp;(/ -F *auid!=unset/||/ -F *auid!=-1/||/ -F *auid!=4294967295/) \\\n&amp;&amp;(/ -C *euid!=uid/||/ -C *uid!=euid/) \\\n&amp;&amp;/ -S *execve/ \\\n&amp;&amp;(/ key= *[!-~]* *$/||/ -k *[!-~]* *$/)'\n</code></pre></p> <p>Verify the output matches: <pre><code>-a always,exit -F arch=b64 -S execve -C uid!=euid -F auid!=-1 -F key=user_emulation\n-a always,exit -F arch=b32 -S execve -C uid!=euid -F auid!=-1 -F key=user_emulation\n</code></pre></p> <p>32 Bit systems</p> <p>Follow the same procedures as for 64 bit systems and ignore any entries with b64.</p>","tags":["Level 2","Workstation","Server","Logging and Auditing","Configure System Accounting (auditd)","Configure auditd rules","Automated","IG2","IG3","8.5 Collect Detailed Audit Logs","T1562","T1562.006","TA0004","M1047"]},{"location":"4-Logging-and-Auditing/4.1-Configure-System-Accounting-%28auditd%29/4.1.3-Configure-auditd-rules/4.1.3.2-Ensure-actions-as-another-user-are-always-logged/#remediation","title":"Remediation","text":"<p>Create audit rules</p> <p>Edit or create a file in the /etc/audit/rules.d/ directory, ending in .rules extension, with the relevant rules to monitor elevated privileges.</p> <p>64 Bit systems</p> <p>Example: <pre><code># printf \"\n-a always,exit -F arch=b64 -C euid!=uid -F auid!=unset -S execve -k user_emulation\n-a always,exit -F arch=b32 -C euid!=uid -F auid!=unset -S execve -k user_emulation\n\" &gt;&gt; /etc/audit/rules.d/50-user_emulation.rules\n</code></pre></p> <p>Load audit rules</p> <p>Merge and load the rules into active configuration: <pre><code># augenrules --load\n</code></pre></p> <p>Check if reboot is required. <pre><code># if [[ $(auditctl -s | grep \"enabled\") =~ \"2\" ]]; then printf \"Reboot required to load rules\\n\"; fi\n</code></pre></p> <p>32 Bit systems</p> <p>Follow the same procedures as for 64 bit systems and ignore any entries with b64.</p>","tags":["Level 2","Workstation","Server","Logging and Auditing","Configure System Accounting (auditd)","Configure auditd rules","Automated","IG2","IG3","8.5 Collect Detailed Audit Logs","T1562","T1562.006","TA0004","M1047"]},{"location":"4-Logging-and-Auditing/4.1-Configure-System-Accounting-%28auditd%29/4.1.3-Configure-auditd-rules/4.1.3.20-Ensure-the-audit-configuration-is-immutable/","title":"4.1.3.20 Ensure the audit configuration is immutable","text":"","tags":["Level 2","Workstation","Server","Logging and Auditing","Configure System Accounting (auditd)","Configure auditd rules","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","8.5 Collect Detailed Audit Logs","T1562","T1562.001","TA0005"]},{"location":"4-Logging-and-Auditing/4.1-Configure-System-Accounting-%28auditd%29/4.1.3-Configure-auditd-rules/4.1.3.20-Ensure-the-audit-configuration-is-immutable/#audit","title":"Audit","text":"<p>Run the following command and verify output matches: <pre><code># grep -Ph -- '^\\h*-e\\h+2\\b' /etc/audit/rules.d/*.rules | tail -1\n-e 2\n</code></pre></p>","tags":["Level 2","Workstation","Server","Logging and Auditing","Configure System Accounting (auditd)","Configure auditd rules","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","8.5 Collect Detailed Audit Logs","T1562","T1562.001","TA0005"]},{"location":"4-Logging-and-Auditing/4.1-Configure-System-Accounting-%28auditd%29/4.1.3-Configure-auditd-rules/4.1.3.20-Ensure-the-audit-configuration-is-immutable/#remediation","title":"Remediation","text":"<p>Edit or create the file /etc/audit/rules.d/99-finalize.rules and add the line -e 2 at the end of the file:</p> <p>Example: <pre><code># printf -- \"-e 2\n\" &gt;&gt; /etc/audit/rules.d/99-finalize.rules\n</code></pre></p> <p>Load audit rules</p> <p>Merge and load the rules into active configuration: <pre><code># augenrules --load\n</code></pre></p> <p>Check if reboot is required. <pre><code># if [[ $(auditctl -s | grep \"enabled\") =~ \"2\" ]]; then printf \"Reboot required to load rules\\n\"; fi\n</code></pre></p>","tags":["Level 2","Workstation","Server","Logging and Auditing","Configure System Accounting (auditd)","Configure auditd rules","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","8.5 Collect Detailed Audit Logs","T1562","T1562.001","TA0005"]},{"location":"4-Logging-and-Auditing/4.1-Configure-System-Accounting-%28auditd%29/4.1.3-Configure-auditd-rules/4.1.3.21-Ensure-the-running-and-on-disk-configuration-is-the-same/","title":"4.1.3.21 Ensure the running and on disk configuration is the same","text":"","tags":["Level 2","Workstation","Server","Logging and Auditing","Configure System Accounting (auditd)","Configure auditd rules","Manual","IG2","IG3","8.5 Collect Detailed Audit Logs"]},{"location":"4-Logging-and-Auditing/4.1-Configure-System-Accounting-%28auditd%29/4.1.3-Configure-auditd-rules/4.1.3.21-Ensure-the-running-and-on-disk-configuration-is-the-same/#audit","title":"Audit","text":"<p>Merged rule sets</p> <p>Ensure that all rules in /etc/audit/rules.d have been merged into /etc/audit/audit.rules: <pre><code># augenrules --check\n/usr/sbin/augenrules: No change\n</code></pre></p> <p>Should there be any drift, run augenrules --load to merge and load all rules.</p>","tags":["Level 2","Workstation","Server","Logging and Auditing","Configure System Accounting (auditd)","Configure auditd rules","Manual","IG2","IG3","8.5 Collect Detailed Audit Logs"]},{"location":"4-Logging-and-Auditing/4.1-Configure-System-Accounting-%28auditd%29/4.1.3-Configure-auditd-rules/4.1.3.21-Ensure-the-running-and-on-disk-configuration-is-the-same/#remediation","title":"Remediation","text":"<p>If the rules are not aligned across all three () areas, run the following command to merge and load all rules: <pre><code># augenrules --load\n</code></pre></p> <p>Check if reboot is required. <pre><code>if [[ $(auditctl -s | grep \"enabled\") =~ \"2\" ]]; then echo \"Reboot required to load rules\"; fi\n</code></pre></p>","tags":["Level 2","Workstation","Server","Logging and Auditing","Configure System Accounting (auditd)","Configure auditd rules","Manual","IG2","IG3","8.5 Collect Detailed Audit Logs"]},{"location":"4-Logging-and-Auditing/4.1-Configure-System-Accounting-%28auditd%29/4.1.3-Configure-auditd-rules/4.1.3.3-Ensure-events-that-modify-the-sudo-log-file-are-collected/","title":"4.1.3.3 Ensure events that modify the sudo log file are collected","text":"","tags":["Level 2","Workstation","Server","Logging and Auditing","Configure System Accounting (auditd)","Configure auditd rules","Automated","IG2","IG3","8.5 Collect Detailed Audit Logs"]},{"location":"4-Logging-and-Auditing/4.1-Configure-System-Accounting-%28auditd%29/4.1.3-Configure-auditd-rules/4.1.3.3-Ensure-events-that-modify-the-sudo-log-file-are-collected/#audit","title":"Audit","text":"<p>On disk configuration</p> <p>Run the following command to check the on disk rules: <pre><code># {\nSUDO_LOG_FILE_ESCAPED=$(grep -r logfile /etc/sudoers* | sed -e 's/.*logfile=//;s/,? .*//' -e 's/\"//g' -e 's|/|\\\\/|g')\n[ -n \"${SUDO_LOG_FILE_ESCAPED}\" ] &amp;&amp; awk \"/^ *-w/ \\\n&amp;&amp;/\"${SUDO_LOG_FILE_ESCAPED}\"/ \\\n&amp;&amp;/ +-p *wa/ \\\n&amp;&amp;(/ key= *[!-~]* *$/||/ -k *[!-~]* *$/)\" /etc/audit/rules.d/*.rules \\\n|| printf \"ERROR: Variable 'SUDO_LOG_FILE_ESCAPED' is unset.\\n\"\n}\n</code></pre></p> <p>Verify output of matches: <pre><code>-w /var/log/sudo.log -p wa -k sudo_log_file\n</code></pre></p> <p>Running configuration</p> <p>Run the following command to check loaded rules: <pre><code># {\nSUDO_LOG_FILE_ESCAPED=$(grep -r logfile /etc/sudoers* | sed -e\n's/.*logfile=//;s/,? .*//' -e 's/\"//g' -e 's|/|\\\\/|g')\n[ -n \"${SUDO_LOG_FILE_ESCAPED}\" ] &amp;&amp; auditctl -l | awk \"/^ *-w/ \\\n&amp;&amp;/\"${SUDO_LOG_FILE_ESCAPED}\"/ \\\n&amp;&amp;/ +-p *wa/ \\\n&amp;&amp;(/ key= *[!-~]* *$/||/ -k *[!-~]* *$/)\" \\\n|| printf \"ERROR: Variable 'SUDO_LOG_FILE_ESCAPED' is unset.\\n\"\n}\n</code></pre></p> <p>Verify output matches: <pre><code>-w /var/log/sudo.log -p wa -k sudo_log_file\n</code></pre></p>","tags":["Level 2","Workstation","Server","Logging and Auditing","Configure System Accounting (auditd)","Configure auditd rules","Automated","IG2","IG3","8.5 Collect Detailed Audit Logs"]},{"location":"4-Logging-and-Auditing/4.1-Configure-System-Accounting-%28auditd%29/4.1.3-Configure-auditd-rules/4.1.3.3-Ensure-events-that-modify-the-sudo-log-file-are-collected/#remediation","title":"Remediation","text":"<p>Edit or create a file in the /etc/audit/rules.d/ directory, ending in .rules extension, with the relevant rules to monitor events that modify the sudo log file.</p> <p>Example: <pre><code># {\nSUDO_LOG_FILE=$(grep -r logfile /etc/sudoers* | sed -e 's/.*logfile=//;s/,?\n.*//' -e 's/\"//g')\n[ -n \"${SUDO_LOG_FILE}\" ] &amp;&amp; printf \"\n-w ${SUDO_LOG_FILE} -p wa -k sudo_log_file\n\" &gt;&gt; /etc/audit/rules.d/50-sudo.rules || printf \"ERROR: Variable 'SUDO_LOG_FILE_ESCAPED' is unset.\\n\"\n}\n</code></pre></p> <p>Merge and load the rules into active configuration: <pre><code># augenrules --load\n</code></pre></p> <p>Check if reboot is required. <pre><code># if [[ $(auditctl -s | grep \"enabled\") =~ \"2\" ]]; then printf \"Reboot required to load rules\\n\"; fi\n</code></pre></p>","tags":["Level 2","Workstation","Server","Logging and Auditing","Configure System Accounting (auditd)","Configure auditd rules","Automated","IG2","IG3","8.5 Collect Detailed Audit Logs"]},{"location":"4-Logging-and-Auditing/4.1-Configure-System-Accounting-%28auditd%29/4.1.3-Configure-auditd-rules/4.1.3.4-Ensure-events-that-modify-date-and-time-information-are-collected/","title":"4.1.3.4 Ensure events that modify date and time information are collected","text":"","tags":["Level 2","Workstation","Server","Logging and Auditing","Configure System Accounting (auditd)","Configure auditd rules","Automated","IG2","IG3","8.5 Collect Detailed Audit Logs","T1562","T1562.006","TA0005"]},{"location":"4-Logging-and-Auditing/4.1-Configure-System-Accounting-%28auditd%29/4.1.3-Configure-auditd-rules/4.1.3.4-Ensure-events-that-modify-date-and-time-information-are-collected/#audit","title":"Audit","text":"<p>64 Bit systems</p> <p>On disk configuration</p> <p>Run the following command to check the on disk rules: <pre><code># {\nawk '/^ *-a *always,exit/ \\\n&amp;&amp;/ -F *arch=b[2346]{2}/ \\\n&amp;&amp;/ -S/ \\\n&amp;&amp;(/adjtimex/ \\\n ||/settimeofday/ \\\n ||/clock_settime/ ) \\\n&amp;&amp;(/ key= *[!-~]* *$/||/ -k *[!-~]* *$/)' /etc/audit/rules.d/*.rules\nawk '/^ *-w/ \\\n&amp;&amp;/\\/etc\\/localtime/ \\\n&amp;&amp;/ +-p *wa/ \\\n&amp;&amp;(/ key= *[!-~]* *$/||/ -k *[!-~]* *$/)' /etc/audit/rules.d/*.rules\n}\n</code></pre></p> <p>Verify output of matches: <pre><code>-a always,exit -F arch=b64 -S adjtimex,settimeofday,clock_settime -k timechange\n-a always,exit -F arch=b32 -S adjtimex,settimeofday,clock_settime -k timechange\n-w /etc/localtime -p wa -k time-change\n</code></pre></p> <p>Running configuration</p> <p>Run the following command to check loaded rules: <pre><code># {\nauditctl -l | awk '/^ *-a *always,exit/ \\\n&amp;&amp;/ -F *arch=b[2346]{2}/ \\\n&amp;&amp;/ -S/ \\\n&amp;&amp;(/adjtimex/ \\\n ||/settimeofday/ \\\n ||/clock_settime/ ) \\\n&amp;&amp;(/ key= *[!-~]* *$/||/ -k *[!-~]* *$/)'\nauditctl -l | awk '/^ *-w/ \\\n&amp;&amp;/\\/etc\\/localtime/ \\\n&amp;&amp;/ +-p *wa/ \\\n&amp;&amp;(/ key= *[!-~]* *$/||/ -k *[!-~]* *$/)'\n}\n</code></pre></p> <p>Verify the output includes: <pre><code>-a always,exit -F arch=b64 -S adjtimex,settimeofday,clock_settime -F key=time-change\n-a always,exit -F arch=b32 -S adjtimex,settimeofday,clock_settime -F key=time-change\n-w /etc/localtime -p wa -k time-change\n</code></pre></p> <p>32 Bit systems</p> <p>Follow the same procedures as for 64 bit systems and ignore any entries with b64.</p> <p>In addition, also audit for the stime system call rule. For example: <pre><code>-a always,exit -F arch=b32 -S adjtimex,settimeofday,clock_settime,stime -k time-change\n</code></pre></p>","tags":["Level 2","Workstation","Server","Logging and Auditing","Configure System Accounting (auditd)","Configure auditd rules","Automated","IG2","IG3","8.5 Collect Detailed Audit Logs","T1562","T1562.006","TA0005"]},{"location":"4-Logging-and-Auditing/4.1-Configure-System-Accounting-%28auditd%29/4.1.3-Configure-auditd-rules/4.1.3.4-Ensure-events-that-modify-date-and-time-information-are-collected/#remediation","title":"Remediation","text":"<p>Create audit rules</p> <p>Edit or create a file in the /etc/audit/rules.d/ directory, ending in .rules extension, with the relevant rules to monitor events that modify date and time information.</p> <p>64 Bit systems</p> <p>Example: <pre><code># printf \"\n-a always,exit -F arch=b64 -S adjtimex,settimeofday,clock_settime -k timechange\n-a always,exit -F arch=b32 -S adjtimex,settimeofday,clock_settime -k timechange\n-w /etc/localtime -p wa -k time-change\n\" &gt;&gt; /etc/audit/rules.d/50-time-change.rules\n</code></pre></p> <p>Load audit rules</p> <p>Merge and load the rules into active configuration: <pre><code># augenrules --load\n</code></pre></p> <p>Check if reboot is required. <pre><code># if [[ $(auditctl -s | grep \"enabled\") =~ \"2\" ]]; then printf \"Reboot required to load rules\\n\"; fi\n</code></pre></p> <p>32 Bit systems</p> <p>Follow the same procedures as for 64 bit systems and ignore any entries with b64. In addition, add stime to the system call audit. Example: <pre><code>-a always,exit -F arch=b32 -S adjtimex,settimeofday,clock_settime,stime -k time-change\n</code></pre></p>","tags":["Level 2","Workstation","Server","Logging and Auditing","Configure System Accounting (auditd)","Configure auditd rules","Automated","IG2","IG3","8.5 Collect Detailed Audit Logs","T1562","T1562.006","TA0005"]},{"location":"4-Logging-and-Auditing/4.1-Configure-System-Accounting-%28auditd%29/4.1.3-Configure-auditd-rules/4.1.3.5-Ensure-events-that-modify-the-system%27s-network-environment-are-collected/","title":"4.1.3.5 Ensure events that modify the system's network environment are collected","text":"","tags":["Level 2","Workstation","Server","Logging and Auditing","Configure System Accounting (auditd)","Configure auditd rules","Automated","IG2","IG3","8.5 Collect Detailed Audit Logs","T1562","T1562.006","TA0003","M1047"]},{"location":"4-Logging-and-Auditing/4.1-Configure-System-Accounting-%28auditd%29/4.1.3-Configure-auditd-rules/4.1.3.5-Ensure-events-that-modify-the-system%27s-network-environment-are-collected/#audit","title":"Audit","text":"<p>64 Bit systems</p> <p>On disk configuration</p> <p>Run the following commands to check the on disk rules: <pre><code># awk '/^ *-a *always,exit/ \\\n&amp;&amp;/ -F *arch=b(32|64)/ \\\n&amp;&amp;/ -S/ \\\n&amp;&amp;(/sethostname/ \\\n||/setdomainname/) \\\n&amp;&amp;(/ key= *[!-~]* *$/||/ -k *[!-~]* *$/)' /etc/audit/rules.d/*.rules\n# awk '/^ *-w/ \\\n&amp;&amp;(/\\/etc\\/issue/ \\\n||/\\/etc\\/issue.net/ \\\n||/\\/etc\\/hosts/ \\\n||/\\/etc\\/network/) \\\n&amp;&amp;/ +-p *wa/ \\\n&amp;&amp;(/ key= *[!-~]* *$/||/ -k *[!-~]* *$/)' /etc/audit/rules.d/*.rules\n</code></pre></p> <p>Verify the output matches: <pre><code>-a always,exit -F arch=b64 -S sethostname,setdomainname -k system-locale\n-a always,exit -F arch=b32 -S sethostname,setdomainname -k system-locale\n-w /etc/issue -p wa -k system-locale\n-w /etc/issue.net -p wa -k system-locale\n-w /etc/hosts -p wa -k system-locale\n-w /etc/networks -p wa -k system-locale\n-w /etc/network/ -p wa -k system-locale\n</code></pre></p> <p>Running configuration</p> <p>Run the following command to check loaded rules: <pre><code># auditctl -l | awk '/^ *-a *always,exit/ \\\n&amp;&amp;/ -F *arch=b(32|64)/ \\\n&amp;&amp;/ -S/ \\\n&amp;&amp;(/sethostname/ \\\n||/setdomainname/) \\\n&amp;&amp;(/ key= *[!-~]* *$/||/ -k *[!-~]* *$/)'\n# auditctl -l | awk '/^ *-w/ \\\n&amp;&amp;(/\\/etc\\/issue/ \\\n||/\\/etc\\/issue.net/ \\\n||/\\/etc\\/hosts/ \\\n||/\\/etc\\/network/) \\\n&amp;&amp;/ +-p *wa/ \\\n&amp;&amp;(/ key= *[!-~]* *$/||/ -k *[!-~]* *$/)'\n</code></pre></p> <p>Verify the output includes: <pre><code>-a always,exit -F arch=b64 -S sethostname,setdomainname -F key=system-locale\n-a always,exit -F arch=b32 -S sethostname,setdomainname -F key=system-locale\n-w /etc/issue -p wa -k system-locale\n-w /etc/issue.net -p wa -k system-locale\n-w /etc/hosts -p wa -k system-locale\n-w /etc/networks -p wa -k system-locale\n-w /etc/network/ -p wa -k system-locale\n</code></pre></p> <p>32 Bit systems</p> <p>Follow the same procedures as for 64 bit systems and ignore any entries with b64.</p>","tags":["Level 2","Workstation","Server","Logging and Auditing","Configure System Accounting (auditd)","Configure auditd rules","Automated","IG2","IG3","8.5 Collect Detailed Audit Logs","T1562","T1562.006","TA0003","M1047"]},{"location":"4-Logging-and-Auditing/4.1-Configure-System-Accounting-%28auditd%29/4.1.3-Configure-auditd-rules/4.1.3.5-Ensure-events-that-modify-the-system%27s-network-environment-are-collected/#remediation","title":"Remediation","text":"<p>Create audit rules</p> <p>Edit or create a file in the /etc/audit/rules.d/ directory, ending in .rules extension, with the relevant rules to monitor events that modify the system's network environment.</p> <p>64 Bit systems</p> <p>Example: <pre><code># printf \"\n-a always,exit -F arch=b64 -S sethostname,setdomainname -k system-locale\n-a always,exit -F arch=b32 -S sethostname,setdomainname -k system-locale\n-w /etc/issue -p wa -k system-locale\n-w /etc/issue.net -p wa -k system-locale\n-w /etc/hosts -p wa -k system-locale\n-w /etc/networks -p wa -k system-locale\n-w /etc/network/ -p wa -k system-locale\n\" &gt;&gt; /etc/audit/rules.d/50-system_local.rules\n</code></pre></p> <p>Load audit rules</p> <p>Merge and load the rules into active configuration: <pre><code># augenrules --load\n</code></pre></p> <p>Check if reboot is required. <pre><code># if [[ $(auditctl -s | grep \"enabled\") =~ \"2\" ]]; then printf \"Reboot required to load rules\\n\"; fi\n</code></pre></p> <p>32 Bit systems</p> <p>Follow the same procedures as for 64 bit systems and ignore any entries with b64.</p>","tags":["Level 2","Workstation","Server","Logging and Auditing","Configure System Accounting (auditd)","Configure auditd rules","Automated","IG2","IG3","8.5 Collect Detailed Audit Logs","T1562","T1562.006","TA0003","M1047"]},{"location":"4-Logging-and-Auditing/4.1-Configure-System-Accounting-%28auditd%29/4.1.3-Configure-auditd-rules/4.1.3.6-Ensure-use-of-privileged-commands-are-collected/","title":"4.1.3.6 Ensure use of privileged commands are collected","text":"","tags":["Level 2","Workstation","Server","Logging and Auditing","Configure System Accounting (auditd)","Configure auditd rules","Automated","IG2","IG3","8.5 Collect Detailed Audit Logs","T1562","T1562.006","TA0002","M1026"]},{"location":"4-Logging-and-Auditing/4.1-Configure-System-Accounting-%28auditd%29/4.1.3-Configure-auditd-rules/4.1.3.6-Ensure-use-of-privileged-commands-are-collected/#audit","title":"Audit","text":"<p>On disk configuration</p> <p>Run the following command to check on disk rules: <pre><code># for PARTITION in $(findmnt -n -l -k -it $(awk '/nodev/ { print $2 }' /proc/filesystems | paste -sd,) | grep -Pv \"noexec|nosuid\" | awk '{print $1}'); do\nfor PRIVILEGED in $(find \"${PARTITION}\" -xdev -perm /6000 -type f); do\ngrep -qr \"${PRIVILEGED}\" /etc/audit/rules.d &amp;&amp; printf \"OK: '${PRIVILEGED}' found in auditing rules.\\n\" || printf \"Warning: '${PRIVILEGED}' not found in on disk configuration.\\n\"\ndone\ndone\n</code></pre></p> <p>Verify that all output is OK.</p> <p>Running configuration</p> <p>Run the following command to check loaded rules: <pre><code># {\nRUNNING=$(auditctl -l)\n[ -n \"${RUNNING}\" ] &amp;&amp; for PARTITION in $(findmnt -n -l -k -it $(awk '/nodev/ { print $2 }' /proc/filesystems | paste -sd,) | grep -Pv \"noexec|nosuid\" | awk '{print $1}'); do\nfor PRIVILEGED in $(find \"${PARTITION}\" -xdev -perm /6000 -type f); do\nprintf -- \"${RUNNING}\" | grep -q \"${PRIVILEGED}\" &amp;&amp; printf \"OK: '${PRIVILEGED}' found in auditing rules.\\n\" || printf \"Warning: '${PRIVILEGED}' not found in running configuration.\\n\"\ndone\ndone \\\n|| printf \"ERROR: Variable 'RUNNING' is unset.\\n\"\n}\n</code></pre></p> <p>Verify that all output is OK.</p> <p>Special mount points</p> <p>If there are any special mount points that are not visible by default from findmnt as per the above audit, said file systems would have to be manually audited.</p>","tags":["Level 2","Workstation","Server","Logging and Auditing","Configure System Accounting (auditd)","Configure auditd rules","Automated","IG2","IG3","8.5 Collect Detailed Audit Logs","T1562","T1562.006","TA0002","M1026"]},{"location":"4-Logging-and-Auditing/4.1-Configure-System-Accounting-%28auditd%29/4.1.3-Configure-auditd-rules/4.1.3.6-Ensure-use-of-privileged-commands-are-collected/#remediation","title":"Remediation","text":"<p>Edit or create a file in the /etc/audit/rules.d/ directory, ending in .rules extension, with the relevant rules to monitor the use of privileged commands.</p> <p>Example: <pre><code># {\nUID_MIN=$(awk '/^\\s*UID_MIN/{print $2}' /etc/login.defs)\nAUDIT_RULE_FILE=\"/etc/audit/rules.d/50-privileged.rules\"\nNEW_DATA=()\nfor PARTITION in $(findmnt -n -l -k -it $(awk '/nodev/ { print $2 }' /proc/filesystems | paste -sd,) | grep -Pv \"noexec|nosuid\" | awk '{print $1}'); do\nreadarray -t DATA &lt; &lt;(find \"${PARTITION}\" -xdev -perm /6000 -type f | awk -v UID_MIN=${UID_MIN} '{print \"-a always,exit -F path=\" $1 \" -F perm=x -F auid&gt;=\"UID_MIN\" -F auid!=unset -k privileged\" }')\nfor ENTRY in \"${DATA[@]}\"; do\nNEW_DATA+=(\"${ENTRY}\")\ndone\ndone\nreadarray &amp;&gt; /dev/null -t OLD_DATA &lt; \"${AUDIT_RULE_FILE}\"\nCOMBINED_DATA=( \"${OLD_DATA[@]}\" \"${NEW_DATA[@]}\" )\nprintf '%s\\n' \"${COMBINED_DATA[@]}\" | sort -u &gt; \"${AUDIT_RULE_FILE}\"\n}\n</code></pre></p> <p>Merge and load the rules into active configuration: <pre><code># augenrules --load\n</code></pre></p> <p>Check if reboot is required. <pre><code># if [[ $(auditctl -s | grep \"enabled\") =~ \"2\" ]]; then printf \"Reboot required to load rules\\n\"; fi\n</code></pre></p> <p>Special mount points</p> <p>If there are any special mount points that are not visible by default from just scanning /, change the PARTITION variable to the appropriate partition and re-run the remediation.</p>","tags":["Level 2","Workstation","Server","Logging and Auditing","Configure System Accounting (auditd)","Configure auditd rules","Automated","IG2","IG3","8.5 Collect Detailed Audit Logs","T1562","T1562.006","TA0002","M1026"]},{"location":"4-Logging-and-Auditing/4.1-Configure-System-Accounting-%28auditd%29/4.1.3-Configure-auditd-rules/4.1.3.7-Ensure-unsuccessful-file-access-attempts-are-collected/","title":"4.1.3.7 Ensure unsuccessful file access attempts are collected","text":"","tags":["Level 2","Workstation","Server","Logging and Auditing","Configure System Accounting (auditd)","Configure auditd rules","Automated","IG2","IG3","8.5 Collect Detailed Audit Logs","T1562","T1562.006","TA0007"]},{"location":"4-Logging-and-Auditing/4.1-Configure-System-Accounting-%28auditd%29/4.1.3-Configure-auditd-rules/4.1.3.7-Ensure-unsuccessful-file-access-attempts-are-collected/#audit","title":"Audit","text":"<p>64 Bit systems</p> <p>On disk configuration</p> <p>Run the following command to check the on disk rules: <pre><code># {\nUID_MIN=$(awk '/^\\s*UID_MIN/{print $2}' /etc/login.defs)\n[ -n \"${UID_MIN}\" ] &amp;&amp; awk \"/^ *-a *always,exit/ \\\n&amp;&amp;/ -F *arch=b[2346]{2}/ \\\n&amp;&amp;(/ -F *auid!=unset/||/ -F *auid!=-1/||/ -F *auid!=4294967295/) \\\n&amp;&amp;/ -F *auid&gt;=${UID_MIN}/ \\\n&amp;&amp;(/ -F *exit=-EACCES/||/ -F *exit=-EPERM/) \\\n&amp;&amp;/ -S/ \\\n&amp;&amp;/creat/ \\\n&amp;&amp;/open/ \\\n&amp;&amp;/truncate/ \\\n&amp;&amp;(/ key= *[!-~]* *$/||/ -k *[!-~]* *$/)\" /etc/audit/rules.d/*.rules \\\n|| printf \"ERROR: Variable 'UID_MIN' is unset.\\n\"\n}\n</code></pre></p> <p>Verify the output includes: <pre><code>-a always,exit -F arch=b64 -S creat,open,openat,truncate,ftruncate -F exit=-EACCES -F auid&gt;=1000 -F auid!=unset -k access\n-a always,exit -F arch=b64 -S creat,open,openat,truncate,ftruncate -F exit=-EPERM -F auid&gt;=1000 -F auid!=unset -k access\n-a always,exit -F arch=b32 -S creat,open,openat,truncate,ftruncate -F exit=-EACCES -F auid&gt;=1000 -F auid!=unset -k access\n-a always,exit -F arch=b32 -S creat,open,openat,truncate,ftruncate -F exit=-EPERM -F auid&gt;=1000 -F auid!=unset -k access\n</code></pre></p> <p>Running configuration</p> <p>Run the following command to check loaded rules: <pre><code># {\nUID_MIN=$(awk '/^\\s*UID_MIN/{print $2}' /etc/login.defs)\n[ -n \"${UID_MIN}\" ] &amp;&amp; auditctl -l | awk \"/^ *-a *always,exit/ \\\n&amp;&amp;/ -F *arch=b[2346]{2}/ \\\n&amp;&amp;(/ -F *auid!=unset/||/ -F *auid!=-1/||/ -F *auid!=4294967295/) \\\n&amp;&amp;/ -F *auid&gt;=${UID_MIN}/ \\\n&amp;&amp;(/ -F *exit=-EACCES/||/ -F *exit=-EPERM/) \\\n&amp;&amp;/ -S/ \\\n&amp;&amp;/creat/ \\\n&amp;&amp;/open/ \\\n&amp;&amp;/truncate/ \\\n&amp;&amp;(/ key= *[!-~]* *$/||/ -k *[!-~]* *$/)\" \\\n|| printf \"ERROR: Variable 'UID_MIN' is unset.\\n\"\n}\n</code></pre></p> <p>Verify the output includes: <pre><code>-a always,exit -F arch=b64 -S open,truncate,ftruncate,creat,openat -F exit=-EACCES -F auid&gt;=1000 -F auid!=-1 -F key=access\n-a always,exit -F arch=b64 -S open,truncate,ftruncate,creat,openat -F exit=-EPERM -F auid&gt;=1000 -F auid!=-1 -F key=access\n-a always,exit -F arch=b32 -S open,truncate,ftruncate,creat,openat -F exit=-EACCES -F auid&gt;=1000 -F auid!=-1 -F key=access\n-a always,exit -F arch=b32 -S open,truncate,ftruncate,creat,openat -F exit=-EPERM -F auid&gt;=1000 -F auid!=-1 -F key=access\n</code></pre></p> <p>32 Bit systems</p> <p>Follow the same procedures as for 64 bit systems and ignore any entries with b64.</p>","tags":["Level 2","Workstation","Server","Logging and Auditing","Configure System Accounting (auditd)","Configure auditd rules","Automated","IG2","IG3","8.5 Collect Detailed Audit Logs","T1562","T1562.006","TA0007"]},{"location":"4-Logging-and-Auditing/4.1-Configure-System-Accounting-%28auditd%29/4.1.3-Configure-auditd-rules/4.1.3.7-Ensure-unsuccessful-file-access-attempts-are-collected/#remediation","title":"Remediation","text":"<p>Create audit rules</p> <p>Edit or create a file in the /etc/audit/rules.d/ directory, ending in .rules extension, with the relevant rules to monitor unsuccessful file access attempts.</p> <p>64 Bit systems</p> <p>Example: <pre><code># {\nUID_MIN=$(awk '/^\\s*UID_MIN/{print $2}' /etc/login.defs)\n[ -n \"${UID_MIN}\" ] &amp;&amp; printf \"\n-a always,exit -F arch=b64 -S creat,open,openat,truncate,ftruncate -F exit=-EACCES -F auid&gt;=${UID_MIN} -F auid!=unset -k access\n-a always,exit -F arch=b64 -S creat,open,openat,truncate,ftruncate -F exit=-EPERM -F auid&gt;=${UID_MIN} -F auid!=unset -k access\n-a always,exit -F arch=b32 -S creat,open,openat,truncate,ftruncate -F exit=-EACCES -F auid&gt;=${UID_MIN} -F auid!=unset -k access\n-a always,exit -F arch=b32 -S creat,open,openat,truncate,ftruncate -F exit=-EPERM -F auid&gt;=${UID_MIN} -F auid!=unset -k access\n\" &gt;&gt; /etc/audit/rules.d/50-access.rules || printf \"ERROR: Variable 'UID_MIN' is unset.\\n\"\n}\n</code></pre></p> <p>Load audit rules</p> <p>Merge and load the rules into active configuration: <pre><code># augenrules --load\n</code></pre></p> <p>Check if reboot is required. <pre><code># if [[ $(auditctl -s | grep \"enabled\") =~ \"2\" ]]; then printf \"Reboot required to load rules\\n\"; fi\n</code></pre></p> <p>32 Bit systems</p> <p>Follow the same procedures as for 64 bit systems and ignore any entries with b64.</p>","tags":["Level 2","Workstation","Server","Logging and Auditing","Configure System Accounting (auditd)","Configure auditd rules","Automated","IG2","IG3","8.5 Collect Detailed Audit Logs","T1562","T1562.006","TA0007"]},{"location":"4-Logging-and-Auditing/4.1-Configure-System-Accounting-%28auditd%29/4.1.3-Configure-auditd-rules/4.1.3.8-Ensure-events-that-modify-user-group-information-are-collected/","title":"4.1.3.8 Ensure events that modify user/group information are collected","text":"","tags":["Level 2","Workstation","Server","Logging and Auditing","Configure System Accounting (auditd)","Configure auditd rules","Automated","IG2","IG3","8.5 Collect Detailed Audit Logs","T1562","T1562.006","TA0004","M1047"]},{"location":"4-Logging-and-Auditing/4.1-Configure-System-Accounting-%28auditd%29/4.1.3-Configure-auditd-rules/4.1.3.8-Ensure-events-that-modify-user-group-information-are-collected/#audit","title":"Audit","text":"<p>On disk configuration</p> <p>Run the following command to check the on disk rules: <pre><code># awk '/^ *-w/ \\\n&amp;&amp;(/\\/etc\\/group/ \\\n||/\\/etc\\/passwd/ \\\n||/\\/etc\\/gshadow/ \\\n||/\\/etc\\/shadow/ \\\n||/\\/etc\\/security\\/opasswd/) \\\n&amp;&amp;/ +-p *wa/ \\\n&amp;&amp;(/ key= *[!-~]* *$/||/ -k *[!-~]* *$/)' /etc/audit/rules.d/*.rules\n</code></pre></p> <p>Verify the output matches: <pre><code>-w /etc/group -p wa -k identity\n-w /etc/passwd -p wa -k identity\n-w /etc/gshadow -p wa -k identity\n-w /etc/shadow -p wa -k identity\n-w /etc/security/opasswd -p wa -k identity\n</code></pre></p> <p>Running configuration</p> <p>Run the following command to check loaded rules: <pre><code># auditctl -l | awk '/^ *-w/ \\\n&amp;&amp;(/\\/etc\\/group/ \\\n||/\\/etc\\/passwd/ \\\n||/\\/etc\\/gshadow/ \\\n||/\\/etc\\/shadow/ \\\n||/\\/etc\\/security\\/opasswd/) \\\n&amp;&amp;/ +-p *wa/ \\\n&amp;&amp;(/ key= *[!-~]* *$/||/ -k *[!-~]* *$/)'\n</code></pre></p> <p>Verify the output matches: <pre><code>-w /etc/group -p wa -k identity\n-w /etc/passwd -p wa -k identity\n-w /etc/gshadow -p wa -k identity\n-w /etc/shadow -p wa -k identity\n-w /etc/security/opasswd -p wa -k identity\n</code></pre></p>","tags":["Level 2","Workstation","Server","Logging and Auditing","Configure System Accounting (auditd)","Configure auditd rules","Automated","IG2","IG3","8.5 Collect Detailed Audit Logs","T1562","T1562.006","TA0004","M1047"]},{"location":"4-Logging-and-Auditing/4.1-Configure-System-Accounting-%28auditd%29/4.1.3-Configure-auditd-rules/4.1.3.8-Ensure-events-that-modify-user-group-information-are-collected/#remediation","title":"Remediation","text":"<p>Edit or create a file in the /etc/audit/rules.d/ directory, ending in .rules extension, with the relevant rules to monitor events that modify user/group information.</p> <p>Example: <pre><code># printf \"\n-w /etc/group -p wa -k identity\n-w /etc/passwd -p wa -k identity\n-w /etc/gshadow -p wa -k identity\n-w /etc/shadow -p wa -k identity\n-w /etc/security/opasswd -p wa -k identity\n\" &gt;&gt; /etc/audit/rules.d/50-identity.rules\n</code></pre></p> <p>Merge and load the rules into active configuration: <pre><code># augenrules --load\n</code></pre></p> <p>Check if reboot is required. <pre><code># if [[ $(auditctl -s | grep \"enabled\") =~ \"2\" ]]; then printf \"Reboot required to load rules\\n\"; fi\n</code></pre></p>","tags":["Level 2","Workstation","Server","Logging and Auditing","Configure System Accounting (auditd)","Configure auditd rules","Automated","IG2","IG3","8.5 Collect Detailed Audit Logs","T1562","T1562.006","TA0004","M1047"]},{"location":"4-Logging-and-Auditing/4.1-Configure-System-Accounting-%28auditd%29/4.1.3-Configure-auditd-rules/4.1.3.9-Ensure-discretionary-access-control-permission-modification-events-are-collected/","title":"4.1.3.9 Ensure discretionary access control permission modification events are collected","text":"","tags":["Level 2","Workstation","Server","Logging and Auditing","Configure System Accounting (auditd)","Configure auditd rules","Automated","IG2","IG3","8.5 Collect Detailed Audit Logs","T1562","T1562.006","TA0005","M1022"]},{"location":"4-Logging-and-Auditing/4.1-Configure-System-Accounting-%28auditd%29/4.1.3-Configure-auditd-rules/4.1.3.9-Ensure-discretionary-access-control-permission-modification-events-are-collected/#audit","title":"Audit","text":"<p>64 Bit systems</p> <p>On disk configuration</p> <p>Run the following command to check the on disk rules: <pre><code># {\nUID_MIN=$(awk '/^\\s*UID_MIN/{print $2}' /etc/login.defs)\n[ -n \"${UID_MIN}\" ] &amp;&amp; awk \"/^ *-a *always,exit/ \\\n&amp;&amp;/ -F *arch=b[2346]{2}/ \\\n&amp;&amp;(/ -F *auid!=unset/||/ -F *auid!=-1/||/ -F *auid!=4294967295/) \\\n&amp;&amp;/ -S/ \\\n&amp;&amp;/ -F *auid&gt;=${UID_MIN}/ \\\n&amp;&amp;(/chmod/||/fchmod/||/fchmodat/ \\\n ||/chown/||/fchown/||/fchownat/||/lchown/ \\\n ||/setxattr/||/lsetxattr/||/fsetxattr/ \\\n ||/removexattr/||/lremovexattr/||/fremovexattr/) \\\n&amp;&amp;(/ key= *[!-~]* *$/||/ -k *[!-~]* *$/)\" /etc/audit/rules.d/*.rules \\\n|| printf \"ERROR: Variable 'UID_MIN' is unset.\\n\"\n}\n</code></pre></p> <p>Verify the output matches: <pre><code>-a always,exit -F arch=b64 -S chmod,fchmod,fchmodat -F auid&gt;=1000 -F auid!=unset -F key=perm_mod\n-a always,exit -F arch=b64 -S chown,fchown,lchown,fchownat -F auid&gt;=1000 -F auid!=unset -F key=perm_mod\n-a always,exit -F arch=b32 -S chmod,fchmod,fchmodat -F auid&gt;=1000 -F auid!=unset -F key=perm_mod\n-a always,exit -F arch=b32 -S lchown,fchown,chown,fchownat -F auid&gt;=1000 -F auid!=unset -F key=perm_mod\n-a always,exit -F arch=b64 -S\nsetxattr,lsetxattr,fsetxattr,removexattr,lremovexattr,fremovexattr -F auid&gt;=1000 -F auid!=unset -F key=perm_mod\n-a always,exit -F arch=b32 -S setxattr,lsetxattr,fsetxattr,removexattr,lremovexattr,fremovexattr -F auid&gt;=1000 -F auid!=unset -F key=perm_mod\n</code></pre></p> <p>Running configuration</p> <p>Run the following command to check loaded rules: <pre><code># {\nUID_MIN=$(awk '/^\\s*UID_MIN/{print $2}' /etc/login.defs)\n[ -n \"${UID_MIN}\" ] &amp;&amp; auditctl -l | awk \"/^ *-a *always,exit/ \\\n&amp;&amp;/ -F *arch=b[2346]{2}/ \\\n&amp;&amp;(/ -F *auid!=unset/||/ -F *auid!=-1/||/ -F *auid!=4294967295/) \\\n&amp;&amp;/ -S/ \\\n&amp;&amp;/ -F *auid&gt;=${UID_MIN}/ \\\n&amp;&amp;(/chmod/||/fchmod/||/fchmodat/ \\\n ||/chown/||/fchown/||/fchownat/||/lchown/ \\\n ||/setxattr/||/lsetxattr/||/fsetxattr/ \\\n ||/removexattr/||/lremovexattr/||/fremovexattr/) \\\n&amp;&amp;(/ key= *[!-~]* *$/||/ -k *[!-~]* *$/)\" \\\n|| printf \"ERROR: Variable 'UID_MIN' is unset.\\n\"\n}\n</code></pre></p> <p>Verify the output matches: <pre><code>-a always,exit -F arch=b64 -S chmod,fchmod,fchmodat -F auid&gt;=1000 -F auid!=-1 -F key=perm_mod\n-a always,exit -F arch=b64 -S chown,fchown,lchown,fchownat -F auid&gt;=1000 -F auid!=-1 -F key=perm_mod\n-a always,exit -F arch=b32 -S chmod,fchmod,fchmodat -F auid&gt;=1000 -F auid!=-1 -F key=perm_mod\n-a always,exit -F arch=b32 -S lchown,fchown,chown,fchownat -F auid&gt;=1000 -F auid!=-1 -F key=perm_mod\n-a always,exit -F arch=b64 -S\nsetxattr,lsetxattr,fsetxattr,removexattr,lremovexattr,fremovexattr -F auid&gt;=1000 -F auid!=-1 -F key=perm_mod\n-a always,exit -F arch=b32 -S\nsetxattr,lsetxattr,fsetxattr,removexattr,lremovexattr,fremovexattr -F auid&gt;=1000 -F auid!=-1 -F key=perm_mod\n</code></pre></p> <p>32 Bit systems</p> <p>Follow the same procedures as for 64 bit systems and ignore any entries with b64.</p>","tags":["Level 2","Workstation","Server","Logging and Auditing","Configure System Accounting (auditd)","Configure auditd rules","Automated","IG2","IG3","8.5 Collect Detailed Audit Logs","T1562","T1562.006","TA0005","M1022"]},{"location":"4-Logging-and-Auditing/4.1-Configure-System-Accounting-%28auditd%29/4.1.3-Configure-auditd-rules/4.1.3.9-Ensure-discretionary-access-control-permission-modification-events-are-collected/#remediation","title":"Remediation","text":"<p>Create audit rules</p> <p>Edit or create a file in the /etc/audit/rules.d/ directory, ending in .rules extension, with the relevant rules to monitor discretionary access control permission modification events.</p> <p>64 Bit systems</p> <p>Example: <pre><code># {\nUID_MIN=$(awk '/^\\s*UID_MIN/{print $2}' /etc/login.defs)\n[ -n \"${UID_MIN}\" ] &amp;&amp; printf \"\n-a always,exit -F arch=b64 -S chmod,fchmod,fchmodat -F auid&gt;=${UID_MIN} -F\nauid!=unset -F key=perm_mod\n-a always,exit -F arch=b64 -S chown,fchown,lchown,fchownat -F\nauid&gt;=${UID_MIN} -F auid!=unset -F key=perm_mod\n-a always,exit -F arch=b32 -S chmod,fchmod,fchmodat -F auid&gt;=${UID_MIN} -F\nauid!=unset -F key=perm_mod\n-a always,exit -F arch=b32 -S lchown,fchown,chown,fchownat -F\nauid&gt;=${UID_MIN} -F auid!=unset -F key=perm_mod\n-a always,exit -F arch=b64 -S\nsetxattr,lsetxattr,fsetxattr,removexattr,lremovexattr,fremovexattr -F\nauid&gt;=${UID_MIN} -F auid!=unset -F key=perm_mod\n-a always,exit -F arch=b32 -S\nsetxattr,lsetxattr,fsetxattr,removexattr,lremovexattr,fremovexattr -F\nauid&gt;=${UID_MIN} -F auid!=unset -F key=perm_mod\n\" &gt;&gt; /etc/audit/rules.d/50-perm_mod.rules || printf \"ERROR: Variable 'UID_MIN' is unset.\\n\"\n}\n</code></pre></p> <p>Load audit rules</p> <p>Merge and load the rules into active configuration: <pre><code># augenrules --load\n</code></pre></p> <p>Check if reboot is required. <pre><code># if [[ $(auditctl -s | grep \"enabled\") =~ \"2\" ]]; then printf \"Reboot required to load rules\\n\"; fi\n</code></pre></p> <p>32 Bit systems</p> <p>Follow the same procedures as for 64 bit systems and ignore any entries with b64.</p>","tags":["Level 2","Workstation","Server","Logging and Auditing","Configure System Accounting (auditd)","Configure auditd rules","Automated","IG2","IG3","8.5 Collect Detailed Audit Logs","T1562","T1562.006","TA0005","M1022"]},{"location":"4-Logging-and-Auditing/4.1-Configure-System-Accounting-%28auditd%29/4.1.4-Configure-auditd-file-access/4.1.4.1-Ensure-audit-log-files-are-mode-0640-or-less-permissive/","title":"4.1.4.1 Ensure audit log files are mode 0640 or less permissive","text":"","tags":["Level 2","Workstation","Server","Logging and Auditing","Configure System Accounting (auditd)","Configure auditd file access","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1070","T1070.002","T1083","TA0007"]},{"location":"4-Logging-and-Auditing/4.1-Configure-System-Accounting-%28auditd%29/4.1.4-Configure-auditd-file-access/4.1.4.1-Ensure-audit-log-files-are-mode-0640-or-less-permissive/#audit","title":"Audit","text":"<p>Run the following command to verify audit log files have mode 0640 or less permissive: <pre><code># [ -f /etc/audit/auditd.conf ] &amp;&amp; find \"$(dirname $(awk -F \"=\" '/^\\s*log_file/ {print $2}' /etc/audit/auditd.conf | xargs))\" -type f \\( ! -perm 600 -a ! -perm 0400 -a ! -perm 0200 -a ! -perm 0000 -a ! -perm 0640 -a ! -perm 0440 -a ! -perm 0040 \\) -exec stat -Lc \"%n %#a\" {} +\n</code></pre></p> <p>Nothing should be returned</p>","tags":["Level 2","Workstation","Server","Logging and Auditing","Configure System Accounting (auditd)","Configure auditd file access","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1070","T1070.002","T1083","TA0007"]},{"location":"4-Logging-and-Auditing/4.1-Configure-System-Accounting-%28auditd%29/4.1.4-Configure-auditd-file-access/4.1.4.1-Ensure-audit-log-files-are-mode-0640-or-less-permissive/#remediation","title":"Remediation","text":"<p>Run the following command to remove more permissive mode than 0640 from audit log files: <pre><code># [ -f /etc/audit/auditd.conf ] &amp;&amp; find \"$(dirname $(awk -F \"=\" '/^\\s*log_file/ {print $2}' /etc/audit/auditd.conf | xargs))\" -type f \\( ! -perm 600 -a ! -perm 0400 -a ! -perm 0200 -a ! -perm 0000 -a ! -perm 0640 -a ! -perm 0440 -a ! -perm 0040 \\) -exec chmod u-x,g-wx,o-rwx {} +\n</code></pre></p>","tags":["Level 2","Workstation","Server","Logging and Auditing","Configure System Accounting (auditd)","Configure auditd file access","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1070","T1070.002","T1083","TA0007"]},{"location":"4-Logging-and-Auditing/4.1-Configure-System-Accounting-%28auditd%29/4.1.4-Configure-auditd-file-access/4.1.4.10-Ensure-audit-tools-belong-to-group-root/","title":"4.1.4.10 Ensure audit tools belong to group root","text":"","tags":["Level 2","Workstation","Server","Logging and Auditing","Configure System Accounting (auditd)","Configure auditd file access","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1070","T1070.002","T1083","TA0007"]},{"location":"4-Logging-and-Auditing/4.1-Configure-System-Accounting-%28auditd%29/4.1.4-Configure-auditd-file-access/4.1.4.10-Ensure-audit-tools-belong-to-group-root/#audit","title":"Audit","text":"<p>Run the following command to verify the audit tools have mode 755 or more restrictive, are owned by the root user and group root: <pre><code># stat -c \"%n %a %U %G\" /sbin/auditctl /sbin/aureport /sbin/ausearch /sbin/autrace /sbin/auditd /sbin/augenrules | grep -Pv -- '^\\h*\\H+\\h+([0-7][0,1,4,5][0,1,4,5])\\h+root\\h+root\\h*$'\n</code></pre></p> <p>Nothing should be returned</p>","tags":["Level 2","Workstation","Server","Logging and Auditing","Configure System Accounting (auditd)","Configure auditd file access","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1070","T1070.002","T1083","TA0007"]},{"location":"4-Logging-and-Auditing/4.1-Configure-System-Accounting-%28auditd%29/4.1.4-Configure-auditd-file-access/4.1.4.10-Ensure-audit-tools-belong-to-group-root/#remediation","title":"Remediation","text":"<p>Run the following command to remove more permissive mode from the audit tools: <pre><code># chmod go-w /sbin/auditctl /sbin/aureport /sbin/ausearch /sbin/autrace /sbin/auditd /sbin/augenrules\n</code></pre></p> <p>Run the following command to change owner and group of the audit tools to root user and group: <pre><code># chown root:root /sbin/auditctl /sbin/aureport /sbin/ausearch /sbin/autrace /sbin/auditd /sbin/augenrules\n</code></pre></p>","tags":["Level 2","Workstation","Server","Logging and Auditing","Configure System Accounting (auditd)","Configure auditd file access","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1070","T1070.002","T1083","TA0007"]},{"location":"4-Logging-and-Auditing/4.1-Configure-System-Accounting-%28auditd%29/4.1.4-Configure-auditd-file-access/4.1.4.11-Ensure-cryptographic-mechanisms-are-used-to-protect-the-integrity-of-audit-tools/","title":"4.1.4.11 Ensure cryptographic mechanisms are used to protect the integrity of audit tool","text":"","tags":["Level 1","Workstation","Server","Logging and Auditing","Configure System Accounting (auditd)","Configure auditd file access","Automated","IG1","IG2","IG3","4.1 Establish and Maintain a Secure Configuration Process","T1070","T1070.002","T1083","TA0007"]},{"location":"4-Logging-and-Auditing/4.1-Configure-System-Accounting-%28auditd%29/4.1.4-Configure-auditd-file-access/4.1.4.11-Ensure-cryptographic-mechanisms-are-used-to-protect-the-integrity-of-audit-tools/#audit","title":"Audit","text":"<p>Verify that Advanced Intrusion Detection Environment (AIDE) is properly configured.</p> <p>Run the following command to verify that AIDE is configured to use cryptographic mechanisms to protect the integrity of audit tools: <pre><code># grep -Ps -- '(\\/sbin\\/(audit|au)\\H*\\b)' /etc/aide/aide.conf.d/*.conf /etc/aide/aide.conf\n</code></pre></p> <p>Verify the output includes: <pre><code>/sbin/auditctl p+i+n+u+g+s+b+acl+xattrs+sha512\n/sbin/auditd p+i+n+u+g+s+b+acl+xattrs+sha512\n/sbin/ausearch p+i+n+u+g+s+b+acl+xattrs+sha512\n/sbin/aureport p+i+n+u+g+s+b+acl+xattrs+sha512\n/sbin/autrace p+i+n+u+g+s+b+acl+xattrs+sha512\n/sbin/augenrules p+i+n+u+g+s+b+acl+xattrs+sha512\n</code></pre></p>","tags":["Level 1","Workstation","Server","Logging and Auditing","Configure System Accounting (auditd)","Configure auditd file access","Automated","IG1","IG2","IG3","4.1 Establish and Maintain a Secure Configuration Process","T1070","T1070.002","T1083","TA0007"]},{"location":"4-Logging-and-Auditing/4.1-Configure-System-Accounting-%28auditd%29/4.1.4-Configure-auditd-file-access/4.1.4.11-Ensure-cryptographic-mechanisms-are-used-to-protect-the-integrity-of-audit-tools/#remediation","title":"Remediation","text":"<p>Add or update the following selection lines for to a file ending in .conf in the /etc/aide/aide.conf.d/ or to /etc/aide/aide.conf to protect the integrity of the audit tools: <pre><code># Audit Tools\n/sbin/auditctl p+i+n+u+g+s+b+acl+xattrs+sha512\n/sbin/auditd p+i+n+u+g+s+b+acl+xattrs+sha512\n/sbin/ausearch p+i+n+u+g+s+b+acl+xattrs+sha512\n/sbin/aureport p+i+n+u+g+s+b+acl+xattrs+sha512\n/sbin/autrace p+i+n+u+g+s+b+acl+xattrs+sha512\n/sbin/augenrules p+i+n+u+g+s+b+acl+xattrs+sha512\n</code></pre></p>","tags":["Level 1","Workstation","Server","Logging and Auditing","Configure System Accounting (auditd)","Configure auditd file access","Automated","IG1","IG2","IG3","4.1 Establish and Maintain a Secure Configuration Process","T1070","T1070.002","T1083","TA0007"]},{"location":"4-Logging-and-Auditing/4.1-Configure-System-Accounting-%28auditd%29/4.1.4-Configure-auditd-file-access/4.1.4.2-Ensure-only-authorized-users-own-audit-log-files/","title":"4.1.4.2 Ensure only authorized users own audit log files","text":"","tags":["Level 2","Workstation","Server","Logging and Auditing","Configure System Accounting (auditd)","Configure auditd file access","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1070","T1070.002","T1083","TA0007"]},{"location":"4-Logging-and-Auditing/4.1-Configure-System-Accounting-%28auditd%29/4.1.4-Configure-auditd-file-access/4.1.4.2-Ensure-only-authorized-users-own-audit-log-files/#audit","title":"Audit","text":"<p>Run the following command to verify audit log files are owned by the root user: <pre><code># [ -f /etc/audit/auditd.conf ] &amp;&amp; find \"$(dirname $(awk -F \"=\" '/^\\s*log_file/ {print $2}' /etc/audit/auditd.conf | xargs))\" -type f ! -user root -exec stat -Lc \"%n %U\" {} +\n</code></pre></p> <p>Nothing should be returned</p>","tags":["Level 2","Workstation","Server","Logging and Auditing","Configure System Accounting (auditd)","Configure auditd file access","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1070","T1070.002","T1083","TA0007"]},{"location":"4-Logging-and-Auditing/4.1-Configure-System-Accounting-%28auditd%29/4.1.4-Configure-auditd-file-access/4.1.4.2-Ensure-only-authorized-users-own-audit-log-files/#remediation","title":"Remediation","text":"<p>Run the following command to configure the audit log files to be owned by the root user: <pre><code># [ -f /etc/audit/auditd.conf ] &amp;&amp; find \"$(dirname $(awk -F \"=\" '/^\\s*log_file/ {print $2}' /etc/audit/auditd.conf | xargs))\" -type f ! -user root -exec chown root {} +\n</code></pre></p>","tags":["Level 2","Workstation","Server","Logging and Auditing","Configure System Accounting (auditd)","Configure auditd file access","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1070","T1070.002","T1083","TA0007"]},{"location":"4-Logging-and-Auditing/4.1-Configure-System-Accounting-%28auditd%29/4.1.4-Configure-auditd-file-access/4.1.4.3-Ensure-only-authorized-groups-are-assigned-ownership-of-audit-log-files/","title":"4.1.4.3 Ensure only authorized groups are assigned ownership of audit log files","text":"","tags":["Level 2","Workstation","Server","Logging and Auditing","Configure System Accounting (auditd)","Configure auditd file access","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1070","T1070.002","T1083","TA0007"]},{"location":"4-Logging-and-Auditing/4.1-Configure-System-Accounting-%28auditd%29/4.1.4-Configure-auditd-file-access/4.1.4.3-Ensure-only-authorized-groups-are-assigned-ownership-of-audit-log-files/#audit","title":"Audit","text":"<p>Run the following command to verify log_group parameter is set to either adm or root in /etc/audit/auditd.conf: <pre><code># grep -Piw -- '^\\h*log_group\\h*=\\h*(adm|root)\\b' /etc/audit/auditd.conf\n</code></pre></p> <p>Verify the output is: <pre><code>log_group = adm\n\n-OR\n\nlog_group = root\n</code></pre></p> <p>Using the path of the directory containing the audit logs, determine if the audit log files are owned by the \"root\" or \"adm\" group by using the following command: <pre><code># stat -c \"%n %G\" \"$(dirname $(awk -F\"=\" '/^\\s*log_file\\s*=\\s*/ {print $2}' /etc/audit/auditd.conf | xargs))\"/* | grep -Pv '^\\h*\\H+\\h+(adm|root)\\b'\n</code></pre></p> <p>Nothing should be returned</p>","tags":["Level 2","Workstation","Server","Logging and Auditing","Configure System Accounting (auditd)","Configure auditd file access","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1070","T1070.002","T1083","TA0007"]},{"location":"4-Logging-and-Auditing/4.1-Configure-System-Accounting-%28auditd%29/4.1.4-Configure-auditd-file-access/4.1.4.3-Ensure-only-authorized-groups-are-assigned-ownership-of-audit-log-files/#remediation","title":"Remediation","text":"<p>Run the following command to configure the audit log files to be owned by adm group: <pre><code># find $(dirname $(awk -F\"=\" '/^\\s*log_file/ {print $2}' /etc/audit/auditd.conf | xargs)) -type f \\( ! -group adm -a ! -group root \\) -exec chgrp adm {} +\n</code></pre></p> <p>Run the following command to configure the audit log files to be owned by the adm group: <pre><code># chgrp adm /var/log/audit/\n</code></pre></p> <p>Run the following command to set the log_group parameter in the audit configuration file to log_group = adm: <pre><code># sed -ri 's/^\\s*#?\\s*log_group\\s*=\\s*\\S+(\\s*#.*)?.*$/log_group = adm\\1/' /etc/audit/auditd.conf\n</code></pre></p> <p>Run the following command to restart the audit daemon to reload the configuration file: <pre><code># systemctl restart auditd\n</code></pre></p>","tags":["Level 2","Workstation","Server","Logging and Auditing","Configure System Accounting (auditd)","Configure auditd file access","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1070","T1070.002","T1083","TA0007"]},{"location":"4-Logging-and-Auditing/4.1-Configure-System-Accounting-%28auditd%29/4.1.4-Configure-auditd-file-access/4.1.4.4-Ensure-the-audit-log-directory-is-0750-or-more-restrictive/","title":"4.1.4.4 Ensure the audit log directory is 0750 or more restrictive","text":"","tags":["Level 2","Workstation","Server","Logging and Auditing","Configure System Accounting (auditd)","Configure auditd file access","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1070","T1070.002","T1083","TA0007"]},{"location":"4-Logging-and-Auditing/4.1-Configure-System-Accounting-%28auditd%29/4.1.4-Configure-auditd-file-access/4.1.4.4-Ensure-the-audit-log-directory-is-0750-or-more-restrictive/#audit","title":"Audit","text":"<p>Run the following command to verify that the audit log directory has a mode of 0750 or less permissive: <pre><code># stat -Lc \"%n %a\" \"$(dirname $( awk -F\"=\" '/^\\s*log_file/ {print $2}' /etc/audit/auditd.conf))\" | grep -Pv -- '^\\h*\\H+\\h+([0,5,7][0,5]0)'\n</code></pre></p> <p>Nothing should be returned</p>","tags":["Level 2","Workstation","Server","Logging and Auditing","Configure System Accounting (auditd)","Configure auditd file access","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1070","T1070.002","T1083","TA0007"]},{"location":"4-Logging-and-Auditing/4.1-Configure-System-Accounting-%28auditd%29/4.1.4-Configure-auditd-file-access/4.1.4.4-Ensure-the-audit-log-directory-is-0750-or-more-restrictive/#remediation","title":"Remediation","text":"<p>Run the following command to configure the audit log directory to have a mode of \"0750\" or less permissive: <pre><code># chmod g-w,o-rwx \"$(dirname $(awk -F\"=\" '/^\\s*log_file/ {print $2}' /etc/audit/auditd.conf))\"\n</code></pre></p> <p>Default Value:</p> <p>750</p>","tags":["Level 2","Workstation","Server","Logging and Auditing","Configure System Accounting (auditd)","Configure auditd file access","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1070","T1070.002","T1083","TA0007"]},{"location":"4-Logging-and-Auditing/4.1-Configure-System-Accounting-%28auditd%29/4.1.4-Configure-auditd-file-access/4.1.4.5-Ensure-audit-configuration-files-are-640-or-more-restrictive/","title":"4.1.4.5 Ensure audit configuration files are 640 or more restrictive","text":"","tags":["Level 2","Workstation","Server","Logging and Auditing","Configure System Accounting (auditd)","Configure auditd file access","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1070","T1070.002","T1083","TA0007"]},{"location":"4-Logging-and-Auditing/4.1-Configure-System-Accounting-%28auditd%29/4.1.4-Configure-auditd-file-access/4.1.4.5-Ensure-audit-configuration-files-are-640-or-more-restrictive/#audit","title":"Audit","text":"<p>Run the following command to verify that the audit configuration files have mode 640 or more restrictive and are owned by the root user and root group: <pre><code># find /etc/audit/ -type f \\( -name '*.conf' -o -name '*.rules' \\) -exec stat -Lc \"%n %a\" {} + | grep -Pv -- '^\\h*\\H+\\h*([0,2,4,6][0,4]0)\\h*$'\n</code></pre></p> <p>Nothing should be returned</p>","tags":["Level 2","Workstation","Server","Logging and Auditing","Configure System Accounting (auditd)","Configure auditd file access","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1070","T1070.002","T1083","TA0007"]},{"location":"4-Logging-and-Auditing/4.1-Configure-System-Accounting-%28auditd%29/4.1.4-Configure-auditd-file-access/4.1.4.5-Ensure-audit-configuration-files-are-640-or-more-restrictive/#remediation","title":"Remediation","text":"<p>Run the following command to remove more permissive mode than 0640 from the audit configuration files: <pre><code># find /etc/audit/ -type f \\( -name '*.conf' -o -name '*.rules' \\) -exec chmod u-x,g-wx,o-rwx {} +\n</code></pre></p>","tags":["Level 2","Workstation","Server","Logging and Auditing","Configure System Accounting (auditd)","Configure auditd file access","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1070","T1070.002","T1083","TA0007"]},{"location":"4-Logging-and-Auditing/4.1-Configure-System-Accounting-%28auditd%29/4.1.4-Configure-auditd-file-access/4.1.4.6-Ensure-audit-configuration-files-are-owned-by-root/","title":"4.1.4.6 Ensure audit configuration files are owned by root","text":"","tags":["Level 2","Workstation","Server","Logging and Auditing","Configure System Accounting (auditd)","Configure auditd file access","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1070","T1070.002","T1083","TA0007"]},{"location":"4-Logging-and-Auditing/4.1-Configure-System-Accounting-%28auditd%29/4.1.4-Configure-auditd-file-access/4.1.4.6-Ensure-audit-configuration-files-are-owned-by-root/#audit","title":"Audit","text":"<p>Run the following command to verify that the audit configuration files have mode 640 or more restrictive and are owned by the root user and root group: <pre><code># find /etc/audit/ -type f \\( -name '*.conf' -o -name '*.rules' \\) ! -user root\n</code></pre></p> <p>Nothing should be returned</p>","tags":["Level 2","Workstation","Server","Logging and Auditing","Configure System Accounting (auditd)","Configure auditd file access","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1070","T1070.002","T1083","TA0007"]},{"location":"4-Logging-and-Auditing/4.1-Configure-System-Accounting-%28auditd%29/4.1.4-Configure-auditd-file-access/4.1.4.6-Ensure-audit-configuration-files-are-owned-by-root/#remediation","title":"Remediation","text":"<p>Run the following command to change ownership to root user: <pre><code># find /etc/audit/ -type f \\( -name '*.conf' -o -name '*.rules' \\) ! -user root -exec chown root {} +\n</code></pre></p>","tags":["Level 2","Workstation","Server","Logging and Auditing","Configure System Accounting (auditd)","Configure auditd file access","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1070","T1070.002","T1083","TA0007"]},{"location":"4-Logging-and-Auditing/4.1-Configure-System-Accounting-%28auditd%29/4.1.4-Configure-auditd-file-access/4.1.4.7-Ensure-audit-configuration-files-belong-to-group-root/","title":"4.1.4.7 Ensure audit configuration files belong to group root","text":"","tags":["Level 2","Workstation","Server","Logging and Auditing","Configure System Accounting (auditd)","Configure auditd file access","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1070","T1070.002","T1083","TA0007"]},{"location":"4-Logging-and-Auditing/4.1-Configure-System-Accounting-%28auditd%29/4.1.4-Configure-auditd-file-access/4.1.4.7-Ensure-audit-configuration-files-belong-to-group-root/#audit","title":"Audit","text":"<p>Run the following command to verify that the audit configuration files have mode 640 or more restrictive and are owned by the root user and root group: <pre><code># find /etc/audit/ -type f \\( -name '*.conf' -o -name '*.rules' \\) ! -group root\n</code></pre> Nothing should be returned</p>","tags":["Level 2","Workstation","Server","Logging and Auditing","Configure System Accounting (auditd)","Configure auditd file access","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1070","T1070.002","T1083","TA0007"]},{"location":"4-Logging-and-Auditing/4.1-Configure-System-Accounting-%28auditd%29/4.1.4-Configure-auditd-file-access/4.1.4.7-Ensure-audit-configuration-files-belong-to-group-root/#remediation","title":"Remediation","text":"<p>Run the following command to change group to root: <pre><code># find /etc/audit/ -type f \\( -name '*.conf' -o -name '*.rules' \\) ! -group root -exec chgrp root {} +\n</code></pre></p>","tags":["Level 2","Workstation","Server","Logging and Auditing","Configure System Accounting (auditd)","Configure auditd file access","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1070","T1070.002","T1083","TA0007"]},{"location":"4-Logging-and-Auditing/4.1-Configure-System-Accounting-%28auditd%29/4.1.4-Configure-auditd-file-access/4.1.4.8-Ensure-audit-tools-are-755-or-more-restrictive/","title":"4.1.4.8 Ensure audit tools are 755 or more restrictive","text":"","tags":["Level 2","Workstation","Server","Logging and Auditing","Configure System Accounting (auditd)","Configure auditd file access","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1070","T1070.002","T1083","TA0007"]},{"location":"4-Logging-and-Auditing/4.1-Configure-System-Accounting-%28auditd%29/4.1.4-Configure-auditd-file-access/4.1.4.8-Ensure-audit-tools-are-755-or-more-restrictive/#audit","title":"Audit","text":"<p>Run the following command to verify the audit tools have mode 755 or more restrictive, are owned by the root user and group root: <pre><code># stat -c \"%n %a\" /sbin/auditctl /sbin/aureport /sbin/ausearch /sbin/autrace /sbin/auditd /sbin/augenrules | grep -Pv -- '^\\h*\\H+\\h+([0-7][0,1,4,5][0,1,4,5])\\h*$'\n</code></pre></p> <p>Nothing should be returned</p>","tags":["Level 2","Workstation","Server","Logging and Auditing","Configure System Accounting (auditd)","Configure auditd file access","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1070","T1070.002","T1083","TA0007"]},{"location":"4-Logging-and-Auditing/4.1-Configure-System-Accounting-%28auditd%29/4.1.4-Configure-auditd-file-access/4.1.4.8-Ensure-audit-tools-are-755-or-more-restrictive/#remediation","title":"Remediation","text":"<p>Run the following command to remove more permissive mode from the audit tools: <pre><code># chmod go-w /sbin/auditctl /sbin/aureport /sbin/ausearch /sbin/autrace /sbin/auditd /sbin/augenrules\n</code></pre></p>","tags":["Level 2","Workstation","Server","Logging and Auditing","Configure System Accounting (auditd)","Configure auditd file access","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1070","T1070.002","T1083","TA0007"]},{"location":"4-Logging-and-Auditing/4.1-Configure-System-Accounting-%28auditd%29/4.1.4-Configure-auditd-file-access/4.1.4.9-Ensure-audit-tools-are-owned-by-root/","title":"4.1.4.9 Ensure audit tools are owned by root","text":"","tags":["Level 2","Workstation","Server","Logging and Auditing","Configure System Accounting (auditd)","Configure auditd file access","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1070","T1070.002","T1083","TA0007"]},{"location":"4-Logging-and-Auditing/4.1-Configure-System-Accounting-%28auditd%29/4.1.4-Configure-auditd-file-access/4.1.4.9-Ensure-audit-tools-are-owned-by-root/#audit","title":"Audit","text":"<p>Run the following command to verify the audit tools have mode 755 or more restrictive, are owned by the root user and group root: <pre><code># stat -c \"%n %U\" /sbin/auditctl /sbin/aureport /sbin/ausearch /sbin/autrace /sbin/auditd /sbin/augenrules | grep -Pv -- '^\\h*\\H+\\h+root\\h*$'\n</code></pre></p> <p>Nothing should be returned</p>","tags":["Level 2","Workstation","Server","Logging and Auditing","Configure System Accounting (auditd)","Configure auditd file access","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1070","T1070.002","T1083","TA0007"]},{"location":"4-Logging-and-Auditing/4.1-Configure-System-Accounting-%28auditd%29/4.1.4-Configure-auditd-file-access/4.1.4.9-Ensure-audit-tools-are-owned-by-root/#remediation","title":"Remediation","text":"<p>Run the following command to change the owner of the audit tools to the root user: <pre><code># chown root /sbin/auditctl /sbin/aureport /sbin/ausearch /sbin/autrace /sbin/auditd /sbin/augenrules\n</code></pre></p>","tags":["Level 2","Workstation","Server","Logging and Auditing","Configure System Accounting (auditd)","Configure auditd file access","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1070","T1070.002","T1083","TA0007"]},{"location":"4-Logging-and-Auditing/4.2-Configure-Logging/4.2.3-Ensure-all-logfiles-have-appropriate-permissions-and-ownership/","title":"4.2.3 Ensure all logfiles have appropriate permissions and ownership","text":"","tags":["Level 1","Workstation","Server","Logging and Auditing","Configure Logging","Configure rsyslog","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1070","T1070.002","T1083","TA0007"]},{"location":"4-Logging-and-Auditing/4.2-Configure-Logging/4.2.3-Ensure-all-logfiles-have-appropriate-permissions-and-ownership/#audit","title":"Audit","text":"<p>Run the following script to verify that files in /var/log/ have appropriate permissions and ownership: <pre><code>#!/usr/bin/env bash\n{\necho -e \"\\n- Start check - logfiles have appropriate permissions and ownership\"\noutput=\"\"\nfind /var/log -type f | (while read -r fname; do\nbname=\"$(basename \"$fname\")\"\ncase \"$bname\" in\nlastlog | lastlog.* | wtmp | wtmp.* | btmp | btmp.*)\nif ! stat -Lc \"%a\" \"$fname\" | grep -Pq -- '^\\h*[0,2,4,6][0,2,4,6][0,4]\\h*$'; then\noutput=\"$output\\n- File: \\\"$fname\\\" mode: \\\"$(stat -Lc \"%a\" \"$fname\")\\\"\\n\"\nfi\nif ! stat -Lc \"%U %G\" \"$fname\" | grep -Pq -- '^\\h*root\\h+(utmp|root)\\h*$'; then\noutput=\"$output\\n- File: \\\"$fname\\\" ownership: \\\"$(stat -Lc \"%U:%G\" \"$fname\")\\\"\\n\"\nfi\n;;\nsecure | auth.log)\nif ! stat -Lc \"%a\" \"$fname\" | grep -Pq -- '^\\h*[0,2,4,6][0,4]0\\h*$'; then\noutput=\"$output\\n- File: \\\"$fname\\\" mode: \\\"$(stat -Lc \"%a\" \"$fname\")\\\"\\n\"\nfi\nif ! stat -Lc \"%U %G\" \"$fname\" | grep -Pq -- '^\\h*(syslog|root)\\h+(adm|root)\\h*$'; then\noutput=\"$output\\n- File: \\\"$fname\\\" ownership: \\\"$(stat -Lc \"%U:%G\" \"$fname\")\\\"\\n\"\nfi\n;;\nSSSD | sssd)\nif ! stat -Lc \"%a\" \"$fname\" | grep -Pq -- '^\\h*[0,2,4,6][0,2,4,6]0\\h*$'; then\noutput=\"$output\\n- File: \\\"$fname\\\" mode: \\\"$(stat -Lc \"%a\" \"$fname\")\\\"\\n\"\nfi\nif ! stat -Lc \"%U %G\" \"$fname\" | grep -Piq -- '^\\h*(SSSD|root)\\h+(SSSD|root)\\h*$'; then\noutput=\"$output\\n- File: \\\"$fname\\\" ownership: \\\"$(stat -Lc \"%U:%G\" \"$fname\")\\\"\\n\"\nfi\n;;\ngdm | gdm3)\nif ! stat -Lc \"%a\" \"$fname\" | grep -Pq -- '^\\h*[0,2,4,6][0,2,4,6]0\\h*$'; then\noutput=\"$output\\n- File: \\\"$fname\\\" mode: \\\"$(stat -Lc \"%a\" \"$fname\")\\\"\\n\"\nfi\nif ! stat -Lc \"%U %G\" \"$fname\" | grep -Pq -- '^\\h*(root)\\h+(gdm3?|root)\\h*$'; then\noutput=\"$output\\n- File: \\\"$fname\\\" ownership: \\\"$(stat -Lc \"%U:%G\" \"$fname\")\\\"\\n\"\nfi\n;;\n*.journal)\nif ! stat -Lc \"%a\" \"$fname\" | grep -Pq -- '^\\h*[0,2,4,6][0,4]0\\h*$'; then\noutput=\"$output\\n- File: \\\"$fname\\\" mode: \\\"$(stat -Lc \"%a\" \"$fname\")\\\"\\n\"\nfi\nif ! stat -Lc \"%U %G\" \"$fname\" | grep -Pq -- '^\\h*(root)\\h+(systemd-journal|root)\\h*$'; then\noutput=\"$output\\n- File: \\\"$fname\\\" ownership: \\\"$(stat -Lc \"%U:%G\" \"$fname\")\\\"\\n\"\nfi\n;;\n*)\nif ! stat -Lc \"%a\" \"$fname\" | grep -Pq -- '^\\h*[0,2,4,6][0,4]0\\h*$'; then\noutput=\"$output\\n- File: \\\"$fname\\\" mode: \\\"$(stat -Lc \"%a\" \"$fname\")\\\"\\n\"\nfi\nif ! stat -Lc \"%U %G\" \"$fname\" | grep -Pq -- '^\\h*(syslog|root)\\h+(adm|root)\\h*$'; then\noutput=\"$output\\n- File: \\\"$fname\\\" ownership: \\\"$(stat -Lc \"%U:%G\" \"$fname\")\\\"\\n\"\nfi\n;;\nesac\ndone\n# If all files passed, then we pass\nif [ -z \"$output\" ]; then\necho -e \"\\n- PASS\\n- All files in \\\"/var/log/\\\" have appropriate permissions and ownership\\n\"\nelse\n# print the reason why we are failing\necho -e \"\\n- FAIL:\\n$output\"\nfi\necho -e \"- End check - logfiles have appropriate permissions and ownership\\n\"\n)\n}\n</code></pre></p>","tags":["Level 1","Workstation","Server","Logging and Auditing","Configure Logging","Configure rsyslog","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1070","T1070.002","T1083","TA0007"]},{"location":"4-Logging-and-Auditing/4.2-Configure-Logging/4.2.3-Ensure-all-logfiles-have-appropriate-permissions-and-ownership/#remediation","title":"Remediation","text":"<p>Run the following script to update permissions and ownership on files in /var/log.</p> <p>Although the script is not destructive, ensure that the output of the audit procedure is captured in the event that the remediation causes issues.</p> <pre><code>#!/usr/bin/env bash\n{\necho -e \"\\n- Start remediation - logfiles have appropriate permissions and ownership\"\nfind /var/log -type f | while read -r fname; do\nbname=\"$(basename \"$fname\")\"\ncase \"$bname\" in\nlastlog | lastlog.* | wtmp | wtmp.* | btmp | btmp.*)\n! stat -Lc \"%a\" \"$fname\" | grep -Pq -- '^\\h*[0,2,4,6][0,2,4,6][0,4]\\h*$' &amp;&amp; echo -e \"- changing mode on \\\"$fname\\\"\" &amp;&amp; chmod ug-x,o-wx \"$fname\"\n! stat -Lc \"%U\" \"$fname\" | grep -Pq -- '^\\h*root\\h*$' &amp;&amp; echo -e \"- changing owner on \\\"$fname\\\"\" &amp;&amp; chown root \"$fname\"\n! stat -Lc \"%G\" \"$fname\" | grep -Pq -- '^\\h*(utmp|root)\\h*$' &amp;&amp; echo -e \"- changing group on \\\"$fname\\\"\" &amp;&amp; chgrp root \"$fname\"\n;;\nsecure | auth.log)\n! stat -Lc \"%a\" \"$fname\" | grep -Pq -- '^\\h*[0,2,4,6][0,4]0\\h*$' &amp;&amp; echo -e \"- changing mode on \\\"$fname\\\"\" &amp;&amp; chmod u-x,g-wx,o-rwx \"$fname\"\n! stat -Lc \"%U\" \"$fname\" | grep -Pq -- '^\\h*(syslog|root)\\h*$' &amp;&amp; echo -e \"- changing owner on \\\"$fname\\\"\" &amp;&amp; chown root \"$fname\"\n! stat -Lc \"%G\" \"$fname\" | grep -Pq -- '^\\h*(adm|root)\\h*$' &amp;&amp; echo -e \"- changing group on \\\"$fname\\\"\" &amp;&amp; chgrp root \"$fname\"\n;;\nSSSD | sssd)\n! stat -Lc \"%a\" \"$fname\" | grep -Pq -- '^\\h*[0,2,4,6][0,2,4,6]0\\h*$' &amp;&amp; echo -e \"- changing mode on \\\"$fname\\\"\" &amp;&amp; chmod ug-x,o-rwx \"$fname\"\n! stat -Lc \"%U\" \"$fname\" | grep -Piq -- '^\\h*(SSSD|root)\\h*$' &amp;&amp; echo -e \"- changing owner on \\\"$fname\\\"\" &amp;&amp; chown root \"$fname\"\n! stat -Lc \"%G\" \"$fname\" | grep -Piq -- '^\\h*(SSSD|root)\\h*$' &amp;&amp; echo -e \"- changing group on \\\"$fname\\\"\" &amp;&amp; chgrp root \"$fname\"\n;;\ngdm | gdm3)\n! stat -Lc \"%a\" \"$fname\" | grep -Pq -- '^\\h*[0,2,4,6][0,2,4,6]0\\h*$' &amp;&amp; echo -e \"- changing mode on \\\"$fname\\\"\" &amp;&amp; chmod ug-x,o-rwx\n ! stat -Lc \"%U\" \"$fname\" | grep -Pq -- '^\\h*root\\h*$' &amp;&amp; echo -e \"- changing owner on \\\"$fname\\\"\" &amp;&amp; chown root \"$fname\"\n! stat -Lc \"%G\" \"$fname\" | grep -Pq -- '^\\h*(gdm3?|root)\\h*$' &amp;&amp; echo -e \"- changing group on \\\"$fname\\\"\" &amp;&amp; chgrp root \"$fname\"\n;;\n*.journal)\n! stat -Lc \"%a\" \"$fname\" | grep -Pq -- '^\\h*[0,2,4,6][0,4]0\\h*$' &amp;&amp; echo -e \"- changing mode on \\\"$fname\\\"\" &amp;&amp; chmod u-x,g-wx,o-rwx \"$fname\"\n! stat -Lc \"%U\" \"$fname\" | grep -Pq -- '^\\h*root\\h*$' &amp;&amp; echo -e \"- changing owner on \\\"$fname\\\"\" &amp;&amp; chown root \"$fname\"\n! stat -Lc \"%G\" \"$fname\" | grep -Pq -- '^\\h*(systemdjournal|root)\\h*$' &amp;&amp; echo -e \"- changing group on \\\"$fname\\\"\" &amp;&amp; chgrp root \"$fname\"\n;;\n*)\n! stat -Lc \"%a\" \"$fname\" | grep -Pq -- '^\\h*[0,2,4,6][0,4]0\\h*$' &amp;&amp; echo -e \"- changing mode on \\\"$fname\\\"\" &amp;&amp; chmod u-x,g-wx,o-rwx \"$fname\"\n! stat -Lc \"%U\" \"$fname\" | grep -Pq -- '^\\h*(syslog|root)\\h*$' &amp;&amp; echo -e \"- changing owner on \\\"$fname\\\"\" &amp;&amp; chown root \"$fname\"\n! stat -Lc \"%G\" \"$fname\" | grep -Pq -- '^\\h*(adm|root)\\h*$' &amp;&amp; echo -e \"- changing group on \\\"$fname\\\"\" &amp;&amp; chgrp root \"$fname\"\n;;\nesac\ndone\necho -e \"- End remediation - logfiles have appropriate permissions and ownership\\n\"\n}\n</code></pre> <p>Note: You may also need to change the configuration for your logging software or services for any logs that had incorrect permissions.</p> <p>If there are services that log to other locations, ensure that those log files have the appropriate permissions.</p>","tags":["Level 1","Workstation","Server","Logging and Auditing","Configure Logging","Configure rsyslog","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1070","T1070.002","T1083","TA0007"]},{"location":"4-Logging-and-Auditing/4.2-Configure-Logging/4.2.1-Configure-journald/4.2.1.2-Ensure-journald-service-is-enabled/","title":"4.2.1.2 Ensure journald service is enabled","text":"","tags":["Level 1","Workstation","Server","Logging and Auditing","Configure Logging","Configure journald","Automated","IG1","IG2","IG3","8.2 Collect Audit Logs","T1070","T1070.002","T1562","T1562.001","TA0005"]},{"location":"4-Logging-and-Auditing/4.2-Configure-Logging/4.2.1-Configure-journald/4.2.1.2-Ensure-journald-service-is-enabled/#audit","title":"Audit","text":"<p>Run the following command to verify systemd-journald is enabled: <pre><code># systemctl is-enabled systemd-journald.service\n</code></pre></p> <p>Verify the output matches: <pre><code>static\n</code></pre></p>","tags":["Level 1","Workstation","Server","Logging and Auditing","Configure Logging","Configure journald","Automated","IG1","IG2","IG3","8.2 Collect Audit Logs","T1070","T1070.002","T1562","T1562.001","TA0005"]},{"location":"4-Logging-and-Auditing/4.2-Configure-Logging/4.2.1-Configure-journald/4.2.1.2-Ensure-journald-service-is-enabled/#remediation","title":"Remediation","text":"<p>By default the systemd-journald service does not have an [Install] section and thus cannot be enabled / disabled. It is meant to be referenced as Requires or Wants by other unit files. As such, if the status of systemd-journald is not static, investigate why.</p>","tags":["Level 1","Workstation","Server","Logging and Auditing","Configure Logging","Configure journald","Automated","IG1","IG2","IG3","8.2 Collect Audit Logs","T1070","T1070.002","T1562","T1562.001","TA0005"]},{"location":"4-Logging-and-Auditing/4.2-Configure-Logging/4.2.1-Configure-journald/4.2.1.3-Ensure-journald-is-configured-to-compress-large-log-files/","title":"4.2.1.3 Ensure journald is configured to compress large log files","text":"","tags":["Level 1","Workstation","Server","Logging and Auditing","Configure Logging","Configure journald","Automated","IG1","IG2","IG3","8.2 Collect Audit Logs","8.3 Ensure Adequate Audit Log Storage","T1562","T1562.002","TA0040","M1053"]},{"location":"4-Logging-and-Auditing/4.2-Configure-Logging/4.2.1-Configure-journald/4.2.1.3-Ensure-journald-is-configured-to-compress-large-log-files/#audit","title":"Audit","text":"<p>Review /etc/systemd/journald.conf and verify that large files will be compressed: <pre><code># grep ^\\s*Compress /etc/systemd/journald.conf\n</code></pre></p> <p>Verify the output matches: <pre><code>Compress=yes\n</code></pre></p>","tags":["Level 1","Workstation","Server","Logging and Auditing","Configure Logging","Configure journald","Automated","IG1","IG2","IG3","8.2 Collect Audit Logs","8.3 Ensure Adequate Audit Log Storage","T1562","T1562.002","TA0040","M1053"]},{"location":"4-Logging-and-Auditing/4.2-Configure-Logging/4.2.1-Configure-journald/4.2.1.3-Ensure-journald-is-configured-to-compress-large-log-files/#remediation","title":"Remediation","text":"<p>Edit the /etc/systemd/journald.conf file and add the following line: <pre><code>Compress=yes\n</code></pre></p> <p>Restart the service: <pre><code># systemctl restart systemd-journald\n</code></pre></p>","tags":["Level 1","Workstation","Server","Logging and Auditing","Configure Logging","Configure journald","Automated","IG1","IG2","IG3","8.2 Collect Audit Logs","8.3 Ensure Adequate Audit Log Storage","T1562","T1562.002","TA0040","M1053"]},{"location":"4-Logging-and-Auditing/4.2-Configure-Logging/4.2.1-Configure-journald/4.2.1.4-Ensure-journald-is-configured-to-write-logfiles-to-persistent-disk/","title":"4.2.1.4 Ensure journald is configured to write logfiles to persistent disk","text":"","tags":["Level 1","Workstation","Server","Logging and Auditing","Configure Logging","Configure journald","Automated","IG1","IG2","IG3","8.2 Collect Audit Logs","T1562","T1562.006","T1070","T1070.002","TA0005","M1022"]},{"location":"4-Logging-and-Auditing/4.2-Configure-Logging/4.2.1-Configure-journald/4.2.1.4-Ensure-journald-is-configured-to-write-logfiles-to-persistent-disk/#audit","title":"Audit","text":"<p>Review /etc/systemd/journald.conf and verify that logs are persisted to disk: <pre><code># grep ^\\s*Storage /etc/systemd/journald.conf\n</code></pre></p> <p>Verify the output matches: <pre><code>Storage=persistent\n</code></pre></p>","tags":["Level 1","Workstation","Server","Logging and Auditing","Configure Logging","Configure journald","Automated","IG1","IG2","IG3","8.2 Collect Audit Logs","T1562","T1562.006","T1070","T1070.002","TA0005","M1022"]},{"location":"4-Logging-and-Auditing/4.2-Configure-Logging/4.2.1-Configure-journald/4.2.1.4-Ensure-journald-is-configured-to-write-logfiles-to-persistent-disk/#remediation","title":"Remediation","text":"<p>Edit the /etc/systemd/journald.conf file and add the following line: <pre><code>Storage=persistent\n</code></pre></p> <p>Restart the service: <pre><code># systemctl restart systemd-journald\n</code></pre></p>","tags":["Level 1","Workstation","Server","Logging and Auditing","Configure Logging","Configure journald","Automated","IG1","IG2","IG3","8.2 Collect Audit Logs","T1562","T1562.006","T1070","T1070.002","TA0005","M1022"]},{"location":"4-Logging-and-Auditing/4.2-Configure-Logging/4.2.1-Configure-journald/4.2.1.5-ensure-journald-is-not-configured-to-send-logs-to-rsyslog/","title":"4.2.1.5 Ensure journald is not configured to send logs to rsyslog","text":"","tags":["Level 1","Workstation","Server","Logging and Auditing","Configure Logging","Configure journald","Manual","IG1","IG2","IG3","8.2 Collect Audit Logs","8.9 Centralize Audit Logs","T1562","T1562.006","T1070","T1070.002","TA0040","M1029"]},{"location":"4-Logging-and-Auditing/4.2-Configure-Logging/4.2.1-Configure-journald/4.2.1.5-ensure-journald-is-not-configured-to-send-logs-to-rsyslog/#audit","title":"Audit","text":"<p>IF journald is the method for capturing logs</p> <p>Review /etc/systemd/journald.conf and verify that logs are not forwarded to rsyslog. <pre><code># grep ^\\s*ForwardToSyslog /etc/systemd/journald.conf\n</code></pre></p> <p>Verify that there is no output.</p>","tags":["Level 1","Workstation","Server","Logging and Auditing","Configure Logging","Configure journald","Manual","IG1","IG2","IG3","8.2 Collect Audit Logs","8.9 Centralize Audit Logs","T1562","T1562.006","T1070","T1070.002","TA0040","M1029"]},{"location":"4-Logging-and-Auditing/4.2-Configure-Logging/4.2.1-Configure-journald/4.2.1.5-ensure-journald-is-not-configured-to-send-logs-to-rsyslog/#remediation","title":"Remediation","text":"<p>Edit the /etc/systemd/journald.conf file and ensure that ForwardToSyslog=yes is removed.</p> <p>Restart the service: <pre><code># systemctl restart systemd-journald\n</code></pre></p>","tags":["Level 1","Workstation","Server","Logging and Auditing","Configure Logging","Configure journald","Manual","IG1","IG2","IG3","8.2 Collect Audit Logs","8.9 Centralize Audit Logs","T1562","T1562.006","T1070","T1070.002","TA0040","M1029"]},{"location":"4-Logging-and-Auditing/4.2-Configure-Logging/4.2.1-Configure-journald/4.2.1.6-Ensure-journald-log-rotation-is-configured-per-site-policy/","title":"4.2.1.6 Ensure journald log rotation is configured per site policy","text":"","tags":["Level 1","Workstation","Server","Logging and Auditing","Configure Logging","Configure journald","Manual","IG1","IG2","IG3","8.2 Collect Audit Logs","T1070","T1070.002","TA0040","M1022"]},{"location":"4-Logging-and-Auditing/4.2-Configure-Logging/4.2.1-Configure-journald/4.2.1.6-Ensure-journald-log-rotation-is-configured-per-site-policy/#audit","title":"Audit","text":"<p>Review /etc/systemd/journald.conf and verify logs are rotated according to site policy. The specific parameters for log rotation are: <pre><code>SystemMaxUse=\nSystemKeepFree=\nRuntimeMaxUse=\nRuntimeKeepFree=\nMaxFileSec=\n</code></pre></p>","tags":["Level 1","Workstation","Server","Logging and Auditing","Configure Logging","Configure journald","Manual","IG1","IG2","IG3","8.2 Collect Audit Logs","T1070","T1070.002","TA0040","M1022"]},{"location":"4-Logging-and-Auditing/4.2-Configure-Logging/4.2.1-Configure-journald/4.2.1.6-Ensure-journald-log-rotation-is-configured-per-site-policy/#remediation","title":"Remediation","text":"<p>Review /etc/systemd/journald.conf and verify logs are rotated according to site policy. The settings should be carefully understood as there are specific edge cases and prioritisation of parameters.</p> <p>The specific parameters for log rotation are: <pre><code>SystemMaxUse=\nSystemKeepFree=\nRuntimeMaxUse=\nRuntimeKeepFree=\nMaxFileSec=\n</code></pre></p>","tags":["Level 1","Workstation","Server","Logging and Auditing","Configure Logging","Configure journald","Manual","IG1","IG2","IG3","8.2 Collect Audit Logs","T1070","T1070.002","TA0040","M1022"]},{"location":"4-Logging-and-Auditing/4.2-Configure-Logging/4.2.1-Configure-journald/4.2.1.7-Ensure-journald-default-file-permissions-configured/","title":"4.2.1.7 Ensure journald default file permissions configured","text":"","tags":["Level 1","Workstation","Server","Logging and Auditing","Configure Logging","Configure journald","Manual","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","8.2 Collect Audit Logs","T1070","T1070.002","T1083","TA0007"]},{"location":"4-Logging-and-Auditing/4.2-Configure-Logging/4.2.1-Configure-journald/4.2.1.7-Ensure-journald-default-file-permissions-configured/#audit","title":"Audit","text":"<p>First see if there is an override file /etc/tmpfiles.d/systemd.conf. If so, this file will override all default settings as defined in /usr/lib/tmpfiles.d/systemd.conf and should be inspected.</p> <p>If there is no override file, inspect the default /usr/lib/tmpfiles.d/systemd.conf against the site specific requirements.</p> <p>Ensure that file permissions are 0640.</p> <p>Should a site policy dictate less restrictive permissions, ensure to follow said policy.</p> <p>NOTE: More restrictive permissions such as 0600 is implicitly sufficient.</p>","tags":["Level 1","Workstation","Server","Logging and Auditing","Configure Logging","Configure journald","Manual","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","8.2 Collect Audit Logs","T1070","T1070.002","T1083","TA0007"]},{"location":"4-Logging-and-Auditing/4.2-Configure-Logging/4.2.1-Configure-journald/4.2.1.7-Ensure-journald-default-file-permissions-configured/#remediation","title":"Remediation","text":"<p>If the default configuration is not appropriate for the site specific requirements, copy /usr/lib/tmpfiles.d/systemd.conf to /etc/tmpfiles.d/systemd.conf and modify as required. Requirements is either 0640 or site policy if that is less restrictive.</p>","tags":["Level 1","Workstation","Server","Logging and Auditing","Configure Logging","Configure journald","Manual","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","8.2 Collect Audit Logs","T1070","T1070.002","T1083","TA0007"]},{"location":"4-Logging-and-Auditing/4.2-Configure-Logging/4.2.1-Configure-journald/4.2.1.1-Ensure-journald-is-configured-to-send-logs-to-a-remote-log-host/4.2.1.1.1-Ensure-systemd-journal-remote-is-installed/","title":"4.2.1.1.1 Ensure systemd-journal-remote is installed","text":"","tags":["Level 1","Workstation","Server","Logging and Auditing","Configure Logging","Configure journald","Ensure journald is configured to send logs to a remote log host","Automated","IG1","IG2","IG3","8.2 Collect Audit Logs","T1070","T1070.002","T1562","T1562.006","TA0040","M1029"]},{"location":"4-Logging-and-Auditing/4.2-Configure-Logging/4.2.1-Configure-journald/4.2.1.1-Ensure-journald-is-configured-to-send-logs-to-a-remote-log-host/4.2.1.1.1-Ensure-systemd-journal-remote-is-installed/#audit","title":"Audit","text":"<p>Run the following command to verify systemd-journal-remote is installed.</p> <p>Run the following command: <pre><code># dpkg-query -W -f='${binary:Package}\\t${Status}\\t${db:Status-Status}\\n' systemd-journal-remote\nsystemd-journal-remote install ok installed installed\n</code></pre></p>","tags":["Level 1","Workstation","Server","Logging and Auditing","Configure Logging","Configure journald","Ensure journald is configured to send logs to a remote log host","Automated","IG1","IG2","IG3","8.2 Collect Audit Logs","T1070","T1070.002","T1562","T1562.006","TA0040","M1029"]},{"location":"4-Logging-and-Auditing/4.2-Configure-Logging/4.2.1-Configure-journald/4.2.1.1-Ensure-journald-is-configured-to-send-logs-to-a-remote-log-host/4.2.1.1.1-Ensure-systemd-journal-remote-is-installed/#remediation","title":"Remediation","text":"<p>Run the following command to install systemd-journal-remote: <pre><code># apt install systemd-journal-remote\n</code></pre></p>","tags":["Level 1","Workstation","Server","Logging and Auditing","Configure Logging","Configure journald","Ensure journald is configured to send logs to a remote log host","Automated","IG1","IG2","IG3","8.2 Collect Audit Logs","T1070","T1070.002","T1562","T1562.006","TA0040","M1029"]},{"location":"4-Logging-and-Auditing/4.2-Configure-Logging/4.2.1-Configure-journald/4.2.1.1-Ensure-journald-is-configured-to-send-logs-to-a-remote-log-host/4.2.1.1.2-Ensure-systemd-journal-remote-is-configured/","title":"4.2.1.1.2 Ensure systemd-journal-remote is configured","text":"","tags":["Level 1","Workstation","Server","Logging and Auditing","Configure Logging","Configure journald","Ensure journald is configured to send logs to a remote log host","Manual","IG1","IG2","IG3","8.2 Collect Audit Logs","T1070","T1070.002","T1562","T1562.006","TA0040","M1029"]},{"location":"4-Logging-and-Auditing/4.2-Configure-Logging/4.2.1-Configure-journald/4.2.1.1-Ensure-journald-is-configured-to-send-logs-to-a-remote-log-host/4.2.1.1.2-Ensure-systemd-journal-remote-is-configured/#audit","title":"Audit","text":"<p>Verify systemd-journal-remote is configured.</p> <p>Run the following command: <pre><code># grep -P \"^ *URL=|^ *ServerKeyFile=|^ *ServerCertificateFile=|^ *TrustedCertificateFile=\" /etc/systemd/journal-upload.conf\n</code></pre></p> <p>Verify the output matches per your environments certificate locations and the URL of the log server. Example: <pre><code>URL=192.168.50.42\nServerKeyFile=/etc/ssl/private/journal-upload.pem\nServerCertificateFile=/etc/ssl/certs/journal-upload.pem\nTrustedCertificateFile=/etc/ssl/ca/trusted.pem\n</code></pre></p>","tags":["Level 1","Workstation","Server","Logging and Auditing","Configure Logging","Configure journald","Ensure journald is configured to send logs to a remote log host","Manual","IG1","IG2","IG3","8.2 Collect Audit Logs","T1070","T1070.002","T1562","T1562.006","TA0040","M1029"]},{"location":"4-Logging-and-Auditing/4.2-Configure-Logging/4.2.1-Configure-journald/4.2.1.1-Ensure-journald-is-configured-to-send-logs-to-a-remote-log-host/4.2.1.1.2-Ensure-systemd-journal-remote-is-configured/#remediation","title":"Remediation","text":"<p>Edit the /etc/systemd/journal-upload.conf file and ensure the following lines are set per your environment: <pre><code>URL=192.168.50.42\nServerKeyFile=/etc/ssl/private/journal-upload.pem\nServerCertificateFile=/etc/ssl/certs/journal-upload.pem\nTrustedCertificateFile=/etc/ssl/ca/trusted.pem\n</code></pre></p> <p>Restart the service: <pre><code># systemctl restart systemd-journal-upload\n</code></pre></p>","tags":["Level 1","Workstation","Server","Logging and Auditing","Configure Logging","Configure journald","Ensure journald is configured to send logs to a remote log host","Manual","IG1","IG2","IG3","8.2 Collect Audit Logs","T1070","T1070.002","T1562","T1562.006","TA0040","M1029"]},{"location":"4-Logging-and-Auditing/4.2-Configure-Logging/4.2.1-Configure-journald/4.2.1.1-Ensure-journald-is-configured-to-send-logs-to-a-remote-log-host/4.2.1.1.3-Ensure-systemd-journal-remote-is-enabled/","title":"4.2.1.1.3 Ensure systemd-journal-remote is enabled","text":"","tags":["Level 1","Workstation","Server","Logging and Auditing","Configure Logging","Configure journald","Ensure journald is configured to send logs to a remote log host","Manual","IG1","IG2","IG3","8.2 Collect Audit Logs","T1070","T1070.002","T1562","T1562.006","TA0040","M1029"]},{"location":"4-Logging-and-Auditing/4.2-Configure-Logging/4.2.1-Configure-journald/4.2.1.1-Ensure-journald-is-configured-to-send-logs-to-a-remote-log-host/4.2.1.1.3-Ensure-systemd-journal-remote-is-enabled/#audit","title":"Audit","text":"<p>Verify systemd-journal-remote is enabled.</p> <p>Run the following command: <pre><code># systemctl is-enabled systemd-journal-upload.service\n</code></pre></p> <p>Verify the output matches: <pre><code>enabled\n</code></pre></p>","tags":["Level 1","Workstation","Server","Logging and Auditing","Configure Logging","Configure journald","Ensure journald is configured to send logs to a remote log host","Manual","IG1","IG2","IG3","8.2 Collect Audit Logs","T1070","T1070.002","T1562","T1562.006","TA0040","M1029"]},{"location":"4-Logging-and-Auditing/4.2-Configure-Logging/4.2.1-Configure-journald/4.2.1.1-Ensure-journald-is-configured-to-send-logs-to-a-remote-log-host/4.2.1.1.3-Ensure-systemd-journal-remote-is-enabled/#remediation","title":"Remediation","text":"<p>Run the following command to enable systemd-journal-remote: <pre><code># systemctl --now enable systemd-journal-upload.service\n</code></pre></p>","tags":["Level 1","Workstation","Server","Logging and Auditing","Configure Logging","Configure journald","Ensure journald is configured to send logs to a remote log host","Manual","IG1","IG2","IG3","8.2 Collect Audit Logs","T1070","T1070.002","T1562","T1562.006","TA0040","M1029"]},{"location":"4-Logging-and-Auditing/4.2-Configure-Logging/4.2.1-Configure-journald/4.2.1.1-Ensure-journald-is-configured-to-send-logs-to-a-remote-log-host/4.2.1.1.4-Ensure-journald-is-not-configured-to-recieve-logs-from-a-remote-client/","title":"4.2.1.1.4 Ensure journald is not configured to recieve logs from a remote client","text":"","tags":["Level 1","Workstation","Server","Logging and Auditing","Configure Logging","Configure journald","Ensure journald is configured to send logs to a remote log host","Automated","IG1","IG2","IG3","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","8.2 Collect Audit Logs","T1070","T1070.002","T1562","T1562.006","TA0040","M1029"]},{"location":"4-Logging-and-Auditing/4.2-Configure-Logging/4.2.1-Configure-journald/4.2.1.1-Ensure-journald-is-configured-to-send-logs-to-a-remote-log-host/4.2.1.1.4-Ensure-journald-is-not-configured-to-recieve-logs-from-a-remote-client/#audit","title":"Audit","text":"<p>Run the following command to verify systemd-journal-remote.socket is not enabled: <pre><code># systemctl is-enabled systemd-journal-remote.socket\n</code></pre></p> <p>Verify the output matches: <pre><code>disabled\n</code></pre></p>","tags":["Level 1","Workstation","Server","Logging and Auditing","Configure Logging","Configure journald","Ensure journald is configured to send logs to a remote log host","Automated","IG1","IG2","IG3","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","8.2 Collect Audit Logs","T1070","T1070.002","T1562","T1562.006","TA0040","M1029"]},{"location":"4-Logging-and-Auditing/4.2-Configure-Logging/4.2.1-Configure-journald/4.2.1.1-Ensure-journald-is-configured-to-send-logs-to-a-remote-log-host/4.2.1.1.4-Ensure-journald-is-not-configured-to-recieve-logs-from-a-remote-client/#remediation","title":"Remediation","text":"<p>Run the following command to disable systemd-journal-remote.socket: <pre><code># systemctl --now disable systemd-journal-remote.socket\n</code></pre></p>","tags":["Level 1","Workstation","Server","Logging and Auditing","Configure Logging","Configure journald","Ensure journald is configured to send logs to a remote log host","Automated","IG1","IG2","IG3","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","8.2 Collect Audit Logs","T1070","T1070.002","T1562","T1562.006","TA0040","M1029"]},{"location":"4-Logging-and-Auditing/4.2-Configure-Logging/4.2.2-Configure-rsyslog/4.2.2.1-Ensure-rsyslog-is-installed/","title":"4.2.2.1 Ensure rsyslog is installed","text":"","tags":["Level 1","Workstation","Server","Logging and Auditing","Configure Logging","Configure rsyslog","Automated","IG1","IG2","IG3","8.2 Collect Audit Logs","T1005","T1070","T1070.002","TA0005"]},{"location":"4-Logging-and-Auditing/4.2-Configure-Logging/4.2.2-Configure-rsyslog/4.2.2.1-Ensure-rsyslog-is-installed/#audit","title":"Audit","text":"<p>Run the following command to verify rsyslog is installed: <pre><code># dpkg-query -W -f='${binary:Package}\\t${Status}\\t${db:Status-Status}\\n' rsyslog\nrsyslog install ok installed installed\n</code></pre></p>","tags":["Level 1","Workstation","Server","Logging and Auditing","Configure Logging","Configure rsyslog","Automated","IG1","IG2","IG3","8.2 Collect Audit Logs","T1005","T1070","T1070.002","TA0005"]},{"location":"4-Logging-and-Auditing/4.2-Configure-Logging/4.2.2-Configure-rsyslog/4.2.2.1-Ensure-rsyslog-is-installed/#remediation","title":"Remediation","text":"<p>Run the following command to install rsyslog: <pre><code># apt install rsyslog\n</code></pre></p>","tags":["Level 1","Workstation","Server","Logging and Auditing","Configure Logging","Configure rsyslog","Automated","IG1","IG2","IG3","8.2 Collect Audit Logs","T1005","T1070","T1070.002","TA0005"]},{"location":"4-Logging-and-Auditing/4.2-Configure-Logging/4.2.2-Configure-rsyslog/4.2.2.2-Ensure-rsyslog-service-is-enabled/","title":"4.2.2.2 Ensure rsyslog service is enabled","text":"","tags":["Level 1","Workstation","Server","Logging and Auditing","Configure Logging","Configure rsyslog","Automated","IG1","IG2","IG3","8.2 Collect Audit Logs","T1070","T1070.002","T1562","T1562.001","TA0005"]},{"location":"4-Logging-and-Auditing/4.2-Configure-Logging/4.2.2-Configure-rsyslog/4.2.2.2-Ensure-rsyslog-service-is-enabled/#audit","title":"Audit","text":"<p>Run the following command to verify rsyslog is enabled: <pre><code># systemctl is-enabled rsyslog\n</code></pre></p> <p>Verify the output matches: <pre><code>enabled\n</code></pre></p>","tags":["Level 1","Workstation","Server","Logging and Auditing","Configure Logging","Configure rsyslog","Automated","IG1","IG2","IG3","8.2 Collect Audit Logs","T1070","T1070.002","T1562","T1562.001","TA0005"]},{"location":"4-Logging-and-Auditing/4.2-Configure-Logging/4.2.2-Configure-rsyslog/4.2.2.2-Ensure-rsyslog-service-is-enabled/#remediation","title":"Remediation","text":"<p>Run the following command to enable rsyslog: <pre><code># systemctl --now enable rsyslog\n</code></pre></p>","tags":["Level 1","Workstation","Server","Logging and Auditing","Configure Logging","Configure rsyslog","Automated","IG1","IG2","IG3","8.2 Collect Audit Logs","T1070","T1070.002","T1562","T1562.001","TA0005"]},{"location":"4-Logging-and-Auditing/4.2-Configure-Logging/4.2.2-Configure-rsyslog/4.2.2.3-Ensure-journald-is-configured-to-send-logs-to-rsyslog/","title":"4.2.2.3 Ensure journald is configured to send logs to rsyslog","text":"","tags":["Level 1","Workstation","Server","Logging and Auditing","Configure Logging","Configure rsyslog","Manual","IG1","IG2","IG3","8.2 Collect Audit Logs","8.9 Centralize Audit Logs"]},{"location":"4-Logging-and-Auditing/4.2-Configure-Logging/4.2.2-Configure-rsyslog/4.2.2.3-Ensure-journald-is-configured-to-send-logs-to-rsyslog/#audit","title":"Audit","text":"<p>IF RSyslog is the preferred method for capturing logs</p> <p>Review /etc/systemd/journald.conf and verify that logs are forwarded to rsyslog. <pre><code># grep ^\\s*ForwardToSyslog /etc/systemd/journald.conf\n</code></pre></p> <p>Verify the output matches: <pre><code>ForwardToSyslog=yes\n</code></pre></p>","tags":["Level 1","Workstation","Server","Logging and Auditing","Configure Logging","Configure rsyslog","Manual","IG1","IG2","IG3","8.2 Collect Audit Logs","8.9 Centralize Audit Logs"]},{"location":"4-Logging-and-Auditing/4.2-Configure-Logging/4.2.2-Configure-rsyslog/4.2.2.3-Ensure-journald-is-configured-to-send-logs-to-rsyslog/#remediation","title":"Remediation","text":"<p>Edit the /etc/systemd/journald.conf file and add the following line: <pre><code>ForwardToSyslog=yes\n</code></pre></p> <p>Restart the service: <pre><code># systemctl restart rsyslog\n</code></pre></p>","tags":["Level 1","Workstation","Server","Logging and Auditing","Configure Logging","Configure rsyslog","Manual","IG1","IG2","IG3","8.2 Collect Audit Logs","8.9 Centralize Audit Logs"]},{"location":"4-Logging-and-Auditing/4.2-Configure-Logging/4.2.2-Configure-rsyslog/4.2.2.4-Ensure-rsyslog-default-file-permissions-are-configured/","title":"4.2.2.4 Ensure rsyslog default file permissions are configured","text":"","tags":["Level 1","Workstation","Server","Logging and Auditing","Configure Logging","Configure rsyslog","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","8.2 Collect Audit Logs","T1070","T1070.002","T1083","TA0007"]},{"location":"4-Logging-and-Auditing/4.2-Configure-Logging/4.2.2-Configure-rsyslog/4.2.2.4-Ensure-rsyslog-default-file-permissions-are-configured/#audit","title":"Audit","text":"<p>Run the following command: <pre><code># grep ^\\$FileCreateMode /etc/rsyslog.conf /etc/rsyslog.d/*.conf\n</code></pre></p> <p>Verify the output matches: <pre><code>$FileCreateMode 0640\n</code></pre> Should a site policy dictate less restrictive permissions, ensure to follow said policy.</p> <p>NOTE: More restrictive permissions such as 0600 is implicitly sufficient.</p>","tags":["Level 1","Workstation","Server","Logging and Auditing","Configure Logging","Configure rsyslog","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","8.2 Collect Audit Logs","T1070","T1070.002","T1083","TA0007"]},{"location":"4-Logging-and-Auditing/4.2-Configure-Logging/4.2.2-Configure-rsyslog/4.2.2.4-Ensure-rsyslog-default-file-permissions-are-configured/#remediation","title":"Remediation","text":"<p>Edit either /etc/rsyslog.conf or a dedicated .conf file in /etc/rsyslog.d/ and set $FileCreateMode to 0640 or more restrictive: <pre><code>$FileCreateMode 0640\n</code></pre></p> <p>Restart the service: <pre><code># systemctl restart rsyslog\n</code></pre></p>","tags":["Level 1","Workstation","Server","Logging and Auditing","Configure Logging","Configure rsyslog","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","8.2 Collect Audit Logs","T1070","T1070.002","T1083","TA0007"]},{"location":"4-Logging-and-Auditing/4.2-Configure-Logging/4.2.2-Configure-rsyslog/4.2.2.5-Ensure-logging-is-configured/","title":"4.2.2.5 Ensure logging is configured","text":"","tags":["Level 1","Workstation","Server","Logging and Auditing","Configure Logging","Configure rsyslog","Manual","IG1","IG2","IG3","8.2 Collect Audit Logs","T1070","T1070.002","TA0005"]},{"location":"4-Logging-and-Auditing/4.2-Configure-Logging/4.2.2-Configure-rsyslog/4.2.2.5-Ensure-logging-is-configured/#audit","title":"Audit","text":"<p>Review the contents of /etc/rsyslog.conf and /etc/rsyslog.d/*.conf files to ensure appropriate logging is set. In addition, run the following command and verify that the log files are logging information as expected: <pre><code># ls -l /var/log/\n</code></pre></p>","tags":["Level 1","Workstation","Server","Logging and Auditing","Configure Logging","Configure rsyslog","Manual","IG1","IG2","IG3","8.2 Collect Audit Logs","T1070","T1070.002","TA0005"]},{"location":"4-Logging-and-Auditing/4.2-Configure-Logging/4.2.2-Configure-rsyslog/4.2.2.5-Ensure-logging-is-configured/#remediation","title":"Remediation","text":"<p>Edit the following lines in the /etc/rsyslog.conf and /etc/rsyslog.d/*.conf files as appropriate for your environment.</p> <p>NOTE: The below configuration is shown for example purposes only. Due care should be given to how the organization wish to store log data. <pre><code>*.emerg :omusrmsg:*\nauth,authpriv.* /var/log/secure\nmail.* -/var/log/mail\nmail.info -/var/log/mail.info\nmail.warning -/var/log/mail.warn\nmail.err /var/log/mail.err\ncron.* /var/log/cron\n*.=warning;*.=err -/var/log/warn\n*.crit /var/log/warn\n*.*;mail.none;news.none -/var/log/messages\nlocal0,local1.* -/var/log/localmessages\nlocal2,local3.* -/var/log/localmessages\nlocal4,local5.* -/var/log/localmessages\nlocal6,local7.* -/var/log/localmessages\n</code></pre></p> <p>Run the following command to reload the rsyslogd configuration: <pre><code># systemctl restart rsyslog\n</code></pre></p>","tags":["Level 1","Workstation","Server","Logging and Auditing","Configure Logging","Configure rsyslog","Manual","IG1","IG2","IG3","8.2 Collect Audit Logs","T1070","T1070.002","TA0005"]},{"location":"4-Logging-and-Auditing/4.2-Configure-Logging/4.2.2-Configure-rsyslog/4.2.2.6-Ensure-rsyslog-is-configured-to-send-logs-to-a-remote-log-host/","title":"4.2.2.6 Ensure rsyslog is configured to send logs to a remote log host","text":"","tags":["Level 1","Workstation","Server","Logging and Auditing","Configure Logging","Configure rsyslog","Manual","IG1","IG2","IG3","8.2 Collect Audit Logs","T1070","T1070.002","T1562","T1562.006","TA0040","M1029"]},{"location":"4-Logging-and-Auditing/4.2-Configure-Logging/4.2.2-Configure-rsyslog/4.2.2.6-Ensure-rsyslog-is-configured-to-send-logs-to-a-remote-log-host/#audit","title":"Audit","text":"<p>Review the /etc/rsyslog.conf and /etc/rsyslog.d/*.conf files and verify that logs are sent to a central host (where loghost.example.com is the name of your central log host):</p> <p>Old format <pre><code># grep \"^*.*[^I][^I]*@\" /etc/rsyslog.conf /etc/rsyslog.d/*.conf\n</code></pre></p> <p>Output should include @@, for example <pre><code>*.* @@loghost.example.com\n</code></pre> <p>New format <pre><code># grep -E '^\\s*([^#]+\\s+)?action\\(([^#]+\\s+)?\\btarget=\\\"?[^#\"]+\\\"?\\b' /etc/rsyslog.conf /etc/rsyslog.d/*.conf\n</code></pre></p> <p>Output should include target=, for example: <pre><code>*.* action(type=\"omfwd\" target=\"loghost.example.com\" port=\"514\" protocol=\"tcp\"\n</code></pre>","tags":["Level 1","Workstation","Server","Logging and Auditing","Configure Logging","Configure rsyslog","Manual","IG1","IG2","IG3","8.2 Collect Audit Logs","T1070","T1070.002","T1562","T1562.006","TA0040","M1029"]},{"location":"4-Logging-and-Auditing/4.2-Configure-Logging/4.2.2-Configure-rsyslog/4.2.2.6-Ensure-rsyslog-is-configured-to-send-logs-to-a-remote-log-host/#remediation","title":"Remediation","text":"<p>Edit the /etc/rsyslog.conf and /etc/rsyslog.d/*.conf files and add the following line (where loghost.example.com is the name of your central log host). The target directive may either be a fully qualified domain name or an IP address. <pre><code>*.* action(type=\"omfwd\" target=\"192.168.2.100\" port=\"514\" protocol=\"tcp\"\naction.resumeRetryCount=\"100\"\nqueue.type=\"LinkedList\" queue.size=\"1000\")\n</code></pre></p> <p>Run the following command to reload the rsyslogd configuration: <pre><code># systemctl restart rsyslog\n</code></pre></p>","tags":["Level 1","Workstation","Server","Logging and Auditing","Configure Logging","Configure rsyslog","Manual","IG1","IG2","IG3","8.2 Collect Audit Logs","T1070","T1070.002","T1562","T1562.006","TA0040","M1029"]},{"location":"4-Logging-and-Auditing/4.2-Configure-Logging/4.2.2-Configure-rsyslog/4.2.2.7-Ensure-rsyslog-is-not-configured-to-receive-logs-from-a-remote-client/","title":"4.2.2.7 Ensure rsyslog is not configured to receive logs from a remote client","text":"","tags":["Level 1","Workstation","Server","Logging and Auditing","Configure Logging","Configure rsyslog","Automated","IG1","IG2","IG3","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","8.2 Collect Audit Logs","T1070","T1070.002","T1562","T1562.006","TA0005"]},{"location":"4-Logging-and-Auditing/4.2-Configure-Logging/4.2.2-Configure-rsyslog/4.2.2.7-Ensure-rsyslog-is-not-configured-to-receive-logs-from-a-remote-client/#audit","title":"Audit","text":"<p>Review the /etc/rsyslog.conf and /etc/rsyslog.d/*.conf files and verify that the system is not configured to accept incoming logs.</p> <p>Old format <pre><code># grep '$ModLoad imtcp' /etc/rsyslog.conf /etc/rsyslog.d/*.conf\n# grep '$InputTCPServerRun' /etc/rsyslog.conf /etc/rsyslog.d/*.conf\n</code></pre></p> <p>No output expected.</p> <p>New format <pre><code># grep -P -- '^\\h*module\\(load=\"imtcp\"\\)' /etc/rsyslog.conf /etc/rsyslog.d/*.conf\n# grep -P -- '^\\h*input\\(type=\"imtcp\" port=\"514\"\\)' /etc/rsyslog.conf /etc/rsyslog.d/*.conf\n</code></pre></p> <p>No output expected.</p>","tags":["Level 1","Workstation","Server","Logging and Auditing","Configure Logging","Configure rsyslog","Automated","IG1","IG2","IG3","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","8.2 Collect Audit Logs","T1070","T1070.002","T1562","T1562.006","TA0005"]},{"location":"4-Logging-and-Auditing/4.2-Configure-Logging/4.2.2-Configure-rsyslog/4.2.2.7-Ensure-rsyslog-is-not-configured-to-receive-logs-from-a-remote-client/#remediation","title":"Remediation","text":"<p>Should there be any active log server configuration found in the auditing section, modify those file and remove the specific lines highlighted by the audit. Ensure none of the following entries are present in any of /etc/rsyslog.conf or /etc/rsyslog.d/*.conf.</p> <p>Old format <pre><code>$ModLoad imtcp\n$InputTCPServerRun\n</code></pre></p> <p>New format <pre><code>module(load=\"imtcp\")\ninput(type=\"imtcp\" port=\"514\")\n</code></pre></p> <p>Restart the service: <pre><code># systemctl restart rsyslog\n</code></pre></p>","tags":["Level 1","Workstation","Server","Logging and Auditing","Configure Logging","Configure rsyslog","Automated","IG1","IG2","IG3","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","8.2 Collect Audit Logs","T1070","T1070.002","T1562","T1562.006","TA0005"]},{"location":"5-Access-Authentication-and-Authorization/5.1-Configure-time-based-job-schedulers/5.1.1-Ensure-cron-daemon-is-enabled-and-running/","title":"5.1.1 Ensure cron daemon is enabled and running","text":"","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","Configure time-based job schedulers","Automated","T1562","T1562.001","TA0005","M1018"]},{"location":"5-Access-Authentication-and-Authorization/5.1-Configure-time-based-job-schedulers/5.1.1-Ensure-cron-daemon-is-enabled-and-running/#audit","title":"Audit","text":"<p>Run the following command to verify cron is enabled: <pre><code># systemctl is-enabled cron\nenabled\n</code></pre></p> <p>Run the following command to verify that cron is running: <pre><code># systemctl status cron | grep 'Active: active (running) '\nActive: active (running) since &lt;Day Date Time&gt;\n</code></pre></p>","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","Configure time-based job schedulers","Automated","T1562","T1562.001","TA0005","M1018"]},{"location":"5-Access-Authentication-and-Authorization/5.1-Configure-time-based-job-schedulers/5.1.1-Ensure-cron-daemon-is-enabled-and-running/#remediation","title":"Remediation","text":"<p>Run the following command to enable and start cron: <pre><code># systemctl --now enable cron\n</code></pre></p>","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","Configure time-based job schedulers","Automated","T1562","T1562.001","TA0005","M1018"]},{"location":"5-Access-Authentication-and-Authorization/5.1-Configure-time-based-job-schedulers/5.1.2-Ensure-permissions-on-etc-crontab-are-configured/","title":"5.1.2 Ensure permissions on /etc/crontab are configured","text":"","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","Configure time-based job schedulers","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1053","T1053.003","TA0002","TA0007","M1018"]},{"location":"5-Access-Authentication-and-Authorization/5.1-Configure-time-based-job-schedulers/5.1.2-Ensure-permissions-on-etc-crontab-are-configured/#audit","title":"Audit","text":"<p>Run the following command and verify Uid and Gid are both 0/root and Access does not grant permissions to group or other: <pre><code># stat /etc/crontab\nAccess: (0600/-rw-------) Uid: ( 0/ root) Gid: ( 0/ root)\n</code></pre></p>","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","Configure time-based job schedulers","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1053","T1053.003","TA0002","TA0007","M1018"]},{"location":"5-Access-Authentication-and-Authorization/5.1-Configure-time-based-job-schedulers/5.1.2-Ensure-permissions-on-etc-crontab-are-configured/#remediation","title":"Remediation","text":"<p>Run the following commands to set ownership and permissions on /etc/crontab: <pre><code># chown root:root /etc/crontab\n# chmod og-rwx /etc/crontab\n</code></pre></p>","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","Configure time-based job schedulers","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1053","T1053.003","TA0002","TA0007","M1018"]},{"location":"5-Access-Authentication-and-Authorization/5.1-Configure-time-based-job-schedulers/5.1.3-Ensure-permissions-on-etc-cron.hourly-are-configured/","title":"5.1.3 Ensure permissions on /etc/cron.hourly are configured","text":"","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","Configure time-based job schedulers","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1053","T1053.003","TA0002","TA0007","M1018"]},{"location":"5-Access-Authentication-and-Authorization/5.1-Configure-time-based-job-schedulers/5.1.3-Ensure-permissions-on-etc-cron.hourly-are-configured/#audit","title":"Audit","text":"<p>Run the following command and verify Uid and Gid are both 0/root and Access does not grant permissions to group or other: <pre><code># stat /etc/cron.hourly/\nAccess: (0700/drwx------) Uid: ( 0/ root) Gid: ( 0/ root)\n</code></pre></p>","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","Configure time-based job schedulers","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1053","T1053.003","TA0002","TA0007","M1018"]},{"location":"5-Access-Authentication-and-Authorization/5.1-Configure-time-based-job-schedulers/5.1.3-Ensure-permissions-on-etc-cron.hourly-are-configured/#remediation","title":"Remediation","text":"<p>Run the following commands to set ownership and permissions on the /etc/cron.hourly directory: <pre><code># chown root:root /etc/cron.hourly/\n# chmod og-rwx /etc/cron.hourly/\n</code></pre></p>","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","Configure time-based job schedulers","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1053","T1053.003","TA0002","TA0007","M1018"]},{"location":"5-Access-Authentication-and-Authorization/5.1-Configure-time-based-job-schedulers/5.1.4-Ensure-permissions-on-etc-cron.daily-are-configured/","title":"5.1.4 Ensure permissions on /etc/cron.daily are configured","text":"","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","Configure time-based job schedulers","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1053","T1053.003","TA0002","TA0007","M1018"]},{"location":"5-Access-Authentication-and-Authorization/5.1-Configure-time-based-job-schedulers/5.1.4-Ensure-permissions-on-etc-cron.daily-are-configured/#audit","title":"Audit","text":"<p>Run the following command and verify Uid and Gid are both 0/root and Access does not grant permissions to group or other: <pre><code># stat /etc/cron.daily/\nAccess: (0700/drwx------) Uid: ( 0/ root) Gid: ( 0/ root)\n</code></pre></p>","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","Configure time-based job schedulers","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1053","T1053.003","TA0002","TA0007","M1018"]},{"location":"5-Access-Authentication-and-Authorization/5.1-Configure-time-based-job-schedulers/5.1.4-Ensure-permissions-on-etc-cron.daily-are-configured/#remediation","title":"Remediation","text":"<p>Run the following commands to set ownership and permissions on the /etc/cron.daily directory: <pre><code># chown root:root /etc/cron.daily/\n# chmod og-rwx /etc/cron.daily/\n</code></pre></p>","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","Configure time-based job schedulers","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1053","T1053.003","TA0002","TA0007","M1018"]},{"location":"5-Access-Authentication-and-Authorization/5.1-Configure-time-based-job-schedulers/5.1.5-Ensure-permissions-on-etc-cron.weekly-are-configured/","title":"5.1.5 Ensure permissions on /etc/cron.weekly are configured","text":"","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","Configure time-based job schedulers","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1053","T1053.003","TA0002","TA0007","M1018"]},{"location":"5-Access-Authentication-and-Authorization/5.1-Configure-time-based-job-schedulers/5.1.5-Ensure-permissions-on-etc-cron.weekly-are-configured/#audit","title":"Audit","text":"<p>Run the following command and verify Uid and Gid are both 0/root and Access does not grant permissions to group or other: <pre><code># stat /etc/cron.weekly/\nAccess: (0700/drwx------) Uid: ( 0/ root) Gid: ( 0/ root)\n</code></pre></p>","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","Configure time-based job schedulers","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1053","T1053.003","TA0002","TA0007","M1018"]},{"location":"5-Access-Authentication-and-Authorization/5.1-Configure-time-based-job-schedulers/5.1.5-Ensure-permissions-on-etc-cron.weekly-are-configured/#remediation","title":"Remediation","text":"<p>Run the following commands to set ownership and permissions on the /etc/cron.weekly directory: <pre><code># chown root:root /etc/cron.weekly/\n# chmod og-rwx /etc/cron.weekly/\n</code></pre></p>","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","Configure time-based job schedulers","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1053","T1053.003","TA0002","TA0007","M1018"]},{"location":"5-Access-Authentication-and-Authorization/5.1-Configure-time-based-job-schedulers/5.1.6-Ensure-permissions-on-etc-cron.monthly-are-configured/","title":"5.1.6 Ensure permissions on /etc/cron.monthly are configured","text":"","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","Configure time-based job schedulers","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1053","T1053.003","TA0002","TA0007","M1018"]},{"location":"5-Access-Authentication-and-Authorization/5.1-Configure-time-based-job-schedulers/5.1.6-Ensure-permissions-on-etc-cron.monthly-are-configured/#audit","title":"Audit","text":"<p>Run the following command and verify Uid and Gid are both 0/root and Access does not grant permissions to group or other: <pre><code># stat /etc/cron.monthly/\nAccess: (0700/drwx------) Uid: ( 0/ root) Gid: ( 0/ root)\n</code></pre></p>","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","Configure time-based job schedulers","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1053","T1053.003","TA0002","TA0007","M1018"]},{"location":"5-Access-Authentication-and-Authorization/5.1-Configure-time-based-job-schedulers/5.1.6-Ensure-permissions-on-etc-cron.monthly-are-configured/#remediation","title":"Remediation","text":"<p>Run the following commands to set ownership and permissions on the /etc/cron.monthly directory: <pre><code># chown root:root /etc/cron.monthly/\n# chmod og-rwx /etc/cron.monthly/\n</code></pre></p>","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","Configure time-based job schedulers","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1053","T1053.003","TA0002","TA0007","M1018"]},{"location":"5-Access-Authentication-and-Authorization/5.1-Configure-time-based-job-schedulers/5.1.7-Ensure-permissions-on-etc-cron.d-are-configured/","title":"5.1.7 Ensure permissions on /etc/cron.d are configured","text":"","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","Configure time-based job schedulers","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1053","T1053.003","TA0002","TA0007","M1018"]},{"location":"5-Access-Authentication-and-Authorization/5.1-Configure-time-based-job-schedulers/5.1.7-Ensure-permissions-on-etc-cron.d-are-configured/#audit","title":"Audit","text":"<p>Run the following command and verify Uid and Gid are both 0/root and Access does not grant permissions to group or other: <pre><code># stat /etc/cron.d/\nAccess: (0700/drwx------) Uid: ( 0/ root) Gid: ( 0/ root)\n</code></pre></p>","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","Configure time-based job schedulers","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1053","T1053.003","TA0002","TA0007","M1018"]},{"location":"5-Access-Authentication-and-Authorization/5.1-Configure-time-based-job-schedulers/5.1.7-Ensure-permissions-on-etc-cron.d-are-configured/#remediation","title":"Remediation","text":"<p>Remediation: Run the following commands to set ownership and permissions on the /etc/cron.d directory: <pre><code># chown root:root /etc/cron.d/\n# chmod og-rwx /etc/cron.d/\n</code></pre></p>","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","Configure time-based job schedulers","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1053","T1053.003","TA0002","TA0007","M1018"]},{"location":"5-Access-Authentication-and-Authorization/5.1-Configure-time-based-job-schedulers/5.1.8-Ensure-cron-is-restricted-to-authorized-users/","title":"5.1.8 Ensure cron is restricted to authorized users","text":"","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","Configure time-based job schedulers","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1053","T1053.003","TA0002","M1018"]},{"location":"5-Access-Authentication-and-Authorization/5.1-Configure-time-based-job-schedulers/5.1.8-Ensure-cron-is-restricted-to-authorized-users/#audit","title":"Audit","text":"<p>Run the following command and verify that /etc/cron.deny does not exist: <pre><code># stat /etc/cron.deny\nstat: cannot stat `/etc/cron.deny': No such file or directory\n</code></pre></p> <p>Run the following command and verify Uid and Gid are both 0/root and Access, does not grant write or execute to group, and does not grant permissions to other for/etc/cron.allow: <pre><code># stat /etc/cron.allow\nAccess: (0640/-rw-r-----) Uid: ( 0/ root) Gid: ( 0/ root)\n</code></pre></p>","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","Configure time-based job schedulers","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1053","T1053.003","TA0002","M1018"]},{"location":"5-Access-Authentication-and-Authorization/5.1-Configure-time-based-job-schedulers/5.1.8-Ensure-cron-is-restricted-to-authorized-users/#remediation","title":"Remediation","text":"<p>Run the following commands to remove /etc/cron.deny: <pre><code># rm /etc/cron.deny\n</code></pre></p> <p>Run the following command to create /etc/cron.allow <pre><code># touch /etc/cron.allow\n</code></pre></p> <p>Run the following commands to set permissions and ownership for /etc/cron.allow: <pre><code># chmod g-wx,o-rwx /etc/cron.allow\n# chown root:root /etc/cron.allow\n</code></pre></p>","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","Configure time-based job schedulers","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1053","T1053.003","TA0002","M1018"]},{"location":"5-Access-Authentication-and-Authorization/5.1-Configure-time-based-job-schedulers/5.1.9-Ensure-at-is-restricted-to-authorized-users/","title":"5.1.9 Ensure at is restricted to authorized users","text":"","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","Configure time-based job schedulers","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1053","T1053.003","TA0002","M1018"]},{"location":"5-Access-Authentication-and-Authorization/5.1-Configure-time-based-job-schedulers/5.1.9-Ensure-at-is-restricted-to-authorized-users/#audit","title":"Audit","text":"<p>Run the following command and verify that /etc/at.deny does not exist: <pre><code># stat /etc/at.deny\nstat: cannot stat `/etc/at.deny': No such file or directory\n</code></pre></p> <p>Run the following command and verify Uid and Gid are both 0/root and Access, does not grant write or execute to group, and does not grant permissions to other for/etc/at.allow: <pre><code># stat /etc/at.allow\nAccess: (0640/-rw-r-----) Uid: ( 0/ root) Gid: ( 0/ root)\n</code></pre></p>","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","Configure time-based job schedulers","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1053","T1053.003","TA0002","M1018"]},{"location":"5-Access-Authentication-and-Authorization/5.1-Configure-time-based-job-schedulers/5.1.9-Ensure-at-is-restricted-to-authorized-users/#remediation","title":"Remediation","text":"<p>Run the following commands to remove /etc/at.deny: <pre><code># rm /etc/at.deny\n</code></pre></p> <p>Run the following command to create /etc/at.allow <pre><code># touch /etc/at.allow\n</code></pre></p> <p>Run the following commands to set permissions and ownership for /etc/at.allow: <pre><code># chmod g-wx,o-rwx /etc/at.allow\n# chown root:root /etc/at.allow\n</code></pre></p>","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","Configure time-based job schedulers","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1053","T1053.003","TA0002","M1018"]},{"location":"5-Access-Authentication-and-Authorization/5.2-Configure-SSH-Server/5.2.1-Ensure-permissions-on-etc-ssh-sshd_config-are-configured/","title":"5.2.1 Ensure permissions on /etc/ssh/sshd_config are configured","text":"","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","Configure SSH Server","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1098","T1098.004","T1543","T1543.002","TA0005","M1022"]},{"location":"5-Access-Authentication-and-Authorization/5.2-Configure-SSH-Server/5.2.1-Ensure-permissions-on-etc-ssh-sshd_config-are-configured/#audit","title":"Audit","text":"<p>Run the following command and verify Uid and Gid are both 0/root and Access does not grant permissions to group or other: <pre><code># stat /etc/ssh/sshd_config\n</code></pre></p> <p>Verify the output matches: <pre><code>Access: (0600/-rw-------) Uid: ( 0/ root) Gid: ( 0/ root)\n</code></pre></p>","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","Configure SSH Server","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1098","T1098.004","T1543","T1543.002","TA0005","M1022"]},{"location":"5-Access-Authentication-and-Authorization/5.2-Configure-SSH-Server/5.2.1-Ensure-permissions-on-etc-ssh-sshd_config-are-configured/#remediation","title":"Remediation","text":"<p>Run the following commands to set ownership and permissions on /etc/ssh/sshd_config: <pre><code># chown root:root /etc/ssh/sshd_config\n# chmod og-rwx /etc/ssh/sshd_config\n</code></pre></p>","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","Configure SSH Server","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1098","T1098.004","T1543","T1543.002","TA0005","M1022"]},{"location":"5-Access-Authentication-and-Authorization/5.2-Configure-SSH-Server/5.2.10-Ensure-SSH-PermitUserEnvironment-is-disabled/","title":"5.2.10 Ensure SSH PermitUserEnvironment is disabled","text":"","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","Configure SSH Server","Automated","IG1","IG2","IG3","4.1 Establish and Maintain a Secure Configuration Process","T1021","TA0008","M1042"]},{"location":"5-Access-Authentication-and-Authorization/5.2-Configure-SSH-Server/5.2.10-Ensure-SSH-PermitUserEnvironment-is-disabled/#audit","title":"Audit","text":"<p>Run the following command: <pre><code># sshd -T -C user=root -C host=\"$(hostname)\" -C addr=\"$(grep $(hostname) /etc/hosts | awk '{print $1}')\" | grep permituserenvironment\n</code></pre></p> <p>Verify the output matches: <pre><code>permituserenvironment no\n</code></pre></p> <p>Run the following command and verify the output: <pre><code># grep -Ei '^\\s*PermitUserEnvironment\\s+yes' /etc/ssh/sshd_config\n</code></pre></p> <p>Nothing should be returned.</p>","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","Configure SSH Server","Automated","IG1","IG2","IG3","4.1 Establish and Maintain a Secure Configuration Process","T1021","TA0008","M1042"]},{"location":"5-Access-Authentication-and-Authorization/5.2-Configure-SSH-Server/5.2.10-Ensure-SSH-PermitUserEnvironment-is-disabled/#remediation","title":"Remediation","text":"<p>Edit the /etc/ssh/sshd_config file to set the parameter as follows: <pre><code>PermitUserEnvironment no\n</code></pre></p> <p>Default Value:</p> <p>PermitUserEnvironment no</p>","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","Configure SSH Server","Automated","IG1","IG2","IG3","4.1 Establish and Maintain a Secure Configuration Process","T1021","TA0008","M1042"]},{"location":"5-Access-Authentication-and-Authorization/5.2-Configure-SSH-Server/5.2.11-Ensure-SSH-IgnoreRhosts-is-enabled/","title":"5.2.11 Ensure SSH IgnoreRhosts is enabled","text":"","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","Configure SSH Server","Automated","IG1","IG2","IG3","4.1 Establish and Maintain a Secure Configuration Process","T1078","T1078.001","T1078.003","TA0001","M1027"]},{"location":"5-Access-Authentication-and-Authorization/5.2-Configure-SSH-Server/5.2.11-Ensure-SSH-IgnoreRhosts-is-enabled/#audit","title":"Audit","text":"<p>Run the following command: <pre><code># sshd -T -C user=root -C host=\"$(hostname)\" -C addr=\"$(grep $(hostname) /etc/hosts | awk '{print $1}')\" | grep ignorerhosts\n</code></pre></p> <p>Verify the output matches: <pre><code>ignorerhosts yes\n</code></pre></p> <p>Run the following command: <pre><code># grep -Ei '^\\s*ignorerhosts\\s+no\\b' /etc/ssh/sshd_config\n</code></pre></p> <p>Nothing should be returned.</p>","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","Configure SSH Server","Automated","IG1","IG2","IG3","4.1 Establish and Maintain a Secure Configuration Process","T1078","T1078.001","T1078.003","TA0001","M1027"]},{"location":"5-Access-Authentication-and-Authorization/5.2-Configure-SSH-Server/5.2.11-Ensure-SSH-IgnoreRhosts-is-enabled/#remediation","title":"Remediation","text":"<p>Edit the /etc/ssh/sshd_config file to set the parameter as follows: <pre><code>IgnoreRhosts yes\n</code></pre></p> <p>Default Value:</p> <p>IgnoreRhosts yes</p>","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","Configure SSH Server","Automated","IG1","IG2","IG3","4.1 Establish and Maintain a Secure Configuration Process","T1078","T1078.001","T1078.003","TA0001","M1027"]},{"location":"5-Access-Authentication-and-Authorization/5.2-Configure-SSH-Server/5.2.12-Ensure-SSH-X11-forwarding-is-disabled/","title":"5.2.12 Ensure SSH X11 forwarding is disabled","text":"","tags":["Level 1","Level 2","Workstation","Server","Access, Authentication and Authorization","Configure SSH Server","Automated","IG2","IG3","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","T1210","TA0008","M1042"]},{"location":"5-Access-Authentication-and-Authorization/5.2-Configure-SSH-Server/5.2.12-Ensure-SSH-X11-forwarding-is-disabled/#audit","title":"Audit","text":"<p>Run the following command: <pre><code># sshd -T -C user=root -C host=\"$(hostname)\" -C addr=\"$(grep $(hostname) /etc/hosts | awk '{print $1}')\" | grep -i x11forwarding\n</code></pre></p> <p>Verify the output matches: <pre><code>x11forwarding no\n</code></pre></p> <p>Run the following command: <pre><code># grep -Ei '^\\s*x11forwarding\\s+yes' /etc/ssh/sshd_config\n</code></pre></p> <p>Nothing is returned.</p>","tags":["Level 1","Level 2","Workstation","Server","Access, Authentication and Authorization","Configure SSH Server","Automated","IG2","IG3","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","T1210","TA0008","M1042"]},{"location":"5-Access-Authentication-and-Authorization/5.2-Configure-SSH-Server/5.2.12-Ensure-SSH-X11-forwarding-is-disabled/#remediation","title":"Remediation","text":"<p>Edit the /etc/ssh/sshd_config file to set the parameter as follows: <pre><code>X11Forwarding no\n</code></pre></p>","tags":["Level 1","Level 2","Workstation","Server","Access, Authentication and Authorization","Configure SSH Server","Automated","IG2","IG3","4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","T1210","TA0008","M1042"]},{"location":"5-Access-Authentication-and-Authorization/5.2-Configure-SSH-Server/5.2.13-Ensure-only-strong-Ciphers-are-used/","title":"5.2.13 Ensure only strong Ciphers are used","text":"","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","Configure SSH Server","Automated","IG2","IG3","3.10 Encrypt Sensitive Data in Transit","T1040","T1557","TA0006","M1041"]},{"location":"5-Access-Authentication-and-Authorization/5.2-Configure-SSH-Server/5.2.13-Ensure-only-strong-Ciphers-are-used/#audit","title":"Audit","text":"<p>Run the following command: <pre><code># sshd -T -C user=root -C host=\"$(hostname)\" -C addr=\"$(grep $(hostname) /etc/hosts | awk '{print $1}')\" | grep ciphers\n</code></pre></p> <p>Verify that output does not contain any of the following weak ciphers: <pre><code>3des-cbc\naes128-cbc\naes192-cbc\naes256-cbc\n</code></pre></p>","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","Configure SSH Server","Automated","IG2","IG3","3.10 Encrypt Sensitive Data in Transit","T1040","T1557","TA0006","M1041"]},{"location":"5-Access-Authentication-and-Authorization/5.2-Configure-SSH-Server/5.2.13-Ensure-only-strong-Ciphers-are-used/#remediation","title":"Remediation","text":"<p>Edit the /etc/ssh/sshd_config file add/modify the Ciphers line to contain a comma separated list of the site approved ciphers.</p> <p>Example: <pre><code>Ciphers chacha20-poly1305@openssh.com,aes256-gcm@openssh.com,aes128-gcm@openssh.com,aes256-ctr,aes192-ctr,aes128-ctr\n</code></pre></p> <p>Default Value:</p> <p>Ciphers chacha20-poly1305@openssh.com,aes128-ctr,aes192-ctr,aes256-ctr,aes128-gcm@openssh.com,aes256-gcm@openssh.com</p>","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","Configure SSH Server","Automated","IG2","IG3","3.10 Encrypt Sensitive Data in Transit","T1040","T1557","TA0006","M1041"]},{"location":"5-Access-Authentication-and-Authorization/5.2-Configure-SSH-Server/5.2.14-Ensure-only-strong-MAC-algorithms-are-used/","title":"5.2.14 Ensure only strong MAC algorithms are used","text":"","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","Configure SSH Server","Automated","IG2","IG3","3.10 Encrypt Sensitive Data in Transit","T1040","T1557","TA0006","M1041"]},{"location":"5-Access-Authentication-and-Authorization/5.2-Configure-SSH-Server/5.2.14-Ensure-only-strong-MAC-algorithms-are-used/#audit","title":"Audit","text":"<p>Run the following command: <pre><code># sshd -T -C user=root -C host=\"$(hostname)\" -C addr=\"$(grep $(hostname) /etc/hosts | awk '{print $1}')\" | grep -i \"MACs\"\n</code></pre></p> <p>Verify that output does not contain any of the listed weak MAC algorithms: <pre><code>hmac-md5\nhmac-md5-96\nhmac-ripemd160\nhmac-sha1\nhmac-sha1-96\numac-64@openssh.com\numac-128@openssh.com\nhmac-md5-etm@openssh.com\nhmac-md5-96-etm@openssh.com\nhmac-ripemd160-etm@openssh.com\nhmac-sha1-etm@openssh.com\nhmac-sha1-96-etm@openssh.com\numac-64-etm@openssh.com\numac-128-etm@openssh.com\n</code></pre></p>","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","Configure SSH Server","Automated","IG2","IG3","3.10 Encrypt Sensitive Data in Transit","T1040","T1557","TA0006","M1041"]},{"location":"5-Access-Authentication-and-Authorization/5.2-Configure-SSH-Server/5.2.14-Ensure-only-strong-MAC-algorithms-are-used/#remediation","title":"Remediation","text":"<p>Edit the /etc/ssh/sshd_config file and add/modify the MACs line to contain a comma separated list of the site approved MACs.</p> <p>Example: <pre><code>MACs hmac-sha2-512-etm@openssh.com,hmac-sha2-256-etm@openssh.com,hmac-sha2-512,hmac-sha2-256\n</code></pre></p> <p>Default Value:</p> <p>MACs umac-64-etm@openssh.com,umac-128-etm@openssh.com,hmac-sha2-256-etm@openssh.com,hmac-sha2-512-etm@openssh.com,hmac-sha1- etm@openssh.com,umac-64@openssh.com,umac-128@openssh.com,hmac-sha2-256,hmac-sha2-512,hmac-sha1</p>","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","Configure SSH Server","Automated","IG2","IG3","3.10 Encrypt Sensitive Data in Transit","T1040","T1557","TA0006","M1041"]},{"location":"5-Access-Authentication-and-Authorization/5.2-Configure-SSH-Server/5.2.15-Ensure-only-strong-Key-Exchange-algorithms-are-used/","title":"5.2.15 Ensure only strong Key Exchange algorithms are used","text":"","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","Configure SSH Server","Automated","IG2","IG3","3.10 Encrypt Sensitive Data in Transit","T1040","T1557","TA0006","M1041"]},{"location":"5-Access-Authentication-and-Authorization/5.2-Configure-SSH-Server/5.2.15-Ensure-only-strong-Key-Exchange-algorithms-are-used/#audit","title":"Audit","text":"<p>Run the following command and verify that output does not contain any of the listed weak Key Exchange algorithms <pre><code># sshd -T -C user=root -C host=\"$(hostname)\" -C addr=\"$(grep $(hostname) /etc/hosts | awk '{print $1}')\" | grep kexalgorithms\n</code></pre></p> <p>Weak Key Exchange Algorithms: <pre><code>diffie-hellman-group1-sha1\ndiffie-hellman-group14-sha1\ndiffie-hellman-group-exchange-sha1\n</code></pre></p>","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","Configure SSH Server","Automated","IG2","IG3","3.10 Encrypt Sensitive Data in Transit","T1040","T1557","TA0006","M1041"]},{"location":"5-Access-Authentication-and-Authorization/5.2-Configure-SSH-Server/5.2.15-Ensure-only-strong-Key-Exchange-algorithms-are-used/#remediation","title":"Remediation","text":"<p>Edit the /etc/ssh/sshd_config file add/modify the KexAlgorithms line to contain a comma separated list of the site approved key exchange algorithms</p> <p>Example: <pre><code>KexAlgorithms curve25519-sha256,curve25519-sha256@libssh.org,diffie-hellman-group14-sha256,diffie-hellman-group16-sha512,diffie-hellman-group18-sha512,ecdh-sha2-nistp521,ecdh-sha2-nistp384,ecdh-sha2-nistp256,diffie-hellman-group-exchange-sha256\n</code></pre></p> <p>Default Value:</p> <p>KexAlgorithms curve25519-sha256,curve25519-sha256@libssh.org,ecdh-sha2-nistp256,ecdh-sha2-nistp384,ecdh-sha2-nistp521,diffie-hellman-group-exchangesha256,diffie-hellman-group16-sha512,diffie-hellman-group18-sha512,diffie-hellmangroup14-sha256</p>","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","Configure SSH Server","Automated","IG2","IG3","3.10 Encrypt Sensitive Data in Transit","T1040","T1557","TA0006","M1041"]},{"location":"5-Access-Authentication-and-Authorization/5.2-Configure-SSH-Server/5.2.16-Ensure-SSH-AllowTcpForwarding-is-disabled/","title":"5.2.16 Ensure SSH AllowTcpForwarding is disabled","text":"","tags":["Level 2","Workstation","Server","Access, Authentication and Authorization","Configure SSH Server","Automated","IG1","IG2","IG3","4.1 Establish and Maintain a Secure Configuration Process","T1048","T1048.002","T1572","TA0008","M1042"]},{"location":"5-Access-Authentication-and-Authorization/5.2-Configure-SSH-Server/5.2.16-Ensure-SSH-AllowTcpForwarding-is-disabled/#audit","title":"Audit","text":"<p>Run the following command: <pre><code># sshd -T -C user=root -C host=\"$(hostname)\" -C addr=\"$(grep $(hostname) /etc/hosts | awk '{print $1}')\" | grep -i allowtcpforwarding\n</code></pre></p> <p>Verify the output matches: <pre><code>allowtcpforwarding no\n</code></pre></p> <p>Run the following command: <pre><code># grep -Ei '^\\s*AllowTcpForwarding\\s+yes' /etc/ssh/sshd_config\n</code></pre></p> <p>Nothing should be returned</p>","tags":["Level 2","Workstation","Server","Access, Authentication and Authorization","Configure SSH Server","Automated","IG1","IG2","IG3","4.1 Establish and Maintain a Secure Configuration Process","T1048","T1048.002","T1572","TA0008","M1042"]},{"location":"5-Access-Authentication-and-Authorization/5.2-Configure-SSH-Server/5.2.16-Ensure-SSH-AllowTcpForwarding-is-disabled/#remediation","title":"Remediation","text":"<p>Edit the /etc/ssh/sshd_config file to set the parameter as follows: <pre><code>AllowTcpForwarding no\n</code></pre></p> <p>Default Value: <pre><code>AllowTcpForwarding yes\n</code></pre></p>","tags":["Level 2","Workstation","Server","Access, Authentication and Authorization","Configure SSH Server","Automated","IG1","IG2","IG3","4.1 Establish and Maintain a Secure Configuration Process","T1048","T1048.002","T1572","TA0008","M1042"]},{"location":"5-Access-Authentication-and-Authorization/5.2-Configure-SSH-Server/5.2.17-Ensure-SSH-warning-banner-is-configured/","title":"5.2.17 Ensure SSH warning banner is configured","text":"","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","Configure SSH Server","Automated","IG1","IG2","IG3","4.1 Establish and Maintain a Secure Configuration Process","TA0001","TA0007","M1035"]},{"location":"5-Access-Authentication-and-Authorization/5.2-Configure-SSH-Server/5.2.17-Ensure-SSH-warning-banner-is-configured/#audit","title":"Audit","text":"<p>Run the following command: <pre><code># sshd -T -C user=root -C host=\"$(hostname)\" -C addr=\"$(grep $(hostname) /etc/hosts | awk '{print $1}')\" | grep banner\n</code></pre></p> <p>Verify the output matches: <pre><code>banner /etc/issue.net\n</code></pre></p>","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","Configure SSH Server","Automated","IG1","IG2","IG3","4.1 Establish and Maintain a Secure Configuration Process","TA0001","TA0007","M1035"]},{"location":"5-Access-Authentication-and-Authorization/5.2-Configure-SSH-Server/5.2.17-Ensure-SSH-warning-banner-is-configured/#remediation","title":"Remediation","text":"<p>Edit the /etc/ssh/sshd_config file to set the parameter as follows: <pre><code>Banner /etc/issue.net\n</code></pre></p>","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","Configure SSH Server","Automated","IG1","IG2","IG3","4.1 Establish and Maintain a Secure Configuration Process","TA0001","TA0007","M1035"]},{"location":"5-Access-Authentication-and-Authorization/5.2-Configure-SSH-Server/5.2.18-Ensure-SSH-MaxAuthTries-is-set-to-4-or-less/","title":"5.2.18 Ensure SSH MaxAuthTries is set to 4 or less","text":"","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","Configure SSH Server","Automated","IG2","IG3","8.5 Collect Detailed Audit Logs","T1110","T1110.001","T1110.003","TA0006","M1036"]},{"location":"5-Access-Authentication-and-Authorization/5.2-Configure-SSH-Server/5.2.18-Ensure-SSH-MaxAuthTries-is-set-to-4-or-less/#audit","title":"Audit","text":"<p>Run the following command and verify that output MaxAuthTries is 4 or less: <pre><code># sshd -T -C user=root -C host=\"$(hostname)\" -C addr=\"$(grep $(hostname) /etc/hosts | awk '{print $1}')\" | grep maxauthtries\nmaxauthtries 4\n</code></pre></p> <p>Run the following command and verify that the output: <pre><code># grep -Ei '^\\s*maxauthtries\\s+([5-9]|[1-9][0-9]+)' /etc/ssh/sshd_config\n</code></pre></p> <p>Nothing is returned</p>","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","Configure SSH Server","Automated","IG2","IG3","8.5 Collect Detailed Audit Logs","T1110","T1110.001","T1110.003","TA0006","M1036"]},{"location":"5-Access-Authentication-and-Authorization/5.2-Configure-SSH-Server/5.2.18-Ensure-SSH-MaxAuthTries-is-set-to-4-or-less/#remediation","title":"Remediation","text":"<p>Edit the /etc/ssh/sshd_config file to set the parameter as follows: <pre><code>MaxAuthTries 4\n</code></pre></p> <p>Default Value:</p> <p>MaxAuthTries 6</p>","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","Configure SSH Server","Automated","IG2","IG3","8.5 Collect Detailed Audit Logs","T1110","T1110.001","T1110.003","TA0006","M1036"]},{"location":"5-Access-Authentication-and-Authorization/5.2-Configure-SSH-Server/5.2.19-Ensure-SSH-MaxStartups-is-configured/","title":"5.2.19 Ensure SSH MaxStartups is configured","text":"","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","Configure SSH Server","Automated","IG2","IG3","4.1 Establish and Maintain a Secure Configuration Process","T1499","T1499.002","TA0040"]},{"location":"5-Access-Authentication-and-Authorization/5.2-Configure-SSH-Server/5.2.19-Ensure-SSH-MaxStartups-is-configured/#audit","title":"Audit","text":"<p>Run the following command: <pre><code># sshd -T -C user=root -C host=\"$(hostname)\" -C addr=\"$(grep $(hostname) /etc/hosts | awk '{print $1}')\" | grep -i maxstartups\n</code></pre></p> <p>Verify that output MaxStartups is 10:30:60 or more restrictive: <pre><code>maxstartups 10:30:60\n</code></pre></p> <p>Run the following command and verify the output: <pre><code># grep -Ei '^\\s*maxstartups\\s+(((1[1-9]|[1-9][0-9][0-9]+):([0-9]+):([0-9]+))|(([0-9]+):(3[1-9]|[4-9][0-9]|[1-9][0-9][0-9]+):([0-9]+))|(([0-9]+):([0-9]+):(6[1-9]|[7-9][0-9]|[1-9][0-9][0-9]+)))' /etc/ssh/sshd_config\n</code></pre></p> <p>Nothing should be returned.</p>","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","Configure SSH Server","Automated","IG2","IG3","4.1 Establish and Maintain a Secure Configuration Process","T1499","T1499.002","TA0040"]},{"location":"5-Access-Authentication-and-Authorization/5.2-Configure-SSH-Server/5.2.19-Ensure-SSH-MaxStartups-is-configured/#remediation","title":"Remediation","text":"<p>Edit the /etc/ssh/sshd_config file to set the parameter as follows: <pre><code>MaxStartups 10:30:60\n</code></pre></p> <p>Default Value:</p> <p>MaxStartups 10:30:100</p>","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","Configure SSH Server","Automated","IG2","IG3","4.1 Establish and Maintain a Secure Configuration Process","T1499","T1499.002","TA0040"]},{"location":"5-Access-Authentication-and-Authorization/5.2-Configure-SSH-Server/5.2.2-Ensure-permissions-on-SSH-private-host-key-files-are-configured/","title":"5.2.2 Ensure permissions on SSH private host key files are configured","text":"","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","Configure SSH Server","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1552","T1552.004","TA0003","TA0006","M1022"]},{"location":"5-Access-Authentication-and-Authorization/5.2-Configure-SSH-Server/5.2.2-Ensure-permissions-on-SSH-private-host-key-files-are-configured/#audit","title":"Audit","text":"<p>Run the following script to verify SSH private host key files are mode 0600 or more restrictive, owned be the root user, and owned be the group root or group designated to own openSSH private keys: <pre><code>#!/usr/bin/env bash\n{\nl_output=\"\"\nl_skgn=\"ssh_keys\" # Group designated to own openSSH keys\nl_skgid=\"$(awk -F: '($1 == \"'\"$l_skgn\"'\"){print $3}' /etc/group)\"\nawk '{print}' &lt;&lt;&lt; \"$(find /etc/ssh -xdev -type f -name 'ssh_host_*_key' -exec stat -L -c \"%n %#a %U %G %g\" {} +)\" | (while read -r l_file l_mode l_owner l_group l_gid; do\n[ -n \"$l_skgid\" ] &amp;&amp; l_cga=\"$l_skgn\" || l_cga=\"root\"\n[ \"$l_gid\" = \"$l_skgid\" ] &amp;&amp; l_pmask=\"0137\" || l_pmask=\"0177\"\nl_maxperm=\"$( printf '%o' $(( 0777 &amp; ~$l_pmask )) )\"\n[ $(( $l_mode &amp; $l_pmask )) -gt 0 ] &amp;&amp; l_output=\"$l_output\\n - File: \\\"$l_file\\\" is mode \\\"$l_mode\\\" should be mode: \\\"$l_maxperm\\\" or more restrictive\"\n[ \"$l_owner\" != \"root\" ] &amp;&amp; l_output=\"$l_output\\n - File: \\\"$l_file\\\" is owned by: \\\"$l_owner\\\" should be owned by \\\"root\\\"\"\nif [ \"$l_group\" != \"root\" ] &amp;&amp; [ \"$l_gid\" != \"$l_skgid\" ]; then\nl_output=\"$l_output\\n - File: \\\"$l_file\\\" is owned by group \\\"$l_group\\\" should belong to group \\\"$l_cga\\\"\"\nfi\ndone\nif [ -z \"$l_output\" ]; then\necho -e \"\\n- Audit Result:\\n *** PASS ***\\n\"\nelse\necho -e \"\\n- Audit Result:\\n *** FAIL ***$l_output\\n\"\nfi\n)\n}\n</code></pre></p>","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","Configure SSH Server","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1552","T1552.004","TA0003","TA0006","M1022"]},{"location":"5-Access-Authentication-and-Authorization/5.2-Configure-SSH-Server/5.2.2-Ensure-permissions-on-SSH-private-host-key-files-are-configured/#remediation","title":"Remediation","text":"<p>Run the following script to set mode, ownership, and group on the private SSH host key files: <pre><code>#!/usr/bin/env bash\n{\nl_skgn=\"ssh_keys\" # Group designated to own openSSH keys\nl_skgid=\"$(awk -F: '($1 == \"'\"$l_skgn\"'\"){print $3}' /etc/group)\"\nawk '{print}' &lt;&lt;&lt; \"$(find /etc/ssh -xdev -type f -name 'ssh_host_*_key' -exec stat -L -c \"%n %#a %U %G %g\" {} +)\" | (while read -r l_file l_mode l_owner l_group l_gid; do\n[ -n \"$l_skgid\" ] &amp;&amp; l_cga=\"$l_skgn\" || l_cga=\"root\"\n[ \"$l_gid\" = \"$l_skgid\" ] &amp;&amp; l_pmask=\"0137\" || l_pmask=\"0177\"\nl_maxperm=\"$( printf '%o' $(( 0777 &amp; ~$l_pmask )) )\"\nif [ $(( $l_mode &amp; $l_pmask )) -gt 0 ]; then\necho -e \" - File: \\\"$l_file\\\" is mode \\\"$l_mode\\\" changing to mode: \\\"$l_maxperm\\\"\"\nif [ -n \"$l_skgid\" ]; then\nchmod u-x,g-wx,o-rwx \"$l_file\"\nelse\nchmod u-x,go-rwx \"$l_file\"\nfi\nfi\nif [ \"$l_owner\" != \"root\" ]; then\necho -e \" - File: \\\"$l_file\\\" is owned by: \\\"$l_owner\\\" changing owner to \\\"root\\\"\"\nchown root \"$l_file\"\nfi\nif [ \"$l_group\" != \"root\" ] &amp;&amp; [ \"$l_gid\" != \"$l_skgid\" ]; then\necho -e \" - File: \\\"$l_file\\\" is owned by group \\\"$l_group\\\" should belong to group \\\"$l_cga\\\"\"\nchgrp \"$l_cga\" \"$l_file\"\nfi\ndone\n)\n}\n</code></pre></p>","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","Configure SSH Server","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1552","T1552.004","TA0003","TA0006","M1022"]},{"location":"5-Access-Authentication-and-Authorization/5.2-Configure-SSH-Server/5.2.20-Ensure-SSH-MaxSessions-is-set-to-10-or-less/","title":"5.2.20 Ensure SSH MaxSessions is set to 10 or less","text":"","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","Configure SSH Server","Automated","T1499","T1499.002","TA0040"]},{"location":"5-Access-Authentication-and-Authorization/5.2-Configure-SSH-Server/5.2.20-Ensure-SSH-MaxSessions-is-set-to-10-or-less/#audit","title":"Audit","text":"<p>Run the following command and verify that output MaxSessions is 10 or less: <pre><code># sshd -T -C user=root -C host=\"$(hostname)\" -C addr=\"$(grep $(hostname) /etc/hosts | awk '{print $1}')\" | grep -i maxsessions\nmaxsessions 10\n</code></pre></p> <p>Run the following command and verify the output: <pre><code>grep -Ei '^\\s*MaxSessions\\s+(1[1-9]|[2-9][0-9]|[1-9][0-9][0-9]+)' /etc/ssh/sshd_config\n</code></pre></p> <p>Nothing should be returned</p>","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","Configure SSH Server","Automated","T1499","T1499.002","TA0040"]},{"location":"5-Access-Authentication-and-Authorization/5.2-Configure-SSH-Server/5.2.20-Ensure-SSH-MaxSessions-is-set-to-10-or-less/#remediation","title":"Remediation","text":"<p>Edit the /etc/ssh/sshd_config file to set the parameter as follows: <pre><code>MaxSessions 10\n</code></pre></p> <p>Default Value:</p> <p>MaxSessions 10</p>","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","Configure SSH Server","Automated","T1499","T1499.002","TA0040"]},{"location":"5-Access-Authentication-and-Authorization/5.2-Configure-SSH-Server/5.2.21-Ensure-SSH-LoginGraceTime-is-set-to-one-minute-or-less/","title":"5.2.21 Ensure SSH LoginGraceTime is set to one minute or less","text":"","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","Configure SSH Server","Automated","IG1","IG2","IG3","4.1 Establish and Maintain a Secure Configuration Process","T1110","T1110.003","T1110.004","T1499","T1499.002","TA0006","M1036"]},{"location":"5-Access-Authentication-and-Authorization/5.2-Configure-SSH-Server/5.2.21-Ensure-SSH-LoginGraceTime-is-set-to-one-minute-or-less/#audit","title":"Audit","text":"<p>Run the following command and verify that output LoginGraceTime is between 1 and 60 seconds or 1m: <pre><code># sshd -T -C user=root -C host=\"$(hostname)\" -C addr=\"$(grep $(hostname) /etc/hosts | awk '{print $1}')\" | grep logingracetime\n</code></pre></p> <p>Verify the output matches: <pre><code>logingracetime 60\n</code></pre></p> <p>Run the following command and verify the output: <pre><code># grep -Ei '^\\s*LoginGraceTime\\s+(0|6[1-9]|[7-9][0-9]|[1-9][0-9][0-9]+|[^1]m)' /etc/ssh/sshd_config\n</code></pre></p> <p>Nothing should be returned.</p>","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","Configure SSH Server","Automated","IG1","IG2","IG3","4.1 Establish and Maintain a Secure Configuration Process","T1110","T1110.003","T1110.004","T1499","T1499.002","TA0006","M1036"]},{"location":"5-Access-Authentication-and-Authorization/5.2-Configure-SSH-Server/5.2.21-Ensure-SSH-LoginGraceTime-is-set-to-one-minute-or-less/#remediation","title":"Remediation","text":"<p>Edit the /etc/ssh/sshd_config file to set the parameter as follows: <pre><code>LoginGraceTime 60\n</code></pre></p> <p>Default Value:</p> <p>LoginGraceTime 120</p>","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","Configure SSH Server","Automated","IG1","IG2","IG3","4.1 Establish and Maintain a Secure Configuration Process","T1110","T1110.003","T1110.004","T1499","T1499.002","TA0006","M1036"]},{"location":"5-Access-Authentication-and-Authorization/5.2-Configure-SSH-Server/5.2.22-Ensure-SSH-Idle-Timeout-Interval-is-configured/","title":"5.2.22 Ensure SSH Idle Timeout Interval is configured","text":"","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","Configure SSH Server","Automated","T1078","T1078.001","T1078.002","T1078.003","TA0001","M1026"]},{"location":"5-Access-Authentication-and-Authorization/5.2-Configure-SSH-Server/5.2.22-Ensure-SSH-Idle-Timeout-Interval-is-configured/#audit","title":"Audit","text":"<p>Run the following commands and verify ClientAliveInterval is greater than zero: <pre><code># sshd -T -C user=root -C host=\"$(hostname)\" -C addr=\"$(grep $(hostname) /etc/hosts | awk '{print $1}')\" | grep clientaliveinterval\n</code></pre></p> <p>Example output: <pre><code>clientaliveinterval 15\n</code></pre></p> <p>Run the following command and verify ClientAliveCountMax is greater than zero: <pre><code># sshd -T -C user=root -C host=\"$(hostname)\" -C addr=\"$(grep $(hostname) /etc/hosts | awk '{print $1}')\" | grep clientalivecountmax\n</code></pre></p> <p>Example output: <pre><code>clientalivecountmax 3\n</code></pre></p>","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","Configure SSH Server","Automated","T1078","T1078.001","T1078.002","T1078.003","TA0001","M1026"]},{"location":"5-Access-Authentication-and-Authorization/5.2-Configure-SSH-Server/5.2.22-Ensure-SSH-Idle-Timeout-Interval-is-configured/#remediation","title":"Remediation","text":"<p>Edit the /etc/ssh/sshd_config file to set the parameters according to site policy.</p> <p>Example: <pre><code>ClientAliveInterval 15\nClientAliveCountMax 3\n</code></pre></p> <p>Default Value:</p> <p>ClientAliveInterval 0</p> <p>ClientAliveCountMax 3</p>","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","Configure SSH Server","Automated","T1078","T1078.001","T1078.002","T1078.003","TA0001","M1026"]},{"location":"5-Access-Authentication-and-Authorization/5.2-Configure-SSH-Server/5.2.3-Ensure-permissions-on-SSH-public-host-key-files-are-configured/","title":"5.2.3 Ensure permissions on SSH public host key files are configured","text":"","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","Configure SSH Server","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1557","TA0003","TA0006","M1022"]},{"location":"5-Access-Authentication-and-Authorization/5.2-Configure-SSH-Server/5.2.3-Ensure-permissions-on-SSH-public-host-key-files-are-configured/#audit","title":"Audit","text":"<p>Run the following command and verify Access does not grant write or execute permissions to group or other for all returned files: <pre><code># find /etc/ssh -xdev -type f -name 'ssh_host_*_key.pub' -exec stat {} \\;\n</code></pre></p> <p>Example output: <pre><code> File: \u2018/etc/ssh/ssh_host_rsa_key.pub\u2019\n Size: 382 Blocks: 8 IO Block: 4096 regular file\nDevice: ca01h/51713d Inode: 8631758 Links: 1\nAccess: (0644/-rw-r--r--) Uid: ( 0/ root) Gid: ( 0/ root)\nAccess: 2018-10-22 18:24:56.861750616 +0000\nModify: 2018-10-22 18:24:56.861750616 +0000\nChange: 2018-10-22 18:24:56.881750616 +0000\nBirth: -\n File: \u2018/etc/ssh/ssh_host_ecdsa_key.pub\u2019\n Size: 162 Blocks: 8 IO Block: 4096 regular file\nDevice: ca01h/51713d Inode: 8631761 Links: 1\nAccess: (0644/-rw-r--r--) Uid: ( 0/ root) Gid: ( 0/ root)\nAccess: 2018-10-22 18:24:56.897750616 +0000\nModify: 2018-10-22 18:24:56.897750616 +0000\nChange: 2018-10-22 18:24:56.917750616 +0000\nBirth: -\n File: \u2018/etc/ssh/ssh_host_ed25519_key.pub\u2019\n Size: 82 Blocks: 8 IO Block: 4096 regular file\nDevice: ca01h/51713d Inode: 8631763 Links: 1\nAccess: (0644/-rw-r--r--) Uid: ( 0/ root) Gid: ( 0/ root)\nAccess: 2018-10-22 18:24:56.945750616 +0000\nModify: 2018-10-22 18:24:56.945750616 +0000\nChange: 2018-10-22 18:24:56.961750616 +0000\nBirth: -\n</code></pre></p>","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","Configure SSH Server","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1557","TA0003","TA0006","M1022"]},{"location":"5-Access-Authentication-and-Authorization/5.2-Configure-SSH-Server/5.2.3-Ensure-permissions-on-SSH-public-host-key-files-are-configured/#remediation","title":"Remediation","text":"<p>Run the following commands to set permissions and ownership on the SSH host public key files <pre><code># find /etc/ssh -xdev -type f -name 'ssh_host_*_key.pub' -exec chmod u-x,gowx {} \\;\n# find /etc/ssh -xdev -type f -name 'ssh_host_*_key.pub' -exec chown root:root {} \\;\n</code></pre></p> <p>Default Value:</p> <p>Access: (0644/-rw-r--r--) Uid: ( 0/ root) Gid: ( 0/ root)</p>","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","Configure SSH Server","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1557","TA0003","TA0006","M1022"]},{"location":"5-Access-Authentication-and-Authorization/5.2-Configure-SSH-Server/5.2.4-Ensure-SSH-access-is-limited/","title":"5.2.4 Ensure SSH access is limited","text":"","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","Configure SSH Server","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1021","T1021.004","TA0008","M1018"]},{"location":"5-Access-Authentication-and-Authorization/5.2-Configure-SSH-Server/5.2.4-Ensure-SSH-access-is-limited/#audit","title":"Audit","text":"<p>Run the following commands and verify the output: <pre><code># sshd -T -C user=root -C host=\"$(hostname)\" -C addr=\"$(grep $(hostname) /etc/hosts | awk '{print $1}')\" | grep -Pi '^\\h*(allow|deny)(users|groups)\\h+\\H+(\\h+.*)?$'\n# grep -Pi '^\\h*(allow|deny)(users|groups)\\h+\\H+(\\h+.*)?$' /etc/ssh/sshd_config\n</code></pre></p> <p>Verify that the output of both commands matches at least one of the following lines: <pre><code>allowusers &lt;userlist&gt;\nallowgroups &lt;grouplist&gt;\ndenyusers &lt;userlist&gt;\ndenygroups &lt;grouplist&gt;\n</code></pre></p>","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","Configure SSH Server","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1021","T1021.004","TA0008","M1018"]},{"location":"5-Access-Authentication-and-Authorization/5.2-Configure-SSH-Server/5.2.4-Ensure-SSH-access-is-limited/#remediation","title":"Remediation","text":"<p>Edit the /etc/ssh/sshd_config file to set one or more of the parameter as follows: <pre><code>AllowUsers &lt;userlist&gt;\n</code></pre></p> <p>OR</p> <pre><code>AllowGroups &lt;grouplist&gt;\n</code></pre> <p>OR</p> <pre><code>DenyUsers &lt;userlist&gt;\n</code></pre> <p>OR</p> <pre><code>DenyGroups &lt;grouplist&gt;\n</code></pre> <p>Default Value:</p> <p>None</p>","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","Configure SSH Server","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1021","T1021.004","TA0008","M1018"]},{"location":"5-Access-Authentication-and-Authorization/5.2-Configure-SSH-Server/5.2.5-Ensure-SSH-LogLevel-is-appropriate/","title":"5.2.5 Ensure SSH LogLevel is appropriate","text":"","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","Configure SSH Server","Automated","IG1","IG2","IG3","8.2 Collect Audit Logs","T1562","T1562.006","TA0005"]},{"location":"5-Access-Authentication-and-Authorization/5.2-Configure-SSH-Server/5.2.5-Ensure-SSH-LogLevel-is-appropriate/#audit","title":"Audit","text":"<p>Run the following command and verify that output matches loglevel VERBOSE or loglevel INFO: <pre><code># sshd -T -C user=root -C host=\"$(hostname)\" -C addr=\"$(grep $(hostname) /etc/hosts | awk '{print $1}')\" | grep loglevel\nloglevel VERBOSE or loglevel INFO\n</code></pre></p> <p>Run the following command and verify the output matches: <pre><code># grep -i 'loglevel' /etc/ssh/sshd_config | grep -Evi '(VERBOSE|INFO)'\n</code></pre></p> <p>Nothing should be returned</p>","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","Configure SSH Server","Automated","IG1","IG2","IG3","8.2 Collect Audit Logs","T1562","T1562.006","TA0005"]},{"location":"5-Access-Authentication-and-Authorization/5.2-Configure-SSH-Server/5.2.5-Ensure-SSH-LogLevel-is-appropriate/#remediation","title":"Remediation","text":"<p>Edit the /etc/ssh/sshd_config file to set the parameter as follows: <pre><code>LogLevel VERBOSE\n</code></pre></p> <p>OR</p> <pre><code>LogLevel INFO\n</code></pre> <p>Default Value:</p> <p>LogLevel INFO</p>","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","Configure SSH Server","Automated","IG1","IG2","IG3","8.2 Collect Audit Logs","T1562","T1562.006","TA0005"]},{"location":"5-Access-Authentication-and-Authorization/5.2-Configure-SSH-Server/5.2.6-Ensure-SSH-PAM-is-enabled/","title":"5.2.6 Ensure SSH PAM is enabled","text":"","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","Configure SSH Server","Automated","IG1","IG2","IG3","4.1 Establish and Maintain a Secure Configuration Process","T1021","T1021.004","TA0001","M1035"]},{"location":"5-Access-Authentication-and-Authorization/5.2-Configure-SSH-Server/5.2.6-Ensure-SSH-PAM-is-enabled/#audit","title":"Audit","text":"<p>Run the following command: <pre><code># sshd -T -C user=root -C host=\"$(hostname)\" -C addr=\"$(grep $(hostname) /etc/hosts | awk '{print $1}')\" | grep -i usepam\n</code></pre></p> <p>Verify the output matches: <pre><code>usepam yes\n</code></pre></p> <p>Run the following command: <pre><code># grep -Ei '^\\s*UsePAM\\s+no' /etc/ssh/sshd_config\n</code></pre></p> <p>Nothing should be returned.</p>","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","Configure SSH Server","Automated","IG1","IG2","IG3","4.1 Establish and Maintain a Secure Configuration Process","T1021","T1021.004","TA0001","M1035"]},{"location":"5-Access-Authentication-and-Authorization/5.2-Configure-SSH-Server/5.2.6-Ensure-SSH-PAM-is-enabled/#remediation","title":"Remediation","text":"<p>Edit the /etc/ssh/sshd_config file to set the parameter as follows: <pre><code>UsePAM yes\n</code></pre></p>","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","Configure SSH Server","Automated","IG1","IG2","IG3","4.1 Establish and Maintain a Secure Configuration Process","T1021","T1021.004","TA0001","M1035"]},{"location":"5-Access-Authentication-and-Authorization/5.2-Configure-SSH-Server/5.2.7-Ensure-SSH-root-login-is-disabled/","title":"5.2.7 Ensure SSH root login is disabled","text":"","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","Configure SSH Server","Automated","IG1","IG2","IG3","5.4 Restrict Administrator Privileges to Dedicated Administrator Accounts","T1021","TA0008","M1042"]},{"location":"5-Access-Authentication-and-Authorization/5.2-Configure-SSH-Server/5.2.7-Ensure-SSH-root-login-is-disabled/#audit","title":"Audit","text":"<p>Run the following command: <pre><code># sshd -T -C user=root -C host=\"$(hostname)\" -C addr=\"$(grep $(hostname) /etc/hosts | awk '{print $1}')\" | grep permitrootlogin\n</code></pre></p> <p>Verify the output matches: <pre><code>permitrootlogin no\n</code></pre></p> <p>Run the following command: <pre><code># grep -Ei '^\\s*PermitRootLogin\\s+no' /etc/ssh/sshd_config\n</code></pre></p> <p>Verify the output matches: <pre><code>PermitRootLogin no\n</code></pre></p>","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","Configure SSH Server","Automated","IG1","IG2","IG3","5.4 Restrict Administrator Privileges to Dedicated Administrator Accounts","T1021","TA0008","M1042"]},{"location":"5-Access-Authentication-and-Authorization/5.2-Configure-SSH-Server/5.2.7-Ensure-SSH-root-login-is-disabled/#remediation","title":"Remediation","text":"<p>Edit the /etc/ssh/sshd_config file to set the parameter as follows: <pre><code>PermitRootLogin no\n</code></pre></p> <p>Default Value:</p> <p>PermitRootLogin without-password</p>","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","Configure SSH Server","Automated","IG1","IG2","IG3","5.4 Restrict Administrator Privileges to Dedicated Administrator Accounts","T1021","TA0008","M1042"]},{"location":"5-Access-Authentication-and-Authorization/5.2-Configure-SSH-Server/5.2.8-Ensure-SSH-HostbasedAuthentication-is-disabled/","title":"5.2.8 Ensure SSH HostbasedAuthentication is disabled","text":"","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","Configure SSH Server","Automated","IG1","IG2","IG3","4.1 Establish and Maintain a Secure Configuration Process","T1078","T1078.001","T1078.003","TA0001","M1042"]},{"location":"5-Access-Authentication-and-Authorization/5.2-Configure-SSH-Server/5.2.8-Ensure-SSH-HostbasedAuthentication-is-disabled/#audit","title":"Audit","text":"<p>Run the following command: <pre><code># sshd -T -C user=root -C host=\"$(hostname)\" -C addr=\"$(grep $(hostname) /etc/hosts | awk '{print $1}')\" | grep hostbasedauthentication\n</code></pre></p> <p>Verify the output matches: <pre><code>hostbasedauthentication no\n</code></pre></p> <p>Run the following command: <pre><code># grep -Ei '^\\s*HostbasedAuthentication\\s+yes' /etc/ssh/sshd_config\n</code></pre></p> <p>Nothing should be returned.</p>","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","Configure SSH Server","Automated","IG1","IG2","IG3","4.1 Establish and Maintain a Secure Configuration Process","T1078","T1078.001","T1078.003","TA0001","M1042"]},{"location":"5-Access-Authentication-and-Authorization/5.2-Configure-SSH-Server/5.2.8-Ensure-SSH-HostbasedAuthentication-is-disabled/#remediation","title":"Remediation","text":"<p>Edit the /etc/ssh/sshd_config file to set the parameter as follows: <pre><code>HostbasedAuthentication no\n</code></pre></p> <p>Default Value:</p> <p>HostbasedAuthentication no</p>","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","Configure SSH Server","Automated","IG1","IG2","IG3","4.1 Establish and Maintain a Secure Configuration Process","T1078","T1078.001","T1078.003","TA0001","M1042"]},{"location":"5-Access-Authentication-and-Authorization/5.2-Configure-SSH-Server/5.2.9-Ensure-SSH-PermitEmptyPasswords-is-disabled/","title":"5.2.9 Ensure SSH PermitEmptyPasswords is disabled","text":"","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","Configure SSH Server","Automated","IG1","IG2","IG3","4.1 Establish and Maintain a Secure Configuration Process","T1021","TA0008","M1042"]},{"location":"5-Access-Authentication-and-Authorization/5.2-Configure-SSH-Server/5.2.9-Ensure-SSH-PermitEmptyPasswords-is-disabled/#audit","title":"Audit","text":"<p>Run the following command: <pre><code># sshd -T -C user=root -C host=\"$(hostname)\" -C addr=\"$(grep $(hostname) /etc/hosts | awk '{print $1}')\" | grep permitemptypasswords\n</code></pre></p> <p>Verify the output matches: <pre><code>permitemptypasswords no\n</code></pre></p> <p>Run the following command and verify the output: <pre><code># grep -Ei '^\\s*PermitEmptyPasswords\\s+yes' /etc/ssh/sshd_config\n</code></pre></p> <p>Nothing should be returned.</p>","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","Configure SSH Server","Automated","IG1","IG2","IG3","4.1 Establish and Maintain a Secure Configuration Process","T1021","TA0008","M1042"]},{"location":"5-Access-Authentication-and-Authorization/5.2-Configure-SSH-Server/5.2.9-Ensure-SSH-PermitEmptyPasswords-is-disabled/#remediation","title":"Remediation","text":"<p>Edit the /etc/ssh/sshd_config file to set the parameter as follows: <pre><code>PermitEmptyPasswords no\n</code></pre></p> <p>Default Value:</p> <p>PermitEmptyPasswords no</p>","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","Configure SSH Server","Automated","IG1","IG2","IG3","4.1 Establish and Maintain a Secure Configuration Process","T1021","TA0008","M1042"]},{"location":"5-Access-Authentication-and-Authorization/5.3-Configure-privilege-escalation/5.3.1-Ensure-sudo-is-installed/","title":"5.3.1 Ensure sudo is installed","text":"","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","Configure privilege escalation","Automated","IG1","IG2","IG3","5.4 Restrict Administrator Privileges to Dedicated Administrator Accounts","T1078","T1078.003","TA0001"]},{"location":"5-Access-Authentication-and-Authorization/5.3-Configure-privilege-escalation/5.3.1-Ensure-sudo-is-installed/#audit","title":"Audit","text":"<p>Run the following command to verify that either sudo or sudo-ldap is installed: <pre><code># dpkg-query -W sudo sudo-ldap &gt; /dev/null 2&gt;&amp;1 &amp;&amp; dpkg-query -W -f='${binary:Package}\\t${Status}\\t${db:Status-Status}\\n' sudo sudo-ldap | awk '($4==\"installed\" &amp;&amp; $NF==\"installed\") {print \"\\n\"\"PASS:\"\"\\n\"\"Package \"\"\\\"\"$1\"\\\"\"\" is installed\"\"\\n\"}' || echo -e \"\\nFAIL:\\nneither \\\"sudo\\\" or \\\"sudo-ldap\\\" package is installed\\n\"\n</code></pre></p>","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","Configure privilege escalation","Automated","IG1","IG2","IG3","5.4 Restrict Administrator Privileges to Dedicated Administrator Accounts","T1078","T1078.003","TA0001"]},{"location":"5-Access-Authentication-and-Authorization/5.3-Configure-privilege-escalation/5.3.1-Ensure-sudo-is-installed/#remediation","title":"Remediation","text":"<p>First determine is LDAP functionality is required. If so, then install sudo-ldap, else install sudo.</p> <p>Example: <pre><code># apt install sudo\n</code></pre></p>","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","Configure privilege escalation","Automated","IG1","IG2","IG3","5.4 Restrict Administrator Privileges to Dedicated Administrator Accounts","T1078","T1078.003","TA0001"]},{"location":"5-Access-Authentication-and-Authorization/5.3-Configure-privilege-escalation/5.3.2-Ensure-sudo-commands-use-pty/","title":"5.3.2 Ensure sudo commands use pty","text":"","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","Configure privilege escalation","Automated","IG1","IG2","IG3","5.4 Restrict Administrator Privileges to Dedicated Administrator Accounts","T1548","T1548.003","TA0003"]},{"location":"5-Access-Authentication-and-Authorization/5.3-Configure-privilege-escalation/5.3.2-Ensure-sudo-commands-use-pty/#audit","title":"Audit","text":"<p>Verify that sudo can only run other commands from a pseudo terminal.</p> <p>Run the following command: <pre><code># grep -rPi '^\\h*Defaults\\h+([^#\\n\\r]+,)?use_pty(,\\h*\\h+\\h*)*\\h*(#.*)?$' /etc/sudoers*\n</code></pre></p> <p>Verify the output matches: <pre><code>/etc/sudoers:Defaults use_pty\n</code></pre></p>","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","Configure privilege escalation","Automated","IG1","IG2","IG3","5.4 Restrict Administrator Privileges to Dedicated Administrator Accounts","T1548","T1548.003","TA0003"]},{"location":"5-Access-Authentication-and-Authorization/5.3-Configure-privilege-escalation/5.3.2-Ensure-sudo-commands-use-pty/#remediation","title":"Remediation","text":"<p>Edit the file /etc/sudoers with visudo or a file in /etc/sudoers.d/ with visudo -f  and add the following line: <pre><code>Defaults use_pty\n</code></pre>","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","Configure privilege escalation","Automated","IG1","IG2","IG3","5.4 Restrict Administrator Privileges to Dedicated Administrator Accounts","T1548","T1548.003","TA0003"]},{"location":"5-Access-Authentication-and-Authorization/5.3-Configure-privilege-escalation/5.3.3-Ensure-sudo-log-file-exists/","title":"5.3.3 Ensure sudo log file exists","text":"","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","Configure privilege escalation","Automated","IG2","IG3","8.5 Collect Detailed Audit Logs","T1562","T1562.006","TA0004"]},{"location":"5-Access-Authentication-and-Authorization/5.3-Configure-privilege-escalation/5.3.3-Ensure-sudo-log-file-exists/#audit","title":"Audit","text":"<p>Run the following command to verify that sudo has a custom log file configured: <pre><code># grep -rPsi \"^\\h*Defaults\\h+([^#]+,\\h*)?logfile\\h*=\\h*(\\\"|\\')?\\H+(\\\"|\\')?(,\\h*\\H+\\h*)*\\h*(#.*)?$\" /etc/sudoers*\n</code></pre></p> <p>Verify the output matches: <pre><code>Defaults logfile=\"/var/log/sudo.log\"\n</code></pre></p>","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","Configure privilege escalation","Automated","IG2","IG3","8.5 Collect Detailed Audit Logs","T1562","T1562.006","TA0004"]},{"location":"5-Access-Authentication-and-Authorization/5.3-Configure-privilege-escalation/5.3.3-Ensure-sudo-log-file-exists/#remediation","title":"Remediation","text":"<p>Edit the file /etc/sudoers or a file in /etc/sudoers.d/ with visudo or visudo -f <code>&lt;PATH TO FILE&gt;</code> and add the following line:</p> <p>Example: <pre><code>Defaults logfile=\"/var/log/sudo.log\"\n</code></pre></p>","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","Configure privilege escalation","Automated","IG2","IG3","8.5 Collect Detailed Audit Logs","T1562","T1562.006","TA0004"]},{"location":"5-Access-Authentication-and-Authorization/5.3-Configure-privilege-escalation/5.3.4-Ensure-users-must-provide-password-for-privilege-escalation/","title":"5.3.4 Ensure users must provide password for privilege escalation","text":"","tags":["Level 2","Workstation","Server","Access, Authentication and Authorization","Configure privilege escalation","Automated","IG1","IG2","IG3","5.4 Restrict Administrator Privileges to Dedicated Administrator Accounts"]},{"location":"5-Access-Authentication-and-Authorization/5.3-Configure-privilege-escalation/5.3.4-Ensure-users-must-provide-password-for-privilege-escalation/#audit","title":"Audit","text":"<p>Note: If passwords are not being used for authentication, this is not applicable.</p> <p>Verify the operating system requires users to supply a password for privilege escalation. Check the configuration of the /etc/sudoers and /etc/sudoers.d/* files with the following command: <pre><code># grep -r \"^[^#].*NOPASSWD\" /etc/sudoers*\n</code></pre></p> <p>If any line is found refer to the remediation procedure below.</p>","tags":["Level 2","Workstation","Server","Access, Authentication and Authorization","Configure privilege escalation","Automated","IG1","IG2","IG3","5.4 Restrict Administrator Privileges to Dedicated Administrator Accounts"]},{"location":"5-Access-Authentication-and-Authorization/5.3-Configure-privilege-escalation/5.3.4-Ensure-users-must-provide-password-for-privilege-escalation/#remediation","title":"Remediation","text":"<p>Based on the outcome of the audit procedure, use visudo -f <code>&lt;PATH TO FILE&gt;</code> to edit the relevant sudoers file.</p> <p>Remove any line with occurrences of NOPASSWD tags in the file.</p>","tags":["Level 2","Workstation","Server","Access, Authentication and Authorization","Configure privilege escalation","Automated","IG1","IG2","IG3","5.4 Restrict Administrator Privileges to Dedicated Administrator Accounts"]},{"location":"5-Access-Authentication-and-Authorization/5.3-Configure-privilege-escalation/5.3.5-Ensure-re-authentication-for-privilege-escalation-is-not-disabled-globally/","title":"5.3.5 Ensure re-authentication for privilege escalation is not disabled globally","text":"","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","Configure privilege escalation","Automated","IG1","IG2","IG3","5.4 Restrict Administrator Privileges to Dedicated Administrator Accounts"]},{"location":"5-Access-Authentication-and-Authorization/5.3-Configure-privilege-escalation/5.3.5-Ensure-re-authentication-for-privilege-escalation-is-not-disabled-globally/#audit","title":"Audit","text":"<p>Verify the operating system requires users to re-authenticate for privilege escalation.</p> <p>Check the configuration of the /etc/sudoers and /etc/sudoers.d/* files with the following command: <pre><code># grep -r \"^[^#].*\\!authenticate\" /etc/sudoers*\n</code></pre></p> <p>If any line is found with a !authenticate tag, refer to the remediation procedure below.</p>","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","Configure privilege escalation","Automated","IG1","IG2","IG3","5.4 Restrict Administrator Privileges to Dedicated Administrator Accounts"]},{"location":"5-Access-Authentication-and-Authorization/5.3-Configure-privilege-escalation/5.3.5-Ensure-re-authentication-for-privilege-escalation-is-not-disabled-globally/#remediation","title":"Remediation","text":"<p>Configure the operating system to require users to reauthenticate for privilege escalation.</p> <p>Based on the outcome of the audit procedure, use visudo -f <code>&lt;PATH TO FILE&gt;</code> to edit the relevant sudoers file.</p> <p>Remove any occurrences of !authenticate tags in the file(s).</p>","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","Configure privilege escalation","Automated","IG1","IG2","IG3","5.4 Restrict Administrator Privileges to Dedicated Administrator Accounts"]},{"location":"5-Access-Authentication-and-Authorization/5.3-Configure-privilege-escalation/5.3.6-Ensure-sudo-authentication-timeout-is-configured-correctly/","title":"5.3.6 Ensure sudo authentication timeout is configured correctly","text":"","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","Configure privilege escalation","Automated","IG1","IG2","IG3","5.4 Restrict Administrator Privileges to Dedicated Administrator Accounts"]},{"location":"5-Access-Authentication-and-Authorization/5.3-Configure-privilege-escalation/5.3.6-Ensure-sudo-authentication-timeout-is-configured-correctly/#audit","title":"Audit","text":"<p>Ensure that the caching timeout is no more than 15 minutes.</p> <p>Example: <pre><code># grep -roP \"timestamp_timeout=\\K[0-9]*\" /etc/sudoers*\n</code></pre></p> <p>If there is no timestamp_timeout configured in /etc/sudoers* then the default is 15 minutes. This default can be checked with: <pre><code># sudo -V | grep \"Authentication timestamp timeout:\"\n</code></pre></p> <p>NOTE: A value of -1 means that the timeout is disabled. Depending on the configuration of the timestamp_type, this could mean for all terminals / processes of that user and not just that one single terminal session.</p>","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","Configure privilege escalation","Automated","IG1","IG2","IG3","5.4 Restrict Administrator Privileges to Dedicated Administrator Accounts"]},{"location":"5-Access-Authentication-and-Authorization/5.3-Configure-privilege-escalation/5.3.6-Ensure-sudo-authentication-timeout-is-configured-correctly/#remediation","title":"Remediation","text":"<p>If the currently configured timeout is larger than 15 minutes, edit the file listed in the audit section with visudo -f <code>&lt;PATH TO FILE&gt;</code> and modify the entry timestamp_timeout= to 15 minutes or less as per your site policy. The value is in minutes. This particular entry may appear on it's own, or on the same line as env_reset. See the following two examples: <pre><code>Defaults env_reset, timestamp_timeout=15\nDefaults timestamp_timeout=15\nDefaults env_reset\n</code></pre></p>","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","Configure privilege escalation","Automated","IG1","IG2","IG3","5.4 Restrict Administrator Privileges to Dedicated Administrator Accounts"]},{"location":"5-Access-Authentication-and-Authorization/5.3-Configure-privilege-escalation/5.3.7-Ensure-access-to-the-su-command-is-restricted/","title":"5.3.7 Ensure access to the su command is restricted","text":"","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","Configure privilege escalation","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1548","TA0005","M1026"]},{"location":"5-Access-Authentication-and-Authorization/5.3-Configure-privilege-escalation/5.3.7-Ensure-access-to-the-su-command-is-restricted/#audit","title":"Audit","text":"<p>Run the following command: <pre><code># grep -Pi '^\\h*auth\\h+(?:required|requisite)\\h+pam_wheel\\.so\\h+(?:[^#\\n\\r]+\\h+)?((?!\\2)(use_uid\\b|group=\\H+\\b))\\h+(?:[^#\\n\\r]+\\h+)?((?!\\1)(use_uid\\b|group=\\H+\\b))(\\h+.*)?$' /etc/pam.d/su\n</code></pre></p> <p>Verify the output matches: <pre><code>auth required pam_wheel.so use_uid group=&lt;group_name&gt;\n</code></pre></p> <p>Run the following command and verify that the group specified in  contains no users: <pre><code># grep &lt;group_name&gt; /etc/group\n</code></pre> <p>Verify the output does not contain any users in the relevant group: <pre><code>&lt;group_name&gt;:x:&lt;GID&gt;:\n</code></pre></p>","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","Configure privilege escalation","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1548","TA0005","M1026"]},{"location":"5-Access-Authentication-and-Authorization/5.3-Configure-privilege-escalation/5.3.7-Ensure-access-to-the-su-command-is-restricted/#remediation","title":"Remediation","text":"<p>Create an empty group that will be specified for use of the su command. The group should be named according to site policy.</p> <p>Example: <pre><code># groupadd sugroup\n</code></pre></p> <p>Add the following line to the /etc/pam.d/su file, specifying the empty group:  <pre><code>auth required pam_wheel.so use_uid group=sugroup\n</code></pre></p>","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","Configure privilege escalation","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1548","TA0005","M1026"]},{"location":"5-Access-Authentication-and-Authorization/5.4-Configure-PAM/5.4.1-Ensure-password-creation-requirements-are-configured/","title":"5.4.1 Ensure password creation requirements are configured","text":"","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","Configure PAM","Automated","IG1","IG2","IG3","5.2 Use Unique Passwords","T1078","T1078.001","T1078.002","T1078.003","T1078.004","T1110","T1110.001","T1110.002","T1110.003","TA0006","M1027"]},{"location":"5-Access-Authentication-and-Authorization/5.4-Configure-PAM/5.4.1-Ensure-password-creation-requirements-are-configured/#audit","title":"Audit","text":"<p>Verify password creation requirements conform to organization policy.</p> <p>Password length</p> <p>Run the following command: <pre><code># grep '^\\s*minlen\\s*' /etc/security/pwquality.conf\n</code></pre></p> <p>Verify the output matches: <pre><code>minlen = 14\n</code></pre></p> <p>Password complexity</p> <p>Option 1</p> <p>Run the following command: <pre><code># grep '^\\s*minclass\\s*' /etc/security/pwquality.conf\n</code></pre></p> <p>Verify the output matches: <pre><code>minclass = 4\n</code></pre></p> <p>Option 2 </p> <p>Run the following command: <pre><code># grep -E '^\\s*[duol]credit\\s*' /etc/security/pwquality.conf\n</code></pre></p> <p>Verify the output matches: <pre><code>dcredit = -1\nucredit = -1\nlcredit = -1\nocredit = -1\n</code></pre></p>","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","Configure PAM","Automated","IG1","IG2","IG3","5.2 Use Unique Passwords","T1078","T1078.001","T1078.002","T1078.003","T1078.004","T1110","T1110.001","T1110.002","T1110.003","TA0006","M1027"]},{"location":"5-Access-Authentication-and-Authorization/5.4-Configure-PAM/5.4.1-Ensure-password-creation-requirements-are-configured/#remediation","title":"Remediation","text":"<p>The following setting is a recommend example policy. Alter these values to conform to your own organization's password policies.</p> <p>Run the following command to install the pam_pwquality module: <pre><code># apt install libpam-pwquality\n</code></pre></p> <p>Edit the file /etc/security/pwquality.conf and add or modify the following line for password length to conform to site policy: <pre><code>minlen = 14\n</code></pre></p> <p>Edit the file /etc/security/pwquality.conf and add or modify the following line for password complexity to conform to site policy:</p> <p>Option 1 <pre><code>minclass = 4\n</code></pre></p> <p>Option 2</p> <pre><code>dcredit = -1\nucredit = -1\nocredit = -1\nlcredit = -1\n</code></pre>","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","Configure PAM","Automated","IG1","IG2","IG3","5.2 Use Unique Passwords","T1078","T1078.001","T1078.002","T1078.003","T1078.004","T1110","T1110.001","T1110.002","T1110.003","TA0006","M1027"]},{"location":"5-Access-Authentication-and-Authorization/5.4-Configure-PAM/5.4.2-Ensure-lockout-for-failed-password-attempts-is-configured/","title":"5.4.2 Ensure lockout for failed password attempts is configured","text":"","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","Configure PAM","Automated","IG1","IG2","IG3","6.2 Establish an Access Revoking Process","T1110","T1110.001","T1110.003","TA0006","M1027"]},{"location":"5-Access-Authentication-and-Authorization/5.4-Configure-PAM/5.4.2-Ensure-lockout-for-failed-password-attempts-is-configured/#audit","title":"Audit","text":"<p>Verify password lockouts are configured. These settings are commonly configured with the pam_faillock.so module found in /etc/pam.d/common-auth and /etc/pam.d/common-account.</p> <p>Common auth</p> <p>Run the following command to verify pam_faillock.so is configured in /etc/pam.d/common-auth: <pre><code># grep \"pam_faillock.so\" /etc/pam.d/common-auth\n</code></pre></p> <p>Verify the output includes the three pam_faillock.so lines: <pre><code>auth required pam_faillock.so preauth\nauth [default=die] pam_faillock.so authfail\nauth sufficient pam_faillock.so authsucc\n</code></pre></p> <p>Common account</p> <p>Run the following command to verify pam_faillock.so is configured in /etc/pam.d/common-account: <pre><code># grep \"pam_faillock.so\" /etc/pam.d/common-account\n</code></pre></p> <p>Verify the output matches: <pre><code>account required pam_faillock.so\n</code></pre></p> <p>Fail lock configuration</p> <p>Run the following command to verify deny, fail_interval, and unlock time are configured in /etc/security/faillock.conf: <pre><code>awk '/^ *deny *=/\\\n||/^ *fail_interval *=/\\\n||/^ *unlock_time *=/' /etc/security/faillock.conf\n</code></pre></p> <p>Verify the output:</p> <ul> <li>deny is not greater than 4</li> <li>fail_interval is no greater than 900</li> <li>unlock_time is 0, or greater than or equal to 600</li> <li>Settings follow local site policy</li> </ul> <p>Example: <pre><code>deny = 4\nfail_interval = 900\nunlock time = 600\n</code></pre></p>","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","Configure PAM","Automated","IG1","IG2","IG3","6.2 Establish an Access Revoking Process","T1110","T1110.001","T1110.003","TA0006","M1027"]},{"location":"5-Access-Authentication-and-Authorization/5.4-Configure-PAM/5.4.2-Ensure-lockout-for-failed-password-attempts-is-configured/#remediation","title":"Remediation","text":"<p>NOTE: Pay special attention to the configuration. Incorrect configuration can cause system lock outs. This is example configuration. You configuration may differ based on previous changes to the files.</p> <p>Common auth</p> <p>Edit /etc/pam.d/common-auth and ensure that faillock is configured.</p> <p>Note: It is critical to understand each line and the relevant arguments for successful implementation. The order of these entries is very specific. The pam_faillock.so lines surround the pam_unix.so line. The comment \"Added to enable faillock\" is shown to highlight the additional lines and their order in the file. <pre><code># here are the per-package modules (the \"Primary\" block)\nauth required pam_faillock.so preauth # Added to enable faillock\nauth [success=1 default=ignore] pam_unix.so nullok\nauth [default=die] pam_faillock.so authfail # Added to enable faillock\nauth sufficient pam_faillock.so authsucc # Added to enable faillock\n# here's the fallback if no module succeeds\nauth requisite pam_deny.so\n# prime the stack with a positive return value if there isn't one already;\n# this avoids us returning an error just because nothing sets a success code\n# since the modules above will each just jump around\nauth required pam_permit.so\n# and here are more per-package modules (the \"Additional\" block)\nauth optional pam_cap.so\n# end of pam-auth-update config\n</code></pre></p> <p>Common account</p> <p>Edit /etc/pam.d/common-account and ensure that the following stanza is at the end of the file. <pre><code>account required pam_faillock.so\n</code></pre></p> <p>Fail lock configuration</p> <p>Edit /etc/security/faillock.conf and configure it per your site policy.</p> <p>Example: <pre><code>deny = 4\nfail_interval = 900\nunlock time = 600\n</code></pre></p>","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","Configure PAM","Automated","IG1","IG2","IG3","6.2 Establish an Access Revoking Process","T1110","T1110.001","T1110.003","TA0006","M1027"]},{"location":"5-Access-Authentication-and-Authorization/5.4-Configure-PAM/5.4.3-Ensure-password-reuse-is-limited/","title":"5.4.3 Ensure password reuse is limited","text":"","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","Configure PAM","Automated","IG1","IG2","IG3","5.2 Use Unique Passwords","T1078","T1078.001","T1078.002","T1078.003","T1078.004","T1110","T1110.004"]},{"location":"5-Access-Authentication-and-Authorization/5.4-Configure-PAM/5.4.3-Ensure-password-reuse-is-limited/#audit","title":"Audit","text":"<p>Run the following command: <pre><code># grep -P '^\\h*password\\h+([^#\\n\\r]+\\h+)?pam_pwhistory\\.so\\h+([^#\\n\\r]+\\h+)?remember=([5-9]|[1-9][0-9]+)\\b' /etc/pam.d/common-password\npassword required pam_pwhistory.so remember=5\n</code></pre></p> <p>Ensure the remember option is 5 or more and follows your site policy.</p>","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","Configure PAM","Automated","IG1","IG2","IG3","5.2 Use Unique Passwords","T1078","T1078.001","T1078.002","T1078.003","T1078.004","T1110","T1110.004"]},{"location":"5-Access-Authentication-and-Authorization/5.4-Configure-PAM/5.4.3-Ensure-password-reuse-is-limited/#remediation","title":"Remediation","text":"<p>NOTE: Pay special attention to the configuration. Incorrect configuration can cause system lock outs. This is example configuration. You configuration may differ based on previous changes to the files.</p> <p>Edit the /etc/pam.d/common-password file to include the remember= option of 5 or more. If this line doesn't exist, add the line directly above the line: <code>password [success=1 default=ignore] pam_unix.so obscure yescrypt</code>:</p> <p>Example: <pre><code>password required pam_pwhistory.so use_authtok remember=5\n</code></pre></p>","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","Configure PAM","Automated","IG1","IG2","IG3","5.2 Use Unique Passwords","T1078","T1078.001","T1078.002","T1078.003","T1078.004","T1110","T1110.004"]},{"location":"5-Access-Authentication-and-Authorization/5.4-Configure-PAM/5.4.4-Ensure-password-hashing-algorithm-is-up-to-date-with-the-latest-standards/","title":"5.4.4 Ensure password hashing algorithm is up to date with the latest standards","text":"","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","Configure PAM","Automated","IG2","IG3","3.11 Encrypt Sensitive Data at Rest","T1003","T1003.008","T1110","T1110.002","TA0006","MA1041"]},{"location":"5-Access-Authentication-and-Authorization/5.4-Configure-PAM/5.4.4-Ensure-password-hashing-algorithm-is-up-to-date-with-the-latest-standards/#audit","title":"Audit","text":"<p>PAM</p> <p>No hashing algorithm should be configured in /etc/pam.d/common-password.</p> <p>Run the following command: <pre><code># grep -v ^# /etc/pam.d/common-password | grep -E \"(yescrypt|md5|bigcrypt|sha256|sha512|blowfish)\"\n</code></pre></p> <p>Verify that there is no output.</p> <p>If there is a business requirement to configure the hashing algorithm in PAM, ensure that the same algorithm is configured in /etc/login.defs.</p> <p>Login definitions</p> <p>Run the following command: <pre><code># grep -i \"^\\s*ENCRYPT_METHOD\\s*yescrypt\\s*$\" /etc/login.defs\n</code></pre></p> <p>Verify the output matches: <pre><code>ENCRYPT_METHOD yescrypt\n</code></pre></p>","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","Configure PAM","Automated","IG2","IG3","3.11 Encrypt Sensitive Data at Rest","T1003","T1003.008","T1110","T1110.002","TA0006","MA1041"]},{"location":"5-Access-Authentication-and-Authorization/5.4-Configure-PAM/5.4.4-Ensure-password-hashing-algorithm-is-up-to-date-with-the-latest-standards/#remediation","title":"Remediation","text":"<p>NOTE: Pay special attention to the configuration. Incorrect configuration can cause system lock outs. This is example configuration. You configuration may differ based on previous changes to the files.</p> <p>PAM</p> <p>Edit the /etc/pam.d/common-password file and ensure that no hashing algorithm option for pam_unix.so is set: <pre><code>password [success=1 default=ignore] pam_unix.so obscure use_authtok try_first_pass remember=5\n</code></pre></p> <p>Login definitions</p> <p>Edit /etc/login.defs and ensure that ENCRYPT_METHOD is set to yescrypt</p>","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","Configure PAM","Automated","IG2","IG3","3.11 Encrypt Sensitive Data at Rest","T1003","T1003.008","T1110","T1110.002","TA0006","MA1041"]},{"location":"5-Access-Authentication-and-Authorization/5.4-Configure-PAM/5.4.5-Ensure-all-current-passwords-uses-the-configured-hashing-algorithm/","title":"5.4.5 Ensure all current passwords uses the configured hashing algorithm","text":"<p>title: 5.4.5 Ensure all current passwords uses the configured hashing algorithm tags:   - Level 1   - Workstation   - Server   - Access, Authentication and Authorization   - Configure PAM   - Manual   - IG2   - IG3   - 3.11 Encrypt Sensitive Data at Rest   - T1003   - T1003.008   - T1110   - T1110.002   - TA0006   - MA1041</p>"},{"location":"5-Access-Authentication-and-Authorization/5.4-Configure-PAM/5.4.5-Ensure-all-current-passwords-uses-the-configured-hashing-algorithm/#audit","title":"Audit","text":"<p>Run the following script to get a list of users that are not using the currently configured hashing algorithm: <pre><code>#!/usr/bin/env bash\n{\ndeclare -A HASH_MAP=( [\"y\"]=\"yescrypt\" [\"1\"]=\"md5\" [\"2\"]=\"blowfish\" [\"5\"]=\"SHA256\" [\"6\"]=\"SHA512\" [\"g\"]=\"gost-yescrypt\" )\nCONFIGURED_HASH=$(sed -n \"s/^\\s*ENCRYPT_METHOD\\s*\\(.*\\)\\s*$/\\1/p\" /etc/login.defs)\nfor MY_USER in $(sed -n \"s/^\\(.*\\):\\\\$.*/\\1/p\" /etc/shadow)\ndo\nCURRENT_HASH=$(sed -n \"s/${MY_USER}:\\\\$\\(.\\).*/\\1/p\" /etc/shadow)\nif [[ \"${HASH_MAP[\"${CURRENT_HASH}\"]^^}\" != \"${CONFIGURED_HASH^^}\" ]]; then\necho \"The password for '${MY_USER}' is using '${HASH_MAP[\"${CURRENT_HASH}\"]}' instead of the configured '${CONFIGURED_HASH}'.\"\nfi\ndone\n}\n</code></pre></p> <p>Nothing should be returned.</p> <p>Any system accounts that need to be expired should be carefully done separately by the system administrator to prevent any potential problems.</p>"},{"location":"5-Access-Authentication-and-Authorization/5.4-Configure-PAM/5.4.5-Ensure-all-current-passwords-uses-the-configured-hashing-algorithm/#remediation","title":"Remediation","text":"<p>If the administrator wish to force an immediate change on all users as per the output of the audit, execute: <pre><code>#!/usr/bin/env bash\n{\nUID_MIN=$(awk '/^\\s*UID_MIN/{print $2}' /etc/login.defs)\nawk -F: -v UID_MIN=\"${UID_MIN}\" '( $3 &gt;= UID_MIN &amp;&amp; $1 != \"nfsnobody\" ) { print $1 }' /etc/passwd | xargs -n 1 chage -d 0\n}\n</code></pre></p> <p>NOTE: This could cause significant temporary CPU load on the system if a large number of users reset their passwords at the same time.</p>"},{"location":"5-Access-Authentication-and-Authorization/5.5-User-Accounts-and-Environment/5.5.2-Ensure-system-accounts-are-secured/","title":"5.5.2 Ensure system accounts are secured","text":"","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","User Accounts and Environment","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1078","T1078.001","T1078.003","TA0005","M1026"]},{"location":"5-Access-Authentication-and-Authorization/5.5-User-Accounts-and-Environment/5.5.2-Ensure-system-accounts-are-secured/#audit","title":"Audit","text":"<p>Run the following commands and verify no results are returned: <pre><code># awk -F: '$1!~/(root|sync|shutdown|halt|^\\+)/ &amp;&amp; $3&lt;'\"$(awk '/^\\s*UID_MIN/{print $2}' /etc/login.defs)\"' &amp;&amp; $7!~/((\\/usr)?\\/sbin\\/nologin)/ &amp;&amp; $7!~/(\\/bin)?\\/false/ {print}' /etc/passwd\n</code></pre></p> <pre><code># awk -F: '($1!~/(root|^\\+)/ &amp;&amp; $3&lt;'\"$(awk '/^\\s*UID_MIN/{print $2}' /etc/login.defs)\"') {print $1}' /etc/passwd | xargs -I '{}' passwd -S '{}' | awk '($2!~/LK?/) {print $1}'\n</code></pre> <p>Note: The root, sync, shutdown, and halt users are exempted from requiring a nonlogin shell</p>","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","User Accounts and Environment","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1078","T1078.001","T1078.003","TA0005","M1026"]},{"location":"5-Access-Authentication-and-Authorization/5.5-User-Accounts-and-Environment/5.5.2-Ensure-system-accounts-are-secured/#remediation","title":"Remediation","text":"<p>Set the shell for any accounts returned by the audit to nologin: <pre><code># usermod -s $(which nologin) &lt;user&gt;\n</code></pre></p> <p>Lock any non root accounts returned by the audit: <pre><code># usermod -L &lt;user&gt;\n</code></pre></p> <p>The following command will set all system accounts to a non login shell: <pre><code># awk -F: '$1!~/(root|sync|shutdown|halt|^\\+)/ &amp;&amp; $3&lt;'\"$(awk '/^\\s*UID_MIN/{print $2}' /etc/login.defs)\"' &amp;&amp; $7!~/((\\/usr)?\\/sbin\\/nologin)/ &amp;&amp; $7!~/(\\/bin)?\\/false/ {print $1}' /etc/passwd | while read -r user; do usermod -s \"$(which nologin)\" \"$user\"; done\n</code></pre></p> <p>The following command will automatically lock not root system accounts: <pre><code># awk -F: '($1!~/(root|^\\+)/ &amp;&amp; $3&lt;'\"$(awk '/^\\s*UID_MIN/{print $2}' /etc/login.defs)\"') {print $1}' /etc/passwd | xargs -I '{}' passwd -S '{}' | awk '($2!~/LK?/) {print $1}' | while read -r user; do usermod -L \"$user\"; done\n</code></pre></p>","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","User Accounts and Environment","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1078","T1078.001","T1078.003","TA0005","M1026"]},{"location":"5-Access-Authentication-and-Authorization/5.5-User-Accounts-and-Environment/5.5.3-Ensure-default-group-for-the-root-account-is-GID-0/","title":"5.5.3 Ensure default group for the root account is GID 0","text":"","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","User Accounts and Environment","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1548","TA0005","M1026"]},{"location":"5-Access-Authentication-and-Authorization/5.5-User-Accounts-and-Environment/5.5.3-Ensure-default-group-for-the-root-account-is-GID-0/#audit","title":"Audit","text":"<p>Run the following command and verify the result is 0 : <pre><code># grep \"^root:\" /etc/passwd | cut -f4 -d:\n0\n</code></pre></p>","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","User Accounts and Environment","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1548","TA0005","M1026"]},{"location":"5-Access-Authentication-and-Authorization/5.5-User-Accounts-and-Environment/5.5.3-Ensure-default-group-for-the-root-account-is-GID-0/#remediation","title":"Remediation","text":"<p>Run the following command to set the root user default group to GID 0 : <pre><code># usermod -g 0 root\n</code></pre></p>","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","User Accounts and Environment","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1548","TA0005","M1026"]},{"location":"5-Access-Authentication-and-Authorization/5.5-User-Accounts-and-Environment/5.5.4-Ensure-default-user-umask-is-027-or-more-restrictive/","title":"5.5.4 Ensure default user umask is 027 or more restrictive","text":"","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","User Accounts and Environment","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1565","T1565.001","TA0007"]},{"location":"5-Access-Authentication-and-Authorization/5.5-User-Accounts-and-Environment/5.5.4-Ensure-default-user-umask-is-027-or-more-restrictive/#audit","title":"Audit","text":"<p>Run the following to verify:</p> <ul> <li>A default user umask is set to enforce a newly created directories's permissions to be 750 (drwxr-x---), and a newly created file's permissions be 640 (rw-r-----), or more restrictive</li> <li>No less restrictive System Wide umask is set</li> </ul> <p>Run the following script to verify that a default user umask is set enforcing a newly created directories's permissions to be 750 (drwxr-x---), and a newly created file's permissions be 640 (rw-r-----), or more restrictive: <pre><code>#!/bin/bash\npassing=\"\"\ngrep -Eiq '^\\s*UMASK\\s+(0[0-7][2-7]7|[0-7][2-7]7)\\b' /etc/login.defs &amp;&amp; grep -Eqi '^\\s*USERGROUPS_ENAB\\s*\"?no\"?\\b' /etc/login.defs &amp;&amp; grep -Eq '^\\s*session\\s+(optional|requisite|required)\\s+pam_umask\\.so\\b' /etc/pam.d/common-session &amp;&amp; passing=true\ngrep -REiq '^\\s*UMASK\\s+\\s*(0[0-7][2-7]7|[0-7][2-7]7|u=(r?|w?|x?)(r?|w?|x?)(r?|w?|x?),g=(r?x?|x?r?),o=)\\b' /etc/profile* /etc/bash.bashrc* &amp;&amp; passing=true\n[ \"$passing\" = true ] &amp;&amp; echo \"Default user umask is set\"\n</code></pre></p> <p>Verify output is: \"Default user umask is set\"</p> <p>Run the following to verify that no less restrictive system wide umask is set: <pre><code># grep -RPi '(^|^[^#]*)\\s*umask\\s+([0-7][0-7][01][0-7]\\b|[0-7][0-7][0-7][0-6]\\b|[0-7][01][0-7]\\b|[0-7][0-7][0-6]\\b|(u=[rwx]{0,3},)?(g=[rwx]{0,3},)?o=[rwx]+\\b|(u=[rwx]{1,3},)?g=[^rx]{1,3}(,o=[rwx]{0,3})?\\b)' /etc/login.defs /etc/profile* /etc/bash.bashrc*\n</code></pre></p> <p>No file should be returned</p>","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","User Accounts and Environment","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1565","T1565.001","TA0007"]},{"location":"5-Access-Authentication-and-Authorization/5.5-User-Accounts-and-Environment/5.5.4-Ensure-default-user-umask-is-027-or-more-restrictive/#remediation","title":"Remediation","text":"<p>Run the following command and remove or modify the umask of any returned files: <pre><code># grep -RPi '(^|^[^#]*)\\s*umask\\s+([0-7][0-7][01][0-7]\\b|[0-7][0-7][0-7][0-6]\\b|[0-7][01][0-7]\\b|[0-7][0-7][0-6]\\b|(u=[rwx]{0,3},)?(g=[rwx]{0,3},)?o=[rwx]+\\b|(u=[rwx]{1,3},)?g=[^rx]{1,3}(,o=[rwx]{0,3})?\\b)' /etc/login.defs /etc/profile* /etc/bash.bashrc*\n</code></pre></p> <p>Follow one of the following methods to set the default user umask:</p> <p>Edit /etc/login.defs and edit the UMASK and USERGROUPS_ENAB lines as follows: <pre><code>UMASK 027\nUSERGROUPS_ENAB no\n</code></pre></p> <p>Edit /etc/pam.d/common-session and add or edit the following: <pre><code>session optional pam_umask.so\n</code></pre></p> <p>OR</p> <p>Configure umask in one of the following files: * A file in the /etc/profile.d/ directory ending in .sh * /etc/profile * /etc/bash.bashrc</p> <p>Example: /etc/profile.d/set_umask.sh <pre><code>umask 027\n</code></pre></p> <p>Note: this method only applies to bash and shell. If other shells are supported on the system, it is recommended that their configuration files also are checked.</p> <p>Default Value:</p> <p>UMASK 022</p>","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","User Accounts and Environment","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1565","T1565.001","TA0007"]},{"location":"5-Access-Authentication-and-Authorization/5.5-User-Accounts-and-Environment/5.5.5-Ensure-default-user-shell-timeout-is-900-seconds-or-less/","title":"5.5.5 Ensure default user shell timeout is 900 seconds or less","text":"","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","User Accounts and Environment","Automated","IG1","IG2","IG3","4.3 Configure Automatic Session Locking on Enterprise Assets","T1078","T1078.001","T1078.002","T1078.003","TA0005","M1026"]},{"location":"5-Access-Authentication-and-Authorization/5.5-User-Accounts-and-Environment/5.5.5-Ensure-default-user-shell-timeout-is-900-seconds-or-less/#audit","title":"Audit","text":"<p>Run the following script to verify that TMOUT is configured to: include a timeout of no more than 900 seconds, to be readonly, to be exported, and is not being changed to a longer timeout. <pre><code>#!/bin/bash\noutput1=\"\" output2=\"\"\n[ -f /etc/bash.bashrc ] &amp;&amp; BRC=\"/etc/bash.bashrc\"\nfor f in \"$BRC\" /etc/profile /etc/profile.d/*.sh ; do\ngrep -Pq '^\\s*([^#]+\\s+)?TMOUT=(900|[1-8][0-9][0-9]|[1-9][0-9]|[1-9])\\b' \"$f\" &amp;&amp; grep -Pq '^\\s*([^#]+;\\s*)?readonly\\s+TMOUT(\\s+|\\s*;|\\s*$|=(900|[1-8][0-9][0-9]|[1-9][0-9]|[1-9]))\\b' \"$f\" &amp;&amp; grep -Pq '^\\s*([^#]+;\\s*)?export\\s+TMOUT(\\s+|\\s*;|\\s*$|=(900|[1-8][0-9][0-9]|[1-9][0-9]|[1-9]))\\b' \"$f\" &amp;&amp; output1=\"$f\"\ndone\ngrep -Pq '^\\s*([^#]+\\s+)?TMOUT=(9[0-9][1-9]|9[1-9][0-9]|0+|[1-9]\\d{3,})\\b' /etc/profile /etc/profile.d/*.sh \"$BRC\" &amp;&amp; output2=$(grep -Ps '^\\s*([^#]+\\s+)?TMOUT=(9[0-9][1-9]|9[1-9][0-9]|0+|[1-9]\\d{3,})\\b' /etc/profile /etc/profile.d/*.sh $BRC)\nif [ -n \"$output1\" ] &amp;&amp; [ -z \"$output2\" ]; then\necho -e \"\\nPASSED\\n\\nTMOUT is configured in: \\\"$output1\\\"\\n\"\nelse\n[ -z \"$output1\" ] &amp;&amp; echo -e \"\\nFAILED\\n\\nTMOUT is not configured\\n\"\n[ -n \"$output2\" ] &amp;&amp; echo -e \"\\nFAILED\\n\\nTMOUT is incorrectly configured in: \\\"$output2\\\"\\n\"\nfi\n</code></pre></p>","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","User Accounts and Environment","Automated","IG1","IG2","IG3","4.3 Configure Automatic Session Locking on Enterprise Assets","T1078","T1078.001","T1078.002","T1078.003","TA0005","M1026"]},{"location":"5-Access-Authentication-and-Authorization/5.5-User-Accounts-and-Environment/5.5.5-Ensure-default-user-shell-timeout-is-900-seconds-or-less/#remediation","title":"Remediation","text":"<p>Review /etc/bash.bashrc, /etc/profile, and all files ending in *.sh in the /etc/profile.d/ directory and remove or edit all TMOUT=n entries to follow local site policy. TMOUT should not exceed 900 or be equal to 0.</p> <p>Configure TMOUT in one of the following files:</p> <ul> <li>A file in the /etc/profile.d/ directory ending in .sh</li> <li>/etc/profile</li> <li>/etc/bash.bashrc</li> </ul> <p>TMOUT configuration examples:</p> <ul> <li> <p>As multiple lines: <pre><code>TMOUT=900\nreadonly TMOUT\nexport TMOUT\n</code></pre></p> </li> <li> <p>As a single line: <pre><code>readonly TMOUT=900 ; export TMOUT\n</code></pre></p> </li> </ul>","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","User Accounts and Environment","Automated","IG1","IG2","IG3","4.3 Configure Automatic Session Locking on Enterprise Assets","T1078","T1078.001","T1078.002","T1078.003","TA0005","M1026"]},{"location":"5-Access-Authentication-and-Authorization/5.5-User-Accounts-and-Environment/5.5.1-Set-Shadow-Password-Suite-Parameters/5.5.1.1-Ensure-minimum-days-between-password-changes-is-configured/","title":"5.5.1.1 Ensure minimum days between password changes is configured","text":"","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","User Accounts and Environment","Set Shadow Password Suite Parameters","Automated","IG1","IG2","IG3","5.2 Use Unique Passwords","T1078","T1078.001","T1078.002","T1078.003","T1078.004","T1110","T1110.004","TA0006","MA1027"]},{"location":"5-Access-Authentication-and-Authorization/5.5-User-Accounts-and-Environment/5.5.1-Set-Shadow-Password-Suite-Parameters/5.5.1.1-Ensure-minimum-days-between-password-changes-is-configured/#audit","title":"Audit","text":"<p>Run the following command and verify PASS_MIN_DAYS conforms to site policy (no less than 1 day): <pre><code># grep PASS_MIN_DAYS /etc/login.defs\nPASS_MIN_DAYS 1\n</code></pre></p> <p>Run the following command and Review list of users and PAS_MIN_DAYS to Verify that all users' PAS_MIN_DAYS conforms to site policy (no less than 1 day): <pre><code># awk -F : '(/^[^:]+:[^!*]/ &amp;&amp; $4 &lt; 1){print $1 \" \" $4}' /etc/shadow\nNo &lt;user&gt;:&lt;PASS_MIN_DAYS&gt; should be returned\n</code></pre></p>","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","User Accounts and Environment","Set Shadow Password Suite Parameters","Automated","IG1","IG2","IG3","5.2 Use Unique Passwords","T1078","T1078.001","T1078.002","T1078.003","T1078.004","T1110","T1110.004","TA0006","MA1027"]},{"location":"5-Access-Authentication-and-Authorization/5.5-User-Accounts-and-Environment/5.5.1-Set-Shadow-Password-Suite-Parameters/5.5.1.1-Ensure-minimum-days-between-password-changes-is-configured/#remediation","title":"Remediation","text":"<p>Set the PASS_MIN_DAYS parameter to 1 in /etc/login.defs : <pre><code>PASS_MIN_DAYS 1\n</code></pre></p> <p>Modify user parameters for all users with a password set to match: <pre><code># chage --mindays 1 &lt;user&gt;\n</code></pre></p> <p>Default Value:</p> <p>PASS_MIN_DAYS 0</p>","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","User Accounts and Environment","Set Shadow Password Suite Parameters","Automated","IG1","IG2","IG3","5.2 Use Unique Passwords","T1078","T1078.001","T1078.002","T1078.003","T1078.004","T1110","T1110.004","TA0006","MA1027"]},{"location":"5-Access-Authentication-and-Authorization/5.5-User-Accounts-and-Environment/5.5.1-Set-Shadow-Password-Suite-Parameters/5.5.1.2-Ensure-password-expiration-is-365-days-or-less/","title":"5.5.1.2 Ensure password expiration is 365 days or less","text":"","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","User Accounts and Environment","Set Shadow Password Suite Parameters","Automated","IG1","IG2","IG3","5.2 Use Unique Passwords","T1078","T1078.001","T1078.002","T1078.003","T1078.004","T1110","T1110.001","T1110.002","T1110.003","T1110.004"]},{"location":"5-Access-Authentication-and-Authorization/5.5-User-Accounts-and-Environment/5.5.1-Set-Shadow-Password-Suite-Parameters/5.5.1.2-Ensure-password-expiration-is-365-days-or-less/#audit","title":"Audit","text":"<p>Run the following command and verify PASS_MAX_DAYS conforms to site policy, does not exceed 365 days, and is greater than PASS_MIN_DAYS: <pre><code># grep PASS_MAX_DAYS /etc/login.defs\nPASS_MAX_DAYS 365\n</code></pre></p> <p>Run the following command and Review list of users and PASS_MAX_DAYS to verify that all users' PASS_MAX_DAYS conforms to site policy, does not exceed 365 days, and is no less than PASS_MIN_DAYS <pre><code># awk -F: '(/^[^:]+:[^!*]/ &amp;&amp; ($5&gt;365 || $5~/([0-1]|-1|\\s*)/)){print $1 \" \" $5}' /etc/shadow\nNo &lt;user&gt;:&lt;PASS_MAX_DAYS&gt; should be returned\n</code></pre></p>","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","User Accounts and Environment","Set Shadow Password Suite Parameters","Automated","IG1","IG2","IG3","5.2 Use Unique Passwords","T1078","T1078.001","T1078.002","T1078.003","T1078.004","T1110","T1110.001","T1110.002","T1110.003","T1110.004"]},{"location":"5-Access-Authentication-and-Authorization/5.5-User-Accounts-and-Environment/5.5.1-Set-Shadow-Password-Suite-Parameters/5.5.1.2-Ensure-password-expiration-is-365-days-or-less/#remediation","title":"Remediation","text":"<p>Set the PASS_MAX_DAYS parameter to conform to site policy in /etc/login.defs : <pre><code>PASS_MA_DAYS 365\n</code></pre></p> <p>Modify user parameters for all users with a password set to match: <pre><code># chage --maxdays 365 &lt;user&gt;\n</code></pre></p> <p>Default Value:</p> <p>PASS_MAX_DAYS 99999</p>","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","User Accounts and Environment","Set Shadow Password Suite Parameters","Automated","IG1","IG2","IG3","5.2 Use Unique Passwords","T1078","T1078.001","T1078.002","T1078.003","T1078.004","T1110","T1110.001","T1110.002","T1110.003","T1110.004"]},{"location":"5-Access-Authentication-and-Authorization/5.5-User-Accounts-and-Environment/5.5.1-Set-Shadow-Password-Suite-Parameters/5.5.1.3-Ensure-password-expiration-warning-days-is-7-or-more/","title":"5.5.1.3 Ensure password expiration warning days is 7 or more","text":"","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","User Accounts and Environment","Set Shadow Password Suite Parameters","Automated","IG1","IG2","IG3","5.2 Use Unique Passwords","TA0006","M1027"]},{"location":"5-Access-Authentication-and-Authorization/5.5-User-Accounts-and-Environment/5.5.1-Set-Shadow-Password-Suite-Parameters/5.5.1.3-Ensure-password-expiration-warning-days-is-7-or-more/#audit","title":"Audit","text":"<p>Run the following command and verify PASS_WARN_AGE conforms to site policy (No less than 7 days): <pre><code># grep PASS_WARN_AGE /etc/login.defs\nPASS_WARN_AGE 7\n</code></pre></p> <p>Verify all users with a password have their number of days of warning before password expires set to 7 or more:</p> <p>Run the following command and Review list of users and PASS_WARN_AGE to verify that all users' PASS_WARN_AGE conforms to site policy (No less than 7 days): <pre><code># awk -F: '(/^[^:]+:[^!*]/ &amp;&amp; $6&lt;7){print $1 \" \" $6}' /etc/shadow\nNo &lt;user&gt;:&lt;PASS_WARN_AGE&gt; should be returned\n</code></pre></p>","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","User Accounts and Environment","Set Shadow Password Suite Parameters","Automated","IG1","IG2","IG3","5.2 Use Unique Passwords","TA0006","M1027"]},{"location":"5-Access-Authentication-and-Authorization/5.5-User-Accounts-and-Environment/5.5.1-Set-Shadow-Password-Suite-Parameters/5.5.1.3-Ensure-password-expiration-warning-days-is-7-or-more/#remediation","title":"Remediation","text":"<p>Set the PASS_WARN_AGE parameter to 7 in /etc/login.defs : <pre><code>PASS_WARN_AGE 7\n</code></pre></p> <p>Modify user parameters for all users with a password set to match: <pre><code># chage --warndays 7 &lt;user&gt;\n</code></pre></p> <p>Default Value:</p> <p>PASS_WARN_AGE 7</p>","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","User Accounts and Environment","Set Shadow Password Suite Parameters","Automated","IG1","IG2","IG3","5.2 Use Unique Passwords","TA0006","M1027"]},{"location":"5-Access-Authentication-and-Authorization/5.5-User-Accounts-and-Environment/5.5.1-Set-Shadow-Password-Suite-Parameters/5.5.1.4-Ensure-inactive-password-lock-is-30-days-or-less/","title":"5.5.1.4 Ensure inactive password lock is 30 days or less","text":"","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","User Accounts and Environment","Set Shadow Password Suite Parameters","Automated","IG1","IG2","IG3","5.2 Use Unique Passwords","T1078","T1078.002","T1078.003","TA0001","M1027"]},{"location":"5-Access-Authentication-and-Authorization/5.5-User-Accounts-and-Environment/5.5.1-Set-Shadow-Password-Suite-Parameters/5.5.1.4-Ensure-inactive-password-lock-is-30-days-or-less/#audit","title":"Audit","text":"<p>Run the following command and verify INACTIVE conforms to sire policy (no more than 30 days): <pre><code># useradd -D | grep INACTIVE\nINACTIVE=30\n</code></pre></p> <p>Verify all users with a password have Password inactive no more than 30 days after password expires:</p> <p>Run the following command and Review list of users and INACTIVE to verify that all users' INACTIVE conforms to site policy (no more than 30 days): <pre><code># awk -F: '(/^[^:]+:[^!*]/ &amp;&amp; ($7~/(\\\\s*$|-1)/ || $7&gt;30)){print $1 \" \" $7}' /etc/shadow\nNo &lt;user&gt;:&lt;INACTIVE&gt; should be returned\n</code></pre></p>","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","User Accounts and Environment","Set Shadow Password Suite Parameters","Automated","IG1","IG2","IG3","5.2 Use Unique Passwords","T1078","T1078.002","T1078.003","TA0001","M1027"]},{"location":"5-Access-Authentication-and-Authorization/5.5-User-Accounts-and-Environment/5.5.1-Set-Shadow-Password-Suite-Parameters/5.5.1.4-Ensure-inactive-password-lock-is-30-days-or-less/#remediation","title":"Remediation","text":"<p>Run the following command to set the default password inactivity period to 30 days: <pre><code># useradd -D -f 30\n</code></pre></p> <p>Modify user parameters for all users with a password set to match: <pre><code># chage --inactive 30 &lt;user&gt;\n</code></pre></p> <p>Default Value:</p> <p>INACTIVE=-1</p>","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","User Accounts and Environment","Set Shadow Password Suite Parameters","Automated","IG1","IG2","IG3","5.2 Use Unique Passwords","T1078","T1078.002","T1078.003","TA0001","M1027"]},{"location":"5-Access-Authentication-and-Authorization/5.5-User-Accounts-and-Environment/5.5.1-Set-Shadow-Password-Suite-Parameters/5.5.1.5-Ensure-all-users-last-password-change-date-is-in-the-past/","title":"5.5.1.5 Ensure all users last password change date is in the past","text":"","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","User Accounts and Environment","Set Shadow Password Suite Parameters","Automated","IG1","IG2","IG3","5.2 Use Unique Passwords","T1078","T1078.001","T1078.002","T1078.003","T1078.004","T1110","T1110.001","T1110.002","T1110.003","T1110.004"]},{"location":"5-Access-Authentication-and-Authorization/5.5-User-Accounts-and-Environment/5.5.1-Set-Shadow-Password-Suite-Parameters/5.5.1.5-Ensure-all-users-last-password-change-date-is-in-the-past/#audit","title":"Audit","text":"<p>Run the following command and verify nothing is returned <pre><code># awk -F: '/^[^:]+:[^!*]/{print $1}' /etc/shadow | while read -r usr; \\\ndo change=$(date -d \"$(chage --list $usr | grep '^Last password change' | cut -d: -f2 | grep -v 'never$')\" +%s); \\\nif [[ \"$change\" -gt \"$(date +%s)\" ]]; then \\\necho \"User: \\\"$usr\\\" last password change was \\\"$(chage --list $usr | grep '^Last password change' | cut -d: -f2)\\\"\"; fi; done\n</code></pre></p>","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","User Accounts and Environment","Set Shadow Password Suite Parameters","Automated","IG1","IG2","IG3","5.2 Use Unique Passwords","T1078","T1078.001","T1078.002","T1078.003","T1078.004","T1110","T1110.001","T1110.002","T1110.003","T1110.004"]},{"location":"5-Access-Authentication-and-Authorization/5.5-User-Accounts-and-Environment/5.5.1-Set-Shadow-Password-Suite-Parameters/5.5.1.5-Ensure-all-users-last-password-change-date-is-in-the-past/#remediation","title":"Remediation","text":"<p>Investigate any users with a password change date in the future and correct them.</p> <p>Locking the account, expiring the password, or resetting the password manually may be appropriate.</p>","tags":["Level 1","Workstation","Server","Access, Authentication and Authorization","User Accounts and Environment","Set Shadow Password Suite Parameters","Automated","IG1","IG2","IG3","5.2 Use Unique Passwords","T1078","T1078.001","T1078.002","T1078.003","T1078.004","T1110","T1110.001","T1110.002","T1110.003","T1110.004"]},{"location":"6-System-Maintenance/6.1-System-File-Permissions/6.1.1-Ensure-permissions-on-etc-passwd-are-configured/","title":"6.1.1 Ensure permissions on /etc/passwd are configured","text":"","tags":["Level 1","Workstation","Server","System Maintenance","System File Permissions","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1003","T1003.008","T1222","T1222.002","TA0005","M1022"]},{"location":"6-System-Maintenance/6.1-System-File-Permissions/6.1.1-Ensure-permissions-on-etc-passwd-are-configured/#audit","title":"Audit","text":"<p>Run the following command to verify /etc/passwd is mode 644 or more restrictive, Uid is 0/root and Gid is 0/root: <pre><code># stat -Lc \"%n %a %u/%U %g/%G\" /etc/passwd\n/etc/passwd 644 0/root 0/root\n</code></pre></p>","tags":["Level 1","Workstation","Server","System Maintenance","System File Permissions","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1003","T1003.008","T1222","T1222.002","TA0005","M1022"]},{"location":"6-System-Maintenance/6.1-System-File-Permissions/6.1.1-Ensure-permissions-on-etc-passwd-are-configured/#remediation","title":"Remediation","text":"<p>Run the following commands to remove excess permissions, set owner, and set group on /etc/passwd: <pre><code># chmod u-x,go-wx /etc/passwd\n</code></pre></p> <pre><code># chown root:root /etc/passwd\n</code></pre> <p>Default Value:</p> <p>/etc/passwd 644 0/root 0/root</p>","tags":["Level 1","Workstation","Server","System Maintenance","System File Permissions","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1003","T1003.008","T1222","T1222.002","TA0005","M1022"]},{"location":"6-System-Maintenance/6.1-System-File-Permissions/6.1.10-Ensure-no-unowned-files-or-directories-exist/","title":"6.1.10 Ensure no unowned files or directories exist","text":"","tags":["Level 1","Workstation","Server","System Maintenance","System File Permissions","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1222","T1222.002","TA0007"]},{"location":"6-System-Maintenance/6.1-System-File-Permissions/6.1.10-Ensure-no-unowned-files-or-directories-exist/#audit","title":"Audit","text":"<p>Run the following command and verify no files are returned: <pre><code># df --local -P | awk {'if (NR!=1) print $6'} | xargs -I '{}' find '{}' -xdev -nouser\n</code></pre></p> <p>The command above only searches local filesystems, there may still be compromised items on network mounted partitions. Additionally the --local option to df is not universal to all versions, it can be omitted to search all filesystems on a system including network mounted filesystems or the following command can be run manually for each partition: <pre><code># find &lt;partition&gt; -xdev -nouser\n</code></pre></p>","tags":["Level 1","Workstation","Server","System Maintenance","System File Permissions","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1222","T1222.002","TA0007"]},{"location":"6-System-Maintenance/6.1-System-File-Permissions/6.1.10-Ensure-no-unowned-files-or-directories-exist/#remediation","title":"Remediation","text":"<p>Locate files that are owned by users or groups not listed in the system configuration files, and reset the ownership of these files to some active user on the system as appropriate.</p>","tags":["Level 1","Workstation","Server","System Maintenance","System File Permissions","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1222","T1222.002","TA0007"]},{"location":"6-System-Maintenance/6.1-System-File-Permissions/6.1.11-Ensure-no-ungrouped-files-or-directories-exist/","title":"6.1.11 Ensure no ungrouped files or directories exist","text":"","tags":["Level 1","Workstation","Server","System Maintenance","System File Permissions","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1222","T1222.002","TA0007"]},{"location":"6-System-Maintenance/6.1-System-File-Permissions/6.1.11-Ensure-no-ungrouped-files-or-directories-exist/#audit","title":"Audit","text":"<p>Run the following command and verify no files are returned: <pre><code># df --local -P | awk '{if (NR!=1) print $6}' | xargs -I '{}' find '{}' -xdev -nogroup\n</code></pre></p> <p>The command above only searches local filesystems, there may still be compromised items on network mounted partitions. Additionally the --local option to df is not universal to all versions, it can be omitted to search all filesystems on a system including network mounted filesystems or the following command can be run manually for each partition: <pre><code># find &lt;partition&gt; -xdev -nogroup\n</code></pre></p>","tags":["Level 1","Workstation","Server","System Maintenance","System File Permissions","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1222","T1222.002","TA0007"]},{"location":"6-System-Maintenance/6.1-System-File-Permissions/6.1.11-Ensure-no-ungrouped-files-or-directories-exist/#remediation","title":"Remediation","text":"<p>Locate files that are owned by users or groups not listed in the system configuration files, and reset the ownership of these files to some active user on the system as appropriate.</p>","tags":["Level 1","Workstation","Server","System Maintenance","System File Permissions","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1222","T1222.002","TA0007"]},{"location":"6-System-Maintenance/6.1-System-File-Permissions/6.1.12-Audit-SUID-executables/","title":"6.1.12 Audit SUID executables","text":"","tags":["Level 1","Workstation","Server","System Maintenance","System File Permissions","Manual","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1548","T1548.001","TA0004","M1028"]},{"location":"6-System-Maintenance/6.1-System-File-Permissions/6.1.12-Audit-SUID-executables/#audit","title":"Audit","text":"<p>Run the following command to list SUID files: <pre><code># df --local -P | awk '{if (NR!=1) print $6}' | xargs -I '{}' find '{}' -xdev -type f -perm -4000\n</code></pre></p> <p>The command above only searches local filesystems, there may still be compromised items on network mounted partitions. Additionally the --local option to df is not universal to all versions, it can be omitted to search all filesystems on a system including network mounted filesystems or the following command can be run manually for each partition: <pre><code># find &lt;partition&gt; -xdev -type f -perm -4000\n</code></pre></p>","tags":["Level 1","Workstation","Server","System Maintenance","System File Permissions","Manual","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1548","T1548.001","TA0004","M1028"]},{"location":"6-System-Maintenance/6.1-System-File-Permissions/6.1.12-Audit-SUID-executables/#remediation","title":"Remediation","text":"<p>Ensure that no rogue SUID programs have been introduced into the system. Review the files returned by the action in the Audit section and confirm the integrity of these binaries.</p>","tags":["Level 1","Workstation","Server","System Maintenance","System File Permissions","Manual","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1548","T1548.001","TA0004","M1028"]},{"location":"6-System-Maintenance/6.1-System-File-Permissions/6.1.13-Audit-SGID-executables/","title":"6.1.13 Audit SGID executables","text":"","tags":["Level 1","Workstation","Server","System Maintenance","System File Permissions","Manual","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1548","T1548.001","TA0004","M1028"]},{"location":"6-System-Maintenance/6.1-System-File-Permissions/6.1.13-Audit-SGID-executables/#audit","title":"Audit","text":"<p>Run the following command to list SGID files: <pre><code># df --local -P | awk '{if (NR!=1) print $6}' | xargs -I '{}' find '{}' -xdev -type f -perm -2000\n</code></pre></p> <p>The command above only searches local filesystems, there may still be compromised items on network mounted partitions. Additionally the --local option to df is not universal to all versions, it can be omitted to search all filesystems on a system including network mounted filesystems or the following command can be run manually for each partition: <pre><code># find &lt;partition&gt; -xdev -type f -perm -2000\n</code></pre></p>","tags":["Level 1","Workstation","Server","System Maintenance","System File Permissions","Manual","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1548","T1548.001","TA0004","M1028"]},{"location":"6-System-Maintenance/6.1-System-File-Permissions/6.1.13-Audit-SGID-executables/#remediation","title":"Remediation","text":"<p>Ensure that no rogue SGID programs have been introduced into the system. Review the files returned by the action in the Audit section and confirm the integrity of these binaries.</p>","tags":["Level 1","Workstation","Server","System Maintenance","System File Permissions","Manual","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1548","T1548.001","TA0004","M1028"]},{"location":"6-System-Maintenance/6.1-System-File-Permissions/6.1.2-Ensure-permissions-on-etc-passwd-are-configured/","title":"6.1.2 Ensure permissions on /etc/passwd- are configured","text":"","tags":["Level 1","Workstation","Server","System Maintenance","System File Permissions","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1003","T1003.008","T1222","T1222.002","TA0005","M1022"]},{"location":"6-System-Maintenance/6.1-System-File-Permissions/6.1.2-Ensure-permissions-on-etc-passwd-are-configured/#audit","title":"Audit","text":"<p>Run the following command to verify /etc/passwd- is mode 644 or more restrictive, Uid is 0/root and Gid is 0/root: <pre><code># stat -Lc \"%n %a %u/%U %g/%G\" /etc/passwd-\n/etc/passwd- 644 0/root 0/root\n</code></pre></p>","tags":["Level 1","Workstation","Server","System Maintenance","System File Permissions","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1003","T1003.008","T1222","T1222.002","TA0005","M1022"]},{"location":"6-System-Maintenance/6.1-System-File-Permissions/6.1.2-Ensure-permissions-on-etc-passwd-are-configured/#remediation","title":"Remediation","text":"<p>Run the following commands to remove excess permissions, set owner, and set group on /etc/passwd-: <pre><code># chmod u-x,go-wx /etc/passwd-\n# chown root:root /etc/passwd\n</code></pre></p> <p>Default Value:</p> <p>/etc/passwd- 644 0/root 0/root</p>","tags":["Level 1","Workstation","Server","System Maintenance","System File Permissions","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1003","T1003.008","T1222","T1222.002","TA0005","M1022"]},{"location":"6-System-Maintenance/6.1-System-File-Permissions/6.1.3-Ensure-permissions-on-etc-group-are-configured/","title":"6.1.3 Ensure permissions on /etc/group are configured","text":"","tags":["Level 1","Workstation","Server","System Maintenance","System File Permissions","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1003","T1003.008","T1222","T1222.002","TA0005","M1022"]},{"location":"6-System-Maintenance/6.1-System-File-Permissions/6.1.3-Ensure-permissions-on-etc-group-are-configured/#audit","title":"Audit","text":"<p>Run the following command to verify /etc/group is mode 644 or more restrictive, Uid is 0/root and Gid is 0/root: <pre><code># stat -Lc \"%n %a %u/%U %g/%G\" /etc/group\n/etc/group 644 0/root 0/root\n</code></pre></p>","tags":["Level 1","Workstation","Server","System Maintenance","System File Permissions","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1003","T1003.008","T1222","T1222.002","TA0005","M1022"]},{"location":"6-System-Maintenance/6.1-System-File-Permissions/6.1.3-Ensure-permissions-on-etc-group-are-configured/#remediation","title":"Remediation","text":"<p>Run the following commands to remove excess permissions, set owner, and set group on /etc/group: <pre><code># chmod u-x,go-wx /etc/group\n# chown root:root /etc/group\n</code></pre></p> <p>Default Value:</p> <p>/etc/group 644 0/root 0/root</p>","tags":["Level 1","Workstation","Server","System Maintenance","System File Permissions","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1003","T1003.008","T1222","T1222.002","TA0005","M1022"]},{"location":"6-System-Maintenance/6.1-System-File-Permissions/6.1.4-Ensure-permissions-on-etc-group-are-configured/","title":"6.1.4 Ensure permissions on /etc/group- are configured","text":"","tags":["Level 1","Workstation","Server","System Maintenance","System File Permissions","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1003","T1003.008","T1222","T1222.002","TA0005","M1022"]},{"location":"6-System-Maintenance/6.1-System-File-Permissions/6.1.4-Ensure-permissions-on-etc-group-are-configured/#audit","title":"Audit","text":"<p>Run the following command to verify /etc/group- is mode 644 or more restrictive, Uid is 0/root and Gid is 0/root: <pre><code># stat -Lc \"%n %a %u/%U %g/%G\" /etc/group-\n/etc/group- 644 0/root 0/root\n</code></pre></p>","tags":["Level 1","Workstation","Server","System Maintenance","System File Permissions","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1003","T1003.008","T1222","T1222.002","TA0005","M1022"]},{"location":"6-System-Maintenance/6.1-System-File-Permissions/6.1.4-Ensure-permissions-on-etc-group-are-configured/#remediation","title":"Remediation","text":"<p>Run the following command to verify /etc/group- is mode 644 or more restrictive, Uid is 0/root and Gid is 0/root: <pre><code># stat -Lc \"%n %a %u/%U %g/%G\" /etc/group-\n/etc/group- 644 0/root 0/root\n</code></pre></p> <p>Default Value:</p> <p>/etc/group- 644 0/root 0/root</p>","tags":["Level 1","Workstation","Server","System Maintenance","System File Permissions","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1003","T1003.008","T1222","T1222.002","TA0005","M1022"]},{"location":"6-System-Maintenance/6.1-System-File-Permissions/6.1.5-Ensure-permissions-on-etc-shadow-are-configured/","title":"6.1.5 Ensure permissions on /etc/shadow are configured","text":"","tags":["Level 1","Workstation","Server","System Maintenance","System File Permissions","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1003","T1003.008","T1222","T1222.002","TA0005","M1022"]},{"location":"6-System-Maintenance/6.1-System-File-Permissions/6.1.5-Ensure-permissions-on-etc-shadow-are-configured/#audit","title":"Audit","text":"<p>Run the following command to verify /etc/shadow is mode 640 or more restrictive, Uid is 0/root and Gid is 0/root: <pre><code># stat -Lc \"%n %a %u/%U %g/%G\" /etc/shadow\n</code></pre></p> <p>Example: <pre><code>/etc/shadow 640 0/root 42/shadow\n</code></pre></p>","tags":["Level 1","Workstation","Server","System Maintenance","System File Permissions","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1003","T1003.008","T1222","T1222.002","TA0005","M1022"]},{"location":"6-System-Maintenance/6.1-System-File-Permissions/6.1.5-Ensure-permissions-on-etc-shadow-are-configured/#remediation","title":"Remediation","text":"<p>Run one of the following commands to set ownership of /etc/shadow to root and group to either root or shadow: <pre><code># chown root:shadow /etc/shadow\n</code></pre></p> <p>-OR- <pre><code># chown root:root /etc/shadow\n</code></pre></p> <p>Run the following command to remove excess permissions form /etc/shadow: <pre><code># chmod u-x,g-wx,o-rwx /etc/shadow\n</code></pre></p> <p>Default Value:</p> <p>/etc/shadow 640 0/root 42/shadow</p>","tags":["Level 1","Workstation","Server","System Maintenance","System File Permissions","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1003","T1003.008","T1222","T1222.002","TA0005","M1022"]},{"location":"6-System-Maintenance/6.1-System-File-Permissions/6.1.6-Ensure-permissions-on-etc-shadow-are-configured/","title":"6.1.6 Ensure permissions on /etc/shadow- are configured","text":"","tags":["Level 1","Workstation","Server","System Maintenance","System File Permissions","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1003","T1003.008","T1222","T1222.002","TA0005","M1022"]},{"location":"6-System-Maintenance/6.1-System-File-Permissions/6.1.6-Ensure-permissions-on-etc-shadow-are-configured/#audit","title":"Audit","text":"<p>Run the following command to verify /etc/shadow- is mode 640 or more restrictive, Uid is 0/root and Gid is 0/root: <pre><code># stat -Lc \"%n %a %u/%U %g/%G\" /etc/shadow-\n</code></pre></p> <p>Example: <pre><code>/etc/shadow 640 0/root 42/shadow-\n</code></pre></p>","tags":["Level 1","Workstation","Server","System Maintenance","System File Permissions","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1003","T1003.008","T1222","T1222.002","TA0005","M1022"]},{"location":"6-System-Maintenance/6.1-System-File-Permissions/6.1.6-Ensure-permissions-on-etc-shadow-are-configured/#remediation","title":"Remediation","text":"<p>Run one of the following commands to set ownership of /etc/shadow- to root and group to either root or shadow: <pre><code># chown root:shadow /etc/shadow-\n</code></pre></p> <p>-OR- <pre><code># chown root:root /etc/shadow-\n</code></pre></p> <p>Run the following command to remove excess permissions form /etc/shadow-: <pre><code># chmod u-x,g-wx,o-rwx /etc/shadow-\n</code></pre></p> <p>Default Value:</p> <p>/etc/shadow- 640 0/root 42/shadow</p>","tags":["Level 1","Workstation","Server","System Maintenance","System File Permissions","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1003","T1003.008","T1222","T1222.002","TA0005","M1022"]},{"location":"6-System-Maintenance/6.1-System-File-Permissions/6.1.7-Ensure-permissions-on-etc-gshadow-are-configured/","title":"6.1.7 Ensure permissions on /etc/gshadow are configured","text":"","tags":["Level 1","Workstation","Server","System Maintenance","System File Permissions","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1003","T1003.008","T1222","T1222.002","TA0005","M1022"]},{"location":"6-System-Maintenance/6.1-System-File-Permissions/6.1.7-Ensure-permissions-on-etc-gshadow-are-configured/#audit","title":"Audit","text":"<p>Run the following command to verify /etc/gshadow is mode 640 or more restrictive, Uid is 0/root and Gid is 0/root: <pre><code># stat -Lc \"%n %a %u/%U %g/%G\" /etc/gshadow\n</code></pre></p> <p>Example: <pre><code>/etc/gshadow 640 0/root 42/gshadow\n</code></pre></p>","tags":["Level 1","Workstation","Server","System Maintenance","System File Permissions","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1003","T1003.008","T1222","T1222.002","TA0005","M1022"]},{"location":"6-System-Maintenance/6.1-System-File-Permissions/6.1.7-Ensure-permissions-on-etc-gshadow-are-configured/#remediation","title":"Remediation","text":"<p>Run one of the following commands to set ownership of /etc/gshadow to root and group to either root or shadow: <pre><code># chown root:shadow /etc/gshadow\n</code></pre></p> <p>-OR- <pre><code># chown root:root /etc/gshadow\n</code></pre></p> <p>Run the following command to remove excess permissions form /etc/gshadow: <pre><code># chmod u-x,g-wx,o-rwx /etc/gshadow\n</code></pre></p> <p>Default Value:</p> <p>/etc/gshadow 640 0/root 42/shadow</p>","tags":["Level 1","Workstation","Server","System Maintenance","System File Permissions","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1003","T1003.008","T1222","T1222.002","TA0005","M1022"]},{"location":"6-System-Maintenance/6.1-System-File-Permissions/6.1.8-Ensure-permissions-on-etc-gshadow-are-configured/","title":"E6.1.8 Ensure permissions on /etc/gshadow- are configured","text":"","tags":["Level 1","Workstation","Server","System Maintenance","System File Permissions","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1003","T1003.008","T1222","T1222.002","TA0005","M1022"]},{"location":"6-System-Maintenance/6.1-System-File-Permissions/6.1.8-Ensure-permissions-on-etc-gshadow-are-configured/#audit","title":"Audit","text":"<p>Run the following command to verify /etc/gshadow- is mode 640 or more restrictive, Uid is 0/root and Gid is 0/root: <pre><code># stat -Lc \"%n %a %u/%U %g/%G\" /etc/gshadow-\n</code></pre></p> <p>Example: <pre><code>/etc/gshadow- 640 0/root 42/shadow\n</code></pre></p>","tags":["Level 1","Workstation","Server","System Maintenance","System File Permissions","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1003","T1003.008","T1222","T1222.002","TA0005","M1022"]},{"location":"6-System-Maintenance/6.1-System-File-Permissions/6.1.8-Ensure-permissions-on-etc-gshadow-are-configured/#remediation","title":"Remediation","text":"<p>Run one of the following commands to set ownership of /etc/gshadow- to root and group to either root or shadow: <pre><code># chown root:shadow /etc/gshadow-\n</code></pre></p> <p>-OR- <pre><code># chown root:root /etc/gshadow-\n</code></pre></p> <p>Run the following command to remove excess permissions form /etc/gshadow-: <pre><code># chmod u-x,g-wx,o-rwx /etc/gshadow-\n</code></pre></p> <p>Default Value:</p> <p>/etc/gshadow- 640 0/root 42/shadow</p>","tags":["Level 1","Workstation","Server","System Maintenance","System File Permissions","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1003","T1003.008","T1222","T1222.002","TA0005","M1022"]},{"location":"6-System-Maintenance/6.1-System-File-Permissions/6.1.9-Ensure-no-world-writable-files-exist/","title":"6.1.9 Ensure no world writable files exist","text":"","tags":["Level 1","Workstation","Server","System Maintenance","System File Permissions","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1222","T1222.002","TA0005","M1022"]},{"location":"6-System-Maintenance/6.1-System-File-Permissions/6.1.9-Ensure-no-world-writable-files-exist/#audit","title":"Audit","text":"<p>Run the following command and verify no files are returned: <pre><code># df --local -P | awk '{if (NR!=1) print $6}' | xargs -I '{}' find '{}' -xdev -type f -perm -0002\n</code></pre></p> <p>The command above only searches local filesystems, there may still be compromised items on network mounted partitions. Additionally the --local option to df is not universal to all versions, it can be omitted to search all filesystems on a system including network mounted filesystems or the following command can be run manually for each partition: <pre><code># find &lt;partition&gt; -xdev -type f -perm -0002\n</code></pre></p>","tags":["Level 1","Workstation","Server","System Maintenance","System File Permissions","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1222","T1222.002","TA0005","M1022"]},{"location":"6-System-Maintenance/6.1-System-File-Permissions/6.1.9-Ensure-no-world-writable-files-exist/#remediation","title":"Remediation","text":"<p>Removing write access for the \"other\" category ( <code>chmod o-w &lt;filename&gt;</code> ) is advisable, but always consult relevant vendor documentation to avoid breaking any application dependencies on a given file.</p>","tags":["Level 1","Workstation","Server","System Maintenance","System File Permissions","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1222","T1222.002","TA0005","M1022"]},{"location":"6-System-Maintenance/6.2-Local-User-and-Group-Settings/6.2.1-Ensure-accounts-in-etc-passwd-use-shadowed-passwords/","title":"6.2.1 Ensure accounts in /etc/passwd use shadowed passwords","text":"","tags":["Level 1","Workstation","Server","System Maintenance","Local User and Group Settings","Automated","IG2","IG3","3.11 Encrypt Sensitive Data at Rest","T1003","T1003.008","TA0003","M1027"]},{"location":"6-System-Maintenance/6.2-Local-User-and-Group-Settings/6.2.1-Ensure-accounts-in-etc-passwd-use-shadowed-passwords/#audit","title":"Audit","text":"<p>Run the following command and verify that no output is returned: <pre><code># awk -F: '($2 != \"x\" ) { print $1 \" is not set to shadowed passwords \"}' /etc/passwd\n</code></pre></p>","tags":["Level 1","Workstation","Server","System Maintenance","Local User and Group Settings","Automated","IG2","IG3","3.11 Encrypt Sensitive Data at Rest","T1003","T1003.008","TA0003","M1027"]},{"location":"6-System-Maintenance/6.2-Local-User-and-Group-Settings/6.2.1-Ensure-accounts-in-etc-passwd-use-shadowed-passwords/#remediation","title":"Remediation","text":"<p>Run the following command to set accounts to use shadowed passwords: <pre><code># sed -e 's/^\\([a-zA-Z0-9_]*\\):[^:]*:/\\1:x:/' -i /etc/passwd\n</code></pre></p> <p>Investigate to determine if the account is logged in and what it is being used for, to determine if it needs to be forced off.</p>","tags":["Level 1","Workstation","Server","System Maintenance","Local User and Group Settings","Automated","IG2","IG3","3.11 Encrypt Sensitive Data at Rest","T1003","T1003.008","TA0003","M1027"]},{"location":"6-System-Maintenance/6.2-Local-User-and-Group-Settings/6.2.10-Ensure-root-is-the-only-UID-0-account/","title":"6.2.10 Ensure root is the only UID 0 account","text":"","tags":["Level 1","Workstation","Server","System Maintenance","Local User and Group Settings","Automated","T1548","TA0001","M1026"]},{"location":"6-System-Maintenance/6.2-Local-User-and-Group-Settings/6.2.10-Ensure-root-is-the-only-UID-0-account/#audit","title":"Audit","text":"<p>Run the following command and verify that only \"root\" is returned: <pre><code># awk -F: '($3 == 0) { print $1 }' /etc/passwd\nroot\n</code></pre></p>","tags":["Level 1","Workstation","Server","System Maintenance","Local User and Group Settings","Automated","T1548","TA0001","M1026"]},{"location":"6-System-Maintenance/6.2-Local-User-and-Group-Settings/6.2.10-Ensure-root-is-the-only-UID-0-account/#remediation","title":"Remediation","text":"<p>Remove any users other than root with UID 0 or assign them a new UID if appropriate.</p>","tags":["Level 1","Workstation","Server","System Maintenance","Local User and Group Settings","Automated","T1548","TA0001","M1026"]},{"location":"6-System-Maintenance/6.2-Local-User-and-Group-Settings/6.2.11-Ensure-local-interactive-user-home-directories-exist/","title":"6.2.11 Ensure local interactive user home directories exist","text":"","tags":["Level 1","Workstation","Server","System Maintenance","Local User and Group Settings","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","TA0005","M1022"]},{"location":"6-System-Maintenance/6.2-Local-User-and-Group-Settings/6.2.11-Ensure-local-interactive-user-home-directories-exist/#audit","title":"Audit","text":"<p>Run the following script to verify all local interactive user home directories exist: <pre><code>#!/usr/bin/env bash\n{\noutput=\"\"\nvalid_shells=\"^($( sed -rn '/^\\//{s,/,\\\\\\\\/,g;p}' /etc/shells | paste -s -d '|' - ))$\"\nawk -v pat=\"$valid_shells\" -F: '$(NF) ~ pat { print $1 \" \" $(NF-1) }' /etc/passwd | (while read -r user home; do\n[ ! -d \"$home\" ] &amp;&amp; output=\"$output\\n - User \\\"$user\\\" home directory \\\"$home\\\" doesn't exist\"\ndone\nif [ -z \"$output\" ]; then\necho -e \"\\n-PASSED: - All local interactive users have a home directory\\n\"\nelse\necho -e \"\\n- FAILED:\\n$output\\n\"\nfi\n)\n}\n</code></pre></p>","tags":["Level 1","Workstation","Server","System Maintenance","Local User and Group Settings","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","TA0005","M1022"]},{"location":"6-System-Maintenance/6.2-Local-User-and-Group-Settings/6.2.11-Ensure-local-interactive-user-home-directories-exist/#remediation","title":"Remediation","text":"<p>If any users' home directories do not exist, create them and make sure the respective user owns the directory. Users without an assigned home directory should be removed or assigned a home directory as appropriate.</p> <p>The following script will create a home directory for users with an interactive shell whose home directory doesn't exist: <pre><code>#!/usr/bin/env bash\n{\nvalid_shells=\"^($( sed -rn '/^\\//{s,/,\\\\\\\\/,g;p}' /etc/shells | paste -s -d '|' - ))$\"\nawk -v pat=\"$valid_shells\" -F: '$(NF) ~ pat { print $1 \" \" $(NF-1) }' /etc/passwd | while read -r user home; do\nif [ ! -d \"$home\" ]; then\necho -e \"\\n- User \\\"$user\\\" home directory \\\"$home\\\" doesn't exist\\n- creating home directory \\\"$home\\\"\\n\"\nmkdir \"$home\"\nchmod g-w,o-wrx \"$home\"\nchown \"$user\" \"$home\"\nfi\ndone\n}\n</code></pre></p>","tags":["Level 1","Workstation","Server","System Maintenance","Local User and Group Settings","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","TA0005","M1022"]},{"location":"6-System-Maintenance/6.2-Local-User-and-Group-Settings/6.2.12-Ensure-local-interactive-users-own-their-home-directories/","title":"6.2.12 Ensure local interactive users own their home directories","text":"","tags":["Level 1","Workstation","Server","System Maintenance","Local User and Group Settings","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1222","T1222.002","TA0005","M1022"]},{"location":"6-System-Maintenance/6.2-Local-User-and-Group-Settings/6.2.12-Ensure-local-interactive-users-own-their-home-directories/#audit","title":"Audit","text":"<p>Run the following script to verify local interactive users own their home directories: <pre><code>#!/usr/bin/env bash\n{\noutput=\"\"\nvalid_shells=\"^($( sed -rn '/^\\//{s,/,\\\\\\\\/,g;p}' /etc/shells | paste -s -d '|' - ))$\"\nawk -v pat=\"$valid_shells\" -F: '$(NF) ~ pat { print $1 \" \" $(NF-1) }' /etc/passwd | (while read -r user home; do\nowner=\"$(stat -L -c \"%U\" \"$home\")\"\n[ \"$owner\" != \"$user\" ] &amp;&amp; output=\"$output\\n - User \\\"$user\\\" home directory \\\"$home\\\" is owned by user \\\"$owner\\\"\"\ndone\nif [ -z \"$output\" ]; then\necho -e \"\\n-PASSED: - All local interactive users have a home directory\\n\"\nelse\necho -e \"\\n- FAILED:\\n$output\\n\"\nfi\n)\n}\n</code></pre></p>","tags":["Level 1","Workstation","Server","System Maintenance","Local User and Group Settings","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1222","T1222.002","TA0005","M1022"]},{"location":"6-System-Maintenance/6.2-Local-User-and-Group-Settings/6.2.12-Ensure-local-interactive-users-own-their-home-directories/#remediation","title":"Remediation","text":"<p>Change the ownership of any home directories that are not owned by the defined user to the correct user.</p> <p>The following script will update local interactive user home directories to be own by the user: <pre><code>#!/usr/bin/env bash\n{\noutput=\"\"\nvalid_shells=\"^($( sed -rn '/^\\//{s,/,\\\\\\\\/,g;p}' /etc/shells | paste -s -d '|' - ))$\"\nawk -v pat=\"$valid_shells\" -F: '$(NF) ~ pat { print $1 \" \" $(NF-1) }' /etc/passwd | while read -r user home; do\nowner=\"$(stat -L -c \"%U\" \"$home\")\"\nif [ \"$owner\" != \"$user\" ]; then\necho -e \"\\n- User \\\"$user\\\" home directory \\\"$home\\\" is owned by user \\\"$owner\\\"\\n - changing ownership to \\\"$user\\\"\\n\"\nchown \"$user\" \"$home\"\nfi\ndone\n}\n</code></pre></p>","tags":["Level 1","Workstation","Server","System Maintenance","Local User and Group Settings","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1222","T1222.002","TA0005","M1022"]},{"location":"6-System-Maintenance/6.2-Local-User-and-Group-Settings/6.2.13-Ensure-local-interactive-user-home-directories-are-mode-750-or-more-restrictive/","title":"6.2.13 Ensure local interactive user home directories are mode 750 or more restrictive","text":"","tags":["Level 1","Workstation","Server","System Maintenance","Local User and Group Settings","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1222","T1222.002","TA0005","M1022"]},{"location":"6-System-Maintenance/6.2-Local-User-and-Group-Settings/6.2.13-Ensure-local-interactive-user-home-directories-are-mode-750-or-more-restrictive/#audit","title":"Audit","text":"<p>Run the following script and verify no verify interactive user home directories are mode 750 or more restrictive: <pre><code>#!/usr/bin/env bash\n{\noutput=\"\"\nperm_mask='0027'\nmaxperm=\"$( printf '%o' $(( 0777 &amp; ~$perm_mask)) )\"\nvalid_shells=\"^($( sed -rn '/^\\//{s,/,\\\\\\\\/,g;p}' /etc/shells | paste -s -d '|' - ))$\"\nawk -v pat=\"$valid_shells\" -F: '$(NF) ~ pat { print $1 \" \" $(NF-1) }' /etc/passwd | (while read -r user home; do\nif [ -d \"$home\" ]; then\nmode=$( stat -L -c '%#a' \"$home\" )\n[ $(( $mode &amp; $perm_mask )) -gt 0 ] &amp;&amp; output=\"$output\\n- User $user home directory: \\\"$home\\\" is too permissive: \\\"$mode\\\" (should be: \\\"$maxperm\\\" or more restrictive)\"\nfi\ndone\nif [ -n \"$output\" ]; then\necho -e \"\\n- Failed:$output\"\nelse\necho -e \"\\n- Passed:\\n- All user home directories are mode: \\\"$maxperm\\\" or more restrictive\"\nfi\n)\n}\n</code></pre></p>","tags":["Level 1","Workstation","Server","System Maintenance","Local User and Group Settings","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1222","T1222.002","TA0005","M1022"]},{"location":"6-System-Maintenance/6.2-Local-User-and-Group-Settings/6.2.13-Ensure-local-interactive-user-home-directories-are-mode-750-or-more-restrictive/#remediation","title":"Remediation","text":"<p>Making global modifications to user home directories without alerting the user community can result in unexpected outages and unhappy users. Therefore, it is recommended that a monitoring policy be established to report user file permissions and determine the action to be taken in accordance with site policy.</p> <p>The following script can be used to remove permissions is excess of 750 from interactive user home directories: <pre><code>#!/usr/bin/env bash\n{\nperm_mask='0027'\nmaxperm=\"$( printf '%o' $(( 0777 &amp; ~$perm_mask)) )\"\nvalid_shells=\"^($( sed -rn '/^\\//{s,/,\\\\\\\\/,g;p}' /etc/shells | paste -s -d '|' - ))$\"\nawk -v pat=\"$valid_shells\" -F: '$(NF) ~ pat { print $1 \" \" $(NF-1) }' /etc/passwd | (while read -r user home; do\nmode=$( stat -L -c '%#a' \"$home\" )\nif [ $(( $mode &amp; $perm_mask )) -gt 0 ]; then\necho -e \"- modifying User $user home directory: \\\"$home\\\"\\nremoving excessive permissions from current mode of \\\"$mode\\\"\"\nchmod g-w,o-rwx \"$home\"\nfi\ndone\n)\n}\n</code></pre></p>","tags":["Level 1","Workstation","Server","System Maintenance","Local User and Group Settings","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1222","T1222.002","TA0005","M1022"]},{"location":"6-System-Maintenance/6.2-Local-User-and-Group-Settings/6.2.14-Ensure-no-local-interactive-user-has-.netrc-files/","title":"6.2.14 Ensure no local interactive user has .netrc files","text":"","tags":["Level 1","Workstation","Server","System Maintenance","Local User and Group Settings","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1152","T1152.001","TA0006","M1027"]},{"location":"6-System-Maintenance/6.2-Local-User-and-Group-Settings/6.2.14-Ensure-no-local-interactive-user-has-.netrc-files/#audit","title":"Audit","text":"<p>Run the following script. This script will return:</p> <ul> <li>FAILED: for any .netrc file with permissions less restrictive than 600</li> <li>WARNING: for any .netrc files that exist in interactive users' home directories. <pre><code>#!/usr/bin/env bash\n{\noutput=\"\" output2=\"\"\nperm_mask='0177'\nmaxperm=\"$( printf '%o' $(( 0777 &amp; ~$perm_mask)) )\"\nvalid_shells=\"^($( sed -rn '/^\\//{s,/,\\\\\\\\/,g;p}' /etc/shells | paste -s -d '|' - ))$\"\nawk -v pat=\"$valid_shells\" -F: '$(NF) ~ pat { print $1 \" \" $(NF-1) }' /etc/passwd | (while read -r user home; do\nif [ -f \"$home/.netrc\" ]; then\nmode=\"$( stat -L -c '%#a' \"$home/.netrc\" )\"\nif [ $(( $mode &amp; $perm_mask )) -gt 0 ]; then\noutput=\"$output\\n - User \\\"$user\\\" file: \\\"$home/.netrc\\\" is too permissive: \\\"$mode\\\" (should be: \\\"$maxperm\\\" or more restrictive)\"\nelse\noutput2=\"$output2\\n - User \\\"$user\\\" file: \\\"$home/.netrc\\\" exists and has file mode: \\\"$mode\\\" (should be: \\\"$maxperm\\\" or more restrictive)\"\nfi\nfi\ndone\nif [ -z \"$output\" ]; then\nif [ -z \"$output2\" ]; then\necho -e \"\\n-PASSED: - No local interactive users have \\\".netrc\\\" files in their home directory\\n\"\nelse\necho -e \"\\n- WARNING:\\n$output2\\n\"\nfi\nelse\necho -e \"\\n- FAILED:\\n$output\\n\"\n[ -n \"$output2\" ] &amp;&amp; echo -e \"\\n- WARNING:\\n$output2\\n\"\nfi\n)\n}\n</code></pre></li> </ul> <p>Verify:</p> <ul> <li>Any lines under FAILED: - File should be removed unless deemed necessary, in accordance with local site policy, and permissions are updated to be 600 or more restrictive</li> <li>Any lines under WARNING: - File should be removed unless deemed necessary, and in accordance with local site policy</li> </ul>","tags":["Level 1","Workstation","Server","System Maintenance","Local User and Group Settings","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1152","T1152.001","TA0006","M1027"]},{"location":"6-System-Maintenance/6.2-Local-User-and-Group-Settings/6.2.14-Ensure-no-local-interactive-user-has-.netrc-files/#remediation","title":"Remediation","text":"<p>Making global modifications to users' files without alerting the user community can result in unexpected outages and unhappy users. Therefore, it is recommended that a monitoring policy be established to report user .netrc file permissions and determine the action to be taken in accordance with local site policy.</p> <p>The following script will remove .netrc files from interactive users' home directories <pre><code>#!/usr/bin/env bash\n{\nperm_mask='0177'\nvalid_shells=\"^($( sed -rn '/^\\//{s,/,\\\\\\\\/,g;p}' /etc/shells | paste -s -d '|' - ))$\"\nawk -v pat=\"$valid_shells\" -F: '$(NF) ~ pat { print $1 \" \" $(NF-1) }' /etc/passwd | while read -r user home; do\nif [ -f \"$home/.netrc\" ]; then\necho -e \"\\n- User \\\"$user\\\" file: \\\"$home/.netrc\\\" exists\\n - removing file: \\\"$home/.netrc\\\"\\n\"\nrm -f \"$home/.netrc\"\nfi\ndone\n}\n</code></pre></p>","tags":["Level 1","Workstation","Server","System Maintenance","Local User and Group Settings","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1152","T1152.001","TA0006","M1027"]},{"location":"6-System-Maintenance/6.2-Local-User-and-Group-Settings/6.2.15-Ensure-no-local-interactive-user-has-.forward-files/","title":"6.2.15 Ensure no local interactive user has .forward files","text":"","tags":["Level 1","Workstation","Server","System Maintenance","Local User and Group Settings","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1114","T1114.003","TA0010","M1031"]},{"location":"6-System-Maintenance/6.2-Local-User-and-Group-Settings/6.2.15-Ensure-no-local-interactive-user-has-.forward-files/#audit","title":"Audit","text":"<p>Run the following script and verify no lines are returned: <pre><code>#!/usr/bin/env bash\n{\noutput=\"\"\nfname=\".forward\"\nvalid_shells=\"^($( sed -rn '/^\\//{s,/,\\\\\\\\/,g;p}' /etc/shells | paste -s -d '|' - ))$\"\nawk -v pat=\"$valid_shells\" -F: '$(NF) ~ pat { print $1 \" \" $(NF-1) }' /etc/passwd | (while read -r user home; do\n[ -f \"$home/$fname\" ] &amp;&amp; output=\"$output\\n - User \\\"$user\\\" file: \\\"$home/$fname\\\" exists\"\ndone\nif [ -z \"$output\" ]; then\necho -e \"\\n-PASSED: - No local interactive users have \\\"$fname\\\" files in their home directory\\n\"\nelse\necho -e \"\\n- FAILED:\\n$output\\n\"\nfi\n)\n}\n</code></pre></p>","tags":["Level 1","Workstation","Server","System Maintenance","Local User and Group Settings","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1114","T1114.003","TA0010","M1031"]},{"location":"6-System-Maintenance/6.2-Local-User-and-Group-Settings/6.2.15-Ensure-no-local-interactive-user-has-.forward-files/#remediation","title":"Remediation","text":"<p>Making global modifications to users' files without alerting the user community can result in unexpected outages and unhappy users. Therefore, it is recommended that a monitoring policy be established to report user .forward files and determine the action to be taken in accordance with site policy.</p> <p>The following script will remove .forward files from interactive users' home directories <pre><code>#!/usr/bin/env bash\n{\noutput=\"\"\nfname=\".forward\"\nvalid_shells=\"^($( sed -rn '/^\\//{s,/,\\\\\\\\/,g;p}' /etc/shells | paste -s -d '|' - ))$\"\nawk -v pat=\"$valid_shells\" -F: '$(NF) ~ pat { print $1 \" \" $(NF-1) }' /etc/passwd | (while read -r user home; do\nif [ -f \"$home/$fname\" ]; then\necho -e \"$output\\n- User \\\"$user\\\" file: \\\"$home/$fname\\\" exists\\n - removing file: \\\"$home/$fname\\\"\\n\"\nrm -r \"$home/$fname\"\nfi\ndone\n)\n}\n</code></pre></p>","tags":["Level 1","Workstation","Server","System Maintenance","Local User and Group Settings","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1114","T1114.003","TA0010","M1031"]},{"location":"6-System-Maintenance/6.2-Local-User-and-Group-Settings/6.2.16-Ensure-no-local-interactive-user-has-.rhosts-files/","title":"6.2.16 Ensue no local interactive user has .rhosts files","text":"","tags":["Level 1","Workstation","Server","System Maintenance","Local User and Group Settings","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1049","TA0007"]},{"location":"6-System-Maintenance/6.2-Local-User-and-Group-Settings/6.2.16-Ensure-no-local-interactive-user-has-.rhosts-files/#audit","title":"Audit","text":"<p>Run the following script to verify no local interactive user has .rhosts files: <pre><code>#!/usr/bin/env bash\n{\noutput=\"\"\nfname=\".rhosts\"\nvalid_shells=\"^($( sed -rn '/^\\//{s,/,\\\\\\\\/,g;p}' /etc/shells | paste -s -d '|' - ))$\"\nawk -v pat=\"$valid_shells\" -F: '$(NF) ~ pat { print $1 \" \" $(NF-1) }' /etc/passwd | (while read -r user home; do\n[ -f \"$home/$fname\" ] &amp;&amp; output=\"$output\\n - User \\\"$user\\\" file: \\\"$home/$fname\\\" exists\"\ndone\nif [ -z \"$output\" ]; then\necho -e \"\\n-PASSED: - No local interactive users have \\\"$fname\\\" files in their home directory\\n\"\nelse\necho -e \"\\n- FAILED:\\n$output\\n\"\nfi\n)\n}\n</code></pre></p>","tags":["Level 1","Workstation","Server","System Maintenance","Local User and Group Settings","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1049","TA0007"]},{"location":"6-System-Maintenance/6.2-Local-User-and-Group-Settings/6.2.16-Ensure-no-local-interactive-user-has-.rhosts-files/#remediation","title":"Remediation","text":"<p>Making global modifications to users' files without alerting the user community can result in unexpected outages and unhappy users. Therefore, it is recommended that a monitoring policy be established to report user .rhosts files and determine the action to be taken in accordance with site policy.</p> <p>The following script will remove .rhosts files from interactive users' home directories <pre><code>#!/usr/bin/env bash\n{\nperm_mask='0177'\nvalid_shells=\"^($( sed -rn '/^\\//{s,/,\\\\\\\\/,g;p}' /etc/shells | paste -s -d '|' - ))$\"\nawk -v pat=\"$valid_shells\" -F: '$(NF) ~ pat { print $1 \" \" $(NF-1) }' /etc/passwd | while read -r user home; do\nif [ -f \"$home/.rhosts\" ]; then\necho -e \"\\n- User \\\"$user\\\" file: \\\"$home/.rhosts\\\" exists\\n - removing file: \\\"$home/.rhosts\\\"\\n\"\nrm -f \"$home/.rhosts\"\nfi\ndone\n}\n</code></pre></p>","tags":["Level 1","Workstation","Server","System Maintenance","Local User and Group Settings","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1049","TA0007"]},{"location":"6-System-Maintenance/6.2-Local-User-and-Group-Settings/6.2.17-Ensure-local-interactive-user-dot-files-are-not-group-or-world-writable/","title":"6.2.17 Ensure local interactive user dot files are not group or world writable","text":"","tags":["Level 1","Workstation","Server","System Maintenance","Local User and Group Settings","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1222","T1222.001","T1222.002","T1152","T1152.003","T1152.004","TA0005","M1022"]},{"location":"6-System-Maintenance/6.2-Local-User-and-Group-Settings/6.2.17-Ensure-local-interactive-user-dot-files-are-not-group-or-world-writable/#audit","title":"Audit","text":"<p>Run the following script to verify local interactive user dot files are not group or world writable: <pre><code>#!/usr/bin/env bash\n{\noutput=\"\"\nperm_mask='0022'\nmaxperm=\"$( printf '%o' $(( 0777 &amp; ~$perm_mask)) )\"\nvalid_shells=\"^($( sed -rn '/^\\//{s,/,\\\\\\\\/,g;p}' /etc/shells | paste -s -d '|' - ))$\"\nawk -v pat=\"$valid_shells\" -F: '$(NF) ~ pat { print $1 \" \" $(NF-1) }' /etc/passwd | (while read -r user home; do\nfor dfile in $(find \"$home\" -type f -name '.*'); do\nmode=$( stat -L -c '%#a' \"$dfile\" )\n[ $(( $mode &amp; $perm_mask )) -gt 0 ] &amp;&amp; output=\"$output\\n- User $user file: \\\"$dfile\\\" is too permissive: \\\"$mode\\\" (should be: \\\"$maxperm\\\" or more restrictive)\"\ndone\ndone\nif [ -n \"$output\" ]; then\necho -e \"\\n- Failed:$output\"\nelse\necho -e \"\\n- Passed:\\n- All user home dot files are mode: \\\"$maxperm\\\" or more restrictive\"\nfi\n)\n}\n</code></pre></p>","tags":["Level 1","Workstation","Server","System Maintenance","Local User and Group Settings","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1222","T1222.001","T1222.002","T1152","T1152.003","T1152.004","TA0005","M1022"]},{"location":"6-System-Maintenance/6.2-Local-User-and-Group-Settings/6.2.17-Ensure-local-interactive-user-dot-files-are-not-group-or-world-writable/#remediation","title":"Remediation","text":"<p>Making global modifications to users' files without alerting the user community can result in unexpected outages and unhappy users. Therefore, it is recommended that a monitoring policy be established to report user dot file permissions and determine the action to be taken in accordance with site policy.</p> <p>The following script will remove excessive permissions on dot files within interactive users' home directories. <pre><code>#!/usr/bin/env bash\n{\nperm_mask='0022'\nvalid_shells=\"^($( sed -rn '/^\\//{s,/,\\\\\\\\/,g;p}' /etc/shells | paste -s -d '|' - ))$\"\nawk -v pat=\"$valid_shells\" -F: '$(NF) ~ pat { print $1 \" \" $(NF-1) }' /etc/passwd | while read -r user home; do\nfind \"$home\" -type f -name '.*' | while read -r dfile; do\nmode=$( stat -L -c '%#a' \"$dfile\" )\nif [ $(( $mode &amp; $perm_mask )) -gt 0 ]; then\necho -e \"\\n- Modifying User \\\"$user\\\" file: \\\"$dfile\\\"\\nremoving group and other write permissions\"\nchmod go-w \"$dfile\"\nfi\ndone\ndone\n}\n</code></pre></p>","tags":["Level 1","Workstation","Server","System Maintenance","Local User and Group Settings","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1222","T1222.001","T1222.002","T1152","T1152.003","T1152.004","TA0005","M1022"]},{"location":"6-System-Maintenance/6.2-Local-User-and-Group-Settings/6.2.2-Ensure-etc-shadow-password-fields-are-not-empty/","title":"6.2.2 Ensure /etc/shadow password fields are not empty","text":"","tags":["Level 1","Workstation","Server","System Maintenance","Local User and Group Settings","Automated","IG1","IG2","IG3","5.2 Use Unique Passwords","T1078","T1078.001","T1078.003","TA0003","M1027"]},{"location":"6-System-Maintenance/6.2-Local-User-and-Group-Settings/6.2.2-Ensure-etc-shadow-password-fields-are-not-empty/#audit","title":"Audit","text":"<p>Run the following command and verify that no output is returned: <pre><code># awk -F: '($2 == \"\" ) { print $1 \" does not have a password \"}' /etc/shadow\n</code></pre></p>","tags":["Level 1","Workstation","Server","System Maintenance","Local User and Group Settings","Automated","IG1","IG2","IG3","5.2 Use Unique Passwords","T1078","T1078.001","T1078.003","TA0003","M1027"]},{"location":"6-System-Maintenance/6.2-Local-User-and-Group-Settings/6.2.2-Ensure-etc-shadow-password-fields-are-not-empty/#remediation","title":"Remediation","text":"<p>If any accounts in the /etc/shadow file do not have a password, run the following command to lock the account until it can be determined why it does not have a password: <pre><code># passwd -l &lt;username&gt;\n</code></pre></p> <p>Also, check to see if the account is logged in and investigate what it is being used for to determine if it needs to be forced off.</p>","tags":["Level 1","Workstation","Server","System Maintenance","Local User and Group Settings","Automated","IG1","IG2","IG3","5.2 Use Unique Passwords","T1078","T1078.001","T1078.003","TA0003","M1027"]},{"location":"6-System-Maintenance/6.2-Local-User-and-Group-Settings/6.2.3-Ensure-all-groups-in-etc-passwd-exist-in-etc-group/","title":"6.2.3 Ensure all groups in /etc/passwd exist in /etc/group","text":"","tags":["Level 1","Workstation","Server","System Maintenance","Local User and Group Settings","Automated","T1222","T1222.002","TA0003","M1027"]},{"location":"6-System-Maintenance/6.2-Local-User-and-Group-Settings/6.2.3-Ensure-all-groups-in-etc-passwd-exist-in-etc-group/#audit","title":"Audit","text":"<p>Run the following script and verify no results are returned: <pre><code>#!/bin/bash\nfor i in $(cut -s -d: -f4 /etc/passwd | sort -u ); do\ngrep -q -P \"^.*?:[^:]*:$i:\" /etc/group\n if [ $? -ne 0 ]; then\necho \"Group $i is referenced by /etc/passwd but does not exist in /etc/group\"\nfi\ndone\n</code></pre></p>","tags":["Level 1","Workstation","Server","System Maintenance","Local User and Group Settings","Automated","T1222","T1222.002","TA0003","M1027"]},{"location":"6-System-Maintenance/6.2-Local-User-and-Group-Settings/6.2.3-Ensure-all-groups-in-etc-passwd-exist-in-etc-group/#remediation","title":"Remediation","text":"<p>Analyze the output of the Audit step above and perform the appropriate action to correct any discrepancies found.</p>","tags":["Level 1","Workstation","Server","System Maintenance","Local User and Group Settings","Automated","T1222","T1222.002","TA0003","M1027"]},{"location":"6-System-Maintenance/6.2-Local-User-and-Group-Settings/6.2.4-Ensure-shadow-group-is-empty/","title":"6.2.4 Ensure shadow group is empty","text":"","tags":["Level 1","Workstation","Server","System Maintenance","Local User and Group Settings","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1003","T1003.008","TA0005","M1022"]},{"location":"6-System-Maintenance/6.2-Local-User-and-Group-Settings/6.2.4-Ensure-shadow-group-is-empty/#audit","title":"Audit","text":"<p>Run the following commands and verify no results are returned: <pre><code># awk -F: '($1==\"shadow\") {print $NF}' /etc/group\n# awk -F: -v GID=\"$(awk -F: '($1==\"shadow\") {print $3}' /etc/group)\"'($4==GID) {print $1}' /etc/passwd\n</code></pre></p>","tags":["Level 1","Workstation","Server","System Maintenance","Local User and Group Settings","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1003","T1003.008","TA0005","M1022"]},{"location":"6-System-Maintenance/6.2-Local-User-and-Group-Settings/6.2.4-Ensure-shadow-group-is-empty/#remediation","title":"Remediation","text":"<p>Run the following command to remove all users from the shadow group <pre><code># sed -ri 's/(^shadow:[^:]*:[^:]*:)([^:]+$)/\\1/' /etc/group\n</code></pre></p> <p>Change the primary group of any users with shadow as their primary group. <pre><code># usermod -g &lt;primary group&gt; &lt;user&gt;\n</code></pre></p>","tags":["Level 1","Workstation","Server","System Maintenance","Local User and Group Settings","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1003","T1003.008","TA0005","M1022"]},{"location":"6-System-Maintenance/6.2-Local-User-and-Group-Settings/6.2.5-Ensure-no-duplicate-UIDs-exist/","title":"6.2.5 Ensure no duplicate UIDs exist","text":"","tags":["Level 1","Workstation","Server","System Maintenance","Local User and Group Settings","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1078","T1078.001","T1078.003","TA0005","M1027"]},{"location":"6-System-Maintenance/6.2-Local-User-and-Group-Settings/6.2.5-Ensure-no-duplicate-UIDs-exist/#audit","title":"Audit","text":"<p>Run the following script and verify no results are returned: <pre><code>#!/bin/bash\ncut -f3 -d\":\" /etc/passwd | sort -n | uniq -c | while read x ; do\n[ -z \"$x\" ] &amp;&amp; break\nset - $x\nif [ $1 -gt 1 ]; then\nusers=$(awk -F: '($3 == n) { print $1 }' n=$2 /etc/passwd | xargs)\necho \"Duplicate UID ($2): $users\"\nfi\ndone\n</code></pre></p>","tags":["Level 1","Workstation","Server","System Maintenance","Local User and Group Settings","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1078","T1078.001","T1078.003","TA0005","M1027"]},{"location":"6-System-Maintenance/6.2-Local-User-and-Group-Settings/6.2.5-Ensure-no-duplicate-UIDs-exist/#remediation","title":"Remediation","text":"<p>Based on the results of the audit script, establish unique UIDs and review all files owned by the shared UIDs to determine which UID they are supposed to belong to.</p>","tags":["Level 1","Workstation","Server","System Maintenance","Local User and Group Settings","Automated","IG1","IG2","IG3","3.3 Configure Data Access Control Lists","T1078","T1078.001","T1078.003","TA0005","M1027"]},{"location":"6-System-Maintenance/6.2-Local-User-and-Group-Settings/6.2.6-Ensure-no-duplicate-GIDs-exist/","title":"6.2.6 Ensure no duplicate GIDs exist","text":"","tags":["Level 1","Workstation","Server","System Maintenance","Local User and Group Settings","Automated","T1078","T1078.001","T1078.003","TA0005","M1027"]},{"location":"6-System-Maintenance/6.2-Local-User-and-Group-Settings/6.2.6-Ensure-no-duplicate-GIDs-exist/#audit","title":"Audit","text":"<p>Run the following script and verify no results are returned: <pre><code>#!/bin/bash\ncut -d: -f3 /etc/group | sort | uniq -d | while read x ; do\necho \"Duplicate GID ($x) in /etc/group\"\ndone\n</code></pre></p>","tags":["Level 1","Workstation","Server","System Maintenance","Local User and Group Settings","Automated","T1078","T1078.001","T1078.003","TA0005","M1027"]},{"location":"6-System-Maintenance/6.2-Local-User-and-Group-Settings/6.2.6-Ensure-no-duplicate-GIDs-exist/#remediation","title":"Remediation","text":"<p>Based on the results of the audit script, establish unique GIDs and review all files owned by the shared GID to determine which group they are supposed to belong to.</p>","tags":["Level 1","Workstation","Server","System Maintenance","Local User and Group Settings","Automated","T1078","T1078.001","T1078.003","TA0005","M1027"]},{"location":"6-System-Maintenance/6.2-Local-User-and-Group-Settings/6.2.7-Ensure-no-duplicate-user-names-exist/","title":"6.2.7 Ensure no duplicate user names exist","text":"","tags":["Level 1","Workstation","Server","System Maintenance","Local User and Group Settings","Automated","T1078","T1078.001","T1078.003","TA0004","M1027"]},{"location":"6-System-Maintenance/6.2-Local-User-and-Group-Settings/6.2.7-Ensure-no-duplicate-user-names-exist/#audit","title":"Audit","text":"<p>Run the following script and verify no results are returned: <pre><code>#!/bin/bash\ncut -d: -f1 /etc/passwd | sort | uniq -d | while read -r x; do\necho \"Duplicate login name $x in /etc/passwd\"\ndone\n</code></pre></p>","tags":["Level 1","Workstation","Server","System Maintenance","Local User and Group Settings","Automated","T1078","T1078.001","T1078.003","TA0004","M1027"]},{"location":"6-System-Maintenance/6.2-Local-User-and-Group-Settings/6.2.7-Ensure-no-duplicate-user-names-exist/#remediation","title":"Remediation","text":"<p>Based on the results of the audit script, establish unique user names for the users. File ownerships will automatically reflect the change as long as the users have unique UIDs.</p>","tags":["Level 1","Workstation","Server","System Maintenance","Local User and Group Settings","Automated","T1078","T1078.001","T1078.003","TA0004","M1027"]},{"location":"6-System-Maintenance/6.2-Local-User-and-Group-Settings/6.2.8-Ensure-no-duplicate-group-names-exist/","title":"6.2.8 Ensure no duplicate group names exist","text":"","tags":["Level 1","Workstation","Server","System Maintenance","Local User and Group Settings","Automated","T1078","T1078.001","T1078.003","TA0004","M1027"]},{"location":"6-System-Maintenance/6.2-Local-User-and-Group-Settings/6.2.8-Ensure-no-duplicate-group-names-exist/#audit","title":"Audit","text":"<p>Run the following script and verify no results are returned: <pre><code>#!/bin/bash\ncut -d: -f1 /etc/group | sort | uniq -d | while read -r x; do\necho \"Duplicate group name $x in /etc/group\"\ndone\n</code></pre></p>","tags":["Level 1","Workstation","Server","System Maintenance","Local User and Group Settings","Automated","T1078","T1078.001","T1078.003","TA0004","M1027"]},{"location":"6-System-Maintenance/6.2-Local-User-and-Group-Settings/6.2.8-Ensure-no-duplicate-group-names-exist/#remediation","title":"Remediation","text":"<p>Based on the results of the audit script, establish unique names for the user groups. File group ownerships will automatically reflect the change as long as the groups have unique GIDs.</p>","tags":["Level 1","Workstation","Server","System Maintenance","Local User and Group Settings","Automated","T1078","T1078.001","T1078.003","TA0004","M1027"]},{"location":"6-System-Maintenance/6.2-Local-User-and-Group-Settings/6.2.9-Ensure-root-PATH-Integrity/","title":"6.2.9 Ensure root PATH Integrity","text":"","tags":["Level 1","Workstation","Server","System Maintenance","Local User and Group Settings","Automated","T1204","T1204.002","TA0006","M1022"]},{"location":"6-System-Maintenance/6.2-Local-User-and-Group-Settings/6.2.9-Ensure-root-PATH-Integrity/#audit","title":"Audit","text":"<p>Run the following script and verify no results are returned: <pre><code>#!/bin/bash\nRPCV=\"$(sudo -Hiu root env | grep '^PATH' | cut -d= -f2)\"\necho \"$RPCV\" | grep -q \"::\" &amp;&amp; echo \"root's path contains a empty directory (::)\"\necho \"$RPCV\" | grep -q \":$\" &amp;&amp; echo \"root's path contains a trailing (:)\"\nfor x in $(echo \"$RPCV\" | tr \":\" \" \"); do\nif [ -d \"$x\" ]; then\nls -ldH \"$x\" | awk '$9 == \".\" {print \"PATH contains current working directory (.)\"}\n $3 != \"root\" {print $9, \"is not owned by root\"}\n substr($1,6,1) != \"-\" {print $9, \"is group writable\"}\n substr($1,9,1) != \"-\" {print $9, \"is world writable\"}'\nelse\necho \"$x is not a directory\"\nfi\ndone\n</code></pre></p>","tags":["Level 1","Workstation","Server","System Maintenance","Local User and Group Settings","Automated","T1204","T1204.002","TA0006","M1022"]},{"location":"6-System-Maintenance/6.2-Local-User-and-Group-Settings/6.2.9-Ensure-root-PATH-Integrity/#remediation","title":"Remediation","text":"<p>Correct or justify any items discovered in the Audit step.</p>","tags":["Level 1","Workstation","Server","System Maintenance","Local User and Group Settings","Automated","T1204","T1204.002","TA0006","M1022"]},{"location":"tags/","title":"Tags","text":""},{"location":"tags/#103-disable-autorun-and-autoplay-for-removable-media","title":"10.3 Disable Autorun and Autoplay for Removable Media","text":"<ul> <li>1.1.10 Disable USB Storage</li> <li>1.1.9 Disable Automounting</li> <li>1.8.6 Ensure GDM automatic mounting of removable media is disabled</li> <li>1.8.8 Ensure GDM autorun-never is enabled</li> <li>1.8.9 Ensure GDM autorun-never is not overridden</li> </ul>"},{"location":"tags/#105-enable-anti-exploitation-features","title":"10.5 Enable Anti-Exploitation Features","text":"<ul> <li>1.5.1 Ensure address space layout randomization (ASLR) is enabled</li> </ul>"},{"location":"tags/#310-encrypt-sensitive-data-in-transit","title":"3.10 Encrypt Sensitive Data in Transit","text":"<ul> <li>5.2.13 Ensure only strong Ciphers are used</li> <li>5.2.14 Ensure only strong MAC algorithms are used</li> <li>5.2.15 Ensure only strong Key Exchange algorithms are used</li> </ul>"},{"location":"tags/#311-encrypt-sensitive-data-at-rest","title":"3.11 Encrypt Sensitive Data at Rest","text":"<ul> <li>5.4.4 Ensure password hashing algorithm is up to date with the latest standards</li> <li>6.2.1 Ensure accounts in /etc/passwd use shadowed passwords</li> </ul>"},{"location":"tags/#314-log-sensitive-data-access","title":"3.14 Log Sensitive Data Access","text":"<ul> <li>1.3.1 Ensure AIDE is installed</li> <li>1.5.2 Ensure prelink is not installed</li> </ul>"},{"location":"tags/#33-configure-data-access-control-lists","title":"3.3 Configure Data Access Control Lists","text":"<ul> <li>1.1.2.1 Ensure /tmp is a separate partition</li> <li>1.1.2.2 Ensure nodev option set on /tmp partition</li> <li>1.1.2.3 Ensure noexec option set on /tmp partition</li> <li>1.1.2.4 Ensure nosuid option set on /tmp partition</li> <li>1.1.3.1 Ensure separate partition exists for /var</li> <li>1.1.3.2 Ensure nodev option set on /var partition</li> <li>1.1.3.3 Ensure nosuid option set on /var partition</li> <li>1.1.4.1 Ensure separate partition exists for /var/tmp</li> <li>1.1.4.2 Ensure noexec option set on /var/tmp partition</li> <li>1.1.4.3 Ensure nosuid option set on /var/tmp partition</li> <li>1.1.4.4 Ensure nodev option set on /var/tmp partition</li> <li>1.1.5.2 Ensure nodev option set on /var/log partition</li> <li>1.1.5.3 Ensure noexec option set on /var/log partition</li> <li>1.1.5.4 Ensure nosuid option set on /var/log partition</li> <li>1.1.6.2 Ensure noexec option set on /var/log/audit partition</li> <li>1.1.6.3 Ensure nodev option set on /var/log/audit partition</li> <li>1.1.6.4 Ensure nosuid option set on /var/log/audit partition</li> <li>1.1.7.1 Ensure separate partition exists for /home</li> <li>1.1.7.2 Ensure nodev option set on /home partition</li> <li>1.1.7.3 Ensure nosuid option set on /home partition</li> <li>1.1.8.1 Ensure nodev option set on /dev/shm partition</li> <li>1.1.8.2 Ensure noexec option set on /dev/shm partition</li> <li>1.1.8.3 Ensure nosuid option set on /dev/shm partition</li> <li>1.4.2 Ensure permissions on bootloader config are configured</li> <li>1.6.1.1 Ensure AppArmor is installed</li> <li>1.6.1.2 Ensure AppArmor is enabled in the bootloader configuration</li> <li>1.6.1.3 Ensure all AppArmor Profiles are in enforce or complain mode</li> <li>1.6.1.4 Ensure all AppArmor Profiles are enforcing</li> <li>1.7.4 Ensure permissions on /etc/motd are configured</li> <li>1.7.5 Ensure permissions on /etc/issue are configured</li> <li>1.7.6 Ensure permissions on /etc/issue.net are configured</li> <li>4.1.3.20 Ensure the audit configuration is immutable</li> <li>4.1.4.1 Ensure audit log files are mode 0640 or less permissive</li> <li>4.1.4.10 Ensure audit tools belong to group root</li> <li>4.1.4.2 Ensure only authorized users own audit log files</li> <li>4.1.4.3 Ensure only authorized groups are assigned ownership of audit log files</li> <li>4.1.4.4 Ensure the audit log directory is 0750 or more restrictive</li> <li>4.1.4.5 Ensure audit configuration files are 640 or more restrictive</li> <li>4.1.4.6 Ensure audit configuration files are owned by root</li> <li>4.1.4.7 Ensure audit configuration files belong to group root</li> <li>4.1.4.8 Ensure audit tools are 755 or more restrictive</li> <li>4.1.4.9 Ensure audit tools are owned by root</li> <li>4.2.3 Ensure all logfiles have appropriate permissions and ownership</li> <li>4.2.1.7 Ensure journald default file permissions configured</li> <li>4.2.2.4 Ensure rsyslog default file permissions are configured</li> <li>5.1.2 Ensure permissions on /etc/crontab are configured</li> <li>5.1.3 Ensure permissions on /etc/cron.hourly are configured</li> <li>5.1.4 Ensure permissions on /etc/cron.daily are configured</li> <li>5.1.5 Ensure permissions on /etc/cron.weekly are configured</li> <li>5.1.6 Ensure permissions on /etc/cron.monthly are configured</li> <li>5.1.7 Ensure permissions on /etc/cron.d are configured</li> <li>5.1.8 Ensure cron is restricted to authorized users</li> <li>5.1.9 Ensure at is restricted to authorized users</li> <li>5.2.1 Ensure permissions on /etc/ssh/sshd_config are configured</li> <li>5.2.2 Ensure permissions on SSH private host key files are configured</li> <li>5.2.3 Ensure permissions on SSH public host key files are configured</li> <li>5.2.4 Ensure SSH access is limited</li> <li>5.3.7 Ensure access to the su command is restricted</li> <li>5.5.2 Ensure system accounts are secured</li> <li>5.5.3 Ensure default group for the root account is GID 0</li> <li>5.5.4 Ensure default user umask is 027 or more restrictive</li> <li>6.1.1 Ensure permissions on /etc/passwd are configured</li> <li>6.1.10 Ensure no unowned files or directories exist</li> <li>6.1.11 Ensure no ungrouped files or directories exist</li> <li>6.1.12 Audit SUID executables</li> <li>6.1.13 Audit SGID executables</li> <li>6.1.2 Ensure permissions on /etc/passwd- are configured</li> <li>6.1.3 Ensure permissions on /etc/group are configured</li> <li>6.1.4 Ensure permissions on /etc/group- are configured</li> <li>6.1.5 Ensure permissions on /etc/shadow are configured</li> <li>6.1.6 Ensure permissions on /etc/shadow- are configured</li> <li>6.1.7 Ensure permissions on /etc/gshadow are configured</li> <li>E6.1.8 Ensure permissions on /etc/gshadow- are configured</li> <li>6.1.9 Ensure no world writable files exist</li> <li>6.2.11 Ensure local interactive user home directories exist</li> <li>6.2.12 Ensure local interactive users own their home directories</li> <li>6.2.13 Ensure local interactive user home directories are mode 750 or more restrictive</li> <li>6.2.14 Ensure no local interactive user has .netrc files</li> <li>6.2.15 Ensure no local interactive user has .forward files</li> <li>6.2.16 Ensue no local interactive user has .rhosts files</li> <li>6.2.17 Ensure local interactive user dot files are not group or world writable</li> <li>6.2.4 Ensure shadow group is empty</li> <li>6.2.5 Ensure no duplicate UIDs exist</li> </ul>"},{"location":"tags/#41-establish-and-maintain-a-secure-configuration-process","title":"4.1 Establish and Maintain a Secure Configuration Process","text":"<ul> <li>4.1.4.11 Ensure cryptographic mechanisms are used to protect the integrity of audit tool</li> <li>5.2.10 Ensure SSH PermitUserEnvironment is disabled</li> <li>5.2.11 Ensure SSH IgnoreRhosts is enabled</li> <li>5.2.16 Ensure SSH AllowTcpForwarding is disabled</li> <li>5.2.17 Ensure SSH warning banner is configured</li> <li>5.2.19 Ensure SSH MaxStartups is configured</li> <li>5.2.21 Ensure SSH LoginGraceTime is set to one minute or less</li> <li>5.2.6 Ensure SSH PAM is enabled</li> <li>5.2.8 Ensure SSH HostbasedAuthentication is disabled</li> <li>5.2.9 Ensure SSH PermitEmptyPasswords is disabled</li> </ul>"},{"location":"tags/#43-configure-automatic-session-locking-on-enterprise-assets","title":"4.3 Configure Automatic Session Locking on Enterprise Assets","text":"<ul> <li>1.8.4 Ensure GDM screen locks when the user is idle</li> <li>1.8.5 Ensure GDM screen locks cannot be overridden</li> <li>5.5.5 Ensure default user shell timeout is 900 seconds or less</li> </ul>"},{"location":"tags/#44-implement-and-manage-a-firewall-on-servers","title":"4.4 Implement and Manage a Firewall on Servers","text":"<ul> <li>3.5.1.1 Ensure ufw is installed</li> <li>3.5.1.2 Ensure iptables-persistent is not installed with ufw</li> <li>3.5.1.3 Ensure ufw service is enabled</li> <li>3.5.1.4 Ensure ufw loopback traffic is configured</li> <li>3.5.1.5 Ensure ufw outbound connections are configured</li> <li>3.5.1.6 Ensure ufw firewall rules exist for all open ports</li> <li>3.5.1.7 Ensure ufw default deny firewall policy</li> <li>3.5.2.1 Ensure nftables is installed</li> <li>3.5.2.10 Ensure nftables rules are permanent</li> <li>3.5.2.2 Ensure ufw is uninstalled or disabled with nftables</li> <li>3.5.2.3 Ensure iptables are flushed with nftables</li> <li>3.5.2.4 Ensure a nftables table exists</li> <li>3.5.2.5 Ensure nftables base chains exist</li> <li>3.5.2.6 Ensure nftables loopback traffic is configured</li> <li>3.5.2.7 Ensure nftables outbound and established connections are configured</li> <li>3.5.2.8 Ensure nftables default deny firewall policy</li> <li>3.5.2.9 Ensure nftables service is enabled</li> <li>3.5.3.1.1 Ensure iptables packages are installed</li> <li>3.5.3.1.2 Ensure nftables is not installed with iptables</li> <li>3.5.3.1.3 Ensure ufw is uninstalled or disabled with iptables</li> <li>3.5.3.2.1 Ensure iptables default deny firewall policy</li> <li>3.5.3.2.2 Ensure iptables loopback traffic is configured</li> <li>3.5.3.2.4 Ensure iptables firewall rules exist for all open ports</li> <li>3.5.3.3.1 Ensure ip6tables default deny firewall policy</li> <li>3.5.3.3.2 Ensure ip6tables loopback traffic is configured</li> <li>3.5.3.3.3 Ensure ip6tables outbound and established connections are configured</li> <li>3.5.3.3.4 Ensure ip6tables firewall rules exist for all open ports</li> </ul>"},{"location":"tags/#45-implement-and-manage-a-firewall-on-end-user-devices","title":"4.5 Implement and Manage a Firewall on End-User Devices","text":"<ul> <li>3.5.1.1 Ensure ufw is installed</li> <li>3.5.1.2 Ensure iptables-persistent is not installed with ufw</li> <li>3.5.1.3 Ensure ufw service is enabled</li> <li>3.5.1.4 Ensure ufw loopback traffic is configured</li> <li>3.5.1.5 Ensure ufw outbound connections are configured</li> <li>3.5.1.7 Ensure ufw default deny firewall policy</li> <li>3.5.2.1 Ensure nftables is installed</li> <li>3.5.2.10 Ensure nftables rules are permanent</li> <li>3.5.2.2 Ensure ufw is uninstalled or disabled with nftables</li> <li>3.5.2.3 Ensure iptables are flushed with nftables</li> <li>3.5.2.4 Ensure a nftables table exists</li> <li>3.5.2.5 Ensure nftables base chains exist</li> <li>3.5.2.6 Ensure nftables loopback traffic is configured</li> <li>3.5.2.7 Ensure nftables outbound and established connections are configured</li> <li>3.5.2.8 Ensure nftables default deny firewall policy</li> <li>3.5.2.9 Ensure nftables service is enabled</li> <li>3.5.3.1.1 Ensure iptables packages are installed</li> <li>3.5.3.1.2 Ensure nftables is not installed with iptables</li> <li>3.5.3.1.3 Ensure ufw is uninstalled or disabled with iptables</li> <li>3.5.3.2.1 Ensure iptables default deny firewall policy</li> <li>3.5.3.2.2 Ensure iptables loopback traffic is configured</li> <li>3.5.3.2.4 Ensure iptables firewall rules exist for all open ports</li> <li>3.5.3.3.1 Ensure ip6tables default deny firewall policy</li> <li>3.5.3.3.2 Ensure ip6tables loopback traffic is configured</li> <li>3.5.3.3.3 Ensure ip6tables outbound and established connections are configured</li> <li>3.5.3.3.4 Ensure ip6tables firewall rules exist for all open ports</li> </ul>"},{"location":"tags/#48-uninstall-or-disable-unnecessary-services-on-enterprise-assets-and-software","title":"4.8 Uninstall or Disable Unnecessary Services on Enterprise Assets and Software","text":"<ul> <li>1.1.1.1 Ensure mounting of cramfs filesystems is disabled</li> <li>1.1.1.2 Ensure mounting of squashfs filesystems is disabled</li> <li>1.1.1.3 Ensure mounting of udf filesystems is disabled</li> <li>1.5.3 Ensure Automatic Error Reporting is not enabled</li> <li>1.5.4 Ensure core dumps are restricted</li> <li>1.8.1 Ensure GNOME Display Manager is removed</li> <li>1.8.10 Ensure XDCMP is not enabled</li> <li>2.4 Ensure nonessential services are removed or masked</li> <li>2.2.1 Ensure X Window System is not installed</li> <li>2.2.10 Ensure IMAP and POP3 server are not installed</li> <li>2.2.11 Ensure Samba is not installed</li> <li>2.2.12 Ensure HTTP Proxy Server is not installed</li> <li>2.2.13 Ensure SNMP Server is not installed</li> <li>2.2.14 Ensure NIS Server is not installed</li> <li>2.2.15 Ensure mail transfer agent is configured for local-only mode</li> <li>2.2.16 Ensure rsync service is either not installed or masked</li> <li>2.2.2 Ensure Avahi Server is not installed</li> <li>2.2.3 Ensure CUPS is not installed</li> <li>2.2.4 Ensure DHCP Server is not installed</li> <li>2.2.5 Ensure LDAP server is not installed</li> <li>2.2.6 Ensure NFS is not installed</li> <li>2.2.7 Ensure DNS Server is not installed</li> <li>2.2.8 Ensure FTP Server is not installed</li> <li>2.2.9 Ensure HTTP server is not installed</li> <li>2.3.1 Ensure NIS Client is not installed</li> <li>2.3.2 Ensure rsh client is not installed</li> <li>2.3.3 Ensure talk client is not installed</li> <li>2.3.4 Ensure telnet client is not installed</li> <li>2.3.5 Ensure LDAP client is not installed</li> <li>2.3.6 Ensure RPC is not installed</li> <li>3.1.1 Ensure system is checked to determine if IPv6 is enabled</li> <li>3.1.2 Ensure wireless interfaces are disabled</li> <li>3.1.3 Ensure DCCP is disabled</li> <li>3.1.4 Ensure SCTP is disabled</li> <li>3.2.1 Ensure packet redirect sending is disabled</li> <li>3.2.2 Ensure IP forwarding is disabled</li> <li>3.3.1 Ensure source routed packets are not accepted</li> <li>3.3.2 Ensure ICMP redirects are not accepted</li> <li>3.3.3 Ensure secure ICMP redirects are not accepted</li> <li>3.3.5 Ensure broadcast ICMP requests are ignored</li> <li>3.3.6 Ensure bogus ICMP responses are ignored</li> <li>3.3.7 Ensure Reverse Path Filtering is enabled</li> <li>3.3.8 Ensure TCP SYN Cookies is enabled</li> <li>3.3.9 Ensure IPv6 router advertisements are not accepted</li> <li>4.2.1.1.4 Ensure journald is not configured to recieve logs from a remote client</li> <li>4.2.2.7 Ensure rsyslog is not configured to receive logs from a remote client</li> <li>5.2.12 Ensure SSH X11 forwarding is disabled</li> </ul>"},{"location":"tags/#52-use-unique-passwords","title":"5.2 Use Unique Passwords","text":"<ul> <li>1.4.1 Ensure bootloader password is set</li> <li>1.4.3 Ensure authentication required for single user mode</li> <li>5.4.1 Ensure password creation requirements are configured</li> <li>5.4.3 Ensure password reuse is limited</li> <li>5.5.1.1 Ensure minimum days between password changes is configured</li> <li>5.5.1.2 Ensure password expiration is 365 days or less</li> <li>5.5.1.3 Ensure password expiration warning days is 7 or more</li> <li>5.5.1.4 Ensure inactive password lock is 30 days or less</li> <li>5.5.1.5 Ensure all users last password change date is in the past</li> <li>6.2.2 Ensure /etc/shadow password fields are not empty</li> </ul>"},{"location":"tags/#54-restrict-administrator-privileges-to-dedicated-administrator-accounts","title":"5.4 Restrict Administrator Privileges to Dedicated Administrator Accounts","text":"<ul> <li>5.2.7 Ensure SSH root login is disabled</li> <li>5.3.1 Ensure sudo is installed</li> <li>5.3.2 Ensure sudo commands use pty</li> <li>5.3.4 Ensure users must provide password for privilege escalation</li> <li>5.3.5 Ensure re-authentication for privilege escalation is not disabled globally</li> <li>5.3.6 Ensure sudo authentication timeout is configured correctly</li> </ul>"},{"location":"tags/#62-establish-an-access-revoking-process","title":"6.2 Establish an Access Revoking Process","text":"<ul> <li>5.4.2 Ensure lockout for failed password attempts is configured</li> </ul>"},{"location":"tags/#73-perform-automated-operating-system-patch-management","title":"7.3 Perform Automated Operating System Patch Management","text":"<ul> <li>1.9 Ensure updates, patches, and additional security software are installed</li> <li>1.2.1 Ensure package manager repositories are configured</li> <li>1.2.2 Ensure GPG keys are configured</li> </ul>"},{"location":"tags/#82-collect-audit-logs","title":"8.2 Collect Audit Logs","text":"<ul> <li>4.1.1.2 Ensure auditd service is enabled and active</li> <li>4.1.1.3 Ensure auditing for processes that start prior to auditd is enabled</li> <li>4.1.1.4 Ensure audit_backlog_limit is sufficient</li> <li>4.1.2.3 Ensure system is disabled when audit logs are full</li> <li>4.1.3.15 Ensure successful and unsuccessful attempts to use the chcon command are recorded</li> <li>4.1.3.16 Ensure successful and unsuccessful attempts to use the setfacl command are recorded</li> <li>4.1.3.17 Ensure successful and unsuccessful attempts to use the chacl command are recorde</li> <li>4.1.3.18 Ensure successful and unsuccessful attempts to use the usermod command are recorded</li> <li>4.2.1.2 Ensure journald service is enabled</li> <li>4.2.1.3 Ensure journald is configured to compress large log files</li> <li>4.2.1.4 Ensure journald is configured to write logfiles to persistent disk</li> <li>4.2.1.5 Ensure journald is not configured to send logs to rsyslog</li> <li>4.2.1.6 Ensure journald log rotation is configured per site policy</li> <li>4.2.1.7 Ensure journald default file permissions configured</li> <li>4.2.1.1.1 Ensure systemd-journal-remote is installed</li> <li>4.2.1.1.2 Ensure systemd-journal-remote is configured</li> <li>4.2.1.1.3 Ensure systemd-journal-remote is enabled</li> <li>4.2.1.1.4 Ensure journald is not configured to recieve logs from a remote client</li> <li>4.2.2.1 Ensure rsyslog is installed</li> <li>4.2.2.2 Ensure rsyslog service is enabled</li> <li>4.2.2.3 Ensure journald is configured to send logs to rsyslog</li> <li>4.2.2.4 Ensure rsyslog default file permissions are configured</li> <li>4.2.2.5 Ensure logging is configured</li> <li>4.2.2.6 Ensure rsyslog is configured to send logs to a remote log host</li> <li>4.2.2.7 Ensure rsyslog is not configured to receive logs from a remote client</li> <li>5.2.5 Ensure SSH LogLevel is appropriate</li> </ul>"},{"location":"tags/#83-ensure-adequate-audit-log-storage","title":"8.3 Ensure Adequate Audit Log Storage","text":"<ul> <li>1.1.5.1 Ensure separate partition exists for /var/log</li> <li>1.1.6.1 Ensure separate partition exists for /var/log/audit</li> <li>4.1.2.1 Ensure audit log storage size is configured</li> <li>4.1.2.2 Ensure audit logs are not automatically deleted</li> <li>4.2.1.3 Ensure journald is configured to compress large log files</li> </ul>"},{"location":"tags/#84-standardize-time-synchronization","title":"8.4 Standardize Time Synchronization","text":"<ul> <li>2.1.1.1 Ensure a single time synchronization daemon is in use</li> <li>2.1.2.1 Ensure chrony is configured with authorized timeserver</li> <li>2.1.2.2 Ensure chrony is running as user _chrony</li> <li>2.1.2.3 Ensure chrony is enabled and running</li> <li>2.1.3.1 Ensure systemd-timesyncd configured with authorized timeserver</li> <li>2.1.3.2 Ensure systemd-timesyncd is enabled and running</li> <li>2.1.4.1 Ensure ntp access control is configured</li> <li>2.1.4.2 Ensure ntp is configured with authorized timeserver</li> <li>2.1.4.3 Ensure ntp is running as user ntp</li> <li>Ensure mounting of cramfs filesystems is disabled</li> </ul>"},{"location":"tags/#85-collect-detailed-audit-logs","title":"8.5 Collect Detailed Audit Logs","text":"<ul> <li>1.3.2 Ensure filesystem integrity is regularly checked</li> <li>3.3.4 Ensure suspicious packets are logged</li> <li>4.1.1.1 Ensure auditd is installed</li> <li>4.1.3.1 Ensure changes to system administration scope (sudoers) is collected</li> <li>4.1.3.10 Ensure successful file system mounts are collected</li> <li>4.1.3.11 Ensure session initiation information is collected</li> <li>4.1.3.12 Ensure login and logout events are collected</li> <li>4.1.3.13 Ensure file deletion events by users are collected</li> <li>4.1.3.14 Ensure events that modify the system's Mandatory Access Controls are collected</li> <li>4.1.3.19 Ensure kernel module loading unloading and modification is collected</li> <li>4.1.3.2 Ensure actions as another user are always logged</li> <li>4.1.3.20 Ensure the audit configuration is immutable</li> <li>4.1.3.21 Ensure the running and on disk configuration is the same</li> <li>4.1.3.3 Ensure events that modify the sudo log file are collected</li> <li>4.1.3.4 Ensure events that modify date and time information are collected</li> <li>4.1.3.5 Ensure events that modify the system's network environment are collected</li> <li>4.1.3.6 Ensure use of privileged commands are collected</li> <li>4.1.3.7 Ensure unsuccessful file access attempts are collected</li> <li>4.1.3.8 Ensure events that modify user/group information are collected</li> <li>4.1.3.9 Ensure discretionary access control permission modification events are collected</li> <li>5.2.18 Ensure SSH MaxAuthTries is set to 4 or less</li> <li>5.3.3 Ensure sudo log file exists</li> </ul>"},{"location":"tags/#89-centralize-audit-logs","title":"8.9 Centralize Audit Logs","text":"<ul> <li>4.2.1.5 Ensure journald is not configured to send logs to rsyslog</li> <li>4.2.2.3 Ensure journald is configured to send logs to rsyslog</li> </ul>"},{"location":"tags/#access-authentication-and-authorization","title":"Access, Authentication and Authorization","text":"<ul> <li>5.1.1 Ensure cron daemon is enabled and running</li> <li>5.1.2 Ensure permissions on /etc/crontab are configured</li> <li>5.1.3 Ensure permissions on /etc/cron.hourly are configured</li> <li>5.1.4 Ensure permissions on /etc/cron.daily are configured</li> <li>5.1.5 Ensure permissions on /etc/cron.weekly are configured</li> <li>5.1.6 Ensure permissions on /etc/cron.monthly are configured</li> <li>5.1.7 Ensure permissions on /etc/cron.d are configured</li> <li>5.1.8 Ensure cron is restricted to authorized users</li> <li>5.1.9 Ensure at is restricted to authorized users</li> <li>5.2.1 Ensure permissions on /etc/ssh/sshd_config are configured</li> <li>5.2.10 Ensure SSH PermitUserEnvironment is disabled</li> <li>5.2.11 Ensure SSH IgnoreRhosts is enabled</li> <li>5.2.12 Ensure SSH X11 forwarding is disabled</li> <li>5.2.13 Ensure only strong Ciphers are used</li> <li>5.2.14 Ensure only strong MAC algorithms are used</li> <li>5.2.15 Ensure only strong Key Exchange algorithms are used</li> <li>5.2.16 Ensure SSH AllowTcpForwarding is disabled</li> <li>5.2.17 Ensure SSH warning banner is configured</li> <li>5.2.18 Ensure SSH MaxAuthTries is set to 4 or less</li> <li>5.2.19 Ensure SSH MaxStartups is configured</li> <li>5.2.2 Ensure permissions on SSH private host key files are configured</li> <li>5.2.20 Ensure SSH MaxSessions is set to 10 or less</li> <li>5.2.21 Ensure SSH LoginGraceTime is set to one minute or less</li> <li>5.2.22 Ensure SSH Idle Timeout Interval is configured</li> <li>5.2.3 Ensure permissions on SSH public host key files are configured</li> <li>5.2.4 Ensure SSH access is limited</li> <li>5.2.5 Ensure SSH LogLevel is appropriate</li> <li>5.2.6 Ensure SSH PAM is enabled</li> <li>5.2.7 Ensure SSH root login is disabled</li> <li>5.2.8 Ensure SSH HostbasedAuthentication is disabled</li> <li>5.2.9 Ensure SSH PermitEmptyPasswords is disabled</li> <li>5.3.1 Ensure sudo is installed</li> <li>5.3.2 Ensure sudo commands use pty</li> <li>5.3.3 Ensure sudo log file exists</li> <li>5.3.4 Ensure users must provide password for privilege escalation</li> <li>5.3.5 Ensure re-authentication for privilege escalation is not disabled globally</li> <li>5.3.6 Ensure sudo authentication timeout is configured correctly</li> <li>5.3.7 Ensure access to the su command is restricted</li> <li>5.4.1 Ensure password creation requirements are configured</li> <li>5.4.2 Ensure lockout for failed password attempts is configured</li> <li>5.4.3 Ensure password reuse is limited</li> <li>5.4.4 Ensure password hashing algorithm is up to date with the latest standards</li> <li>5.5.2 Ensure system accounts are secured</li> <li>5.5.3 Ensure default group for the root account is GID 0</li> <li>5.5.4 Ensure default user umask is 027 or more restrictive</li> <li>5.5.5 Ensure default user shell timeout is 900 seconds or less</li> <li>5.5.1.1 Ensure minimum days between password changes is configured</li> <li>5.5.1.2 Ensure password expiration is 365 days or less</li> <li>5.5.1.3 Ensure password expiration warning days is 7 or more</li> <li>5.5.1.4 Ensure inactive password lock is 30 days or less</li> <li>5.5.1.5 Ensure all users last password change date is in the past</li> </ul>"},{"location":"tags/#additional-process-hardening","title":"Additional Process Hardening","text":"<ul> <li>1.5.1 Ensure address space layout randomization (ASLR) is enabled</li> <li>1.5.2 Ensure prelink is not installed</li> <li>1.5.3 Ensure Automatic Error Reporting is not enabled</li> <li>1.5.4 Ensure core dumps are restricted</li> </ul>"},{"location":"tags/#automated","title":"Automated","text":"<ul> <li>1.1.10 Disable USB Storage</li> <li>1.1.9 Disable Automounting</li> <li>1.1.1.1 Ensure mounting of cramfs filesystems is disabled</li> <li>1.1.1.2 Ensure mounting of squashfs filesystems is disabled</li> <li>1.1.1.3 Ensure mounting of udf filesystems is disabled</li> <li>1.1.2.1 Ensure /tmp is a separate partition</li> <li>1.1.2.2 Ensure nodev option set on /tmp partition</li> <li>1.1.2.3 Ensure noexec option set on /tmp partition</li> <li>1.1.2.4 Ensure nosuid option set on /tmp partition</li> <li>1.1.3.1 Ensure separate partition exists for /var</li> <li>1.1.3.2 Ensure nodev option set on /var partition</li> <li>1.1.3.3 Ensure nosuid option set on /var partition</li> <li>1.1.4.1 Ensure separate partition exists for /var/tmp</li> <li>1.1.4.2 Ensure noexec option set on /var/tmp partition</li> <li>1.1.4.3 Ensure nosuid option set on /var/tmp partition</li> <li>1.1.4.4 Ensure nodev option set on /var/tmp partition</li> <li>1.1.5.1 Ensure separate partition exists for /var/log</li> <li>1.1.5.2 Ensure nodev option set on /var/log partition</li> <li>1.1.5.3 Ensure noexec option set on /var/log partition</li> <li>1.1.5.4 Ensure nosuid option set on /var/log partition</li> <li>1.1.6.1 Ensure separate partition exists for /var/log/audit</li> <li>1.1.6.2 Ensure noexec option set on /var/log/audit partition</li> <li>1.1.6.3 Ensure nodev option set on /var/log/audit partition</li> <li>1.1.6.4 Ensure nosuid option set on /var/log/audit partition</li> <li>1.1.7.1 Ensure separate partition exists for /home</li> <li>1.1.7.2 Ensure nodev option set on /home partition</li> <li>1.1.7.3 Ensure nosuid option set on /home partition</li> <li>1.1.8.1 Ensure nodev option set on /dev/shm partition</li> <li>1.1.8.2 Ensure noexec option set on /dev/shm partition</li> <li>1.1.8.3 Ensure nosuid option set on /dev/shm partition</li> <li>1.3.1 Ensure AIDE is installed</li> <li>1.3.2 Ensure filesystem integrity is regularly checked</li> <li>1.4.1 Ensure bootloader password is set</li> <li>1.4.2 Ensure permissions on bootloader config are configured</li> <li>1.4.3 Ensure authentication required for single user mode</li> <li>1.5.1 Ensure address space layout randomization (ASLR) is enabled</li> <li>1.5.2 Ensure prelink is not installed</li> <li>1.5.3 Ensure Automatic Error Reporting is not enabled</li> <li>1.5.4 Ensure core dumps are restricted</li> <li>1.6.1.1 Ensure AppArmor is installed</li> <li>1.6.1.2 Ensure AppArmor is enabled in the bootloader configuration</li> <li>1.6.1.3 Ensure all AppArmor Profiles are in enforce or complain mode</li> <li>1.6.1.4 Ensure all AppArmor Profiles are enforcing</li> <li>1.7.1 Ensure message of the day is configured properly</li> <li>1.7.2 Ensure local login warning banner is configured properly</li> <li>1.7.3 Ensure remote login warning banner is configured properly</li> <li>1.7.4 Ensure permissions on /etc/motd are configured</li> <li>1.7.5 Ensure permissions on /etc/issue are configured</li> <li>1.7.6 Ensure permissions on /etc/issue.net are configured</li> <li>1.8.1 Ensure GNOME Display Manager is removed</li> <li>1.8.10 Ensure XDCMP is not enabled</li> <li>1.8.2 Ensure GDM login banner is configured</li> <li>1.8.3 Ensure GDM disable-user-list option is enabled</li> <li>1.8.4 Ensure GDM screen locks when the user is idle</li> <li>1.8.5 Ensure GDM screen locks cannot be overridden</li> <li>1.8.6 Ensure GDM automatic mounting of removable media is disabled</li> <li>1.8.7 Ensure GDM disabling automatic mounting of removable media is not overridden</li> <li>1.8.8 Ensure GDM autorun-never is enabled</li> <li>1.8.9 Ensure GDM autorun-never is not overridden</li> <li>2.1.1.1 Ensure a single time synchronization daemon is in use</li> <li>2.1.2.2 Ensure chrony is running as user _chrony</li> <li>2.1.2.3 Ensure chrony is enabled and running</li> <li>2.1.3.2 Ensure systemd-timesyncd is enabled and running</li> <li>2.1.4.1 Ensure ntp access control is configured</li> <li>2.1.4.3 Ensure ntp is running as user ntp</li> <li>Ensure mounting of cramfs filesystems is disabled</li> <li>2.2.1 Ensure X Window System is not installed</li> <li>2.2.10 Ensure IMAP and POP3 server are not installed</li> <li>2.2.11 Ensure Samba is not installed</li> <li>2.2.12 Ensure HTTP Proxy Server is not installed</li> <li>2.2.13 Ensure SNMP Server is not installed</li> <li>2.2.14 Ensure NIS Server is not installed</li> <li>2.2.15 Ensure mail transfer agent is configured for local-only mode</li> <li>2.2.16 Ensure rsync service is either not installed or masked</li> <li>2.2.2 Ensure Avahi Server is not installed</li> <li>2.2.3 Ensure CUPS is not installed</li> <li>2.2.4 Ensure DHCP Server is not installed</li> <li>2.2.5 Ensure LDAP server is not installed</li> <li>2.2.6 Ensure NFS is not installed</li> <li>2.2.7 Ensure DNS Server is not installed</li> <li>2.2.8 Ensure FTP Server is not installed</li> <li>2.2.9 Ensure HTTP server is not installed</li> <li>2.3.1 Ensure NIS Client is not installed</li> <li>2.3.2 Ensure rsh client is not installed</li> <li>2.3.3 Ensure talk client is not installed</li> <li>2.3.4 Ensure telnet client is not installed</li> <li>2.3.5 Ensure LDAP client is not installed</li> <li>2.3.6 Ensure RPC is not installed</li> <li>3.1.2 Ensure wireless interfaces are disabled</li> <li>3.1.3 Ensure DCCP is disabled</li> <li>3.1.4 Ensure SCTP is disabled</li> <li>3.1.5 Ensure RDS is disabled</li> <li>3.1.6 Ensure TIPC is disabled</li> <li>3.2.1 Ensure packet redirect sending is disabled</li> <li>3.2.2 Ensure IP forwarding is disabled</li> <li>3.3.1 Ensure source routed packets are not accepted</li> <li>3.3.2 Ensure ICMP redirects are not accepted</li> <li>3.3.3 Ensure secure ICMP redirects are not accepted</li> <li>3.3.4 Ensure suspicious packets are logged</li> <li>3.3.5 Ensure broadcast ICMP requests are ignored</li> <li>3.3.6 Ensure bogus ICMP responses are ignored</li> <li>3.3.7 Ensure Reverse Path Filtering is enabled</li> <li>3.3.8 Ensure TCP SYN Cookies is enabled</li> <li>3.3.9 Ensure IPv6 router advertisements are not accepted</li> <li>3.5.1.1 Ensure ufw is installed</li> <li>3.5.1.2 Ensure iptables-persistent is not installed with ufw</li> <li>3.5.1.3 Ensure ufw service is enabled</li> <li>3.5.1.4 Ensure ufw loopback traffic is configured</li> <li>3.5.1.6 Ensure ufw firewall rules exist for all open ports</li> <li>3.5.1.7 Ensure ufw default deny firewall policy</li> <li>3.5.2.1 Ensure nftables is installed</li> <li>3.5.2.10 Ensure nftables rules are permanent</li> <li>3.5.2.2 Ensure ufw is uninstalled or disabled with nftables</li> <li>3.5.2.4 Ensure a nftables table exists</li> <li>3.5.2.5 Ensure nftables base chains exist</li> <li>3.5.2.6 Ensure nftables loopback traffic is configured</li> <li>3.5.2.8 Ensure nftables default deny firewall policy</li> <li>3.5.2.9 Ensure nftables service is enabled</li> <li>3.5.3.1.1 Ensure iptables packages are installed</li> <li>3.5.3.1.2 Ensure nftables is not installed with iptables</li> <li>3.5.3.1.3 Ensure ufw is uninstalled or disabled with iptables</li> <li>3.5.3.2.1 Ensure iptables default deny firewall policy</li> <li>3.5.3.2.2 Ensure iptables loopback traffic is configured</li> <li>3.5.3.2.4 Ensure iptables firewall rules exist for all open ports</li> <li>3.5.3.3.1 Ensure ip6tables default deny firewall policy</li> <li>3.5.3.3.2 Ensure ip6tables loopback traffic is configured</li> <li>3.5.3.3.4 Ensure ip6tables firewall rules exist for all open ports</li> <li>4.1.1.1 Ensure auditd is installed</li> <li>4.1.1.2 Ensure auditd service is enabled and active</li> <li>4.1.1.3 Ensure auditing for processes that start prior to auditd is enabled</li> <li>4.1.1.4 Ensure audit_backlog_limit is sufficient</li> <li>4.1.2.1 Ensure audit log storage size is configured</li> <li>4.1.2.2 Ensure audit logs are not automatically deleted</li> <li>4.1.2.3 Ensure system is disabled when audit logs are full</li> <li>4.1.3.1 Ensure changes to system administration scope (sudoers) is collected</li> <li>4.1.3.10 Ensure successful file system mounts are collected</li> <li>4.1.3.11 Ensure session initiation information is collected</li> <li>4.1.3.12 Ensure login and logout events are collected</li> <li>4.1.3.13 Ensure file deletion events by users are collected</li> <li>4.1.3.14 Ensure events that modify the system's Mandatory Access Controls are collected</li> <li>4.1.3.15 Ensure successful and unsuccessful attempts to use the chcon command are recorded</li> <li>4.1.3.16 Ensure successful and unsuccessful attempts to use the setfacl command are recorded</li> <li>4.1.3.17 Ensure successful and unsuccessful attempts to use the chacl command are recorde</li> <li>4.1.3.18 Ensure successful and unsuccessful attempts to use the usermod command are recorded</li> <li>4.1.3.19 Ensure kernel module loading unloading and modification is collected</li> <li>4.1.3.2 Ensure actions as another user are always logged</li> <li>4.1.3.20 Ensure the audit configuration is immutable</li> <li>4.1.3.3 Ensure events that modify the sudo log file are collected</li> <li>4.1.3.4 Ensure events that modify date and time information are collected</li> <li>4.1.3.5 Ensure events that modify the system's network environment are collected</li> <li>4.1.3.6 Ensure use of privileged commands are collected</li> <li>4.1.3.7 Ensure unsuccessful file access attempts are collected</li> <li>4.1.3.8 Ensure events that modify user/group information are collected</li> <li>4.1.3.9 Ensure discretionary access control permission modification events are collected</li> <li>4.1.4.1 Ensure audit log files are mode 0640 or less permissive</li> <li>4.1.4.10 Ensure audit tools belong to group root</li> <li>4.1.4.11 Ensure cryptographic mechanisms are used to protect the integrity of audit tool</li> <li>4.1.4.2 Ensure only authorized users own audit log files</li> <li>4.1.4.3 Ensure only authorized groups are assigned ownership of audit log files</li> <li>4.1.4.4 Ensure the audit log directory is 0750 or more restrictive</li> <li>4.1.4.5 Ensure audit configuration files are 640 or more restrictive</li> <li>4.1.4.6 Ensure audit configuration files are owned by root</li> <li>4.1.4.7 Ensure audit configuration files belong to group root</li> <li>4.1.4.8 Ensure audit tools are 755 or more restrictive</li> <li>4.1.4.9 Ensure audit tools are owned by root</li> <li>4.2.3 Ensure all logfiles have appropriate permissions and ownership</li> <li>4.2.1.2 Ensure journald service is enabled</li> <li>4.2.1.3 Ensure journald is configured to compress large log files</li> <li>4.2.1.4 Ensure journald is configured to write logfiles to persistent disk</li> <li>4.2.1.1.1 Ensure systemd-journal-remote is installed</li> <li>4.2.1.1.4 Ensure journald is not configured to recieve logs from a remote client</li> <li>4.2.2.1 Ensure rsyslog is installed</li> <li>4.2.2.2 Ensure rsyslog service is enabled</li> <li>4.2.2.4 Ensure rsyslog default file permissions are configured</li> <li>4.2.2.7 Ensure rsyslog is not configured to receive logs from a remote client</li> <li>5.1.1 Ensure cron daemon is enabled and running</li> <li>5.1.2 Ensure permissions on /etc/crontab are configured</li> <li>5.1.3 Ensure permissions on /etc/cron.hourly are configured</li> <li>5.1.4 Ensure permissions on /etc/cron.daily are configured</li> <li>5.1.5 Ensure permissions on /etc/cron.weekly are configured</li> <li>5.1.6 Ensure permissions on /etc/cron.monthly are configured</li> <li>5.1.7 Ensure permissions on /etc/cron.d are configured</li> <li>5.1.8 Ensure cron is restricted to authorized users</li> <li>5.1.9 Ensure at is restricted to authorized users</li> <li>5.2.1 Ensure permissions on /etc/ssh/sshd_config are configured</li> <li>5.2.10 Ensure SSH PermitUserEnvironment is disabled</li> <li>5.2.11 Ensure SSH IgnoreRhosts is enabled</li> <li>5.2.12 Ensure SSH X11 forwarding is disabled</li> <li>5.2.13 Ensure only strong Ciphers are used</li> <li>5.2.14 Ensure only strong MAC algorithms are used</li> <li>5.2.15 Ensure only strong Key Exchange algorithms are used</li> <li>5.2.16 Ensure SSH AllowTcpForwarding is disabled</li> <li>5.2.17 Ensure SSH warning banner is configured</li> <li>5.2.18 Ensure SSH MaxAuthTries is set to 4 or less</li> <li>5.2.19 Ensure SSH MaxStartups is configured</li> <li>5.2.2 Ensure permissions on SSH private host key files are configured</li> <li>5.2.20 Ensure SSH MaxSessions is set to 10 or less</li> <li>5.2.21 Ensure SSH LoginGraceTime is set to one minute or less</li> <li>5.2.22 Ensure SSH Idle Timeout Interval is configured</li> <li>5.2.3 Ensure permissions on SSH public host key files are configured</li> <li>5.2.4 Ensure SSH access is limited</li> <li>5.2.5 Ensure SSH LogLevel is appropriate</li> <li>5.2.6 Ensure SSH PAM is enabled</li> <li>5.2.7 Ensure SSH root login is disabled</li> <li>5.2.8 Ensure SSH HostbasedAuthentication is disabled</li> <li>5.2.9 Ensure SSH PermitEmptyPasswords is disabled</li> <li>5.3.1 Ensure sudo is installed</li> <li>5.3.2 Ensure sudo commands use pty</li> <li>5.3.3 Ensure sudo log file exists</li> <li>5.3.4 Ensure users must provide password for privilege escalation</li> <li>5.3.5 Ensure re-authentication for privilege escalation is not disabled globally</li> <li>5.3.6 Ensure sudo authentication timeout is configured correctly</li> <li>5.3.7 Ensure access to the su command is restricted</li> <li>5.4.1 Ensure password creation requirements are configured</li> <li>5.4.2 Ensure lockout for failed password attempts is configured</li> <li>5.4.3 Ensure password reuse is limited</li> <li>5.4.4 Ensure password hashing algorithm is up to date with the latest standards</li> <li>5.5.2 Ensure system accounts are secured</li> <li>5.5.3 Ensure default group for the root account is GID 0</li> <li>5.5.4 Ensure default user umask is 027 or more restrictive</li> <li>5.5.5 Ensure default user shell timeout is 900 seconds or less</li> <li>5.5.1.1 Ensure minimum days between password changes is configured</li> <li>5.5.1.2 Ensure password expiration is 365 days or less</li> <li>5.5.1.3 Ensure password expiration warning days is 7 or more</li> <li>5.5.1.4 Ensure inactive password lock is 30 days or less</li> <li>5.5.1.5 Ensure all users last password change date is in the past</li> <li>6.1.1 Ensure permissions on /etc/passwd are configured</li> <li>6.1.10 Ensure no unowned files or directories exist</li> <li>6.1.11 Ensure no ungrouped files or directories exist</li> <li>6.1.2 Ensure permissions on /etc/passwd- are configured</li> <li>6.1.3 Ensure permissions on /etc/group are configured</li> <li>6.1.4 Ensure permissions on /etc/group- are configured</li> <li>6.1.5 Ensure permissions on /etc/shadow are configured</li> <li>6.1.6 Ensure permissions on /etc/shadow- are configured</li> <li>6.1.7 Ensure permissions on /etc/gshadow are configured</li> <li>E6.1.8 Ensure permissions on /etc/gshadow- are configured</li> <li>6.1.9 Ensure no world writable files exist</li> <li>6.2.1 Ensure accounts in /etc/passwd use shadowed passwords</li> <li>6.2.10 Ensure root is the only UID 0 account</li> <li>6.2.11 Ensure local interactive user home directories exist</li> <li>6.2.12 Ensure local interactive users own their home directories</li> <li>6.2.13 Ensure local interactive user home directories are mode 750 or more restrictive</li> <li>6.2.14 Ensure no local interactive user has .netrc files</li> <li>6.2.15 Ensure no local interactive user has .forward files</li> <li>6.2.16 Ensue no local interactive user has .rhosts files</li> <li>6.2.17 Ensure local interactive user dot files are not group or world writable</li> <li>6.2.2 Ensure /etc/shadow password fields are not empty</li> <li>6.2.3 Ensure all groups in /etc/passwd exist in /etc/group</li> <li>6.2.4 Ensure shadow group is empty</li> <li>6.2.5 Ensure no duplicate UIDs exist</li> <li>6.2.6 Ensure no duplicate GIDs exist</li> <li>6.2.7 Ensure no duplicate user names exist</li> <li>6.2.8 Ensure no duplicate group names exist</li> <li>6.2.9 Ensure root PATH Integrity</li> </ul>"},{"location":"tags/#command-line-warning-banners","title":"Command Line Warning Banners","text":"<ul> <li>1.7.1 Ensure message of the day is configured properly</li> <li>1.7.2 Ensure local login warning banner is configured properly</li> <li>1.7.3 Ensure remote login warning banner is configured properly</li> <li>1.7.4 Ensure permissions on /etc/motd are configured</li> <li>1.7.5 Ensure permissions on /etc/issue are configured</li> <li>1.7.6 Ensure permissions on /etc/issue.net are configured</li> </ul>"},{"location":"tags/#configure-devshm","title":"Configure /dev/shm","text":"<ul> <li>1.1.8.1 Ensure nodev option set on /dev/shm partition</li> <li>1.1.8.2 Ensure noexec option set on /dev/shm partition</li> <li>1.1.8.3 Ensure nosuid option set on /dev/shm partition</li> </ul>"},{"location":"tags/#configure-home","title":"Configure /home","text":"<ul> <li>1.1.7.1 Ensure separate partition exists for /home</li> <li>1.1.7.2 Ensure nodev option set on /home partition</li> <li>1.1.7.3 Ensure nosuid option set on /home partition</li> </ul>"},{"location":"tags/#configure-tmp","title":"Configure /tmp","text":"<ul> <li>1.1.2.1 Ensure /tmp is a separate partition</li> <li>1.1.2.2 Ensure nodev option set on /tmp partition</li> <li>1.1.2.3 Ensure noexec option set on /tmp partition</li> <li>1.1.2.4 Ensure nosuid option set on /tmp partition</li> </ul>"},{"location":"tags/#configure-var","title":"Configure /var","text":"<ul> <li>1.1.3.1 Ensure separate partition exists for /var</li> <li>1.1.3.2 Ensure nodev option set on /var partition</li> <li>1.1.3.3 Ensure nosuid option set on /var partition</li> </ul>"},{"location":"tags/#configure-varlog","title":"Configure /var/log","text":"<ul> <li>1.1.5.1 Ensure separate partition exists for /var/log</li> <li>1.1.5.2 Ensure nodev option set on /var/log partition</li> <li>1.1.5.3 Ensure noexec option set on /var/log partition</li> <li>1.1.5.4 Ensure nosuid option set on /var/log partition</li> </ul>"},{"location":"tags/#configure-varlogaudit","title":"Configure /var/log/audit","text":"<ul> <li>1.1.6.1 Ensure separate partition exists for /var/log/audit</li> <li>1.1.6.2 Ensure noexec option set on /var/log/audit partition</li> <li>1.1.6.3 Ensure nodev option set on /var/log/audit partition</li> <li>1.1.6.4 Ensure nosuid option set on /var/log/audit partition</li> </ul>"},{"location":"tags/#configure-vartmp","title":"Configure /var/tmp","text":"<ul> <li>1.1.4.1 Ensure separate partition exists for /var/tmp</li> <li>1.1.4.2 Ensure noexec option set on /var/tmp partition</li> <li>1.1.4.3 Ensure nosuid option set on /var/tmp partition</li> <li>1.1.4.4 Ensure nodev option set on /var/tmp partition</li> </ul>"},{"location":"tags/#configure-apparmor","title":"Configure AppArmor","text":"<ul> <li>1.6.1.1 Ensure AppArmor is installed</li> <li>1.6.1.2 Ensure AppArmor is enabled in the bootloader configuration</li> <li>1.6.1.3 Ensure all AppArmor Profiles are in enforce or complain mode</li> <li>1.6.1.4 Ensure all AppArmor Profiles are enforcing</li> </ul>"},{"location":"tags/#configure-data-retention","title":"Configure Data Retention","text":"<ul> <li>4.1.2.1 Ensure audit log storage size is configured</li> <li>4.1.2.2 Ensure audit logs are not automatically deleted</li> <li>4.1.2.3 Ensure system is disabled when audit logs are full</li> </ul>"},{"location":"tags/#configure-ipv4-iptables","title":"Configure IPv4 iptables","text":"<ul> <li>3.5.3.2.1 Ensure iptables default deny firewall policy</li> <li>3.5.3.2.2 Ensure iptables loopback traffic is configured</li> <li>3.5.3.2.4 Ensure iptables firewall rules exist for all open ports</li> </ul>"},{"location":"tags/#configure-ipv6-ip6tables","title":"Configure IPv6 ip6tables","text":"<ul> <li>3.5.3.3.1 Ensure ip6tables default deny firewall policy</li> <li>3.5.3.3.2 Ensure ip6tables loopback traffic is configured</li> <li>3.5.3.3.3 Ensure ip6tables outbound and established connections are configured</li> <li>3.5.3.3.4 Ensure ip6tables firewall rules exist for all open ports</li> </ul>"},{"location":"tags/#configure-logging","title":"Configure Logging","text":"<ul> <li>4.2.3 Ensure all logfiles have appropriate permissions and ownership</li> <li>4.2.1.2 Ensure journald service is enabled</li> <li>4.2.1.3 Ensure journald is configured to compress large log files</li> <li>4.2.1.4 Ensure journald is configured to write logfiles to persistent disk</li> <li>4.2.1.5 Ensure journald is not configured to send logs to rsyslog</li> <li>4.2.1.6 Ensure journald log rotation is configured per site policy</li> <li>4.2.1.7 Ensure journald default file permissions configured</li> <li>4.2.1.1.1 Ensure systemd-journal-remote is installed</li> <li>4.2.1.1.2 Ensure systemd-journal-remote is configured</li> <li>4.2.1.1.3 Ensure systemd-journal-remote is enabled</li> <li>4.2.1.1.4 Ensure journald is not configured to recieve logs from a remote client</li> <li>4.2.2.1 Ensure rsyslog is installed</li> <li>4.2.2.2 Ensure rsyslog service is enabled</li> <li>4.2.2.3 Ensure journald is configured to send logs to rsyslog</li> <li>4.2.2.4 Ensure rsyslog default file permissions are configured</li> <li>4.2.2.5 Ensure logging is configured</li> <li>4.2.2.6 Ensure rsyslog is configured to send logs to a remote log host</li> <li>4.2.2.7 Ensure rsyslog is not configured to receive logs from a remote client</li> </ul>"},{"location":"tags/#configure-pam","title":"Configure PAM","text":"<ul> <li>5.4.1 Ensure password creation requirements are configured</li> <li>5.4.2 Ensure lockout for failed password attempts is configured</li> <li>5.4.3 Ensure password reuse is limited</li> <li>5.4.4 Ensure password hashing algorithm is up to date with the latest standards</li> </ul>"},{"location":"tags/#configure-ssh-server","title":"Configure SSH Server","text":"<ul> <li>5.2.1 Ensure permissions on /etc/ssh/sshd_config are configured</li> <li>5.2.10 Ensure SSH PermitUserEnvironment is disabled</li> <li>5.2.11 Ensure SSH IgnoreRhosts is enabled</li> <li>5.2.12 Ensure SSH X11 forwarding is disabled</li> <li>5.2.13 Ensure only strong Ciphers are used</li> <li>5.2.14 Ensure only strong MAC algorithms are used</li> <li>5.2.15 Ensure only strong Key Exchange algorithms are used</li> <li>5.2.16 Ensure SSH AllowTcpForwarding is disabled</li> <li>5.2.17 Ensure SSH warning banner is configured</li> <li>5.2.18 Ensure SSH MaxAuthTries is set to 4 or less</li> <li>5.2.19 Ensure SSH MaxStartups is configured</li> <li>5.2.2 Ensure permissions on SSH private host key files are configured</li> <li>5.2.20 Ensure SSH MaxSessions is set to 10 or less</li> <li>5.2.21 Ensure SSH LoginGraceTime is set to one minute or less</li> <li>5.2.22 Ensure SSH Idle Timeout Interval is configured</li> <li>5.2.3 Ensure permissions on SSH public host key files are configured</li> <li>5.2.4 Ensure SSH access is limited</li> <li>5.2.5 Ensure SSH LogLevel is appropriate</li> <li>5.2.6 Ensure SSH PAM is enabled</li> <li>5.2.7 Ensure SSH root login is disabled</li> <li>5.2.8 Ensure SSH HostbasedAuthentication is disabled</li> <li>5.2.9 Ensure SSH PermitEmptyPasswords is disabled</li> </ul>"},{"location":"tags/#configure-software-updates","title":"Configure Software Updates","text":"<ul> <li>1.2.1 Ensure package manager repositories are configured</li> <li>1.2.2 Ensure GPG keys are configured</li> </ul>"},{"location":"tags/#configure-system-accounting-auditd","title":"Configure System Accounting (auditd)","text":"<ul> <li>4.1.1.1 Ensure auditd is installed</li> <li>4.1.1.2 Ensure auditd service is enabled and active</li> <li>4.1.1.3 Ensure auditing for processes that start prior to auditd is enabled</li> <li>4.1.1.4 Ensure audit_backlog_limit is sufficient</li> <li>4.1.2.1 Ensure audit log storage size is configured</li> <li>4.1.2.2 Ensure audit logs are not automatically deleted</li> <li>4.1.2.3 Ensure system is disabled when audit logs are full</li> <li>4.1.3.1 Ensure changes to system administration scope (sudoers) is collected</li> <li>4.1.3.10 Ensure successful file system mounts are collected</li> <li>4.1.3.11 Ensure session initiation information is collected</li> <li>4.1.3.12 Ensure login and logout events are collected</li> <li>4.1.3.13 Ensure file deletion events by users are collected</li> <li>4.1.3.14 Ensure events that modify the system's Mandatory Access Controls are collected</li> <li>4.1.3.15 Ensure successful and unsuccessful attempts to use the chcon command are recorded</li> <li>4.1.3.16 Ensure successful and unsuccessful attempts to use the setfacl command are recorded</li> <li>4.1.3.17 Ensure successful and unsuccessful attempts to use the chacl command are recorde</li> <li>4.1.3.18 Ensure successful and unsuccessful attempts to use the usermod command are recorded</li> <li>4.1.3.19 Ensure kernel module loading unloading and modification is collected</li> <li>4.1.3.2 Ensure actions as another user are always logged</li> <li>4.1.3.20 Ensure the audit configuration is immutable</li> <li>4.1.3.21 Ensure the running and on disk configuration is the same</li> <li>4.1.3.3 Ensure events that modify the sudo log file are collected</li> <li>4.1.3.4 Ensure events that modify date and time information are collected</li> <li>4.1.3.5 Ensure events that modify the system's network environment are collected</li> <li>4.1.3.6 Ensure use of privileged commands are collected</li> <li>4.1.3.7 Ensure unsuccessful file access attempts are collected</li> <li>4.1.3.8 Ensure events that modify user/group information are collected</li> <li>4.1.3.9 Ensure discretionary access control permission modification events are collected</li> <li>4.1.4.1 Ensure audit log files are mode 0640 or less permissive</li> <li>4.1.4.10 Ensure audit tools belong to group root</li> <li>4.1.4.11 Ensure cryptographic mechanisms are used to protect the integrity of audit tool</li> <li>4.1.4.2 Ensure only authorized users own audit log files</li> <li>4.1.4.3 Ensure only authorized groups are assigned ownership of audit log files</li> <li>4.1.4.4 Ensure the audit log directory is 0750 or more restrictive</li> <li>4.1.4.5 Ensure audit configuration files are 640 or more restrictive</li> <li>4.1.4.6 Ensure audit configuration files are owned by root</li> <li>4.1.4.7 Ensure audit configuration files belong to group root</li> <li>4.1.4.8 Ensure audit tools are 755 or more restrictive</li> <li>4.1.4.9 Ensure audit tools are owned by root</li> </ul>"},{"location":"tags/#configure-time-synchronization","title":"Configure Time Synchronization","text":"<ul> <li>2.1.1.1 Ensure a single time synchronization daemon is in use</li> <li>2.1.2.1 Ensure chrony is configured with authorized timeserver</li> <li>2.1.2.2 Ensure chrony is running as user _chrony</li> <li>2.1.2.3 Ensure chrony is enabled and running</li> <li>2.1.3.1 Ensure systemd-timesyncd configured with authorized timeserver</li> <li>2.1.3.2 Ensure systemd-timesyncd is enabled and running</li> <li>2.1.4.1 Ensure ntp access control is configured</li> <li>2.1.4.2 Ensure ntp is configured with authorized timeserver</li> <li>2.1.4.3 Ensure ntp is running as user ntp</li> <li>Ensure mounting of cramfs filesystems is disabled</li> </ul>"},{"location":"tags/#configure-uncomplicatedfirewall","title":"Configure UncomplicatedFirewall","text":"<ul> <li>3.5.1.1 Ensure ufw is installed</li> <li>3.5.1.2 Ensure iptables-persistent is not installed with ufw</li> <li>3.5.1.3 Ensure ufw service is enabled</li> <li>3.5.1.4 Ensure ufw loopback traffic is configured</li> <li>3.5.1.5 Ensure ufw outbound connections are configured</li> <li>3.5.1.6 Ensure ufw firewall rules exist for all open ports</li> <li>3.5.1.7 Ensure ufw default deny firewall policy</li> </ul>"},{"location":"tags/#configure-auditd-file-access","title":"Configure auditd file access","text":"<ul> <li>4.1.4.1 Ensure audit log files are mode 0640 or less permissive</li> <li>4.1.4.10 Ensure audit tools belong to group root</li> <li>4.1.4.11 Ensure cryptographic mechanisms are used to protect the integrity of audit tool</li> <li>4.1.4.2 Ensure only authorized users own audit log files</li> <li>4.1.4.3 Ensure only authorized groups are assigned ownership of audit log files</li> <li>4.1.4.4 Ensure the audit log directory is 0750 or more restrictive</li> <li>4.1.4.5 Ensure audit configuration files are 640 or more restrictive</li> <li>4.1.4.6 Ensure audit configuration files are owned by root</li> <li>4.1.4.7 Ensure audit configuration files belong to group root</li> <li>4.1.4.8 Ensure audit tools are 755 or more restrictive</li> <li>4.1.4.9 Ensure audit tools are owned by root</li> </ul>"},{"location":"tags/#configure-auditd-rules","title":"Configure auditd rules","text":"<ul> <li>4.1.3.1 Ensure changes to system administration scope (sudoers) is collected</li> <li>4.1.3.10 Ensure successful file system mounts are collected</li> <li>4.1.3.11 Ensure session initiation information is collected</li> <li>4.1.3.12 Ensure login and logout events are collected</li> <li>4.1.3.13 Ensure file deletion events by users are collected</li> <li>4.1.3.14 Ensure events that modify the system's Mandatory Access Controls are collected</li> <li>4.1.3.15 Ensure successful and unsuccessful attempts to use the chcon command are recorded</li> <li>4.1.3.16 Ensure successful and unsuccessful attempts to use the setfacl command are recorded</li> <li>4.1.3.17 Ensure successful and unsuccessful attempts to use the chacl command are recorde</li> <li>4.1.3.18 Ensure successful and unsuccessful attempts to use the usermod command are recorded</li> <li>4.1.3.19 Ensure kernel module loading unloading and modification is collected</li> <li>4.1.3.2 Ensure actions as another user are always logged</li> <li>4.1.3.20 Ensure the audit configuration is immutable</li> <li>4.1.3.21 Ensure the running and on disk configuration is the same</li> <li>4.1.3.3 Ensure events that modify the sudo log file are collected</li> <li>4.1.3.4 Ensure events that modify date and time information are collected</li> <li>4.1.3.5 Ensure events that modify the system's network environment are collected</li> <li>4.1.3.6 Ensure use of privileged commands are collected</li> <li>4.1.3.7 Ensure unsuccessful file access attempts are collected</li> <li>4.1.3.8 Ensure events that modify user/group information are collected</li> <li>4.1.3.9 Ensure discretionary access control permission modification events are collected</li> </ul>"},{"location":"tags/#configure-chrony","title":"Configure chrony","text":"<ul> <li>2.1.2.1 Ensure chrony is configured with authorized timeserver</li> <li>2.1.2.2 Ensure chrony is running as user _chrony</li> <li>2.1.2.3 Ensure chrony is enabled and running</li> </ul>"},{"location":"tags/#configure-iptables","title":"Configure iptables","text":"<ul> <li>3.5.3.1.1 Ensure iptables packages are installed</li> <li>3.5.3.1.2 Ensure nftables is not installed with iptables</li> <li>3.5.3.1.3 Ensure ufw is uninstalled or disabled with iptables</li> <li>3.5.3.2.1 Ensure iptables default deny firewall policy</li> <li>3.5.3.2.2 Ensure iptables loopback traffic is configured</li> <li>3.5.3.2.4 Ensure iptables firewall rules exist for all open ports</li> <li>3.5.3.3.1 Ensure ip6tables default deny firewall policy</li> <li>3.5.3.3.2 Ensure ip6tables loopback traffic is configured</li> <li>3.5.3.3.3 Ensure ip6tables outbound and established connections are configured</li> <li>3.5.3.3.4 Ensure ip6tables firewall rules exist for all open ports</li> </ul>"},{"location":"tags/#configure-iptables-software","title":"Configure iptables software","text":"<ul> <li>3.5.3.1.1 Ensure iptables packages are installed</li> <li>3.5.3.1.2 Ensure nftables is not installed with iptables</li> <li>3.5.3.1.3 Ensure ufw is uninstalled or disabled with iptables</li> </ul>"},{"location":"tags/#configure-journald","title":"Configure journald","text":"<ul> <li>4.2.1.2 Ensure journald service is enabled</li> <li>4.2.1.3 Ensure journald is configured to compress large log files</li> <li>4.2.1.4 Ensure journald is configured to write logfiles to persistent disk</li> <li>4.2.1.5 Ensure journald is not configured to send logs to rsyslog</li> <li>4.2.1.6 Ensure journald log rotation is configured per site policy</li> <li>4.2.1.7 Ensure journald default file permissions configured</li> <li>4.2.1.1.1 Ensure systemd-journal-remote is installed</li> <li>4.2.1.1.2 Ensure systemd-journal-remote is configured</li> <li>4.2.1.1.3 Ensure systemd-journal-remote is enabled</li> <li>4.2.1.1.4 Ensure journald is not configured to recieve logs from a remote client</li> </ul>"},{"location":"tags/#configure-nftables","title":"Configure nftables","text":"<ul> <li>3.5.2.1 Ensure nftables is installed</li> <li>3.5.2.10 Ensure nftables rules are permanent</li> <li>3.5.2.2 Ensure ufw is uninstalled or disabled with nftables</li> <li>3.5.2.3 Ensure iptables are flushed with nftables</li> <li>3.5.2.4 Ensure a nftables table exists</li> <li>3.5.2.5 Ensure nftables base chains exist</li> <li>3.5.2.6 Ensure nftables loopback traffic is configured</li> <li>3.5.2.7 Ensure nftables outbound and established connections are configured</li> <li>3.5.2.8 Ensure nftables default deny firewall policy</li> <li>3.5.2.9 Ensure nftables service is enabled</li> </ul>"},{"location":"tags/#configure-ntp","title":"Configure ntp","text":"<ul> <li>2.1.4.1 Ensure ntp access control is configured</li> <li>2.1.4.2 Ensure ntp is configured with authorized timeserver</li> <li>2.1.4.3 Ensure ntp is running as user ntp</li> <li>Ensure mounting of cramfs filesystems is disabled</li> </ul>"},{"location":"tags/#configure-privilege-escalation","title":"Configure privilege escalation","text":"<ul> <li>5.3.1 Ensure sudo is installed</li> <li>5.3.2 Ensure sudo commands use pty</li> <li>5.3.3 Ensure sudo log file exists</li> <li>5.3.4 Ensure users must provide password for privilege escalation</li> <li>5.3.5 Ensure re-authentication for privilege escalation is not disabled globally</li> <li>5.3.6 Ensure sudo authentication timeout is configured correctly</li> <li>5.3.7 Ensure access to the su command is restricted</li> </ul>"},{"location":"tags/#configure-rsyslog","title":"Configure rsyslog","text":"<ul> <li>4.2.3 Ensure all logfiles have appropriate permissions and ownership</li> <li>4.2.2.1 Ensure rsyslog is installed</li> <li>4.2.2.2 Ensure rsyslog service is enabled</li> <li>4.2.2.3 Ensure journald is configured to send logs to rsyslog</li> <li>4.2.2.4 Ensure rsyslog default file permissions are configured</li> <li>4.2.2.5 Ensure logging is configured</li> <li>4.2.2.6 Ensure rsyslog is configured to send logs to a remote log host</li> <li>4.2.2.7 Ensure rsyslog is not configured to receive logs from a remote client</li> </ul>"},{"location":"tags/#configure-systemd-timesyncd","title":"Configure systemd-timesyncd","text":"<ul> <li>2.1.3.1 Ensure systemd-timesyncd configured with authorized timeserver</li> <li>2.1.3.2 Ensure systemd-timesyncd is enabled and running</li> </ul>"},{"location":"tags/#configure-time-based-job-schedulers","title":"Configure time-based job schedulers","text":"<ul> <li>5.1.1 Ensure cron daemon is enabled and running</li> <li>5.1.2 Ensure permissions on /etc/crontab are configured</li> <li>5.1.3 Ensure permissions on /etc/cron.hourly are configured</li> <li>5.1.4 Ensure permissions on /etc/cron.daily are configured</li> <li>5.1.5 Ensure permissions on /etc/cron.weekly are configured</li> <li>5.1.6 Ensure permissions on /etc/cron.monthly are configured</li> <li>5.1.7 Ensure permissions on /etc/cron.d are configured</li> <li>5.1.8 Ensure cron is restricted to authorized users</li> <li>5.1.9 Ensure at is restricted to authorized users</li> </ul>"},{"location":"tags/#disable-automounting","title":"Disable Automounting","text":"<ul> <li>1.1.9 Disable Automounting</li> </ul>"},{"location":"tags/#disable-unused-filesystems","title":"Disable unused filesystems","text":"<ul> <li>1.1.10 Disable USB Storage</li> <li>1.1.1.1 Ensure mounting of cramfs filesystems is disabled</li> <li>1.1.1.2 Ensure mounting of squashfs filesystems is disabled</li> <li>1.1.1.3 Ensure mounting of udf filesystems is disabled</li> </ul>"},{"location":"tags/#disable-unused-network-protocols-and-devices","title":"Disable unused network protocols and devices","text":"<ul> <li>3.1.1 Ensure system is checked to determine if IPv6 is enabled</li> <li>3.1.2 Ensure wireless interfaces are disabled</li> <li>3.1.3 Ensure DCCP is disabled</li> <li>3.1.4 Ensure SCTP is disabled</li> <li>3.1.5 Ensure RDS is disabled</li> <li>3.1.6 Ensure TIPC is disabled</li> </ul>"},{"location":"tags/#ensure-auditing-is-enabled","title":"Ensure auditing is enabled","text":"<ul> <li>4.1.1.1 Ensure auditd is installed</li> <li>4.1.1.2 Ensure auditd service is enabled and active</li> <li>4.1.1.3 Ensure auditing for processes that start prior to auditd is enabled</li> <li>4.1.1.4 Ensure audit_backlog_limit is sufficient</li> </ul>"},{"location":"tags/#ensure-journald-is-configured-to-send-logs-to-a-remote-log-host","title":"Ensure journald is configured to send logs to a remote log host","text":"<ul> <li>4.2.1.1.1 Ensure systemd-journal-remote is installed</li> <li>4.2.1.1.2 Ensure systemd-journal-remote is configured</li> <li>4.2.1.1.3 Ensure systemd-journal-remote is enabled</li> <li>4.2.1.1.4 Ensure journald is not configured to recieve logs from a remote client</li> </ul>"},{"location":"tags/#ensure-time-synchronization-is-in-use","title":"Ensure time synchronization is in use","text":"<ul> <li>2.1.1.1 Ensure a single time synchronization daemon is in use</li> </ul>"},{"location":"tags/#filesystem-configuration","title":"Filesystem Configuration","text":"<ul> <li>1.1.10 Disable USB Storage</li> <li>1.1.9 Disable Automounting</li> <li>1.1.1.1 Ensure mounting of cramfs filesystems is disabled</li> <li>1.1.1.2 Ensure mounting of squashfs filesystems is disabled</li> <li>1.1.1.3 Ensure mounting of udf filesystems is disabled</li> <li>1.1.2.1 Ensure /tmp is a separate partition</li> <li>1.1.2.2 Ensure nodev option set on /tmp partition</li> <li>1.1.2.3 Ensure noexec option set on /tmp partition</li> <li>1.1.2.4 Ensure nosuid option set on /tmp partition</li> <li>1.1.3.1 Ensure separate partition exists for /var</li> <li>1.1.3.2 Ensure nodev option set on /var partition</li> <li>1.1.3.3 Ensure nosuid option set on /var partition</li> <li>1.1.4.1 Ensure separate partition exists for /var/tmp</li> <li>1.1.4.2 Ensure noexec option set on /var/tmp partition</li> <li>1.1.4.3 Ensure nosuid option set on /var/tmp partition</li> <li>1.1.4.4 Ensure nodev option set on /var/tmp partition</li> <li>1.1.5.1 Ensure separate partition exists for /var/log</li> <li>1.1.5.2 Ensure nodev option set on /var/log partition</li> <li>1.1.5.3 Ensure noexec option set on /var/log partition</li> <li>1.1.5.4 Ensure nosuid option set on /var/log partition</li> <li>1.1.6.1 Ensure separate partition exists for /var/log/audit</li> <li>1.1.6.2 Ensure noexec option set on /var/log/audit partition</li> <li>1.1.6.3 Ensure nodev option set on /var/log/audit partition</li> <li>1.1.6.4 Ensure nosuid option set on /var/log/audit partition</li> <li>1.1.7.1 Ensure separate partition exists for /home</li> <li>1.1.7.2 Ensure nodev option set on /home partition</li> <li>1.1.7.3 Ensure nosuid option set on /home partition</li> <li>1.1.8.1 Ensure nodev option set on /dev/shm partition</li> <li>1.1.8.2 Ensure noexec option set on /dev/shm partition</li> <li>1.1.8.3 Ensure nosuid option set on /dev/shm partition</li> </ul>"},{"location":"tags/#filesystem-integrity-checking","title":"Filesystem Integrity Checking","text":"<ul> <li>1.3.1 Ensure AIDE is installed</li> <li>1.3.2 Ensure filesystem integrity is regularly checked</li> </ul>"},{"location":"tags/#firewall-configuration","title":"Firewall Configuration","text":"<ul> <li>3.5.1.1 Ensure ufw is installed</li> <li>3.5.1.2 Ensure iptables-persistent is not installed with ufw</li> <li>3.5.1.3 Ensure ufw service is enabled</li> <li>3.5.1.4 Ensure ufw loopback traffic is configured</li> <li>3.5.1.5 Ensure ufw outbound connections are configured</li> <li>3.5.1.6 Ensure ufw firewall rules exist for all open ports</li> <li>3.5.1.7 Ensure ufw default deny firewall policy</li> <li>3.5.2.1 Ensure nftables is installed</li> <li>3.5.2.10 Ensure nftables rules are permanent</li> <li>3.5.2.2 Ensure ufw is uninstalled or disabled with nftables</li> <li>3.5.2.3 Ensure iptables are flushed with nftables</li> <li>3.5.2.4 Ensure a nftables table exists</li> <li>3.5.2.5 Ensure nftables base chains exist</li> <li>3.5.2.6 Ensure nftables loopback traffic is configured</li> <li>3.5.2.7 Ensure nftables outbound and established connections are configured</li> <li>3.5.2.8 Ensure nftables default deny firewall policy</li> <li>3.5.2.9 Ensure nftables service is enabled</li> <li>3.5.3.1.1 Ensure iptables packages are installed</li> <li>3.5.3.1.2 Ensure nftables is not installed with iptables</li> <li>3.5.3.1.3 Ensure ufw is uninstalled or disabled with iptables</li> <li>3.5.3.2.1 Ensure iptables default deny firewall policy</li> <li>3.5.3.2.2 Ensure iptables loopback traffic is configured</li> <li>3.5.3.2.4 Ensure iptables firewall rules exist for all open ports</li> <li>3.5.3.3.1 Ensure ip6tables default deny firewall policy</li> <li>3.5.3.3.2 Ensure ip6tables loopback traffic is configured</li> <li>3.5.3.3.3 Ensure ip6tables outbound and established connections are configured</li> <li>3.5.3.3.4 Ensure ip6tables firewall rules exist for all open ports</li> </ul>"},{"location":"tags/#gnome-display-manager","title":"GNOME Display Manager","text":"<ul> <li>1.8.1 Ensure GNOME Display Manager is removed</li> <li>1.8.10 Ensure XDCMP is not enabled</li> <li>1.8.2 Ensure GDM login banner is configured</li> <li>1.8.3 Ensure GDM disable-user-list option is enabled</li> <li>1.8.4 Ensure GDM screen locks when the user is idle</li> <li>1.8.5 Ensure GDM screen locks cannot be overridden</li> <li>1.8.6 Ensure GDM automatic mounting of removable media is disabled</li> <li>1.8.7 Ensure GDM disabling automatic mounting of removable media is not overridden</li> <li>1.8.8 Ensure GDM autorun-never is enabled</li> <li>1.8.9 Ensure GDM autorun-never is not overridden</li> </ul>"},{"location":"tags/#ig1","title":"IG1","text":"<ul> <li>1.9 Ensure updates, patches, and additional security software are installed</li> <li>1.1.9 Disable Automounting</li> <li>1.1.2.1 Ensure /tmp is a separate partition</li> <li>1.1.2.2 Ensure nodev option set on /tmp partition</li> <li>1.1.2.3 Ensure noexec option set on /tmp partition</li> <li>1.1.2.4 Ensure nosuid option set on /tmp partition</li> <li>1.1.3.1 Ensure separate partition exists for /var</li> <li>1.1.3.2 Ensure nodev option set on /var partition</li> <li>1.1.3.3 Ensure nosuid option set on /var partition</li> <li>1.1.4.1 Ensure separate partition exists for /var/tmp</li> <li>1.1.4.2 Ensure noexec option set on /var/tmp partition</li> <li>1.1.4.3 Ensure nosuid option set on /var/tmp partition</li> <li>1.1.4.4 Ensure nodev option set on /var/tmp partition</li> <li>1.1.5.1 Ensure separate partition exists for /var/log</li> <li>1.1.5.2 Ensure nodev option set on /var/log partition</li> <li>1.1.5.3 Ensure noexec option set on /var/log partition</li> <li>1.1.5.4 Ensure nosuid option set on /var/log partition</li> <li>1.1.6.1 Ensure separate partition exists for /var/log/audit</li> <li>1.1.6.2 Ensure noexec option set on /var/log/audit partition</li> <li>1.1.6.3 Ensure nodev option set on /var/log/audit partition</li> <li>1.1.6.4 Ensure nosuid option set on /var/log/audit partition</li> <li>1.1.7.1 Ensure separate partition exists for /home</li> <li>1.1.7.2 Ensure nodev option set on /home partition</li> <li>1.1.7.3 Ensure nosuid option set on /home partition</li> <li>1.1.8.1 Ensure nodev option set on /dev/shm partition</li> <li>1.1.8.2 Ensure noexec option set on /dev/shm partition</li> <li>1.1.8.3 Ensure nosuid option set on /dev/shm partition</li> <li>1.2.1 Ensure package manager repositories are configured</li> <li>1.2.2 Ensure GPG keys are configured</li> <li>1.4.1 Ensure bootloader password is set</li> <li>1.4.2 Ensure permissions on bootloader config are configured</li> <li>1.4.3 Ensure authentication required for single user mode</li> <li>1.6.1.1 Ensure AppArmor is installed</li> <li>1.6.1.2 Ensure AppArmor is enabled in the bootloader configuration</li> <li>1.6.1.3 Ensure all AppArmor Profiles are in enforce or complain mode</li> <li>1.6.1.4 Ensure all AppArmor Profiles are enforcing</li> <li>1.7.4 Ensure permissions on /etc/motd are configured</li> <li>1.7.5 Ensure permissions on /etc/issue are configured</li> <li>1.7.6 Ensure permissions on /etc/issue.net are configured</li> <li>1.8.4 Ensure GDM screen locks when the user is idle</li> <li>1.8.5 Ensure GDM screen locks cannot be overridden</li> <li>1.8.6 Ensure GDM automatic mounting of removable media is disabled</li> <li>1.8.8 Ensure GDM autorun-never is enabled</li> <li>1.8.9 Ensure GDM autorun-never is not overridden</li> <li>3.5.1.1 Ensure ufw is installed</li> <li>3.5.1.2 Ensure iptables-persistent is not installed with ufw</li> <li>3.5.1.3 Ensure ufw service is enabled</li> <li>3.5.1.4 Ensure ufw loopback traffic is configured</li> <li>3.5.1.5 Ensure ufw outbound connections are configured</li> <li>3.5.1.6 Ensure ufw firewall rules exist for all open ports</li> <li>3.5.1.7 Ensure ufw default deny firewall policy</li> <li>3.5.2.1 Ensure nftables is installed</li> <li>3.5.2.10 Ensure nftables rules are permanent</li> <li>3.5.2.2 Ensure ufw is uninstalled or disabled with nftables</li> <li>3.5.2.3 Ensure iptables are flushed with nftables</li> <li>3.5.2.4 Ensure a nftables table exists</li> <li>3.5.2.5 Ensure nftables base chains exist</li> <li>3.5.2.6 Ensure nftables loopback traffic is configured</li> <li>3.5.2.7 Ensure nftables outbound and established connections are configured</li> <li>3.5.2.8 Ensure nftables default deny firewall policy</li> <li>3.5.2.9 Ensure nftables service is enabled</li> <li>3.5.3.1.1 Ensure iptables packages are installed</li> <li>3.5.3.1.2 Ensure nftables is not installed with iptables</li> <li>3.5.3.1.3 Ensure ufw is uninstalled or disabled with iptables</li> <li>3.5.3.2.1 Ensure iptables default deny firewall policy</li> <li>3.5.3.2.2 Ensure iptables loopback traffic is configured</li> <li>3.5.3.2.4 Ensure iptables firewall rules exist for all open ports</li> <li>3.5.3.3.1 Ensure ip6tables default deny firewall policy</li> <li>3.5.3.3.2 Ensure ip6tables loopback traffic is configured</li> <li>3.5.3.3.3 Ensure ip6tables outbound and established connections are configured</li> <li>3.5.3.3.4 Ensure ip6tables firewall rules exist for all open ports</li> <li>4.1.1.2 Ensure auditd service is enabled and active</li> <li>4.1.1.3 Ensure auditing for processes that start prior to auditd is enabled</li> <li>4.1.1.4 Ensure audit_backlog_limit is sufficient</li> <li>4.1.2.1 Ensure audit log storage size is configured</li> <li>4.1.2.2 Ensure audit logs are not automatically deleted</li> <li>4.1.2.3 Ensure system is disabled when audit logs are full</li> <li>4.1.3.15 Ensure successful and unsuccessful attempts to use the chcon command are recorded</li> <li>4.1.3.16 Ensure successful and unsuccessful attempts to use the setfacl command are recorded</li> <li>4.1.3.17 Ensure successful and unsuccessful attempts to use the chacl command are recorde</li> <li>4.1.3.18 Ensure successful and unsuccessful attempts to use the usermod command are recorded</li> <li>4.1.3.20 Ensure the audit configuration is immutable</li> <li>4.1.4.1 Ensure audit log files are mode 0640 or less permissive</li> <li>4.1.4.10 Ensure audit tools belong to group root</li> <li>4.1.4.11 Ensure cryptographic mechanisms are used to protect the integrity of audit tool</li> <li>4.1.4.2 Ensure only authorized users own audit log files</li> <li>4.1.4.3 Ensure only authorized groups are assigned ownership of audit log files</li> <li>4.1.4.4 Ensure the audit log directory is 0750 or more restrictive</li> <li>4.1.4.5 Ensure audit configuration files are 640 or more restrictive</li> <li>4.1.4.6 Ensure audit configuration files are owned by root</li> <li>4.1.4.7 Ensure audit configuration files belong to group root</li> <li>4.1.4.8 Ensure audit tools are 755 or more restrictive</li> <li>4.1.4.9 Ensure audit tools are owned by root</li> <li>4.2.3 Ensure all logfiles have appropriate permissions and ownership</li> <li>4.2.1.2 Ensure journald service is enabled</li> <li>4.2.1.3 Ensure journald is configured to compress large log files</li> <li>4.2.1.4 Ensure journald is configured to write logfiles to persistent disk</li> <li>4.2.1.5 Ensure journald is not configured to send logs to rsyslog</li> <li>4.2.1.6 Ensure journald log rotation is configured per site policy</li> <li>4.2.1.7 Ensure journald default file permissions configured</li> <li>4.2.1.1.1 Ensure systemd-journal-remote is installed</li> <li>4.2.1.1.2 Ensure systemd-journal-remote is configured</li> <li>4.2.1.1.3 Ensure systemd-journal-remote is enabled</li> <li>4.2.1.1.4 Ensure journald is not configured to recieve logs from a remote client</li> <li>4.2.2.1 Ensure rsyslog is installed</li> <li>4.2.2.2 Ensure rsyslog service is enabled</li> <li>4.2.2.3 Ensure journald is configured to send logs to rsyslog</li> <li>4.2.2.4 Ensure rsyslog default file permissions are configured</li> <li>4.2.2.5 Ensure logging is configured</li> <li>4.2.2.6 Ensure rsyslog is configured to send logs to a remote log host</li> <li>4.2.2.7 Ensure rsyslog is not configured to receive logs from a remote client</li> <li>5.1.2 Ensure permissions on /etc/crontab are configured</li> <li>5.1.3 Ensure permissions on /etc/cron.hourly are configured</li> <li>5.1.4 Ensure permissions on /etc/cron.daily are configured</li> <li>5.1.5 Ensure permissions on /etc/cron.weekly are configured</li> <li>5.1.6 Ensure permissions on /etc/cron.monthly are configured</li> <li>5.1.7 Ensure permissions on /etc/cron.d are configured</li> <li>5.1.8 Ensure cron is restricted to authorized users</li> <li>5.1.9 Ensure at is restricted to authorized users</li> <li>5.2.1 Ensure permissions on /etc/ssh/sshd_config are configured</li> <li>5.2.10 Ensure SSH PermitUserEnvironment is disabled</li> <li>5.2.11 Ensure SSH IgnoreRhosts is enabled</li> <li>5.2.16 Ensure SSH AllowTcpForwarding is disabled</li> <li>5.2.17 Ensure SSH warning banner is configured</li> <li>5.2.2 Ensure permissions on SSH private host key files are configured</li> <li>5.2.21 Ensure SSH LoginGraceTime is set to one minute or less</li> <li>5.2.3 Ensure permissions on SSH public host key files are configured</li> <li>5.2.4 Ensure SSH access is limited</li> <li>5.2.5 Ensure SSH LogLevel is appropriate</li> <li>5.2.6 Ensure SSH PAM is enabled</li> <li>5.2.7 Ensure SSH root login is disabled</li> <li>5.2.8 Ensure SSH HostbasedAuthentication is disabled</li> <li>5.2.9 Ensure SSH PermitEmptyPasswords is disabled</li> <li>5.3.1 Ensure sudo is installed</li> <li>5.3.2 Ensure sudo commands use pty</li> <li>5.3.4 Ensure users must provide password for privilege escalation</li> <li>5.3.5 Ensure re-authentication for privilege escalation is not disabled globally</li> <li>5.3.6 Ensure sudo authentication timeout is configured correctly</li> <li>5.3.7 Ensure access to the su command is restricted</li> <li>5.4.1 Ensure password creation requirements are configured</li> <li>5.4.2 Ensure lockout for failed password attempts is configured</li> <li>5.4.3 Ensure password reuse is limited</li> <li>5.5.2 Ensure system accounts are secured</li> <li>5.5.3 Ensure default group for the root account is GID 0</li> <li>5.5.4 Ensure default user umask is 027 or more restrictive</li> <li>5.5.5 Ensure default user shell timeout is 900 seconds or less</li> <li>5.5.1.1 Ensure minimum days between password changes is configured</li> <li>5.5.1.2 Ensure password expiration is 365 days or less</li> <li>5.5.1.3 Ensure password expiration warning days is 7 or more</li> <li>5.5.1.4 Ensure inactive password lock is 30 days or less</li> <li>5.5.1.5 Ensure all users last password change date is in the past</li> <li>6.1.1 Ensure permissions on /etc/passwd are configured</li> <li>6.1.10 Ensure no unowned files or directories exist</li> <li>6.1.11 Ensure no ungrouped files or directories exist</li> <li>6.1.12 Audit SUID executables</li> <li>6.1.13 Audit SGID executables</li> <li>6.1.2 Ensure permissions on /etc/passwd- are configured</li> <li>6.1.3 Ensure permissions on /etc/group are configured</li> <li>6.1.4 Ensure permissions on /etc/group- are configured</li> <li>6.1.5 Ensure permissions on /etc/shadow are configured</li> <li>6.1.6 Ensure permissions on /etc/shadow- are configured</li> <li>6.1.7 Ensure permissions on /etc/gshadow are configured</li> <li>E6.1.8 Ensure permissions on /etc/gshadow- are configured</li> <li>6.1.9 Ensure no world writable files exist</li> <li>6.2.11 Ensure local interactive user home directories exist</li> <li>6.2.12 Ensure local interactive users own their home directories</li> <li>6.2.13 Ensure local interactive user home directories are mode 750 or more restrictive</li> <li>6.2.14 Ensure no local interactive user has .netrc files</li> <li>6.2.15 Ensure no local interactive user has .forward files</li> <li>6.2.16 Ensue no local interactive user has .rhosts files</li> <li>6.2.17 Ensure local interactive user dot files are not group or world writable</li> <li>6.2.2 Ensure /etc/shadow password fields are not empty</li> <li>6.2.4 Ensure shadow group is empty</li> <li>6.2.5 Ensure no duplicate UIDs exist</li> </ul>"},{"location":"tags/#ig2","title":"IG2","text":"<ul> <li>1.9 Ensure updates, patches, and additional security software are installed</li> <li>1.1.10 Disable USB Storage</li> <li>1.1.9 Disable Automounting</li> <li>1.1.1.1 Ensure mounting of cramfs filesystems is disabled</li> <li>1.1.1.2 Ensure mounting of squashfs filesystems is disabled</li> <li>1.1.1.3 Ensure mounting of udf filesystems is disabled</li> <li>1.1.2.1 Ensure /tmp is a separate partition</li> <li>1.1.2.2 Ensure nodev option set on /tmp partition</li> <li>1.1.2.3 Ensure noexec option set on /tmp partition</li> <li>1.1.2.4 Ensure nosuid option set on /tmp partition</li> <li>1.1.3.1 Ensure separate partition exists for /var</li> <li>1.1.3.2 Ensure nodev option set on /var partition</li> <li>1.1.3.3 Ensure nosuid option set on /var partition</li> <li>1.1.4.1 Ensure separate partition exists for /var/tmp</li> <li>1.1.4.2 Ensure noexec option set on /var/tmp partition</li> <li>1.1.4.3 Ensure nosuid option set on /var/tmp partition</li> <li>1.1.4.4 Ensure nodev option set on /var/tmp partition</li> <li>1.1.5.1 Ensure separate partition exists for /var/log</li> <li>1.1.5.2 Ensure nodev option set on /var/log partition</li> <li>1.1.5.3 Ensure noexec option set on /var/log partition</li> <li>1.1.5.4 Ensure nosuid option set on /var/log partition</li> <li>1.1.6.1 Ensure separate partition exists for /var/log/audit</li> <li>1.1.6.2 Ensure noexec option set on /var/log/audit partition</li> <li>1.1.6.3 Ensure nodev option set on /var/log/audit partition</li> <li>1.1.6.4 Ensure nosuid option set on /var/log/audit partition</li> <li>1.1.7.1 Ensure separate partition exists for /home</li> <li>1.1.7.2 Ensure nodev option set on /home partition</li> <li>1.1.7.3 Ensure nosuid option set on /home partition</li> <li>1.1.8.1 Ensure nodev option set on /dev/shm partition</li> <li>1.1.8.2 Ensure noexec option set on /dev/shm partition</li> <li>1.1.8.3 Ensure nosuid option set on /dev/shm partition</li> <li>1.2.1 Ensure package manager repositories are configured</li> <li>1.2.2 Ensure GPG keys are configured</li> <li>1.3.2 Ensure filesystem integrity is regularly checked</li> <li>1.4.1 Ensure bootloader password is set</li> <li>1.4.2 Ensure permissions on bootloader config are configured</li> <li>1.4.3 Ensure authentication required for single user mode</li> <li>1.5.1 Ensure address space layout randomization (ASLR) is enabled</li> <li>1.5.3 Ensure Automatic Error Reporting is not enabled</li> <li>1.5.4 Ensure core dumps are restricted</li> <li>1.6.1.1 Ensure AppArmor is installed</li> <li>1.6.1.2 Ensure AppArmor is enabled in the bootloader configuration</li> <li>1.6.1.3 Ensure all AppArmor Profiles are in enforce or complain mode</li> <li>1.6.1.4 Ensure all AppArmor Profiles are enforcing</li> <li>1.7.4 Ensure permissions on /etc/motd are configured</li> <li>1.7.5 Ensure permissions on /etc/issue are configured</li> <li>1.7.6 Ensure permissions on /etc/issue.net are configured</li> <li>1.8.1 Ensure GNOME Display Manager is removed</li> <li>1.8.10 Ensure XDCMP is not enabled</li> <li>1.8.4 Ensure GDM screen locks when the user is idle</li> <li>1.8.5 Ensure GDM screen locks cannot be overridden</li> <li>1.8.6 Ensure GDM automatic mounting of removable media is disabled</li> <li>1.8.8 Ensure GDM autorun-never is enabled</li> <li>1.8.9 Ensure GDM autorun-never is not overridden</li> <li>2.4 Ensure nonessential services are removed or masked</li> <li>2.1.1.1 Ensure a single time synchronization daemon is in use</li> <li>2.1.2.1 Ensure chrony is configured with authorized timeserver</li> <li>2.1.2.2 Ensure chrony is running as user _chrony</li> <li>2.1.2.3 Ensure chrony is enabled and running</li> <li>2.1.3.1 Ensure systemd-timesyncd configured with authorized timeserver</li> <li>2.1.3.2 Ensure systemd-timesyncd is enabled and running</li> <li>2.1.4.1 Ensure ntp access control is configured</li> <li>2.1.4.2 Ensure ntp is configured with authorized timeserver</li> <li>2.1.4.3 Ensure ntp is running as user ntp</li> <li>Ensure mounting of cramfs filesystems is disabled</li> <li>2.2.1 Ensure X Window System is not installed</li> <li>2.2.10 Ensure IMAP and POP3 server are not installed</li> <li>2.2.11 Ensure Samba is not installed</li> <li>2.2.12 Ensure HTTP Proxy Server is not installed</li> <li>2.2.13 Ensure SNMP Server is not installed</li> <li>2.2.14 Ensure NIS Server is not installed</li> <li>2.2.15 Ensure mail transfer agent is configured for local-only mode</li> <li>2.2.16 Ensure rsync service is either not installed or masked</li> <li>2.2.2 Ensure Avahi Server is not installed</li> <li>2.2.3 Ensure CUPS is not installed</li> <li>2.2.4 Ensure DHCP Server is not installed</li> <li>2.2.5 Ensure LDAP server is not installed</li> <li>2.2.6 Ensure NFS is not installed</li> <li>2.2.7 Ensure DNS Server is not installed</li> <li>2.2.8 Ensure FTP Server is not installed</li> <li>2.2.9 Ensure HTTP server is not installed</li> <li>2.3.1 Ensure NIS Client is not installed</li> <li>2.3.2 Ensure rsh client is not installed</li> <li>2.3.3 Ensure talk client is not installed</li> <li>2.3.4 Ensure telnet client is not installed</li> <li>2.3.5 Ensure LDAP client is not installed</li> <li>2.3.6 Ensure RPC is not installed</li> <li>3.1.1 Ensure system is checked to determine if IPv6 is enabled</li> <li>3.1.2 Ensure wireless interfaces are disabled</li> <li>3.1.3 Ensure DCCP is disabled</li> <li>3.1.4 Ensure SCTP is disabled</li> <li>3.1.5 Ensure RDS is disabled</li> <li>3.1.6 Ensure TIPC is disabled</li> <li>3.2.1 Ensure packet redirect sending is disabled</li> <li>3.2.2 Ensure IP forwarding is disabled</li> <li>3.3.1 Ensure source routed packets are not accepted</li> <li>3.3.2 Ensure ICMP redirects are not accepted</li> <li>3.3.3 Ensure secure ICMP redirects are not accepted</li> <li>3.3.4 Ensure suspicious packets are logged</li> <li>3.3.5 Ensure broadcast ICMP requests are ignored</li> <li>3.3.6 Ensure bogus ICMP responses are ignored</li> <li>3.3.7 Ensure Reverse Path Filtering is enabled</li> <li>3.3.8 Ensure TCP SYN Cookies is enabled</li> <li>3.3.9 Ensure IPv6 router advertisements are not accepted</li> <li>3.5.1.1 Ensure ufw is installed</li> <li>3.5.1.2 Ensure iptables-persistent is not installed with ufw</li> <li>3.5.1.3 Ensure ufw service is enabled</li> <li>3.5.1.4 Ensure ufw loopback traffic is configured</li> <li>3.5.1.5 Ensure ufw outbound connections are configured</li> <li>3.5.1.6 Ensure ufw firewall rules exist for all open ports</li> <li>3.5.1.7 Ensure ufw default deny firewall policy</li> <li>3.5.2.1 Ensure nftables is installed</li> <li>3.5.2.10 Ensure nftables rules are permanent</li> <li>3.5.2.2 Ensure ufw is uninstalled or disabled with nftables</li> <li>3.5.2.3 Ensure iptables are flushed with nftables</li> <li>3.5.2.4 Ensure a nftables table exists</li> <li>3.5.2.5 Ensure nftables base chains exist</li> <li>3.5.2.6 Ensure nftables loopback traffic is configured</li> <li>3.5.2.7 Ensure nftables outbound and established connections are configured</li> <li>3.5.2.8 Ensure nftables default deny firewall policy</li> <li>3.5.2.9 Ensure nftables service is enabled</li> <li>3.5.3.1.1 Ensure iptables packages are installed</li> <li>3.5.3.1.2 Ensure nftables is not installed with iptables</li> <li>3.5.3.1.3 Ensure ufw is uninstalled or disabled with iptables</li> <li>3.5.3.2.1 Ensure iptables default deny firewall policy</li> <li>3.5.3.2.2 Ensure iptables loopback traffic is configured</li> <li>3.5.3.2.4 Ensure iptables firewall rules exist for all open ports</li> <li>3.5.3.3.1 Ensure ip6tables default deny firewall policy</li> <li>3.5.3.3.2 Ensure ip6tables loopback traffic is configured</li> <li>3.5.3.3.3 Ensure ip6tables outbound and established connections are configured</li> <li>3.5.3.3.4 Ensure ip6tables firewall rules exist for all open ports</li> <li>4.1.1.1 Ensure auditd is installed</li> <li>4.1.1.2 Ensure auditd service is enabled and active</li> <li>4.1.1.3 Ensure auditing for processes that start prior to auditd is enabled</li> <li>4.1.1.4 Ensure audit_backlog_limit is sufficient</li> <li>4.1.2.1 Ensure audit log storage size is configured</li> <li>4.1.2.2 Ensure audit logs are not automatically deleted</li> <li>4.1.2.3 Ensure system is disabled when audit logs are full</li> <li>4.1.3.1 Ensure changes to system administration scope (sudoers) is collected</li> <li>4.1.3.10 Ensure successful file system mounts are collected</li> <li>4.1.3.11 Ensure session initiation information is collected</li> <li>4.1.3.12 Ensure login and logout events are collected</li> <li>4.1.3.13 Ensure file deletion events by users are collected</li> <li>4.1.3.14 Ensure events that modify the system's Mandatory Access Controls are collected</li> <li>4.1.3.15 Ensure successful and unsuccessful attempts to use the chcon command are recorded</li> <li>4.1.3.16 Ensure successful and unsuccessful attempts to use the setfacl command are recorded</li> <li>4.1.3.17 Ensure successful and unsuccessful attempts to use the chacl command are recorde</li> <li>4.1.3.18 Ensure successful and unsuccessful attempts to use the usermod command are recorded</li> <li>4.1.3.19 Ensure kernel module loading unloading and modification is collected</li> <li>4.1.3.2 Ensure actions as another user are always logged</li> <li>4.1.3.20 Ensure the audit configuration is immutable</li> <li>4.1.3.21 Ensure the running and on disk configuration is the same</li> <li>4.1.3.3 Ensure events that modify the sudo log file are collected</li> <li>4.1.3.4 Ensure events that modify date and time information are collected</li> <li>4.1.3.5 Ensure events that modify the system's network environment are collected</li> <li>4.1.3.6 Ensure use of privileged commands are collected</li> <li>4.1.3.7 Ensure unsuccessful file access attempts are collected</li> <li>4.1.3.8 Ensure events that modify user/group information are collected</li> <li>4.1.3.9 Ensure discretionary access control permission modification events are collected</li> <li>4.1.4.1 Ensure audit log files are mode 0640 or less permissive</li> <li>4.1.4.10 Ensure audit tools belong to group root</li> <li>4.1.4.11 Ensure cryptographic mechanisms are used to protect the integrity of audit tool</li> <li>4.1.4.2 Ensure only authorized users own audit log files</li> <li>4.1.4.3 Ensure only authorized groups are assigned ownership of audit log files</li> <li>4.1.4.4 Ensure the audit log directory is 0750 or more restrictive</li> <li>4.1.4.5 Ensure audit configuration files are 640 or more restrictive</li> <li>4.1.4.6 Ensure audit configuration files are owned by root</li> <li>4.1.4.7 Ensure audit configuration files belong to group root</li> <li>4.1.4.8 Ensure audit tools are 755 or more restrictive</li> <li>4.1.4.9 Ensure audit tools are owned by root</li> <li>4.2.3 Ensure all logfiles have appropriate permissions and ownership</li> <li>4.2.1.2 Ensure journald service is enabled</li> <li>4.2.1.3 Ensure journald is configured to compress large log files</li> <li>4.2.1.4 Ensure journald is configured to write logfiles to persistent disk</li> <li>4.2.1.5 Ensure journald is not configured to send logs to rsyslog</li> <li>4.2.1.6 Ensure journald log rotation is configured per site policy</li> <li>4.2.1.7 Ensure journald default file permissions configured</li> <li>4.2.1.1.1 Ensure systemd-journal-remote is installed</li> <li>4.2.1.1.2 Ensure systemd-journal-remote is configured</li> <li>4.2.1.1.3 Ensure systemd-journal-remote is enabled</li> <li>4.2.1.1.4 Ensure journald is not configured to recieve logs from a remote client</li> <li>4.2.2.1 Ensure rsyslog is installed</li> <li>4.2.2.2 Ensure rsyslog service is enabled</li> <li>4.2.2.3 Ensure journald is configured to send logs to rsyslog</li> <li>4.2.2.4 Ensure rsyslog default file permissions are configured</li> <li>4.2.2.5 Ensure logging is configured</li> <li>4.2.2.6 Ensure rsyslog is configured to send logs to a remote log host</li> <li>4.2.2.7 Ensure rsyslog is not configured to receive logs from a remote client</li> <li>5.1.2 Ensure permissions on /etc/crontab are configured</li> <li>5.1.3 Ensure permissions on /etc/cron.hourly are configured</li> <li>5.1.4 Ensure permissions on /etc/cron.daily are configured</li> <li>5.1.5 Ensure permissions on /etc/cron.weekly are configured</li> <li>5.1.6 Ensure permissions on /etc/cron.monthly are configured</li> <li>5.1.7 Ensure permissions on /etc/cron.d are configured</li> <li>5.1.8 Ensure cron is restricted to authorized users</li> <li>5.1.9 Ensure at is restricted to authorized users</li> <li>5.2.1 Ensure permissions on /etc/ssh/sshd_config are configured</li> <li>5.2.10 Ensure SSH PermitUserEnvironment is disabled</li> <li>5.2.11 Ensure SSH IgnoreRhosts is enabled</li> <li>5.2.12 Ensure SSH X11 forwarding is disabled</li> <li>5.2.13 Ensure only strong Ciphers are used</li> <li>5.2.14 Ensure only strong MAC algorithms are used</li> <li>5.2.15 Ensure only strong Key Exchange algorithms are used</li> <li>5.2.16 Ensure SSH AllowTcpForwarding is disabled</li> <li>5.2.17 Ensure SSH warning banner is configured</li> <li>5.2.18 Ensure SSH MaxAuthTries is set to 4 or less</li> <li>5.2.19 Ensure SSH MaxStartups is configured</li> <li>5.2.2 Ensure permissions on SSH private host key files are configured</li> <li>5.2.21 Ensure SSH LoginGraceTime is set to one minute or less</li> <li>5.2.3 Ensure permissions on SSH public host key files are configured</li> <li>5.2.4 Ensure SSH access is limited</li> <li>5.2.5 Ensure SSH LogLevel is appropriate</li> <li>5.2.6 Ensure SSH PAM is enabled</li> <li>5.2.7 Ensure SSH root login is disabled</li> <li>5.2.8 Ensure SSH HostbasedAuthentication is disabled</li> <li>5.2.9 Ensure SSH PermitEmptyPasswords is disabled</li> <li>5.3.1 Ensure sudo is installed</li> <li>5.3.2 Ensure sudo commands use pty</li> <li>5.3.3 Ensure sudo log file exists</li> <li>5.3.4 Ensure users must provide password for privilege escalation</li> <li>5.3.5 Ensure re-authentication for privilege escalation is not disabled globally</li> <li>5.3.6 Ensure sudo authentication timeout is configured correctly</li> <li>5.3.7 Ensure access to the su command is restricted</li> <li>5.4.1 Ensure password creation requirements are configured</li> <li>5.4.2 Ensure lockout for failed password attempts is configured</li> <li>5.4.3 Ensure password reuse is limited</li> <li>5.4.4 Ensure password hashing algorithm is up to date with the latest standards</li> <li>5.5.2 Ensure system accounts are secured</li> <li>5.5.3 Ensure default group for the root account is GID 0</li> <li>5.5.4 Ensure default user umask is 027 or more restrictive</li> <li>5.5.5 Ensure default user shell timeout is 900 seconds or less</li> <li>5.5.1.1 Ensure minimum days between password changes is configured</li> <li>5.5.1.2 Ensure password expiration is 365 days or less</li> <li>5.5.1.3 Ensure password expiration warning days is 7 or more</li> <li>5.5.1.4 Ensure inactive password lock is 30 days or less</li> <li>5.5.1.5 Ensure all users last password change date is in the past</li> <li>6.1.1 Ensure permissions on /etc/passwd are configured</li> <li>6.1.10 Ensure no unowned files or directories exist</li> <li>6.1.11 Ensure no ungrouped files or directories exist</li> <li>6.1.12 Audit SUID executables</li> <li>6.1.13 Audit SGID executables</li> <li>6.1.2 Ensure permissions on /etc/passwd- are configured</li> <li>6.1.3 Ensure permissions on /etc/group are configured</li> <li>6.1.4 Ensure permissions on /etc/group- are configured</li> <li>6.1.5 Ensure permissions on /etc/shadow are configured</li> <li>6.1.6 Ensure permissions on /etc/shadow- are configured</li> <li>6.1.7 Ensure permissions on /etc/gshadow are configured</li> <li>E6.1.8 Ensure permissions on /etc/gshadow- are configured</li> <li>6.1.9 Ensure no world writable files exist</li> <li>6.2.1 Ensure accounts in /etc/passwd use shadowed passwords</li> <li>6.2.11 Ensure local interactive user home directories exist</li> <li>6.2.12 Ensure local interactive users own their home directories</li> <li>6.2.13 Ensure local interactive user home directories are mode 750 or more restrictive</li> <li>6.2.14 Ensure no local interactive user has .netrc files</li> <li>6.2.15 Ensure no local interactive user has .forward files</li> <li>6.2.16 Ensue no local interactive user has .rhosts files</li> <li>6.2.17 Ensure local interactive user dot files are not group or world writable</li> <li>6.2.2 Ensure /etc/shadow password fields are not empty</li> <li>6.2.4 Ensure shadow group is empty</li> <li>6.2.5 Ensure no duplicate UIDs exist</li> </ul>"},{"location":"tags/#ig3","title":"IG3","text":"<ul> <li>1.9 Ensure updates, patches, and additional security software are installed</li> <li>1.1.10 Disable USB Storage</li> <li>1.1.9 Disable Automounting</li> <li>1.1.1.1 Ensure mounting of cramfs filesystems is disabled</li> <li>1.1.1.2 Ensure mounting of squashfs filesystems is disabled</li> <li>1.1.1.3 Ensure mounting of udf filesystems is disabled</li> <li>1.1.2.1 Ensure /tmp is a separate partition</li> <li>1.1.2.2 Ensure nodev option set on /tmp partition</li> <li>1.1.2.3 Ensure noexec option set on /tmp partition</li> <li>1.1.2.4 Ensure nosuid option set on /tmp partition</li> <li>1.1.3.1 Ensure separate partition exists for /var</li> <li>1.1.3.2 Ensure nodev option set on /var partition</li> <li>1.1.3.3 Ensure nosuid option set on /var partition</li> <li>1.1.4.1 Ensure separate partition exists for /var/tmp</li> <li>1.1.4.2 Ensure noexec option set on /var/tmp partition</li> <li>1.1.4.3 Ensure nosuid option set on /var/tmp partition</li> <li>1.1.4.4 Ensure nodev option set on /var/tmp partition</li> <li>1.1.5.1 Ensure separate partition exists for /var/log</li> <li>1.1.5.2 Ensure nodev option set on /var/log partition</li> <li>1.1.5.3 Ensure noexec option set on /var/log partition</li> <li>1.1.5.4 Ensure nosuid option set on /var/log partition</li> <li>1.1.6.1 Ensure separate partition exists for /var/log/audit</li> <li>1.1.6.2 Ensure noexec option set on /var/log/audit partition</li> <li>1.1.6.3 Ensure nodev option set on /var/log/audit partition</li> <li>1.1.6.4 Ensure nosuid option set on /var/log/audit partition</li> <li>1.1.7.1 Ensure separate partition exists for /home</li> <li>1.1.7.2 Ensure nodev option set on /home partition</li> <li>1.1.7.3 Ensure nosuid option set on /home partition</li> <li>1.1.8.1 Ensure nodev option set on /dev/shm partition</li> <li>1.1.8.2 Ensure noexec option set on /dev/shm partition</li> <li>1.1.8.3 Ensure nosuid option set on /dev/shm partition</li> <li>1.2.1 Ensure package manager repositories are configured</li> <li>1.2.2 Ensure GPG keys are configured</li> <li>1.3.1 Ensure AIDE is installed</li> <li>1.3.2 Ensure filesystem integrity is regularly checked</li> <li>1.4.1 Ensure bootloader password is set</li> <li>1.4.2 Ensure permissions on bootloader config are configured</li> <li>1.4.3 Ensure authentication required for single user mode</li> <li>1.5.1 Ensure address space layout randomization (ASLR) is enabled</li> <li>1.5.2 Ensure prelink is not installed</li> <li>1.5.3 Ensure Automatic Error Reporting is not enabled</li> <li>1.5.4 Ensure core dumps are restricted</li> <li>1.6.1.1 Ensure AppArmor is installed</li> <li>1.6.1.2 Ensure AppArmor is enabled in the bootloader configuration</li> <li>1.6.1.3 Ensure all AppArmor Profiles are in enforce or complain mode</li> <li>1.6.1.4 Ensure all AppArmor Profiles are enforcing</li> <li>1.7.4 Ensure permissions on /etc/motd are configured</li> <li>1.7.5 Ensure permissions on /etc/issue are configured</li> <li>1.7.6 Ensure permissions on /etc/issue.net are configured</li> <li>1.8.1 Ensure GNOME Display Manager is removed</li> <li>1.8.10 Ensure XDCMP is not enabled</li> <li>1.8.4 Ensure GDM screen locks when the user is idle</li> <li>1.8.5 Ensure GDM screen locks cannot be overridden</li> <li>1.8.6 Ensure GDM automatic mounting of removable media is disabled</li> <li>1.8.8 Ensure GDM autorun-never is enabled</li> <li>1.8.9 Ensure GDM autorun-never is not overridden</li> <li>2.4 Ensure nonessential services are removed or masked</li> <li>2.1.1.1 Ensure a single time synchronization daemon is in use</li> <li>2.1.2.1 Ensure chrony is configured with authorized timeserver</li> <li>2.1.2.2 Ensure chrony is running as user _chrony</li> <li>2.1.2.3 Ensure chrony is enabled and running</li> <li>2.1.3.1 Ensure systemd-timesyncd configured with authorized timeserver</li> <li>2.1.3.2 Ensure systemd-timesyncd is enabled and running</li> <li>2.1.4.1 Ensure ntp access control is configured</li> <li>2.1.4.2 Ensure ntp is configured with authorized timeserver</li> <li>2.1.4.3 Ensure ntp is running as user ntp</li> <li>Ensure mounting of cramfs filesystems is disabled</li> <li>2.2.1 Ensure X Window System is not installed</li> <li>2.2.10 Ensure IMAP and POP3 server are not installed</li> <li>2.2.11 Ensure Samba is not installed</li> <li>2.2.12 Ensure HTTP Proxy Server is not installed</li> <li>2.2.13 Ensure SNMP Server is not installed</li> <li>2.2.14 Ensure NIS Server is not installed</li> <li>2.2.15 Ensure mail transfer agent is configured for local-only mode</li> <li>2.2.16 Ensure rsync service is either not installed or masked</li> <li>2.2.2 Ensure Avahi Server is not installed</li> <li>2.2.3 Ensure CUPS is not installed</li> <li>2.2.4 Ensure DHCP Server is not installed</li> <li>2.2.5 Ensure LDAP server is not installed</li> <li>2.2.6 Ensure NFS is not installed</li> <li>2.2.7 Ensure DNS Server is not installed</li> <li>2.2.8 Ensure FTP Server is not installed</li> <li>2.2.9 Ensure HTTP server is not installed</li> <li>2.3.1 Ensure NIS Client is not installed</li> <li>2.3.2 Ensure rsh client is not installed</li> <li>2.3.3 Ensure talk client is not installed</li> <li>2.3.4 Ensure telnet client is not installed</li> <li>2.3.5 Ensure LDAP client is not installed</li> <li>2.3.6 Ensure RPC is not installed</li> <li>3.1.1 Ensure system is checked to determine if IPv6 is enabled</li> <li>3.1.2 Ensure wireless interfaces are disabled</li> <li>3.1.3 Ensure DCCP is disabled</li> <li>3.1.4 Ensure SCTP is disabled</li> <li>3.1.5 Ensure RDS is disabled</li> <li>3.1.6 Ensure TIPC is disabled</li> <li>3.2.1 Ensure packet redirect sending is disabled</li> <li>3.2.2 Ensure IP forwarding is disabled</li> <li>3.3.1 Ensure source routed packets are not accepted</li> <li>3.3.2 Ensure ICMP redirects are not accepted</li> <li>3.3.3 Ensure secure ICMP redirects are not accepted</li> <li>3.3.4 Ensure suspicious packets are logged</li> <li>3.3.5 Ensure broadcast ICMP requests are ignored</li> <li>3.3.6 Ensure bogus ICMP responses are ignored</li> <li>3.3.7 Ensure Reverse Path Filtering is enabled</li> <li>3.3.8 Ensure TCP SYN Cookies is enabled</li> <li>3.3.9 Ensure IPv6 router advertisements are not accepted</li> <li>3.5.1.1 Ensure ufw is installed</li> <li>3.5.1.2 Ensure iptables-persistent is not installed with ufw</li> <li>3.5.1.3 Ensure ufw service is enabled</li> <li>3.5.1.4 Ensure ufw loopback traffic is configured</li> <li>3.5.1.5 Ensure ufw outbound connections are configured</li> <li>3.5.1.6 Ensure ufw firewall rules exist for all open ports</li> <li>3.5.1.7 Ensure ufw default deny firewall policy</li> <li>3.5.2.1 Ensure nftables is installed</li> <li>3.5.2.10 Ensure nftables rules are permanent</li> <li>3.5.2.2 Ensure ufw is uninstalled or disabled with nftables</li> <li>3.5.2.3 Ensure iptables are flushed with nftables</li> <li>3.5.2.4 Ensure a nftables table exists</li> <li>3.5.2.5 Ensure nftables base chains exist</li> <li>3.5.2.6 Ensure nftables loopback traffic is configured</li> <li>3.5.2.7 Ensure nftables outbound and established connections are configured</li> <li>3.5.2.8 Ensure nftables default deny firewall policy</li> <li>3.5.2.9 Ensure nftables service is enabled</li> <li>3.5.3.1.1 Ensure iptables packages are installed</li> <li>3.5.3.1.2 Ensure nftables is not installed with iptables</li> <li>3.5.3.1.3 Ensure ufw is uninstalled or disabled with iptables</li> <li>3.5.3.2.1 Ensure iptables default deny firewall policy</li> <li>3.5.3.2.2 Ensure iptables loopback traffic is configured</li> <li>3.5.3.2.4 Ensure iptables firewall rules exist for all open ports</li> <li>3.5.3.3.1 Ensure ip6tables default deny firewall policy</li> <li>3.5.3.3.2 Ensure ip6tables loopback traffic is configured</li> <li>3.5.3.3.3 Ensure ip6tables outbound and established connections are configured</li> <li>3.5.3.3.4 Ensure ip6tables firewall rules exist for all open ports</li> <li>4.1.1.1 Ensure auditd is installed</li> <li>4.1.1.2 Ensure auditd service is enabled and active</li> <li>4.1.1.3 Ensure auditing for processes that start prior to auditd is enabled</li> <li>4.1.1.4 Ensure audit_backlog_limit is sufficient</li> <li>4.1.2.1 Ensure audit log storage size is configured</li> <li>4.1.2.2 Ensure audit logs are not automatically deleted</li> <li>4.1.2.3 Ensure system is disabled when audit logs are full</li> <li>4.1.3.1 Ensure changes to system administration scope (sudoers) is collected</li> <li>4.1.3.10 Ensure successful file system mounts are collected</li> <li>4.1.3.11 Ensure session initiation information is collected</li> <li>4.1.3.12 Ensure login and logout events are collected</li> <li>4.1.3.13 Ensure file deletion events by users are collected</li> <li>4.1.3.14 Ensure events that modify the system's Mandatory Access Controls are collected</li> <li>4.1.3.15 Ensure successful and unsuccessful attempts to use the chcon command are recorded</li> <li>4.1.3.16 Ensure successful and unsuccessful attempts to use the setfacl command are recorded</li> <li>4.1.3.17 Ensure successful and unsuccessful attempts to use the chacl command are recorde</li> <li>4.1.3.18 Ensure successful and unsuccessful attempts to use the usermod command are recorded</li> <li>4.1.3.19 Ensure kernel module loading unloading and modification is collected</li> <li>4.1.3.2 Ensure actions as another user are always logged</li> <li>4.1.3.20 Ensure the audit configuration is immutable</li> <li>4.1.3.21 Ensure the running and on disk configuration is the same</li> <li>4.1.3.3 Ensure events that modify the sudo log file are collected</li> <li>4.1.3.4 Ensure events that modify date and time information are collected</li> <li>4.1.3.5 Ensure events that modify the system's network environment are collected</li> <li>4.1.3.6 Ensure use of privileged commands are collected</li> <li>4.1.3.7 Ensure unsuccessful file access attempts are collected</li> <li>4.1.3.8 Ensure events that modify user/group information are collected</li> <li>4.1.3.9 Ensure discretionary access control permission modification events are collected</li> <li>4.1.4.1 Ensure audit log files are mode 0640 or less permissive</li> <li>4.1.4.10 Ensure audit tools belong to group root</li> <li>4.1.4.11 Ensure cryptographic mechanisms are used to protect the integrity of audit tool</li> <li>4.1.4.2 Ensure only authorized users own audit log files</li> <li>4.1.4.3 Ensure only authorized groups are assigned ownership of audit log files</li> <li>4.1.4.4 Ensure the audit log directory is 0750 or more restrictive</li> <li>4.1.4.5 Ensure audit configuration files are 640 or more restrictive</li> <li>4.1.4.6 Ensure audit configuration files are owned by root</li> <li>4.1.4.7 Ensure audit configuration files belong to group root</li> <li>4.1.4.8 Ensure audit tools are 755 or more restrictive</li> <li>4.1.4.9 Ensure audit tools are owned by root</li> <li>4.2.3 Ensure all logfiles have appropriate permissions and ownership</li> <li>4.2.1.2 Ensure journald service is enabled</li> <li>4.2.1.3 Ensure journald is configured to compress large log files</li> <li>4.2.1.4 Ensure journald is configured to write logfiles to persistent disk</li> <li>4.2.1.5 Ensure journald is not configured to send logs to rsyslog</li> <li>4.2.1.6 Ensure journald log rotation is configured per site policy</li> <li>4.2.1.7 Ensure journald default file permissions configured</li> <li>4.2.1.1.1 Ensure systemd-journal-remote is installed</li> <li>4.2.1.1.2 Ensure systemd-journal-remote is configured</li> <li>4.2.1.1.3 Ensure systemd-journal-remote is enabled</li> <li>4.2.1.1.4 Ensure journald is not configured to recieve logs from a remote client</li> <li>4.2.2.1 Ensure rsyslog is installed</li> <li>4.2.2.2 Ensure rsyslog service is enabled</li> <li>4.2.2.3 Ensure journald is configured to send logs to rsyslog</li> <li>4.2.2.4 Ensure rsyslog default file permissions are configured</li> <li>4.2.2.5 Ensure logging is configured</li> <li>4.2.2.6 Ensure rsyslog is configured to send logs to a remote log host</li> <li>4.2.2.7 Ensure rsyslog is not configured to receive logs from a remote client</li> <li>5.1.2 Ensure permissions on /etc/crontab are configured</li> <li>5.1.3 Ensure permissions on /etc/cron.hourly are configured</li> <li>5.1.4 Ensure permissions on /etc/cron.daily are configured</li> <li>5.1.5 Ensure permissions on /etc/cron.weekly are configured</li> <li>5.1.6 Ensure permissions on /etc/cron.monthly are configured</li> <li>5.1.7 Ensure permissions on /etc/cron.d are configured</li> <li>5.1.8 Ensure cron is restricted to authorized users</li> <li>5.1.9 Ensure at is restricted to authorized users</li> <li>5.2.1 Ensure permissions on /etc/ssh/sshd_config are configured</li> <li>5.2.10 Ensure SSH PermitUserEnvironment is disabled</li> <li>5.2.11 Ensure SSH IgnoreRhosts is enabled</li> <li>5.2.12 Ensure SSH X11 forwarding is disabled</li> <li>5.2.13 Ensure only strong Ciphers are used</li> <li>5.2.14 Ensure only strong MAC algorithms are used</li> <li>5.2.15 Ensure only strong Key Exchange algorithms are used</li> <li>5.2.16 Ensure SSH AllowTcpForwarding is disabled</li> <li>5.2.17 Ensure SSH warning banner is configured</li> <li>5.2.18 Ensure SSH MaxAuthTries is set to 4 or less</li> <li>5.2.19 Ensure SSH MaxStartups is configured</li> <li>5.2.2 Ensure permissions on SSH private host key files are configured</li> <li>5.2.21 Ensure SSH LoginGraceTime is set to one minute or less</li> <li>5.2.3 Ensure permissions on SSH public host key files are configured</li> <li>5.2.4 Ensure SSH access is limited</li> <li>5.2.5 Ensure SSH LogLevel is appropriate</li> <li>5.2.6 Ensure SSH PAM is enabled</li> <li>5.2.7 Ensure SSH root login is disabled</li> <li>5.2.8 Ensure SSH HostbasedAuthentication is disabled</li> <li>5.2.9 Ensure SSH PermitEmptyPasswords is disabled</li> <li>5.3.1 Ensure sudo is installed</li> <li>5.3.2 Ensure sudo commands use pty</li> <li>5.3.3 Ensure sudo log file exists</li> <li>5.3.4 Ensure users must provide password for privilege escalation</li> <li>5.3.5 Ensure re-authentication for privilege escalation is not disabled globally</li> <li>5.3.6 Ensure sudo authentication timeout is configured correctly</li> <li>5.3.7 Ensure access to the su command is restricted</li> <li>5.4.1 Ensure password creation requirements are configured</li> <li>5.4.2 Ensure lockout for failed password attempts is configured</li> <li>5.4.3 Ensure password reuse is limited</li> <li>5.4.4 Ensure password hashing algorithm is up to date with the latest standards</li> <li>5.5.2 Ensure system accounts are secured</li> <li>5.5.3 Ensure default group for the root account is GID 0</li> <li>5.5.4 Ensure default user umask is 027 or more restrictive</li> <li>5.5.5 Ensure default user shell timeout is 900 seconds or less</li> <li>5.5.1.1 Ensure minimum days between password changes is configured</li> <li>5.5.1.2 Ensure password expiration is 365 days or less</li> <li>5.5.1.3 Ensure password expiration warning days is 7 or more</li> <li>5.5.1.4 Ensure inactive password lock is 30 days or less</li> <li>5.5.1.5 Ensure all users last password change date is in the past</li> <li>6.1.1 Ensure permissions on /etc/passwd are configured</li> <li>6.1.10 Ensure no unowned files or directories exist</li> <li>6.1.11 Ensure no ungrouped files or directories exist</li> <li>6.1.12 Audit SUID executables</li> <li>6.1.13 Audit SGID executables</li> <li>6.1.2 Ensure permissions on /etc/passwd- are configured</li> <li>6.1.3 Ensure permissions on /etc/group are configured</li> <li>6.1.4 Ensure permissions on /etc/group- are configured</li> <li>6.1.5 Ensure permissions on /etc/shadow are configured</li> <li>6.1.6 Ensure permissions on /etc/shadow- are configured</li> <li>6.1.7 Ensure permissions on /etc/gshadow are configured</li> <li>E6.1.8 Ensure permissions on /etc/gshadow- are configured</li> <li>6.1.9 Ensure no world writable files exist</li> <li>6.2.1 Ensure accounts in /etc/passwd use shadowed passwords</li> <li>6.2.11 Ensure local interactive user home directories exist</li> <li>6.2.12 Ensure local interactive users own their home directories</li> <li>6.2.13 Ensure local interactive user home directories are mode 750 or more restrictive</li> <li>6.2.14 Ensure no local interactive user has .netrc files</li> <li>6.2.15 Ensure no local interactive user has .forward files</li> <li>6.2.16 Ensue no local interactive user has .rhosts files</li> <li>6.2.17 Ensure local interactive user dot files are not group or world writable</li> <li>6.2.2 Ensure /etc/shadow password fields are not empty</li> <li>6.2.4 Ensure shadow group is empty</li> <li>6.2.5 Ensure no duplicate UIDs exist</li> </ul>"},{"location":"tags/#initial-setup","title":"Initial Setup","text":"<ul> <li>1.9 Ensure updates, patches, and additional security software are installed</li> <li>1.1.10 Disable USB Storage</li> <li>1.1.9 Disable Automounting</li> <li>1.1.1.1 Ensure mounting of cramfs filesystems is disabled</li> <li>1.1.1.2 Ensure mounting of squashfs filesystems is disabled</li> <li>1.1.1.3 Ensure mounting of udf filesystems is disabled</li> <li>1.1.2.1 Ensure /tmp is a separate partition</li> <li>1.1.2.2 Ensure nodev option set on /tmp partition</li> <li>1.1.2.3 Ensure noexec option set on /tmp partition</li> <li>1.1.2.4 Ensure nosuid option set on /tmp partition</li> <li>1.1.3.1 Ensure separate partition exists for /var</li> <li>1.1.3.2 Ensure nodev option set on /var partition</li> <li>1.1.3.3 Ensure nosuid option set on /var partition</li> <li>1.1.4.1 Ensure separate partition exists for /var/tmp</li> <li>1.1.4.2 Ensure noexec option set on /var/tmp partition</li> <li>1.1.4.3 Ensure nosuid option set on /var/tmp partition</li> <li>1.1.4.4 Ensure nodev option set on /var/tmp partition</li> <li>1.1.5.1 Ensure separate partition exists for /var/log</li> <li>1.1.5.2 Ensure nodev option set on /var/log partition</li> <li>1.1.5.3 Ensure noexec option set on /var/log partition</li> <li>1.1.5.4 Ensure nosuid option set on /var/log partition</li> <li>1.1.6.1 Ensure separate partition exists for /var/log/audit</li> <li>1.1.6.2 Ensure noexec option set on /var/log/audit partition</li> <li>1.1.6.3 Ensure nodev option set on /var/log/audit partition</li> <li>1.1.6.4 Ensure nosuid option set on /var/log/audit partition</li> <li>1.1.7.1 Ensure separate partition exists for /home</li> <li>1.1.7.2 Ensure nodev option set on /home partition</li> <li>1.1.7.3 Ensure nosuid option set on /home partition</li> <li>1.1.8.1 Ensure nodev option set on /dev/shm partition</li> <li>1.1.8.2 Ensure noexec option set on /dev/shm partition</li> <li>1.1.8.3 Ensure nosuid option set on /dev/shm partition</li> <li>1.2.1 Ensure package manager repositories are configured</li> <li>1.2.2 Ensure GPG keys are configured</li> <li>1.3.1 Ensure AIDE is installed</li> <li>1.3.2 Ensure filesystem integrity is regularly checked</li> <li>1.4.1 Ensure bootloader password is set</li> <li>1.4.2 Ensure permissions on bootloader config are configured</li> <li>1.4.3 Ensure authentication required for single user mode</li> <li>1.5.1 Ensure address space layout randomization (ASLR) is enabled</li> <li>1.5.2 Ensure prelink is not installed</li> <li>1.5.3 Ensure Automatic Error Reporting is not enabled</li> <li>1.5.4 Ensure core dumps are restricted</li> <li>1.6.1.1 Ensure AppArmor is installed</li> <li>1.6.1.2 Ensure AppArmor is enabled in the bootloader configuration</li> <li>1.6.1.3 Ensure all AppArmor Profiles are in enforce or complain mode</li> <li>1.6.1.4 Ensure all AppArmor Profiles are enforcing</li> <li>1.7.1 Ensure message of the day is configured properly</li> <li>1.7.2 Ensure local login warning banner is configured properly</li> <li>1.7.3 Ensure remote login warning banner is configured properly</li> <li>1.7.4 Ensure permissions on /etc/motd are configured</li> <li>1.7.5 Ensure permissions on /etc/issue are configured</li> <li>1.7.6 Ensure permissions on /etc/issue.net are configured</li> <li>1.8.1 Ensure GNOME Display Manager is removed</li> <li>1.8.10 Ensure XDCMP is not enabled</li> <li>1.8.2 Ensure GDM login banner is configured</li> <li>1.8.3 Ensure GDM disable-user-list option is enabled</li> <li>1.8.4 Ensure GDM screen locks when the user is idle</li> <li>1.8.5 Ensure GDM screen locks cannot be overridden</li> <li>1.8.6 Ensure GDM automatic mounting of removable media is disabled</li> <li>1.8.7 Ensure GDM disabling automatic mounting of removable media is not overridden</li> <li>1.8.8 Ensure GDM autorun-never is enabled</li> <li>1.8.9 Ensure GDM autorun-never is not overridden</li> </ul>"},{"location":"tags/#level-1","title":"Level 1","text":"<ul> <li>1.9 Ensure updates, patches, and additional security software are installed</li> <li>1.1.10 Disable USB Storage</li> <li>1.1.9 Disable Automounting</li> <li>1.1.1.1 Ensure mounting of cramfs filesystems is disabled</li> <li>1.1.2.1 Ensure /tmp is a separate partition</li> <li>1.1.2.2 Ensure nodev option set on /tmp partition</li> <li>1.1.2.3 Ensure noexec option set on /tmp partition</li> <li>1.1.2.4 Ensure nosuid option set on /tmp partition</li> <li>1.1.3.2 Ensure nodev option set on /var partition</li> <li>1.1.3.3 Ensure nosuid option set on /var partition</li> <li>1.1.4.2 Ensure noexec option set on /var/tmp partition</li> <li>1.1.4.3 Ensure nosuid option set on /var/tmp partition</li> <li>1.1.4.4 Ensure nodev option set on /var/tmp partition</li> <li>1.1.5.2 Ensure nodev option set on /var/log partition</li> <li>1.1.5.3 Ensure noexec option set on /var/log partition</li> <li>1.1.5.4 Ensure nosuid option set on /var/log partition</li> <li>1.1.6.2 Ensure noexec option set on /var/log/audit partition</li> <li>1.1.6.3 Ensure nodev option set on /var/log/audit partition</li> <li>1.1.6.4 Ensure nosuid option set on /var/log/audit partition</li> <li>1.1.7.2 Ensure nodev option set on /home partition</li> <li>1.1.7.3 Ensure nosuid option set on /home partition</li> <li>1.1.8.1 Ensure nodev option set on /dev/shm partition</li> <li>1.1.8.2 Ensure noexec option set on /dev/shm partition</li> <li>1.1.8.3 Ensure nosuid option set on /dev/shm partition</li> <li>1.2.1 Ensure package manager repositories are configured</li> <li>1.2.2 Ensure GPG keys are configured</li> <li>1.3.1 Ensure AIDE is installed</li> <li>1.3.2 Ensure filesystem integrity is regularly checked</li> <li>1.4.1 Ensure bootloader password is set</li> <li>1.4.2 Ensure permissions on bootloader config are configured</li> <li>1.4.3 Ensure authentication required for single user mode</li> <li>1.5.1 Ensure address space layout randomization (ASLR) is enabled</li> <li>1.5.2 Ensure prelink is not installed</li> <li>1.5.3 Ensure Automatic Error Reporting is not enabled</li> <li>1.5.4 Ensure core dumps are restricted</li> <li>1.6.1.1 Ensure AppArmor is installed</li> <li>1.6.1.2 Ensure AppArmor is enabled in the bootloader configuration</li> <li>1.6.1.3 Ensure all AppArmor Profiles are in enforce or complain mode</li> <li>1.7.1 Ensure message of the day is configured properly</li> <li>1.7.2 Ensure local login warning banner is configured properly</li> <li>1.7.3 Ensure remote login warning banner is configured properly</li> <li>1.7.4 Ensure permissions on /etc/motd are configured</li> <li>1.7.5 Ensure permissions on /etc/issue are configured</li> <li>1.7.6 Ensure permissions on /etc/issue.net are configured</li> <li>1.8.10 Ensure XDCMP is not enabled</li> <li>1.8.4 Ensure GDM screen locks when the user is idle</li> <li>1.8.5 Ensure GDM screen locks cannot be overridden</li> <li>1.8.6 Ensure GDM automatic mounting of removable media is disabled</li> <li>1.8.7 Ensure GDM disabling automatic mounting of removable media is not overridden</li> <li>1.8.8 Ensure GDM autorun-never is enabled</li> <li>1.8.9 Ensure GDM autorun-never is not overridden</li> <li>2.4 Ensure nonessential services are removed or masked</li> <li>2.1.1.1 Ensure a single time synchronization daemon is in use</li> <li>2.1.2.1 Ensure chrony is configured with authorized timeserver</li> <li>2.1.2.2 Ensure chrony is running as user _chrony</li> <li>2.1.2.3 Ensure chrony is enabled and running</li> <li>2.1.3.1 Ensure systemd-timesyncd configured with authorized timeserver</li> <li>2.1.3.2 Ensure systemd-timesyncd is enabled and running</li> <li>2.1.4.1 Ensure ntp access control is configured</li> <li>2.1.4.2 Ensure ntp is configured with authorized timeserver</li> <li>2.1.4.3 Ensure ntp is running as user ntp</li> <li>Ensure mounting of cramfs filesystems is disabled</li> <li>2.2.1 Ensure X Window System is not installed</li> <li>2.2.10 Ensure IMAP and POP3 server are not installed</li> <li>2.2.11 Ensure Samba is not installed</li> <li>2.2.12 Ensure HTTP Proxy Server is not installed</li> <li>2.2.13 Ensure SNMP Server is not installed</li> <li>2.2.14 Ensure NIS Server is not installed</li> <li>2.2.15 Ensure mail transfer agent is configured for local-only mode</li> <li>2.2.16 Ensure rsync service is either not installed or masked</li> <li>2.2.2 Ensure Avahi Server is not installed</li> <li>2.2.3 Ensure CUPS is not installed</li> <li>2.2.4 Ensure DHCP Server is not installed</li> <li>2.2.5 Ensure LDAP server is not installed</li> <li>2.2.6 Ensure NFS is not installed</li> <li>2.2.7 Ensure DNS Server is not installed</li> <li>2.2.8 Ensure FTP Server is not installed</li> <li>2.2.9 Ensure HTTP server is not installed</li> <li>2.3.1 Ensure NIS Client is not installed</li> <li>2.3.2 Ensure rsh client is not installed</li> <li>2.3.3 Ensure talk client is not installed</li> <li>2.3.4 Ensure telnet client is not installed</li> <li>2.3.5 Ensure LDAP client is not installed</li> <li>2.3.6 Ensure RPC is not installed</li> <li>3.1.1 Ensure system is checked to determine if IPv6 is enabled</li> <li>3.1.2 Ensure wireless interfaces are disabled</li> <li>3.2.1 Ensure packet redirect sending is disabled</li> <li>3.2.2 Ensure IP forwarding is disabled</li> <li>3.3.1 Ensure source routed packets are not accepted</li> <li>3.3.2 Ensure ICMP redirects are not accepted</li> <li>3.3.3 Ensure secure ICMP redirects are not accepted</li> <li>3.3.4 Ensure suspicious packets are logged</li> <li>3.3.5 Ensure broadcast ICMP requests are ignored</li> <li>3.3.6 Ensure bogus ICMP responses are ignored</li> <li>3.3.7 Ensure Reverse Path Filtering is enabled</li> <li>3.3.8 Ensure TCP SYN Cookies is enabled</li> <li>3.3.9 Ensure IPv6 router advertisements are not accepted</li> <li>3.5.1.1 Ensure ufw is installed</li> <li>3.5.1.2 Ensure iptables-persistent is not installed with ufw</li> <li>3.5.1.3 Ensure ufw service is enabled</li> <li>3.5.1.4 Ensure ufw loopback traffic is configured</li> <li>3.5.1.5 Ensure ufw outbound connections are configured</li> <li>3.5.1.6 Ensure ufw firewall rules exist for all open ports</li> <li>3.5.1.7 Ensure ufw default deny firewall policy</li> <li>3.5.2.1 Ensure nftables is installed</li> <li>3.5.2.10 Ensure nftables rules are permanent</li> <li>3.5.2.2 Ensure ufw is uninstalled or disabled with nftables</li> <li>3.5.2.3 Ensure iptables are flushed with nftables</li> <li>3.5.2.4 Ensure a nftables table exists</li> <li>3.5.2.5 Ensure nftables base chains exist</li> <li>3.5.2.6 Ensure nftables loopback traffic is configured</li> <li>3.5.2.7 Ensure nftables outbound and established connections are configured</li> <li>3.5.2.8 Ensure nftables default deny firewall policy</li> <li>3.5.2.9 Ensure nftables service is enabled</li> <li>3.5.3.1.1 Ensure iptables packages are installed</li> <li>3.5.3.1.2 Ensure nftables is not installed with iptables</li> <li>3.5.3.1.3 Ensure ufw is uninstalled or disabled with iptables</li> <li>3.5.3.2.1 Ensure iptables default deny firewall policy</li> <li>3.5.3.2.2 Ensure iptables loopback traffic is configured</li> <li>3.5.3.2.4 Ensure iptables firewall rules exist for all open ports</li> <li>3.5.3.3.1 Ensure ip6tables default deny firewall policy</li> <li>3.5.3.3.2 Ensure ip6tables loopback traffic is configured</li> <li>3.5.3.3.3 Ensure ip6tables outbound and established connections are configured</li> <li>3.5.3.3.4 Ensure ip6tables firewall rules exist for all open ports</li> <li>4.1.4.11 Ensure cryptographic mechanisms are used to protect the integrity of audit tool</li> <li>4.2.3 Ensure all logfiles have appropriate permissions and ownership</li> <li>4.2.1.2 Ensure journald service is enabled</li> <li>4.2.1.3 Ensure journald is configured to compress large log files</li> <li>4.2.1.4 Ensure journald is configured to write logfiles to persistent disk</li> <li>4.2.1.5 Ensure journald is not configured to send logs to rsyslog</li> <li>4.2.1.6 Ensure journald log rotation is configured per site policy</li> <li>4.2.1.7 Ensure journald default file permissions configured</li> <li>4.2.1.1.1 Ensure systemd-journal-remote is installed</li> <li>4.2.1.1.2 Ensure systemd-journal-remote is configured</li> <li>4.2.1.1.3 Ensure systemd-journal-remote is enabled</li> <li>4.2.1.1.4 Ensure journald is not configured to recieve logs from a remote client</li> <li>4.2.2.1 Ensure rsyslog is installed</li> <li>4.2.2.2 Ensure rsyslog service is enabled</li> <li>4.2.2.3 Ensure journald is configured to send logs to rsyslog</li> <li>4.2.2.4 Ensure rsyslog default file permissions are configured</li> <li>4.2.2.5 Ensure logging is configured</li> <li>4.2.2.6 Ensure rsyslog is configured to send logs to a remote log host</li> <li>4.2.2.7 Ensure rsyslog is not configured to receive logs from a remote client</li> <li>5.1.1 Ensure cron daemon is enabled and running</li> <li>5.1.2 Ensure permissions on /etc/crontab are configured</li> <li>5.1.3 Ensure permissions on /etc/cron.hourly are configured</li> <li>5.1.4 Ensure permissions on /etc/cron.daily are configured</li> <li>5.1.5 Ensure permissions on /etc/cron.weekly are configured</li> <li>5.1.6 Ensure permissions on /etc/cron.monthly are configured</li> <li>5.1.7 Ensure permissions on /etc/cron.d are configured</li> <li>5.1.8 Ensure cron is restricted to authorized users</li> <li>5.1.9 Ensure at is restricted to authorized users</li> <li>5.2.1 Ensure permissions on /etc/ssh/sshd_config are configured</li> <li>5.2.10 Ensure SSH PermitUserEnvironment is disabled</li> <li>5.2.11 Ensure SSH IgnoreRhosts is enabled</li> <li>5.2.12 Ensure SSH X11 forwarding is disabled</li> <li>5.2.13 Ensure only strong Ciphers are used</li> <li>5.2.14 Ensure only strong MAC algorithms are used</li> <li>5.2.15 Ensure only strong Key Exchange algorithms are used</li> <li>5.2.17 Ensure SSH warning banner is configured</li> <li>5.2.18 Ensure SSH MaxAuthTries is set to 4 or less</li> <li>5.2.19 Ensure SSH MaxStartups is configured</li> <li>5.2.2 Ensure permissions on SSH private host key files are configured</li> <li>5.2.20 Ensure SSH MaxSessions is set to 10 or less</li> <li>5.2.21 Ensure SSH LoginGraceTime is set to one minute or less</li> <li>5.2.22 Ensure SSH Idle Timeout Interval is configured</li> <li>5.2.3 Ensure permissions on SSH public host key files are configured</li> <li>5.2.4 Ensure SSH access is limited</li> <li>5.2.5 Ensure SSH LogLevel is appropriate</li> <li>5.2.6 Ensure SSH PAM is enabled</li> <li>5.2.7 Ensure SSH root login is disabled</li> <li>5.2.8 Ensure SSH HostbasedAuthentication is disabled</li> <li>5.2.9 Ensure SSH PermitEmptyPasswords is disabled</li> <li>5.3.1 Ensure sudo is installed</li> <li>5.3.2 Ensure sudo commands use pty</li> <li>5.3.3 Ensure sudo log file exists</li> <li>5.3.5 Ensure re-authentication for privilege escalation is not disabled globally</li> <li>5.3.6 Ensure sudo authentication timeout is configured correctly</li> <li>5.3.7 Ensure access to the su command is restricted</li> <li>5.4.1 Ensure password creation requirements are configured</li> <li>5.4.2 Ensure lockout for failed password attempts is configured</li> <li>5.4.3 Ensure password reuse is limited</li> <li>5.4.4 Ensure password hashing algorithm is up to date with the latest standards</li> <li>5.5.2 Ensure system accounts are secured</li> <li>5.5.3 Ensure default group for the root account is GID 0</li> <li>5.5.4 Ensure default user umask is 027 or more restrictive</li> <li>5.5.5 Ensure default user shell timeout is 900 seconds or less</li> <li>5.5.1.1 Ensure minimum days between password changes is configured</li> <li>5.5.1.2 Ensure password expiration is 365 days or less</li> <li>5.5.1.3 Ensure password expiration warning days is 7 or more</li> <li>5.5.1.4 Ensure inactive password lock is 30 days or less</li> <li>5.5.1.5 Ensure all users last password change date is in the past</li> <li>6.1.1 Ensure permissions on /etc/passwd are configured</li> <li>6.1.10 Ensure no unowned files or directories exist</li> <li>6.1.11 Ensure no ungrouped files or directories exist</li> <li>6.1.12 Audit SUID executables</li> <li>6.1.13 Audit SGID executables</li> <li>6.1.2 Ensure permissions on /etc/passwd- are configured</li> <li>6.1.3 Ensure permissions on /etc/group are configured</li> <li>6.1.4 Ensure permissions on /etc/group- are configured</li> <li>6.1.5 Ensure permissions on /etc/shadow are configured</li> <li>6.1.6 Ensure permissions on /etc/shadow- are configured</li> <li>6.1.7 Ensure permissions on /etc/gshadow are configured</li> <li>E6.1.8 Ensure permissions on /etc/gshadow- are configured</li> <li>6.1.9 Ensure no world writable files exist</li> <li>6.2.1 Ensure accounts in /etc/passwd use shadowed passwords</li> <li>6.2.10 Ensure root is the only UID 0 account</li> <li>6.2.11 Ensure local interactive user home directories exist</li> <li>6.2.12 Ensure local interactive users own their home directories</li> <li>6.2.13 Ensure local interactive user home directories are mode 750 or more restrictive</li> <li>6.2.14 Ensure no local interactive user has .netrc files</li> <li>6.2.15 Ensure no local interactive user has .forward files</li> <li>6.2.16 Ensue no local interactive user has .rhosts files</li> <li>6.2.17 Ensure local interactive user dot files are not group or world writable</li> <li>6.2.2 Ensure /etc/shadow password fields are not empty</li> <li>6.2.3 Ensure all groups in /etc/passwd exist in /etc/group</li> <li>6.2.4 Ensure shadow group is empty</li> <li>6.2.5 Ensure no duplicate UIDs exist</li> <li>6.2.6 Ensure no duplicate GIDs exist</li> <li>6.2.7 Ensure no duplicate user names exist</li> <li>6.2.8 Ensure no duplicate group names exist</li> <li>6.2.9 Ensure root PATH Integrity</li> </ul>"},{"location":"tags/#level-2","title":"Level 2","text":"<ul> <li>1.1.10 Disable USB Storage</li> <li>1.1.1.2 Ensure mounting of squashfs filesystems is disabled</li> <li>1.1.1.3 Ensure mounting of udf filesystems is disabled</li> <li>1.1.3.1 Ensure separate partition exists for /var</li> <li>1.1.4.1 Ensure separate partition exists for /var/tmp</li> <li>1.1.5.1 Ensure separate partition exists for /var/log</li> <li>1.1.6.1 Ensure separate partition exists for /var/log/audit</li> <li>1.1.7.1 Ensure separate partition exists for /home</li> <li>1.6.1.4 Ensure all AppArmor Profiles are enforcing</li> <li>1.8.1 Ensure GNOME Display Manager is removed</li> <li>1.8.2 Ensure GDM login banner is configured</li> <li>1.8.3 Ensure GDM disable-user-list option is enabled</li> <li>1.8.6 Ensure GDM automatic mounting of removable media is disabled</li> <li>1.8.7 Ensure GDM disabling automatic mounting of removable media is not overridden</li> <li>1.8.8 Ensure GDM autorun-never is enabled</li> <li>2.2.3 Ensure CUPS is not installed</li> <li>3.1.2 Ensure wireless interfaces are disabled</li> <li>3.1.3 Ensure DCCP is disabled</li> <li>3.1.4 Ensure SCTP is disabled</li> <li>3.1.5 Ensure RDS is disabled</li> <li>3.1.6 Ensure TIPC is disabled</li> <li>4.1.1.1 Ensure auditd is installed</li> <li>4.1.1.2 Ensure auditd service is enabled and active</li> <li>4.1.1.3 Ensure auditing for processes that start prior to auditd is enabled</li> <li>4.1.1.4 Ensure audit_backlog_limit is sufficient</li> <li>4.1.2.1 Ensure audit log storage size is configured</li> <li>4.1.2.2 Ensure audit logs are not automatically deleted</li> <li>4.1.2.3 Ensure system is disabled when audit logs are full</li> <li>4.1.3.1 Ensure changes to system administration scope (sudoers) is collected</li> <li>4.1.3.10 Ensure successful file system mounts are collected</li> <li>4.1.3.11 Ensure session initiation information is collected</li> <li>4.1.3.12 Ensure login and logout events are collected</li> <li>4.1.3.13 Ensure file deletion events by users are collected</li> <li>4.1.3.14 Ensure events that modify the system's Mandatory Access Controls are collected</li> <li>4.1.3.15 Ensure successful and unsuccessful attempts to use the chcon command are recorded</li> <li>4.1.3.16 Ensure successful and unsuccessful attempts to use the setfacl command are recorded</li> <li>4.1.3.17 Ensure successful and unsuccessful attempts to use the chacl command are recorde</li> <li>4.1.3.18 Ensure successful and unsuccessful attempts to use the usermod command are recorded</li> <li>4.1.3.19 Ensure kernel module loading unloading and modification is collected</li> <li>4.1.3.2 Ensure actions as another user are always logged</li> <li>4.1.3.20 Ensure the audit configuration is immutable</li> <li>4.1.3.21 Ensure the running and on disk configuration is the same</li> <li>4.1.3.3 Ensure events that modify the sudo log file are collected</li> <li>4.1.3.4 Ensure events that modify date and time information are collected</li> <li>4.1.3.5 Ensure events that modify the system's network environment are collected</li> <li>4.1.3.6 Ensure use of privileged commands are collected</li> <li>4.1.3.7 Ensure unsuccessful file access attempts are collected</li> <li>4.1.3.8 Ensure events that modify user/group information are collected</li> <li>4.1.3.9 Ensure discretionary access control permission modification events are collected</li> <li>4.1.4.1 Ensure audit log files are mode 0640 or less permissive</li> <li>4.1.4.10 Ensure audit tools belong to group root</li> <li>4.1.4.2 Ensure only authorized users own audit log files</li> <li>4.1.4.3 Ensure only authorized groups are assigned ownership of audit log files</li> <li>4.1.4.4 Ensure the audit log directory is 0750 or more restrictive</li> <li>4.1.4.5 Ensure audit configuration files are 640 or more restrictive</li> <li>4.1.4.6 Ensure audit configuration files are owned by root</li> <li>4.1.4.7 Ensure audit configuration files belong to group root</li> <li>4.1.4.8 Ensure audit tools are 755 or more restrictive</li> <li>4.1.4.9 Ensure audit tools are owned by root</li> <li>5.2.12 Ensure SSH X11 forwarding is disabled</li> <li>5.2.16 Ensure SSH AllowTcpForwarding is disabled</li> <li>5.3.4 Ensure users must provide password for privilege escalation</li> </ul>"},{"location":"tags/#local-user-and-group-settings","title":"Local User and Group Settings","text":"<ul> <li>6.2.1 Ensure accounts in /etc/passwd use shadowed passwords</li> <li>6.2.10 Ensure root is the only UID 0 account</li> <li>6.2.11 Ensure local interactive user home directories exist</li> <li>6.2.12 Ensure local interactive users own their home directories</li> <li>6.2.13 Ensure local interactive user home directories are mode 750 or more restrictive</li> <li>6.2.14 Ensure no local interactive user has .netrc files</li> <li>6.2.15 Ensure no local interactive user has .forward files</li> <li>6.2.16 Ensue no local interactive user has .rhosts files</li> <li>6.2.17 Ensure local interactive user dot files are not group or world writable</li> <li>6.2.2 Ensure /etc/shadow password fields are not empty</li> <li>6.2.3 Ensure all groups in /etc/passwd exist in /etc/group</li> <li>6.2.4 Ensure shadow group is empty</li> <li>6.2.5 Ensure no duplicate UIDs exist</li> <li>6.2.6 Ensure no duplicate GIDs exist</li> <li>6.2.7 Ensure no duplicate user names exist</li> <li>6.2.8 Ensure no duplicate group names exist</li> <li>6.2.9 Ensure root PATH Integrity</li> </ul>"},{"location":"tags/#logging-and-auditing","title":"Logging and Auditing","text":"<ul> <li>4.1.1.1 Ensure auditd is installed</li> <li>4.1.1.2 Ensure auditd service is enabled and active</li> <li>4.1.1.3 Ensure auditing for processes that start prior to auditd is enabled</li> <li>4.1.1.4 Ensure audit_backlog_limit is sufficient</li> <li>4.1.2.1 Ensure audit log storage size is configured</li> <li>4.1.2.2 Ensure audit logs are not automatically deleted</li> <li>4.1.2.3 Ensure system is disabled when audit logs are full</li> <li>4.1.3.1 Ensure changes to system administration scope (sudoers) is collected</li> <li>4.1.3.10 Ensure successful file system mounts are collected</li> <li>4.1.3.11 Ensure session initiation information is collected</li> <li>4.1.3.12 Ensure login and logout events are collected</li> <li>4.1.3.13 Ensure file deletion events by users are collected</li> <li>4.1.3.14 Ensure events that modify the system's Mandatory Access Controls are collected</li> <li>4.1.3.15 Ensure successful and unsuccessful attempts to use the chcon command are recorded</li> <li>4.1.3.16 Ensure successful and unsuccessful attempts to use the setfacl command are recorded</li> <li>4.1.3.17 Ensure successful and unsuccessful attempts to use the chacl command are recorde</li> <li>4.1.3.18 Ensure successful and unsuccessful attempts to use the usermod command are recorded</li> <li>4.1.3.19 Ensure kernel module loading unloading and modification is collected</li> <li>4.1.3.2 Ensure actions as another user are always logged</li> <li>4.1.3.20 Ensure the audit configuration is immutable</li> <li>4.1.3.21 Ensure the running and on disk configuration is the same</li> <li>4.1.3.3 Ensure events that modify the sudo log file are collected</li> <li>4.1.3.4 Ensure events that modify date and time information are collected</li> <li>4.1.3.5 Ensure events that modify the system's network environment are collected</li> <li>4.1.3.6 Ensure use of privileged commands are collected</li> <li>4.1.3.7 Ensure unsuccessful file access attempts are collected</li> <li>4.1.3.8 Ensure events that modify user/group information are collected</li> <li>4.1.3.9 Ensure discretionary access control permission modification events are collected</li> <li>4.1.4.1 Ensure audit log files are mode 0640 or less permissive</li> <li>4.1.4.10 Ensure audit tools belong to group root</li> <li>4.1.4.11 Ensure cryptographic mechanisms are used to protect the integrity of audit tool</li> <li>4.1.4.2 Ensure only authorized users own audit log files</li> <li>4.1.4.3 Ensure only authorized groups are assigned ownership of audit log files</li> <li>4.1.4.4 Ensure the audit log directory is 0750 or more restrictive</li> <li>4.1.4.5 Ensure audit configuration files are 640 or more restrictive</li> <li>4.1.4.6 Ensure audit configuration files are owned by root</li> <li>4.1.4.7 Ensure audit configuration files belong to group root</li> <li>4.1.4.8 Ensure audit tools are 755 or more restrictive</li> <li>4.1.4.9 Ensure audit tools are owned by root</li> <li>4.2.3 Ensure all logfiles have appropriate permissions and ownership</li> <li>4.2.1.2 Ensure journald service is enabled</li> <li>4.2.1.3 Ensure journald is configured to compress large log files</li> <li>4.2.1.4 Ensure journald is configured to write logfiles to persistent disk</li> <li>4.2.1.5 Ensure journald is not configured to send logs to rsyslog</li> <li>4.2.1.6 Ensure journald log rotation is configured per site policy</li> <li>4.2.1.7 Ensure journald default file permissions configured</li> <li>4.2.1.1.1 Ensure systemd-journal-remote is installed</li> <li>4.2.1.1.2 Ensure systemd-journal-remote is configured</li> <li>4.2.1.1.3 Ensure systemd-journal-remote is enabled</li> <li>4.2.1.1.4 Ensure journald is not configured to recieve logs from a remote client</li> <li>4.2.2.1 Ensure rsyslog is installed</li> <li>4.2.2.2 Ensure rsyslog service is enabled</li> <li>4.2.2.3 Ensure journald is configured to send logs to rsyslog</li> <li>4.2.2.4 Ensure rsyslog default file permissions are configured</li> <li>4.2.2.5 Ensure logging is configured</li> <li>4.2.2.6 Ensure rsyslog is configured to send logs to a remote log host</li> <li>4.2.2.7 Ensure rsyslog is not configured to receive logs from a remote client</li> </ul>"},{"location":"tags/#m1018","title":"M1018","text":"<ul> <li>5.1.1 Ensure cron daemon is enabled and running</li> <li>5.1.2 Ensure permissions on /etc/crontab are configured</li> <li>5.1.3 Ensure permissions on /etc/cron.hourly are configured</li> <li>5.1.4 Ensure permissions on /etc/cron.daily are configured</li> <li>5.1.5 Ensure permissions on /etc/cron.weekly are configured</li> <li>5.1.6 Ensure permissions on /etc/cron.monthly are configured</li> <li>5.1.7 Ensure permissions on /etc/cron.d are configured</li> <li>5.1.8 Ensure cron is restricted to authorized users</li> <li>5.1.9 Ensure at is restricted to authorized users</li> <li>5.2.4 Ensure SSH access is limited</li> </ul>"},{"location":"tags/#m1022","title":"M1022","text":"<ul> <li>1.1.2.1 Ensure /tmp is a separate partition</li> <li>1.1.2.2 Ensure nodev option set on /tmp partition</li> <li>1.1.2.3 Ensure noexec option set on /tmp partition</li> <li>1.1.2.4 Ensure nosuid option set on /tmp partition</li> <li>1.1.4.1 Ensure separate partition exists for /var/tmp</li> <li>1.1.4.2 Ensure noexec option set on /var/tmp partition</li> <li>1.1.4.3 Ensure nosuid option set on /var/tmp partition</li> <li>1.1.4.4 Ensure nodev option set on /var/tmp partition</li> <li>1.1.5.1 Ensure separate partition exists for /var/log</li> <li>1.1.5.3 Ensure noexec option set on /var/log partition</li> <li>1.1.5.4 Ensure nosuid option set on /var/log partition</li> <li>1.1.6.1 Ensure separate partition exists for /var/log/audit</li> <li>1.1.6.2 Ensure noexec option set on /var/log/audit partition</li> <li>1.1.6.3 Ensure nodev option set on /var/log/audit partition</li> <li>1.1.6.4 Ensure nosuid option set on /var/log/audit partition</li> <li>1.1.7.2 Ensure nodev option set on /home partition</li> <li>1.1.7.3 Ensure nosuid option set on /home partition</li> <li>1.3.2 Ensure filesystem integrity is regularly checked</li> <li>1.4.2 Ensure permissions on bootloader config are configured</li> <li>1.4.3 Ensure authentication required for single user mode</li> <li>1.7.4 Ensure permissions on /etc/motd are configured</li> <li>1.7.5 Ensure permissions on /etc/issue are configured</li> <li>1.7.6 Ensure permissions on /etc/issue.net are configured</li> <li>2.1.2.1 Ensure chrony is configured with authorized timeserver</li> <li>2.1.4.2 Ensure ntp is configured with authorized timeserver</li> <li>4.1.3.14 Ensure events that modify the system's Mandatory Access Controls are collected</li> <li>4.1.3.9 Ensure discretionary access control permission modification events are collected</li> <li>4.2.1.4 Ensure journald is configured to write logfiles to persistent disk</li> <li>4.2.1.6 Ensure journald log rotation is configured per site policy</li> <li>5.2.1 Ensure permissions on /etc/ssh/sshd_config are configured</li> <li>5.2.2 Ensure permissions on SSH private host key files are configured</li> <li>5.2.3 Ensure permissions on SSH public host key files are configured</li> <li>6.1.1 Ensure permissions on /etc/passwd are configured</li> <li>6.1.2 Ensure permissions on /etc/passwd- are configured</li> <li>6.1.3 Ensure permissions on /etc/group are configured</li> <li>6.1.4 Ensure permissions on /etc/group- are configured</li> <li>6.1.5 Ensure permissions on /etc/shadow are configured</li> <li>6.1.6 Ensure permissions on /etc/shadow- are configured</li> <li>6.1.7 Ensure permissions on /etc/gshadow are configured</li> <li>E6.1.8 Ensure permissions on /etc/gshadow- are configured</li> <li>6.1.9 Ensure no world writable files exist</li> <li>6.2.11 Ensure local interactive user home directories exist</li> <li>6.2.12 Ensure local interactive users own their home directories</li> <li>6.2.13 Ensure local interactive user home directories are mode 750 or more restrictive</li> <li>6.2.17 Ensure local interactive user dot files are not group or world writable</li> <li>6.2.4 Ensure shadow group is empty</li> <li>6.2.9 Ensure root PATH Integrity</li> </ul>"},{"location":"tags/#m1026","title":"M1026","text":"<ul> <li>1.6.1.1 Ensure AppArmor is installed</li> <li>1.6.1.2 Ensure AppArmor is enabled in the bootloader configuration</li> <li>4.1.3.6 Ensure use of privileged commands are collected</li> <li>5.2.22 Ensure SSH Idle Timeout Interval is configured</li> <li>5.3.7 Ensure access to the su command is restricted</li> <li>5.5.2 Ensure system accounts are secured</li> <li>5.5.3 Ensure default group for the root account is GID 0</li> <li>5.5.5 Ensure default user shell timeout is 900 seconds or less</li> <li>6.2.10 Ensure root is the only UID 0 account</li> </ul>"},{"location":"tags/#m1027","title":"M1027","text":"<ul> <li>5.2.11 Ensure SSH IgnoreRhosts is enabled</li> <li>5.4.1 Ensure password creation requirements are configured</li> <li>5.4.2 Ensure lockout for failed password attempts is configured</li> <li>5.5.1.3 Ensure password expiration warning days is 7 or more</li> <li>5.5.1.4 Ensure inactive password lock is 30 days or less</li> <li>6.2.1 Ensure accounts in /etc/passwd use shadowed passwords</li> <li>6.2.14 Ensure no local interactive user has .netrc files</li> <li>6.2.2 Ensure /etc/shadow password fields are not empty</li> <li>6.2.3 Ensure all groups in /etc/passwd exist in /etc/group</li> <li>6.2.5 Ensure no duplicate UIDs exist</li> <li>6.2.6 Ensure no duplicate GIDs exist</li> <li>6.2.7 Ensure no duplicate user names exist</li> <li>6.2.8 Ensure no duplicate group names exist</li> </ul>"},{"location":"tags/#m1028","title":"M1028","text":"<ul> <li>1.8.3 Ensure GDM disable-user-list option is enabled</li> <li>3.1.2 Ensure wireless interfaces are disabled</li> <li>6.1.12 Audit SUID executables</li> <li>6.1.13 Audit SGID executables</li> </ul>"},{"location":"tags/#m1029","title":"M1029","text":"<ul> <li>4.2.1.5 Ensure journald is not configured to send logs to rsyslog</li> <li>4.2.1.1.1 Ensure systemd-journal-remote is installed</li> <li>4.2.1.1.2 Ensure systemd-journal-remote is configured</li> <li>4.2.1.1.3 Ensure systemd-journal-remote is enabled</li> <li>4.2.1.1.4 Ensure journald is not configured to recieve logs from a remote client</li> <li>4.2.2.6 Ensure rsyslog is configured to send logs to a remote log host</li> </ul>"},{"location":"tags/#m1030","title":"M1030","text":"<ul> <li>3.2.1 Ensure packet redirect sending is disabled</li> <li>3.2.2 Ensure IP forwarding is disabled</li> <li>3.3.2 Ensure ICMP redirects are not accepted</li> <li>3.3.3 Ensure secure ICMP redirects are not accepted</li> <li>3.3.7 Ensure Reverse Path Filtering is enabled</li> <li>3.3.9 Ensure IPv6 router advertisements are not accepted</li> </ul>"},{"location":"tags/#m1031","title":"M1031","text":"<ul> <li>3.5.1.1 Ensure ufw is installed</li> <li>3.5.1.4 Ensure ufw loopback traffic is configured</li> <li>3.5.1.5 Ensure ufw outbound connections are configured</li> <li>3.5.1.6 Ensure ufw firewall rules exist for all open ports</li> <li>3.5.1.7 Ensure ufw default deny firewall policy</li> <li>3.5.2.1 Ensure nftables is installed</li> <li>3.5.2.10 Ensure nftables rules are permanent</li> <li>3.5.2.4 Ensure a nftables table exists</li> <li>3.5.2.7 Ensure nftables outbound and established connections are configured</li> <li>3.5.2.8 Ensure nftables default deny firewall policy</li> <li>3.5.2.9 Ensure nftables service is enabled</li> <li>3.5.3.1.1 Ensure iptables packages are installed</li> <li>3.5.3.2.1 Ensure iptables default deny firewall policy</li> <li>3.5.3.2.2 Ensure iptables loopback traffic is configured</li> <li>3.5.3.2.4 Ensure iptables firewall rules exist for all open ports</li> <li>3.5.3.3.1 Ensure ip6tables default deny firewall policy</li> <li>3.5.3.3.2 Ensure ip6tables loopback traffic is configured</li> <li>3.5.3.3.3 Ensure ip6tables outbound and established connections are configured</li> <li>3.5.3.3.4 Ensure ip6tables firewall rules exist for all open ports</li> <li>6.2.15 Ensure no local interactive user has .forward files</li> </ul>"},{"location":"tags/#m1034","title":"M1034","text":"<ul> <li>4.1.3.10 Ensure successful file system mounts are collected</li> </ul>"},{"location":"tags/#m1035","title":"M1035","text":"<ul> <li>5.2.17 Ensure SSH warning banner is configured</li> <li>5.2.6 Ensure SSH PAM is enabled</li> </ul>"},{"location":"tags/#m1036","title":"M1036","text":"<ul> <li>5.2.18 Ensure SSH MaxAuthTries is set to 4 or less</li> <li>5.2.21 Ensure SSH LoginGraceTime is set to one minute or less</li> </ul>"},{"location":"tags/#m1037","title":"M1037","text":"<ul> <li>3.3.5 Ensure broadcast ICMP requests are ignored</li> <li>3.3.8 Ensure TCP SYN Cookies is enabled</li> <li>3.5.1.1 Ensure ufw is installed</li> <li>3.5.1.4 Ensure ufw loopback traffic is configured</li> <li>3.5.1.5 Ensure ufw outbound connections are configured</li> <li>3.5.1.6 Ensure ufw firewall rules exist for all open ports</li> <li>3.5.1.7 Ensure ufw default deny firewall policy</li> <li>3.5.2.1 Ensure nftables is installed</li> <li>3.5.2.4 Ensure a nftables table exists</li> <li>3.5.2.7 Ensure nftables outbound and established connections are configured</li> <li>3.5.2.8 Ensure nftables default deny firewall policy</li> <li>3.5.2.9 Ensure nftables service is enabled</li> <li>3.5.3.1.1 Ensure iptables packages are installed</li> <li>3.5.3.2.1 Ensure iptables default deny firewall policy</li> <li>3.5.3.2.2 Ensure iptables loopback traffic is configured</li> <li>3.5.3.2.4 Ensure iptables firewall rules exist for all open ports</li> <li>3.5.3.3.1 Ensure ip6tables default deny firewall policy</li> <li>3.5.3.3.2 Ensure ip6tables loopback traffic is configured</li> <li>3.5.3.3.3 Ensure ip6tables outbound and established connections are configured</li> <li>3.5.3.3.4 Ensure ip6tables firewall rules exist for all open ports</li> </ul>"},{"location":"tags/#m1038","title":"M1038","text":"<ul> <li>1.1.9 Disable Automounting</li> <li>1.1.3.2 Ensure nodev option set on /var partition</li> <li>1.1.3.3 Ensure nosuid option set on /var partition</li> <li>1.1.7.1 Ensure separate partition exists for /home</li> <li>1.1.8.1 Ensure nodev option set on /dev/shm partition</li> <li>1.1.8.2 Ensure noexec option set on /dev/shm partition</li> <li>1.1.8.3 Ensure nosuid option set on /dev/shm partition</li> </ul>"},{"location":"tags/#m1041","title":"M1041","text":"<ul> <li>2.3.2 Ensure rsh client is not installed</li> <li>2.3.3 Ensure talk client is not installed</li> <li>2.3.4 Ensure telnet client is not installed</li> <li>5.2.13 Ensure only strong Ciphers are used</li> <li>5.2.14 Ensure only strong MAC algorithms are used</li> <li>5.2.15 Ensure only strong Key Exchange algorithms are used</li> </ul>"},{"location":"tags/#m1042","title":"M1042","text":"<ul> <li>2.4 Ensure nonessential services are removed or masked</li> <li>2.2.1 Ensure X Window System is not installed</li> <li>2.2.10 Ensure IMAP and POP3 server are not installed</li> <li>2.2.12 Ensure HTTP Proxy Server is not installed</li> <li>2.2.13 Ensure SNMP Server is not installed</li> <li>2.2.14 Ensure NIS Server is not installed</li> <li>2.2.15 Ensure mail transfer agent is configured for local-only mode</li> <li>2.2.16 Ensure rsync service is either not installed or masked</li> <li>2.2.2 Ensure Avahi Server is not installed</li> <li>2.2.3 Ensure CUPS is not installed</li> <li>2.2.4 Ensure DHCP Server is not installed</li> <li>2.2.5 Ensure LDAP server is not installed</li> <li>2.2.7 Ensure DNS Server is not installed</li> <li>2.2.8 Ensure FTP Server is not installed</li> <li>2.2.9 Ensure HTTP server is not installed</li> <li>2.3.1 Ensure NIS Client is not installed</li> <li>2.3.2 Ensure rsh client is not installed</li> <li>2.3.3 Ensure talk client is not installed</li> <li>2.3.4 Ensure telnet client is not installed</li> <li>2.3.5 Ensure LDAP client is not installed</li> <li>2.3.6 Ensure RPC is not installed</li> <li>3.1.1 Ensure system is checked to determine if IPv6 is enabled</li> <li>3.1.3 Ensure DCCP is disabled</li> <li>3.1.4 Ensure SCTP is disabled</li> <li>3.1.5 Ensure RDS is disabled</li> <li>3.1.6 Ensure TIPC is disabled</li> <li>3.2.1 Ensure packet redirect sending is disabled</li> <li>3.2.2 Ensure IP forwarding is disabled</li> <li>3.3.2 Ensure ICMP redirects are not accepted</li> <li>3.3.3 Ensure secure ICMP redirects are not accepted</li> <li>3.3.7 Ensure Reverse Path Filtering is enabled</li> <li>3.3.9 Ensure IPv6 router advertisements are not accepted</li> <li>5.2.10 Ensure SSH PermitUserEnvironment is disabled</li> <li>5.2.12 Ensure SSH X11 forwarding is disabled</li> <li>5.2.16 Ensure SSH AllowTcpForwarding is disabled</li> <li>5.2.7 Ensure SSH root login is disabled</li> <li>5.2.8 Ensure SSH HostbasedAuthentication is disabled</li> <li>5.2.9 Ensure SSH PermitEmptyPasswords is disabled</li> </ul>"},{"location":"tags/#m1046","title":"M1046","text":"<ul> <li>1.4.1 Ensure bootloader password is set</li> </ul>"},{"location":"tags/#m1047","title":"M1047","text":"<ul> <li>4.1.3.1 Ensure changes to system administration scope (sudoers) is collected</li> <li>4.1.3.19 Ensure kernel module loading unloading and modification is collected</li> <li>4.1.3.2 Ensure actions as another user are always logged</li> <li>4.1.3.5 Ensure events that modify the system's network environment are collected</li> <li>4.1.3.8 Ensure events that modify user/group information are collected</li> </ul>"},{"location":"tags/#m1050","title":"M1050","text":"<ul> <li>1.1.10 Disable USB Storage</li> <li>1.1.1.1 Ensure mounting of cramfs filesystems is disabled</li> <li>1.1.1.2 Ensure mounting of squashfs filesystems is disabled</li> <li>1.1.1.3 Ensure mounting of udf filesystems is disabled</li> <li>1.1.5.2 Ensure nodev option set on /var/log partition</li> <li>1.5.1 Ensure address space layout randomization (ASLR) is enabled</li> <li>1.5.2 Ensure prelink is not installed</li> <li>1.8.10 Ensure XDCMP is not enabled</li> </ul>"},{"location":"tags/#m1051","title":"M1051","text":"<ul> <li>1.2.1 Ensure package manager repositories are configured</li> <li>1.2.2 Ensure GPG keys are configured</li> </ul>"},{"location":"tags/#m1053","title":"M1053","text":"<ul> <li>3.3.6 Ensure bogus ICMP responses are ignored</li> <li>4.1.2.1 Ensure audit log storage size is configured</li> <li>4.1.2.2 Ensure audit logs are not automatically deleted</li> <li>4.2.1.3 Ensure journald is configured to compress large log files</li> </ul>"},{"location":"tags/#ma1027","title":"MA1027","text":"<ul> <li>5.5.1.1 Ensure minimum days between password changes is configured</li> </ul>"},{"location":"tags/#ma1041","title":"MA1041","text":"<ul> <li>5.4.4 Ensure password hashing algorithm is up to date with the latest standards</li> </ul>"},{"location":"tags/#mandatory-access-control","title":"Mandatory Access Control","text":"<ul> <li>1.6.1.1 Ensure AppArmor is installed</li> <li>1.6.1.2 Ensure AppArmor is enabled in the bootloader configuration</li> <li>1.6.1.3 Ensure all AppArmor Profiles are in enforce or complain mode</li> <li>1.6.1.4 Ensure all AppArmor Profiles are enforcing</li> </ul>"},{"location":"tags/#manual","title":"Manual","text":"<ul> <li>1.9 Ensure updates, patches, and additional security software are installed</li> <li>1.2.1 Ensure package manager repositories are configured</li> <li>1.2.2 Ensure GPG keys are configured</li> <li>2.4 Ensure nonessential services are removed or masked</li> <li>2.1.2.1 Ensure chrony is configured with authorized timeserver</li> <li>2.1.3.1 Ensure systemd-timesyncd configured with authorized timeserver</li> <li>2.1.4.2 Ensure ntp is configured with authorized timeserver</li> <li>3.1.1 Ensure system is checked to determine if IPv6 is enabled</li> <li>3.5.1.5 Ensure ufw outbound connections are configured</li> <li>3.5.2.3 Ensure iptables are flushed with nftables</li> <li>3.5.2.7 Ensure nftables outbound and established connections are configured</li> <li>3.5.3.3.3 Ensure ip6tables outbound and established connections are configured</li> <li>4.1.3.21 Ensure the running and on disk configuration is the same</li> <li>4.2.1.5 Ensure journald is not configured to send logs to rsyslog</li> <li>4.2.1.6 Ensure journald log rotation is configured per site policy</li> <li>4.2.1.7 Ensure journald default file permissions configured</li> <li>4.2.1.1.2 Ensure systemd-journal-remote is configured</li> <li>4.2.1.1.3 Ensure systemd-journal-remote is enabled</li> <li>4.2.2.3 Ensure journald is configured to send logs to rsyslog</li> <li>4.2.2.5 Ensure logging is configured</li> <li>4.2.2.6 Ensure rsyslog is configured to send logs to a remote log host</li> <li>6.1.12 Audit SUID executables</li> <li>6.1.13 Audit SGID executables</li> </ul>"},{"location":"tags/#network-configuration","title":"Network Configuration","text":"<ul> <li>3.1.1 Ensure system is checked to determine if IPv6 is enabled</li> <li>3.1.2 Ensure wireless interfaces are disabled</li> <li>3.1.3 Ensure DCCP is disabled</li> <li>3.1.4 Ensure SCTP is disabled</li> <li>3.1.5 Ensure RDS is disabled</li> <li>3.1.6 Ensure TIPC is disabled</li> <li>3.2.1 Ensure packet redirect sending is disabled</li> <li>3.2.2 Ensure IP forwarding is disabled</li> <li>3.3.1 Ensure source routed packets are not accepted</li> <li>3.3.2 Ensure ICMP redirects are not accepted</li> <li>3.3.3 Ensure secure ICMP redirects are not accepted</li> <li>3.3.4 Ensure suspicious packets are logged</li> <li>3.3.5 Ensure broadcast ICMP requests are ignored</li> <li>3.3.6 Ensure bogus ICMP responses are ignored</li> <li>3.3.7 Ensure Reverse Path Filtering is enabled</li> <li>3.3.8 Ensure TCP SYN Cookies is enabled</li> <li>3.3.9 Ensure IPv6 router advertisements are not accepted</li> <li>3.5.1.1 Ensure ufw is installed</li> <li>3.5.1.2 Ensure iptables-persistent is not installed with ufw</li> <li>3.5.1.3 Ensure ufw service is enabled</li> <li>3.5.1.4 Ensure ufw loopback traffic is configured</li> <li>3.5.1.5 Ensure ufw outbound connections are configured</li> <li>3.5.1.6 Ensure ufw firewall rules exist for all open ports</li> <li>3.5.1.7 Ensure ufw default deny firewall policy</li> <li>3.5.2.1 Ensure nftables is installed</li> <li>3.5.2.10 Ensure nftables rules are permanent</li> <li>3.5.2.2 Ensure ufw is uninstalled or disabled with nftables</li> <li>3.5.2.3 Ensure iptables are flushed with nftables</li> <li>3.5.2.4 Ensure a nftables table exists</li> <li>3.5.2.5 Ensure nftables base chains exist</li> <li>3.5.2.6 Ensure nftables loopback traffic is configured</li> <li>3.5.2.7 Ensure nftables outbound and established connections are configured</li> <li>3.5.2.8 Ensure nftables default deny firewall policy</li> <li>3.5.2.9 Ensure nftables service is enabled</li> <li>3.5.3.1.1 Ensure iptables packages are installed</li> <li>3.5.3.1.2 Ensure nftables is not installed with iptables</li> <li>3.5.3.1.3 Ensure ufw is uninstalled or disabled with iptables</li> <li>3.5.3.2.1 Ensure iptables default deny firewall policy</li> <li>3.5.3.2.2 Ensure iptables loopback traffic is configured</li> <li>3.5.3.2.4 Ensure iptables firewall rules exist for all open ports</li> <li>3.5.3.3.1 Ensure ip6tables default deny firewall policy</li> <li>3.5.3.3.2 Ensure ip6tables loopback traffic is configured</li> <li>3.5.3.3.3 Ensure ip6tables outbound and established connections are configured</li> <li>3.5.3.3.4 Ensure ip6tables firewall rules exist for all open ports</li> </ul>"},{"location":"tags/#network-parameters-host-only","title":"Network Parameters (Host Only)","text":"<ul> <li>3.2.1 Ensure packet redirect sending is disabled</li> <li>3.2.2 Ensure IP forwarding is disabled</li> </ul>"},{"location":"tags/#network-parameters-host-and-router","title":"Network Parameters (Host and Router)","text":"<ul> <li>3.3.1 Ensure source routed packets are not accepted</li> <li>3.3.2 Ensure ICMP redirects are not accepted</li> <li>3.3.3 Ensure secure ICMP redirects are not accepted</li> <li>3.3.4 Ensure suspicious packets are logged</li> <li>3.3.5 Ensure broadcast ICMP requests are ignored</li> <li>3.3.6 Ensure bogus ICMP responses are ignored</li> <li>3.3.7 Ensure Reverse Path Filtering is enabled</li> <li>3.3.8 Ensure TCP SYN Cookies is enabled</li> <li>3.3.9 Ensure IPv6 router advertisements are not accepted</li> </ul>"},{"location":"tags/#secure-boot-settings","title":"Secure Boot Settings","text":"<ul> <li>1.4.1 Ensure bootloader password is set</li> <li>1.4.2 Ensure permissions on bootloader config are configured</li> <li>1.4.3 Ensure authentication required for single user mode</li> </ul>"},{"location":"tags/#server","title":"Server","text":"<ul> <li>1.9 Ensure updates, patches, and additional security software are installed</li> <li>1.1.10 Disable USB Storage</li> <li>1.1.9 Disable Automounting</li> <li>1.1.1.1 Ensure mounting of cramfs filesystems is disabled</li> <li>1.1.1.2 Ensure mounting of squashfs filesystems is disabled</li> <li>1.1.1.3 Ensure mounting of udf filesystems is disabled</li> <li>1.1.2.1 Ensure /tmp is a separate partition</li> <li>1.1.2.2 Ensure nodev option set on /tmp partition</li> <li>1.1.2.3 Ensure noexec option set on /tmp partition</li> <li>1.1.2.4 Ensure nosuid option set on /tmp partition</li> <li>1.1.3.1 Ensure separate partition exists for /var</li> <li>1.1.3.2 Ensure nodev option set on /var partition</li> <li>1.1.3.3 Ensure nosuid option set on /var partition</li> <li>1.1.4.1 Ensure separate partition exists for /var/tmp</li> <li>1.1.4.2 Ensure noexec option set on /var/tmp partition</li> <li>1.1.4.3 Ensure nosuid option set on /var/tmp partition</li> <li>1.1.4.4 Ensure nodev option set on /var/tmp partition</li> <li>1.1.5.1 Ensure separate partition exists for /var/log</li> <li>1.1.5.2 Ensure nodev option set on /var/log partition</li> <li>1.1.5.3 Ensure noexec option set on /var/log partition</li> <li>1.1.5.4 Ensure nosuid option set on /var/log partition</li> <li>1.1.6.1 Ensure separate partition exists for /var/log/audit</li> <li>1.1.6.2 Ensure noexec option set on /var/log/audit partition</li> <li>1.1.6.3 Ensure nodev option set on /var/log/audit partition</li> <li>1.1.6.4 Ensure nosuid option set on /var/log/audit partition</li> <li>1.1.7.1 Ensure separate partition exists for /home</li> <li>1.1.7.2 Ensure nodev option set on /home partition</li> <li>1.1.7.3 Ensure nosuid option set on /home partition</li> <li>1.1.8.1 Ensure nodev option set on /dev/shm partition</li> <li>1.1.8.2 Ensure noexec option set on /dev/shm partition</li> <li>1.1.8.3 Ensure nosuid option set on /dev/shm partition</li> <li>1.2.1 Ensure package manager repositories are configured</li> <li>1.2.2 Ensure GPG keys are configured</li> <li>1.3.1 Ensure AIDE is installed</li> <li>1.3.2 Ensure filesystem integrity is regularly checked</li> <li>1.4.1 Ensure bootloader password is set</li> <li>1.4.2 Ensure permissions on bootloader config are configured</li> <li>1.4.3 Ensure authentication required for single user mode</li> <li>1.5.1 Ensure address space layout randomization (ASLR) is enabled</li> <li>1.5.2 Ensure prelink is not installed</li> <li>1.5.3 Ensure Automatic Error Reporting is not enabled</li> <li>1.5.4 Ensure core dumps are restricted</li> <li>1.6.1.1 Ensure AppArmor is installed</li> <li>1.6.1.2 Ensure AppArmor is enabled in the bootloader configuration</li> <li>1.6.1.3 Ensure all AppArmor Profiles are in enforce or complain mode</li> <li>1.6.1.4 Ensure all AppArmor Profiles are enforcing</li> <li>1.7.1 Ensure message of the day is configured properly</li> <li>1.7.2 Ensure local login warning banner is configured properly</li> <li>1.7.3 Ensure remote login warning banner is configured properly</li> <li>1.7.4 Ensure permissions on /etc/motd are configured</li> <li>1.7.5 Ensure permissions on /etc/issue are configured</li> <li>1.7.6 Ensure permissions on /etc/issue.net are configured</li> <li>1.8.1 Ensure GNOME Display Manager is removed</li> <li>1.8.10 Ensure XDCMP is not enabled</li> <li>1.8.2 Ensure GDM login banner is configured</li> <li>1.8.3 Ensure GDM disable-user-list option is enabled</li> <li>1.8.4 Ensure GDM screen locks when the user is idle</li> <li>1.8.5 Ensure GDM screen locks cannot be overridden</li> <li>1.8.6 Ensure GDM automatic mounting of removable media is disabled</li> <li>1.8.7 Ensure GDM disabling automatic mounting of removable media is not overridden</li> <li>1.8.8 Ensure GDM autorun-never is enabled</li> <li>1.8.9 Ensure GDM autorun-never is not overridden</li> <li>2.4 Ensure nonessential services are removed or masked</li> <li>2.1.1.1 Ensure a single time synchronization daemon is in use</li> <li>2.1.2.1 Ensure chrony is configured with authorized timeserver</li> <li>2.1.2.2 Ensure chrony is running as user _chrony</li> <li>2.1.2.3 Ensure chrony is enabled and running</li> <li>2.1.3.1 Ensure systemd-timesyncd configured with authorized timeserver</li> <li>2.1.3.2 Ensure systemd-timesyncd is enabled and running</li> <li>2.1.4.1 Ensure ntp access control is configured</li> <li>2.1.4.2 Ensure ntp is configured with authorized timeserver</li> <li>2.1.4.3 Ensure ntp is running as user ntp</li> <li>Ensure mounting of cramfs filesystems is disabled</li> <li>2.2.1 Ensure X Window System is not installed</li> <li>2.2.10 Ensure IMAP and POP3 server are not installed</li> <li>2.2.11 Ensure Samba is not installed</li> <li>2.2.12 Ensure HTTP Proxy Server is not installed</li> <li>2.2.13 Ensure SNMP Server is not installed</li> <li>2.2.14 Ensure NIS Server is not installed</li> <li>2.2.15 Ensure mail transfer agent is configured for local-only mode</li> <li>2.2.16 Ensure rsync service is either not installed or masked</li> <li>2.2.2 Ensure Avahi Server is not installed</li> <li>2.2.3 Ensure CUPS is not installed</li> <li>2.2.4 Ensure DHCP Server is not installed</li> <li>2.2.5 Ensure LDAP server is not installed</li> <li>2.2.6 Ensure NFS is not installed</li> <li>2.2.7 Ensure DNS Server is not installed</li> <li>2.2.8 Ensure FTP Server is not installed</li> <li>2.2.9 Ensure HTTP server is not installed</li> <li>2.3.1 Ensure NIS Client is not installed</li> <li>2.3.2 Ensure rsh client is not installed</li> <li>2.3.3 Ensure talk client is not installed</li> <li>2.3.4 Ensure telnet client is not installed</li> <li>2.3.5 Ensure LDAP client is not installed</li> <li>2.3.6 Ensure RPC is not installed</li> <li>3.1.1 Ensure system is checked to determine if IPv6 is enabled</li> <li>3.1.2 Ensure wireless interfaces are disabled</li> <li>3.1.3 Ensure DCCP is disabled</li> <li>3.1.4 Ensure SCTP is disabled</li> <li>3.1.5 Ensure RDS is disabled</li> <li>3.1.6 Ensure TIPC is disabled</li> <li>3.2.1 Ensure packet redirect sending is disabled</li> <li>3.2.2 Ensure IP forwarding is disabled</li> <li>3.3.1 Ensure source routed packets are not accepted</li> <li>3.3.2 Ensure ICMP redirects are not accepted</li> <li>3.3.3 Ensure secure ICMP redirects are not accepted</li> <li>3.3.4 Ensure suspicious packets are logged</li> <li>3.3.5 Ensure broadcast ICMP requests are ignored</li> <li>3.3.6 Ensure bogus ICMP responses are ignored</li> <li>3.3.7 Ensure Reverse Path Filtering is enabled</li> <li>3.3.8 Ensure TCP SYN Cookies is enabled</li> <li>3.3.9 Ensure IPv6 router advertisements are not accepted</li> <li>3.5.1.1 Ensure ufw is installed</li> <li>3.5.1.2 Ensure iptables-persistent is not installed with ufw</li> <li>3.5.1.3 Ensure ufw service is enabled</li> <li>3.5.1.4 Ensure ufw loopback traffic is configured</li> <li>3.5.1.5 Ensure ufw outbound connections are configured</li> <li>3.5.1.6 Ensure ufw firewall rules exist for all open ports</li> <li>3.5.1.7 Ensure ufw default deny firewall policy</li> <li>3.5.2.1 Ensure nftables is installed</li> <li>3.5.2.10 Ensure nftables rules are permanent</li> <li>3.5.2.2 Ensure ufw is uninstalled or disabled with nftables</li> <li>3.5.2.3 Ensure iptables are flushed with nftables</li> <li>3.5.2.4 Ensure a nftables table exists</li> <li>3.5.2.5 Ensure nftables base chains exist</li> <li>3.5.2.6 Ensure nftables loopback traffic is configured</li> <li>3.5.2.7 Ensure nftables outbound and established connections are configured</li> <li>3.5.2.8 Ensure nftables default deny firewall policy</li> <li>3.5.2.9 Ensure nftables service is enabled</li> <li>3.5.3.1.1 Ensure iptables packages are installed</li> <li>3.5.3.1.2 Ensure nftables is not installed with iptables</li> <li>3.5.3.1.3 Ensure ufw is uninstalled or disabled with iptables</li> <li>3.5.3.2.1 Ensure iptables default deny firewall policy</li> <li>3.5.3.2.2 Ensure iptables loopback traffic is configured</li> <li>3.5.3.2.4 Ensure iptables firewall rules exist for all open ports</li> <li>3.5.3.3.1 Ensure ip6tables default deny firewall policy</li> <li>3.5.3.3.2 Ensure ip6tables loopback traffic is configured</li> <li>3.5.3.3.3 Ensure ip6tables outbound and established connections are configured</li> <li>3.5.3.3.4 Ensure ip6tables firewall rules exist for all open ports</li> <li>4.1.1.1 Ensure auditd is installed</li> <li>4.1.1.2 Ensure auditd service is enabled and active</li> <li>4.1.1.3 Ensure auditing for processes that start prior to auditd is enabled</li> <li>4.1.1.4 Ensure audit_backlog_limit is sufficient</li> <li>4.1.2.1 Ensure audit log storage size is configured</li> <li>4.1.2.2 Ensure audit logs are not automatically deleted</li> <li>4.1.2.3 Ensure system is disabled when audit logs are full</li> <li>4.1.3.1 Ensure changes to system administration scope (sudoers) is collected</li> <li>4.1.3.10 Ensure successful file system mounts are collected</li> <li>4.1.3.11 Ensure session initiation information is collected</li> <li>4.1.3.12 Ensure login and logout events are collected</li> <li>4.1.3.13 Ensure file deletion events by users are collected</li> <li>4.1.3.14 Ensure events that modify the system's Mandatory Access Controls are collected</li> <li>4.1.3.15 Ensure successful and unsuccessful attempts to use the chcon command are recorded</li> <li>4.1.3.16 Ensure successful and unsuccessful attempts to use the setfacl command are recorded</li> <li>4.1.3.17 Ensure successful and unsuccessful attempts to use the chacl command are recorde</li> <li>4.1.3.18 Ensure successful and unsuccessful attempts to use the usermod command are recorded</li> <li>4.1.3.19 Ensure kernel module loading unloading and modification is collected</li> <li>4.1.3.2 Ensure actions as another user are always logged</li> <li>4.1.3.20 Ensure the audit configuration is immutable</li> <li>4.1.3.21 Ensure the running and on disk configuration is the same</li> <li>4.1.3.3 Ensure events that modify the sudo log file are collected</li> <li>4.1.3.4 Ensure events that modify date and time information are collected</li> <li>4.1.3.5 Ensure events that modify the system's network environment are collected</li> <li>4.1.3.6 Ensure use of privileged commands are collected</li> <li>4.1.3.7 Ensure unsuccessful file access attempts are collected</li> <li>4.1.3.8 Ensure events that modify user/group information are collected</li> <li>4.1.3.9 Ensure discretionary access control permission modification events are collected</li> <li>4.1.4.1 Ensure audit log files are mode 0640 or less permissive</li> <li>4.1.4.10 Ensure audit tools belong to group root</li> <li>4.1.4.11 Ensure cryptographic mechanisms are used to protect the integrity of audit tool</li> <li>4.1.4.2 Ensure only authorized users own audit log files</li> <li>4.1.4.3 Ensure only authorized groups are assigned ownership of audit log files</li> <li>4.1.4.4 Ensure the audit log directory is 0750 or more restrictive</li> <li>4.1.4.5 Ensure audit configuration files are 640 or more restrictive</li> <li>4.1.4.6 Ensure audit configuration files are owned by root</li> <li>4.1.4.7 Ensure audit configuration files belong to group root</li> <li>4.1.4.8 Ensure audit tools are 755 or more restrictive</li> <li>4.1.4.9 Ensure audit tools are owned by root</li> <li>4.2.3 Ensure all logfiles have appropriate permissions and ownership</li> <li>4.2.1.2 Ensure journald service is enabled</li> <li>4.2.1.3 Ensure journald is configured to compress large log files</li> <li>4.2.1.4 Ensure journald is configured to write logfiles to persistent disk</li> <li>4.2.1.5 Ensure journald is not configured to send logs to rsyslog</li> <li>4.2.1.6 Ensure journald log rotation is configured per site policy</li> <li>4.2.1.7 Ensure journald default file permissions configured</li> <li>4.2.1.1.1 Ensure systemd-journal-remote is installed</li> <li>4.2.1.1.2 Ensure systemd-journal-remote is configured</li> <li>4.2.1.1.3 Ensure systemd-journal-remote is enabled</li> <li>4.2.1.1.4 Ensure journald is not configured to recieve logs from a remote client</li> <li>4.2.2.1 Ensure rsyslog is installed</li> <li>4.2.2.2 Ensure rsyslog service is enabled</li> <li>4.2.2.3 Ensure journald is configured to send logs to rsyslog</li> <li>4.2.2.4 Ensure rsyslog default file permissions are configured</li> <li>4.2.2.5 Ensure logging is configured</li> <li>4.2.2.6 Ensure rsyslog is configured to send logs to a remote log host</li> <li>4.2.2.7 Ensure rsyslog is not configured to receive logs from a remote client</li> <li>5.1.1 Ensure cron daemon is enabled and running</li> <li>5.1.2 Ensure permissions on /etc/crontab are configured</li> <li>5.1.3 Ensure permissions on /etc/cron.hourly are configured</li> <li>5.1.4 Ensure permissions on /etc/cron.daily are configured</li> <li>5.1.5 Ensure permissions on /etc/cron.weekly are configured</li> <li>5.1.6 Ensure permissions on /etc/cron.monthly are configured</li> <li>5.1.7 Ensure permissions on /etc/cron.d are configured</li> <li>5.1.8 Ensure cron is restricted to authorized users</li> <li>5.1.9 Ensure at is restricted to authorized users</li> <li>5.2.1 Ensure permissions on /etc/ssh/sshd_config are configured</li> <li>5.2.10 Ensure SSH PermitUserEnvironment is disabled</li> <li>5.2.11 Ensure SSH IgnoreRhosts is enabled</li> <li>5.2.12 Ensure SSH X11 forwarding is disabled</li> <li>5.2.13 Ensure only strong Ciphers are used</li> <li>5.2.14 Ensure only strong MAC algorithms are used</li> <li>5.2.15 Ensure only strong Key Exchange algorithms are used</li> <li>5.2.16 Ensure SSH AllowTcpForwarding is disabled</li> <li>5.2.17 Ensure SSH warning banner is configured</li> <li>5.2.18 Ensure SSH MaxAuthTries is set to 4 or less</li> <li>5.2.19 Ensure SSH MaxStartups is configured</li> <li>5.2.2 Ensure permissions on SSH private host key files are configured</li> <li>5.2.20 Ensure SSH MaxSessions is set to 10 or less</li> <li>5.2.21 Ensure SSH LoginGraceTime is set to one minute or less</li> <li>5.2.22 Ensure SSH Idle Timeout Interval is configured</li> <li>5.2.3 Ensure permissions on SSH public host key files are configured</li> <li>5.2.4 Ensure SSH access is limited</li> <li>5.2.5 Ensure SSH LogLevel is appropriate</li> <li>5.2.6 Ensure SSH PAM is enabled</li> <li>5.2.7 Ensure SSH root login is disabled</li> <li>5.2.8 Ensure SSH HostbasedAuthentication is disabled</li> <li>5.2.9 Ensure SSH PermitEmptyPasswords is disabled</li> <li>5.3.1 Ensure sudo is installed</li> <li>5.3.2 Ensure sudo commands use pty</li> <li>5.3.3 Ensure sudo log file exists</li> <li>5.3.4 Ensure users must provide password for privilege escalation</li> <li>5.3.5 Ensure re-authentication for privilege escalation is not disabled globally</li> <li>5.3.6 Ensure sudo authentication timeout is configured correctly</li> <li>5.3.7 Ensure access to the su command is restricted</li> <li>5.4.1 Ensure password creation requirements are configured</li> <li>5.4.2 Ensure lockout for failed password attempts is configured</li> <li>5.4.3 Ensure password reuse is limited</li> <li>5.4.4 Ensure password hashing algorithm is up to date with the latest standards</li> <li>5.5.2 Ensure system accounts are secured</li> <li>5.5.3 Ensure default group for the root account is GID 0</li> <li>5.5.4 Ensure default user umask is 027 or more restrictive</li> <li>5.5.5 Ensure default user shell timeout is 900 seconds or less</li> <li>5.5.1.1 Ensure minimum days between password changes is configured</li> <li>5.5.1.2 Ensure password expiration is 365 days or less</li> <li>5.5.1.3 Ensure password expiration warning days is 7 or more</li> <li>5.5.1.4 Ensure inactive password lock is 30 days or less</li> <li>5.5.1.5 Ensure all users last password change date is in the past</li> <li>6.1.1 Ensure permissions on /etc/passwd are configured</li> <li>6.1.10 Ensure no unowned files or directories exist</li> <li>6.1.11 Ensure no ungrouped files or directories exist</li> <li>6.1.12 Audit SUID executables</li> <li>6.1.13 Audit SGID executables</li> <li>6.1.2 Ensure permissions on /etc/passwd- are configured</li> <li>6.1.3 Ensure permissions on /etc/group are configured</li> <li>6.1.4 Ensure permissions on /etc/group- are configured</li> <li>6.1.5 Ensure permissions on /etc/shadow are configured</li> <li>6.1.6 Ensure permissions on /etc/shadow- are configured</li> <li>6.1.7 Ensure permissions on /etc/gshadow are configured</li> <li>E6.1.8 Ensure permissions on /etc/gshadow- are configured</li> <li>6.1.9 Ensure no world writable files exist</li> <li>6.2.1 Ensure accounts in /etc/passwd use shadowed passwords</li> <li>6.2.10 Ensure root is the only UID 0 account</li> <li>6.2.11 Ensure local interactive user home directories exist</li> <li>6.2.12 Ensure local interactive users own their home directories</li> <li>6.2.13 Ensure local interactive user home directories are mode 750 or more restrictive</li> <li>6.2.14 Ensure no local interactive user has .netrc files</li> <li>6.2.15 Ensure no local interactive user has .forward files</li> <li>6.2.16 Ensue no local interactive user has .rhosts files</li> <li>6.2.17 Ensure local interactive user dot files are not group or world writable</li> <li>6.2.2 Ensure /etc/shadow password fields are not empty</li> <li>6.2.3 Ensure all groups in /etc/passwd exist in /etc/group</li> <li>6.2.4 Ensure shadow group is empty</li> <li>6.2.5 Ensure no duplicate UIDs exist</li> <li>6.2.6 Ensure no duplicate GIDs exist</li> <li>6.2.7 Ensure no duplicate user names exist</li> <li>6.2.8 Ensure no duplicate group names exist</li> <li>6.2.9 Ensure root PATH Integrity</li> </ul>"},{"location":"tags/#service-clients","title":"Service Clients","text":"<ul> <li>2.3.1 Ensure NIS Client is not installed</li> <li>2.3.2 Ensure rsh client is not installed</li> <li>2.3.3 Ensure talk client is not installed</li> <li>2.3.4 Ensure telnet client is not installed</li> <li>2.3.5 Ensure LDAP client is not installed</li> <li>2.3.6 Ensure RPC is not installed</li> </ul>"},{"location":"tags/#services","title":"Services","text":"<ul> <li>2.4 Ensure nonessential services are removed or masked</li> <li>2.1.1.1 Ensure a single time synchronization daemon is in use</li> <li>2.1.2.1 Ensure chrony is configured with authorized timeserver</li> <li>2.1.2.2 Ensure chrony is running as user _chrony</li> <li>2.1.2.3 Ensure chrony is enabled and running</li> <li>2.1.3.1 Ensure systemd-timesyncd configured with authorized timeserver</li> <li>2.1.3.2 Ensure systemd-timesyncd is enabled and running</li> <li>2.1.4.1 Ensure ntp access control is configured</li> <li>2.1.4.2 Ensure ntp is configured with authorized timeserver</li> <li>2.1.4.3 Ensure ntp is running as user ntp</li> <li>Ensure mounting of cramfs filesystems is disabled</li> <li>2.2.1 Ensure X Window System is not installed</li> <li>2.2.10 Ensure IMAP and POP3 server are not installed</li> <li>2.2.11 Ensure Samba is not installed</li> <li>2.2.12 Ensure HTTP Proxy Server is not installed</li> <li>2.2.13 Ensure SNMP Server is not installed</li> <li>2.2.14 Ensure NIS Server is not installed</li> <li>2.2.15 Ensure mail transfer agent is configured for local-only mode</li> <li>2.2.16 Ensure rsync service is either not installed or masked</li> <li>2.2.2 Ensure Avahi Server is not installed</li> <li>2.2.3 Ensure CUPS is not installed</li> <li>2.2.4 Ensure DHCP Server is not installed</li> <li>2.2.5 Ensure LDAP server is not installed</li> <li>2.2.6 Ensure NFS is not installed</li> <li>2.2.7 Ensure DNS Server is not installed</li> <li>2.2.8 Ensure FTP Server is not installed</li> <li>2.2.9 Ensure HTTP server is not installed</li> <li>2.3.1 Ensure NIS Client is not installed</li> <li>2.3.2 Ensure rsh client is not installed</li> <li>2.3.3 Ensure talk client is not installed</li> <li>2.3.4 Ensure telnet client is not installed</li> <li>2.3.5 Ensure LDAP client is not installed</li> <li>2.3.6 Ensure RPC is not installed</li> </ul>"},{"location":"tags/#set-shadow-password-suite-parameters","title":"Set Shadow Password Suite Parameters","text":"<ul> <li>5.5.1.1 Ensure minimum days between password changes is configured</li> <li>5.5.1.2 Ensure password expiration is 365 days or less</li> <li>5.5.1.3 Ensure password expiration warning days is 7 or more</li> <li>5.5.1.4 Ensure inactive password lock is 30 days or less</li> <li>5.5.1.5 Ensure all users last password change date is in the past</li> </ul>"},{"location":"tags/#special-purpose-services","title":"Special Purpose Services","text":"<ul> <li>2.2.1 Ensure X Window System is not installed</li> <li>2.2.10 Ensure IMAP and POP3 server are not installed</li> <li>2.2.11 Ensure Samba is not installed</li> <li>2.2.12 Ensure HTTP Proxy Server is not installed</li> <li>2.2.13 Ensure SNMP Server is not installed</li> <li>2.2.14 Ensure NIS Server is not installed</li> <li>2.2.15 Ensure mail transfer agent is configured for local-only mode</li> <li>2.2.16 Ensure rsync service is either not installed or masked</li> <li>2.2.2 Ensure Avahi Server is not installed</li> <li>2.2.3 Ensure CUPS is not installed</li> <li>2.2.4 Ensure DHCP Server is not installed</li> <li>2.2.5 Ensure LDAP server is not installed</li> <li>2.2.6 Ensure NFS is not installed</li> <li>2.2.7 Ensure DNS Server is not installed</li> <li>2.2.8 Ensure FTP Server is not installed</li> <li>2.2.9 Ensure HTTP server is not installed</li> </ul>"},{"location":"tags/#system-file-permissions","title":"System File Permissions","text":"<ul> <li>6.1.1 Ensure permissions on /etc/passwd are configured</li> <li>6.1.10 Ensure no unowned files or directories exist</li> <li>6.1.11 Ensure no ungrouped files or directories exist</li> <li>6.1.12 Audit SUID executables</li> <li>6.1.13 Audit SGID executables</li> <li>6.1.2 Ensure permissions on /etc/passwd- are configured</li> <li>6.1.3 Ensure permissions on /etc/group are configured</li> <li>6.1.4 Ensure permissions on /etc/group- are configured</li> <li>6.1.5 Ensure permissions on /etc/shadow are configured</li> <li>6.1.6 Ensure permissions on /etc/shadow- are configured</li> <li>6.1.7 Ensure permissions on /etc/gshadow are configured</li> <li>E6.1.8 Ensure permissions on /etc/gshadow- are configured</li> <li>6.1.9 Ensure no world writable files exist</li> </ul>"},{"location":"tags/#system-maintenance","title":"System Maintenance","text":"<ul> <li>6.1.1 Ensure permissions on /etc/passwd are configured</li> <li>6.1.10 Ensure no unowned files or directories exist</li> <li>6.1.11 Ensure no ungrouped files or directories exist</li> <li>6.1.12 Audit SUID executables</li> <li>6.1.13 Audit SGID executables</li> <li>6.1.2 Ensure permissions on /etc/passwd- are configured</li> <li>6.1.3 Ensure permissions on /etc/group are configured</li> <li>6.1.4 Ensure permissions on /etc/group- are configured</li> <li>6.1.5 Ensure permissions on /etc/shadow are configured</li> <li>6.1.6 Ensure permissions on /etc/shadow- are configured</li> <li>6.1.7 Ensure permissions on /etc/gshadow are configured</li> <li>E6.1.8 Ensure permissions on /etc/gshadow- are configured</li> <li>6.1.9 Ensure no world writable files exist</li> <li>6.2.1 Ensure accounts in /etc/passwd use shadowed passwords</li> <li>6.2.10 Ensure root is the only UID 0 account</li> <li>6.2.11 Ensure local interactive user home directories exist</li> <li>6.2.12 Ensure local interactive users own their home directories</li> <li>6.2.13 Ensure local interactive user home directories are mode 750 or more restrictive</li> <li>6.2.14 Ensure no local interactive user has .netrc files</li> <li>6.2.15 Ensure no local interactive user has .forward files</li> <li>6.2.16 Ensue no local interactive user has .rhosts files</li> <li>6.2.17 Ensure local interactive user dot files are not group or world writable</li> <li>6.2.2 Ensure /etc/shadow password fields are not empty</li> <li>6.2.3 Ensure all groups in /etc/passwd exist in /etc/group</li> <li>6.2.4 Ensure shadow group is empty</li> <li>6.2.5 Ensure no duplicate UIDs exist</li> <li>6.2.6 Ensure no duplicate GIDs exist</li> <li>6.2.7 Ensure no duplicate user names exist</li> <li>6.2.8 Ensure no duplicate group names exist</li> <li>6.2.9 Ensure root PATH Integrity</li> </ul>"},{"location":"tags/#t1003","title":"T1003","text":"<ul> <li>5.4.4 Ensure password hashing algorithm is up to date with the latest standards</li> <li>6.1.1 Ensure permissions on /etc/passwd are configured</li> <li>6.1.2 Ensure permissions on /etc/passwd- are configured</li> <li>6.1.3 Ensure permissions on /etc/group are configured</li> <li>6.1.4 Ensure permissions on /etc/group- are configured</li> <li>6.1.5 Ensure permissions on /etc/shadow are configured</li> <li>6.1.6 Ensure permissions on /etc/shadow- are configured</li> <li>6.1.7 Ensure permissions on /etc/gshadow are configured</li> <li>E6.1.8 Ensure permissions on /etc/gshadow- are configured</li> <li>6.2.1 Ensure accounts in /etc/passwd use shadowed passwords</li> <li>6.2.4 Ensure shadow group is empty</li> </ul>"},{"location":"tags/#t1003008","title":"T1003.008","text":"<ul> <li>5.4.4 Ensure password hashing algorithm is up to date with the latest standards</li> <li>6.1.1 Ensure permissions on /etc/passwd are configured</li> <li>6.1.2 Ensure permissions on /etc/passwd- are configured</li> <li>6.1.3 Ensure permissions on /etc/group are configured</li> <li>6.1.4 Ensure permissions on /etc/group- are configured</li> <li>6.1.5 Ensure permissions on /etc/shadow are configured</li> <li>6.1.6 Ensure permissions on /etc/shadow- are configured</li> <li>6.1.7 Ensure permissions on /etc/gshadow are configured</li> <li>E6.1.8 Ensure permissions on /etc/gshadow- are configured</li> <li>6.2.1 Ensure accounts in /etc/passwd use shadowed passwords</li> <li>6.2.4 Ensure shadow group is empty</li> </ul>"},{"location":"tags/#t1005","title":"T1005","text":"<ul> <li>1.1.10 Disable USB Storage</li> <li>1.1.1.1 Ensure mounting of cramfs filesystems is disabled</li> <li>1.1.1.2 Ensure mounting of squashfs filesystems is disabled</li> <li>1.1.1.3 Ensure mounting of udf filesystems is disabled</li> <li>1.1.5.2 Ensure nodev option set on /var/log partition</li> <li>1.5.4 Ensure core dumps are restricted</li> <li>2.2.11 Ensure Samba is not installed</li> <li>4.2.2.1 Ensure rsyslog is installed</li> </ul>"},{"location":"tags/#t1011","title":"T1011","text":"<ul> <li>3.1.2 Ensure wireless interfaces are disabled</li> </ul>"},{"location":"tags/#t1018","title":"T1018","text":"<ul> <li>1.7.3 Ensure remote login warning banner is configured properly</li> <li>2.2.15 Ensure mail transfer agent is configured for local-only mode</li> </ul>"},{"location":"tags/#t1021","title":"T1021","text":"<ul> <li>5.2.10 Ensure SSH PermitUserEnvironment is disabled</li> <li>5.2.4 Ensure SSH access is limited</li> <li>5.2.6 Ensure SSH PAM is enabled</li> <li>5.2.7 Ensure SSH root login is disabled</li> <li>5.2.9 Ensure SSH PermitEmptyPasswords is disabled</li> </ul>"},{"location":"tags/#t1021004","title":"T1021.004","text":"<ul> <li>5.2.4 Ensure SSH access is limited</li> <li>5.2.6 Ensure SSH PAM is enabled</li> </ul>"},{"location":"tags/#t1036","title":"T1036","text":"<ul> <li>1.3.1 Ensure AIDE is installed</li> <li>1.3.2 Ensure filesystem integrity is regularly checked</li> </ul>"},{"location":"tags/#t1036002","title":"T1036.002","text":"<ul> <li>1.3.1 Ensure AIDE is installed</li> <li>1.3.2 Ensure filesystem integrity is regularly checked</li> </ul>"},{"location":"tags/#t1036003","title":"T1036.003","text":"<ul> <li>1.3.1 Ensure AIDE is installed</li> <li>1.3.2 Ensure filesystem integrity is regularly checked</li> </ul>"},{"location":"tags/#t1036005","title":"T1036.005","text":"<ul> <li>1.3.1 Ensure AIDE is installed</li> <li>1.3.2 Ensure filesystem integrity is regularly checked</li> </ul>"},{"location":"tags/#t1039","title":"T1039","text":"<ul> <li>2.2.11 Ensure Samba is not installed</li> </ul>"},{"location":"tags/#t1040","title":"T1040","text":"<ul> <li>1.8.10 Ensure XDCMP is not enabled</li> <li>2.3.2 Ensure rsh client is not installed</li> <li>2.3.4 Ensure telnet client is not installed</li> <li>5.2.13 Ensure only strong Ciphers are used</li> <li>5.2.14 Ensure only strong MAC algorithms are used</li> <li>5.2.15 Ensure only strong Key Exchange algorithms are used</li> </ul>"},{"location":"tags/#t1048","title":"T1048","text":"<ul> <li>5.2.16 Ensure SSH AllowTcpForwarding is disabled</li> </ul>"},{"location":"tags/#t1048002","title":"T1048.002","text":"<ul> <li>5.2.16 Ensure SSH AllowTcpForwarding is disabled</li> </ul>"},{"location":"tags/#t1049","title":"T1049","text":"<ul> <li>6.2.16 Ensue no local interactive user has .rhosts files</li> </ul>"},{"location":"tags/#t1053","title":"T1053","text":"<ul> <li>5.1.2 Ensure permissions on /etc/crontab are configured</li> <li>5.1.3 Ensure permissions on /etc/cron.hourly are configured</li> <li>5.1.4 Ensure permissions on /etc/cron.daily are configured</li> <li>5.1.5 Ensure permissions on /etc/cron.weekly are configured</li> <li>5.1.6 Ensure permissions on /etc/cron.monthly are configured</li> <li>5.1.7 Ensure permissions on /etc/cron.d are configured</li> <li>5.1.8 Ensure cron is restricted to authorized users</li> <li>5.1.9 Ensure at is restricted to authorized users</li> </ul>"},{"location":"tags/#t1053003","title":"T1053.003","text":"<ul> <li>5.1.2 Ensure permissions on /etc/crontab are configured</li> <li>5.1.3 Ensure permissions on /etc/cron.hourly are configured</li> <li>5.1.4 Ensure permissions on /etc/cron.daily are configured</li> <li>5.1.5 Ensure permissions on /etc/cron.weekly are configured</li> <li>5.1.6 Ensure permissions on /etc/cron.monthly are configured</li> <li>5.1.7 Ensure permissions on /etc/cron.d are configured</li> <li>5.1.8 Ensure cron is restricted to authorized users</li> <li>5.1.9 Ensure at is restricted to authorized users</li> </ul>"},{"location":"tags/#t1055","title":"T1055","text":"<ul> <li>1.5.2 Ensure prelink is not installed</li> </ul>"},{"location":"tags/#t1055001","title":"T1055.001","text":"<ul> <li>1.5.2 Ensure prelink is not installed</li> </ul>"},{"location":"tags/#t1055009","title":"T1055.009","text":"<ul> <li>1.5.2 Ensure prelink is not installed</li> </ul>"},{"location":"tags/#t1056","title":"T1056","text":"<ul> <li>1.8.10 Ensure XDCMP is not enabled</li> </ul>"},{"location":"tags/#t1056001","title":"T1056.001","text":"<ul> <li>1.8.10 Ensure XDCMP is not enabled</li> </ul>"},{"location":"tags/#t1065","title":"T1065","text":"<ul> <li>1.5.2 Ensure prelink is not installed</li> </ul>"},{"location":"tags/#t1068","title":"T1068","text":"<ul> <li>1.1.9 Disable Automounting</li> <li>1.2.1 Ensure package manager repositories are configured</li> <li>1.5.1 Ensure address space layout randomization (ASLR) is enabled</li> <li>1.6.1.1 Ensure AppArmor is installed</li> <li>1.6.1.2 Ensure AppArmor is enabled in the bootloader configuration</li> <li>1.6.1.4 Ensure all AppArmor Profiles are enforcing</li> <li>3.1.3 Ensure DCCP is disabled</li> <li>3.1.4 Ensure SCTP is disabled</li> <li>3.1.5 Ensure RDS is disabled</li> <li>3.1.6 Ensure TIPC is disabled</li> </ul>"},{"location":"tags/#t1070","title":"T1070","text":"<ul> <li>2.1.1.1 Ensure a single time synchronization daemon is in use</li> <li>2.1.2.1 Ensure chrony is configured with authorized timeserver</li> <li>2.1.3.1 Ensure systemd-timesyncd configured with authorized timeserver</li> <li>2.1.4.2 Ensure ntp is configured with authorized timeserver</li> <li>4.1.4.1 Ensure audit log files are mode 0640 or less permissive</li> <li>4.1.4.10 Ensure audit tools belong to group root</li> <li>4.1.4.11 Ensure cryptographic mechanisms are used to protect the integrity of audit tool</li> <li>4.1.4.2 Ensure only authorized users own audit log files</li> <li>4.1.4.3 Ensure only authorized groups are assigned ownership of audit log files</li> <li>4.1.4.4 Ensure the audit log directory is 0750 or more restrictive</li> <li>4.1.4.5 Ensure audit configuration files are 640 or more restrictive</li> <li>4.1.4.6 Ensure audit configuration files are owned by root</li> <li>4.1.4.7 Ensure audit configuration files belong to group root</li> <li>4.1.4.8 Ensure audit tools are 755 or more restrictive</li> <li>4.1.4.9 Ensure audit tools are owned by root</li> <li>4.2.3 Ensure all logfiles have appropriate permissions and ownership</li> <li>4.2.1.2 Ensure journald service is enabled</li> <li>4.2.1.4 Ensure journald is configured to write logfiles to persistent disk</li> <li>4.2.1.5 Ensure journald is not configured to send logs to rsyslog</li> <li>4.2.1.6 Ensure journald log rotation is configured per site policy</li> <li>4.2.1.7 Ensure journald default file permissions configured</li> <li>4.2.1.1.1 Ensure systemd-journal-remote is installed</li> <li>4.2.1.1.2 Ensure systemd-journal-remote is configured</li> <li>4.2.1.1.3 Ensure systemd-journal-remote is enabled</li> <li>4.2.1.1.4 Ensure journald is not configured to recieve logs from a remote client</li> <li>4.2.2.1 Ensure rsyslog is installed</li> <li>4.2.2.2 Ensure rsyslog service is enabled</li> <li>4.2.2.4 Ensure rsyslog default file permissions are configured</li> <li>4.2.2.5 Ensure logging is configured</li> <li>4.2.2.6 Ensure rsyslog is configured to send logs to a remote log host</li> <li>4.2.2.7 Ensure rsyslog is not configured to receive logs from a remote client</li> </ul>"},{"location":"tags/#t1070002","title":"T1070.002","text":"<ul> <li>2.1.1.1 Ensure a single time synchronization daemon is in use</li> <li>2.1.2.1 Ensure chrony is configured with authorized timeserver</li> <li>2.1.3.1 Ensure systemd-timesyncd configured with authorized timeserver</li> <li>2.1.4.2 Ensure ntp is configured with authorized timeserver</li> <li>4.1.4.1 Ensure audit log files are mode 0640 or less permissive</li> <li>4.1.4.10 Ensure audit tools belong to group root</li> <li>4.1.4.11 Ensure cryptographic mechanisms are used to protect the integrity of audit tool</li> <li>4.1.4.2 Ensure only authorized users own audit log files</li> <li>4.1.4.3 Ensure only authorized groups are assigned ownership of audit log files</li> <li>4.1.4.4 Ensure the audit log directory is 0750 or more restrictive</li> <li>4.1.4.5 Ensure audit configuration files are 640 or more restrictive</li> <li>4.1.4.6 Ensure audit configuration files are owned by root</li> <li>4.1.4.7 Ensure audit configuration files belong to group root</li> <li>4.1.4.8 Ensure audit tools are 755 or more restrictive</li> <li>4.1.4.9 Ensure audit tools are owned by root</li> <li>4.2.3 Ensure all logfiles have appropriate permissions and ownership</li> <li>4.2.1.2 Ensure journald service is enabled</li> <li>4.2.1.4 Ensure journald is configured to write logfiles to persistent disk</li> <li>4.2.1.5 Ensure journald is not configured to send logs to rsyslog</li> <li>4.2.1.6 Ensure journald log rotation is configured per site policy</li> <li>4.2.1.7 Ensure journald default file permissions configured</li> <li>4.2.1.1.1 Ensure systemd-journal-remote is installed</li> <li>4.2.1.1.2 Ensure systemd-journal-remote is configured</li> <li>4.2.1.1.3 Ensure systemd-journal-remote is enabled</li> <li>4.2.1.1.4 Ensure journald is not configured to recieve logs from a remote client</li> <li>4.2.2.1 Ensure rsyslog is installed</li> <li>4.2.2.2 Ensure rsyslog service is enabled</li> <li>4.2.2.4 Ensure rsyslog default file permissions are configured</li> <li>4.2.2.5 Ensure logging is configured</li> <li>4.2.2.6 Ensure rsyslog is configured to send logs to a remote log host</li> <li>4.2.2.7 Ensure rsyslog is not configured to receive logs from a remote client</li> </ul>"},{"location":"tags/#t1078","title":"T1078","text":"<ul> <li>1.8.3 Ensure GDM disable-user-list option is enabled</li> <li>5.2.11 Ensure SSH IgnoreRhosts is enabled</li> <li>5.2.22 Ensure SSH Idle Timeout Interval is configured</li> <li>5.2.8 Ensure SSH HostbasedAuthentication is disabled</li> <li>5.3.1 Ensure sudo is installed</li> <li>5.4.1 Ensure password creation requirements are configured</li> <li>5.4.3 Ensure password reuse is limited</li> <li>5.5.2 Ensure system accounts are secured</li> <li>5.5.5 Ensure default user shell timeout is 900 seconds or less</li> <li>5.5.1.1 Ensure minimum days between password changes is configured</li> <li>5.5.1.2 Ensure password expiration is 365 days or less</li> <li>5.5.1.4 Ensure inactive password lock is 30 days or less</li> <li>5.5.1.5 Ensure all users last password change date is in the past</li> <li>6.2.2 Ensure /etc/shadow password fields are not empty</li> <li>6.2.5 Ensure no duplicate UIDs exist</li> <li>6.2.6 Ensure no duplicate GIDs exist</li> <li>6.2.7 Ensure no duplicate user names exist</li> <li>6.2.8 Ensure no duplicate group names exist</li> </ul>"},{"location":"tags/#t1078001","title":"T1078.001","text":"<ul> <li>1.8.3 Ensure GDM disable-user-list option is enabled</li> <li>5.2.11 Ensure SSH IgnoreRhosts is enabled</li> <li>5.2.22 Ensure SSH Idle Timeout Interval is configured</li> <li>5.2.8 Ensure SSH HostbasedAuthentication is disabled</li> <li>5.4.1 Ensure password creation requirements are configured</li> <li>5.4.3 Ensure password reuse is limited</li> <li>5.5.2 Ensure system accounts are secured</li> <li>5.5.5 Ensure default user shell timeout is 900 seconds or less</li> <li>5.5.1.1 Ensure minimum days between password changes is configured</li> <li>5.5.1.2 Ensure password expiration is 365 days or less</li> <li>5.5.1.5 Ensure all users last password change date is in the past</li> <li>6.2.2 Ensure /etc/shadow password fields are not empty</li> <li>6.2.5 Ensure no duplicate UIDs exist</li> <li>6.2.6 Ensure no duplicate GIDs exist</li> <li>6.2.7 Ensure no duplicate user names exist</li> <li>6.2.8 Ensure no duplicate group names exist</li> </ul>"},{"location":"tags/#t1078002","title":"T1078.002","text":"<ul> <li>1.8.3 Ensure GDM disable-user-list option is enabled</li> <li>5.2.22 Ensure SSH Idle Timeout Interval is configured</li> <li>5.4.1 Ensure password creation requirements are configured</li> <li>5.4.3 Ensure password reuse is limited</li> <li>5.5.5 Ensure default user shell timeout is 900 seconds or less</li> <li>5.5.1.1 Ensure minimum days between password changes is configured</li> <li>5.5.1.2 Ensure password expiration is 365 days or less</li> <li>5.5.1.4 Ensure inactive password lock is 30 days or less</li> <li>5.5.1.5 Ensure all users last password change date is in the past</li> </ul>"},{"location":"tags/#t1078003","title":"T1078.003","text":"<ul> <li>1.8.3 Ensure GDM disable-user-list option is enabled</li> <li>5.2.11 Ensure SSH IgnoreRhosts is enabled</li> <li>5.2.22 Ensure SSH Idle Timeout Interval is configured</li> <li>5.2.8 Ensure SSH HostbasedAuthentication is disabled</li> <li>5.3.1 Ensure sudo is installed</li> <li>5.4.1 Ensure password creation requirements are configured</li> <li>5.4.3 Ensure password reuse is limited</li> <li>5.5.2 Ensure system accounts are secured</li> <li>5.5.5 Ensure default user shell timeout is 900 seconds or less</li> <li>5.5.1.1 Ensure minimum days between password changes is configured</li> <li>5.5.1.2 Ensure password expiration is 365 days or less</li> <li>5.5.1.4 Ensure inactive password lock is 30 days or less</li> <li>5.5.1.5 Ensure all users last password change date is in the past</li> <li>6.2.2 Ensure /etc/shadow password fields are not empty</li> <li>6.2.5 Ensure no duplicate UIDs exist</li> <li>6.2.6 Ensure no duplicate GIDs exist</li> <li>6.2.7 Ensure no duplicate user names exist</li> <li>6.2.8 Ensure no duplicate group names exist</li> </ul>"},{"location":"tags/#t1078004","title":"T1078.004","text":"<ul> <li>5.4.1 Ensure password creation requirements are configured</li> <li>5.4.3 Ensure password reuse is limited</li> <li>5.5.1.1 Ensure minimum days between password changes is configured</li> <li>5.5.1.2 Ensure password expiration is 365 days or less</li> <li>5.5.1.5 Ensure all users last password change date is in the past</li> </ul>"},{"location":"tags/#t1082","title":"T1082","text":"<ul> <li>1.7.1 Ensure message of the day is configured properly</li> <li>1.7.2 Ensure local login warning banner is configured properly</li> <li>1.7.3 Ensure remote login warning banner is configured properly</li> </ul>"},{"location":"tags/#t1083","title":"T1083","text":"<ul> <li>2.2.11 Ensure Samba is not installed</li> <li>4.1.4.1 Ensure audit log files are mode 0640 or less permissive</li> <li>4.1.4.10 Ensure audit tools belong to group root</li> <li>4.1.4.11 Ensure cryptographic mechanisms are used to protect the integrity of audit tool</li> <li>4.1.4.2 Ensure only authorized users own audit log files</li> <li>4.1.4.3 Ensure only authorized groups are assigned ownership of audit log files</li> <li>4.1.4.4 Ensure the audit log directory is 0750 or more restrictive</li> <li>4.1.4.5 Ensure audit configuration files are 640 or more restrictive</li> <li>4.1.4.6 Ensure audit configuration files are owned by root</li> <li>4.1.4.7 Ensure audit configuration files belong to group root</li> <li>4.1.4.8 Ensure audit tools are 755 or more restrictive</li> <li>4.1.4.9 Ensure audit tools are owned by root</li> <li>4.2.3 Ensure all logfiles have appropriate permissions and ownership</li> <li>4.2.1.7 Ensure journald default file permissions configured</li> <li>4.2.2.4 Ensure rsyslog default file permissions are configured</li> </ul>"},{"location":"tags/#t1087","title":"T1087","text":"<ul> <li>1.8.3 Ensure GDM disable-user-list option is enabled</li> </ul>"},{"location":"tags/#t1087001","title":"T1087.001","text":"<ul> <li>1.8.3 Ensure GDM disable-user-list option is enabled</li> </ul>"},{"location":"tags/#t1087002","title":"T1087.002","text":"<ul> <li>1.8.3 Ensure GDM disable-user-list option is enabled</li> </ul>"},{"location":"tags/#t1091","title":"T1091","text":"<ul> <li>1.8.8 Ensure GDM autorun-never is enabled</li> <li>1.8.9 Ensure GDM autorun-never is not overridden</li> </ul>"},{"location":"tags/#t1098","title":"T1098","text":"<ul> <li>5.2.1 Ensure permissions on /etc/ssh/sshd_config are configured</li> </ul>"},{"location":"tags/#t1098004","title":"T1098.004","text":"<ul> <li>5.2.1 Ensure permissions on /etc/ssh/sshd_config are configured</li> </ul>"},{"location":"tags/#t1105","title":"T1105","text":"<ul> <li>2.2.16 Ensure rsync service is either not installed or masked</li> </ul>"},{"location":"tags/#t1110","title":"T1110","text":"<ul> <li>5.2.18 Ensure SSH MaxAuthTries is set to 4 or less</li> <li>5.2.21 Ensure SSH LoginGraceTime is set to one minute or less</li> <li>5.4.1 Ensure password creation requirements are configured</li> <li>5.4.2 Ensure lockout for failed password attempts is configured</li> <li>5.4.3 Ensure password reuse is limited</li> <li>5.4.4 Ensure password hashing algorithm is up to date with the latest standards</li> <li>5.5.1.1 Ensure minimum days between password changes is configured</li> <li>5.5.1.2 Ensure password expiration is 365 days or less</li> <li>5.5.1.5 Ensure all users last password change date is in the past</li> </ul>"},{"location":"tags/#t1110001","title":"T1110.001","text":"<ul> <li>5.2.18 Ensure SSH MaxAuthTries is set to 4 or less</li> <li>5.4.1 Ensure password creation requirements are configured</li> <li>5.4.2 Ensure lockout for failed password attempts is configured</li> <li>5.5.1.2 Ensure password expiration is 365 days or less</li> <li>5.5.1.5 Ensure all users last password change date is in the past</li> </ul>"},{"location":"tags/#t1110002","title":"T1110.002","text":"<ul> <li>5.4.1 Ensure password creation requirements are configured</li> <li>5.4.4 Ensure password hashing algorithm is up to date with the latest standards</li> <li>5.5.1.2 Ensure password expiration is 365 days or less</li> <li>5.5.1.5 Ensure all users last password change date is in the past</li> </ul>"},{"location":"tags/#t1110003","title":"T1110.003","text":"<ul> <li>5.2.18 Ensure SSH MaxAuthTries is set to 4 or less</li> <li>5.2.21 Ensure SSH LoginGraceTime is set to one minute or less</li> <li>5.4.1 Ensure password creation requirements are configured</li> <li>5.4.2 Ensure lockout for failed password attempts is configured</li> <li>5.5.1.2 Ensure password expiration is 365 days or less</li> <li>5.5.1.5 Ensure all users last password change date is in the past</li> </ul>"},{"location":"tags/#t1110004","title":"T1110.004","text":"<ul> <li>5.2.21 Ensure SSH LoginGraceTime is set to one minute or less</li> <li>5.4.3 Ensure password reuse is limited</li> <li>5.5.1.1 Ensure minimum days between password changes is configured</li> <li>5.5.1.2 Ensure password expiration is 365 days or less</li> <li>5.5.1.5 Ensure all users last password change date is in the past</li> </ul>"},{"location":"tags/#t1114","title":"T1114","text":"<ul> <li>6.2.15 Ensure no local interactive user has .forward files</li> </ul>"},{"location":"tags/#t1114003","title":"T1114.003","text":"<ul> <li>6.2.15 Ensure no local interactive user has .forward files</li> </ul>"},{"location":"tags/#t1135","title":"T1135","text":"<ul> <li>2.2.11 Ensure Samba is not installed</li> </ul>"},{"location":"tags/#t1152","title":"T1152","text":"<ul> <li>6.2.14 Ensure no local interactive user has .netrc files</li> <li>6.2.17 Ensure local interactive user dot files are not group or world writable</li> </ul>"},{"location":"tags/#t1152001","title":"T1152.001","text":"<ul> <li>6.2.14 Ensure no local interactive user has .netrc files</li> </ul>"},{"location":"tags/#t1152003","title":"T1152.003","text":"<ul> <li>6.2.17 Ensure local interactive user dot files are not group or world writable</li> </ul>"},{"location":"tags/#t1152004","title":"T1152.004","text":"<ul> <li>6.2.17 Ensure local interactive user dot files are not group or world writable</li> </ul>"},{"location":"tags/#t1195","title":"T1195","text":"<ul> <li>1.2.1 Ensure package manager repositories are configured</li> <li>1.2.2 Ensure GPG keys are configured</li> </ul>"},{"location":"tags/#t1195001","title":"T1195.001","text":"<ul> <li>1.2.1 Ensure package manager repositories are configured</li> <li>1.2.2 Ensure GPG keys are configured</li> </ul>"},{"location":"tags/#t1195002","title":"T1195.002","text":"<ul> <li>1.2.1 Ensure package manager repositories are configured</li> <li>1.2.2 Ensure GPG keys are configured</li> </ul>"},{"location":"tags/#t1200","title":"T1200","text":"<ul> <li>1.1.2.2 Ensure nodev option set on /tmp partition</li> <li>1.1.3.2 Ensure nodev option set on /var partition</li> <li>1.1.4.4 Ensure nodev option set on /var/tmp partition</li> <li>1.1.5.1 Ensure separate partition exists for /var/log</li> <li>1.1.6.3 Ensure nodev option set on /var/log/audit partition</li> <li>1.1.7.2 Ensure nodev option set on /home partition</li> <li>1.1.8.1 Ensure nodev option set on /dev/shm partition</li> <li>1.1.8.2 Ensure noexec option set on /dev/shm partition</li> </ul>"},{"location":"tags/#t1203","title":"T1203","text":"<ul> <li>1.1.9 Disable Automounting</li> <li>1.2.1 Ensure package manager repositories are configured</li> <li>2.4 Ensure nonessential services are removed or masked</li> <li>2.2.1 Ensure X Window System is not installed</li> <li>2.2.10 Ensure IMAP and POP3 server are not installed</li> <li>2.2.11 Ensure Samba is not installed</li> <li>2.2.12 Ensure HTTP Proxy Server is not installed</li> <li>2.2.13 Ensure SNMP Server is not installed</li> <li>2.2.14 Ensure NIS Server is not installed</li> <li>2.2.16 Ensure rsync service is either not installed or masked</li> <li>2.2.2 Ensure Avahi Server is not installed</li> <li>2.2.3 Ensure CUPS is not installed</li> <li>2.2.4 Ensure DHCP Server is not installed</li> <li>2.2.5 Ensure LDAP server is not installed</li> <li>2.2.7 Ensure DNS Server is not installed</li> <li>2.2.8 Ensure FTP Server is not installed</li> <li>2.2.9 Ensure HTTP server is not installed</li> <li>2.3.1 Ensure NIS Client is not installed</li> <li>2.3.2 Ensure rsh client is not installed</li> <li>2.3.3 Ensure talk client is not installed</li> <li>2.3.4 Ensure telnet client is not installed</li> <li>2.3.5 Ensure LDAP client is not installed</li> <li>2.3.6 Ensure RPC is not installed</li> </ul>"},{"location":"tags/#t1204","title":"T1204","text":"<ul> <li>1.1.2.3 Ensure noexec option set on /tmp partition</li> <li>1.1.4.2 Ensure noexec option set on /var/tmp partition</li> <li>1.1.5.3 Ensure noexec option set on /var/log partition</li> <li>1.1.6.2 Ensure noexec option set on /var/log/audit partition</li> <li>6.2.9 Ensure root PATH Integrity</li> </ul>"},{"location":"tags/#t1204002","title":"T1204.002","text":"<ul> <li>1.1.2.3 Ensure noexec option set on /tmp partition</li> <li>1.1.4.2 Ensure noexec option set on /var/tmp partition</li> <li>1.1.5.3 Ensure noexec option set on /var/log partition</li> <li>1.1.6.2 Ensure noexec option set on /var/log/audit partition</li> <li>6.2.9 Ensure root PATH Integrity</li> </ul>"},{"location":"tags/#t1210","title":"T1210","text":"<ul> <li>1.2.1 Ensure package manager repositories are configured</li> <li>2.4 Ensure nonessential services are removed or masked</li> <li>2.2.1 Ensure X Window System is not installed</li> <li>2.2.10 Ensure IMAP and POP3 server are not installed</li> <li>2.2.11 Ensure Samba is not installed</li> <li>2.2.12 Ensure HTTP Proxy Server is not installed</li> <li>2.2.13 Ensure SNMP Server is not installed</li> <li>2.2.14 Ensure NIS Server is not installed</li> <li>2.2.15 Ensure mail transfer agent is configured for local-only mode</li> <li>2.2.16 Ensure rsync service is either not installed or masked</li> <li>2.2.2 Ensure Avahi Server is not installed</li> <li>2.2.3 Ensure CUPS is not installed</li> <li>2.2.4 Ensure DHCP Server is not installed</li> <li>2.2.5 Ensure LDAP server is not installed</li> <li>2.2.7 Ensure DNS Server is not installed</li> <li>2.2.8 Ensure FTP Server is not installed</li> <li>2.2.9 Ensure HTTP server is not installed</li> <li>3.1.3 Ensure DCCP is disabled</li> <li>3.1.4 Ensure SCTP is disabled</li> <li>3.1.5 Ensure RDS is disabled</li> <li>3.1.6 Ensure TIPC is disabled</li> <li>5.2.12 Ensure SSH X11 forwarding is disabled</li> </ul>"},{"location":"tags/#t1211","title":"T1211","text":"<ul> <li>1.1.9 Disable Automounting</li> <li>1.2.1 Ensure package manager repositories are configured</li> </ul>"},{"location":"tags/#t1212","title":"T1212","text":"<ul> <li>1.1.9 Disable Automounting</li> <li>1.2.1 Ensure package manager repositories are configured</li> </ul>"},{"location":"tags/#t1222","title":"T1222","text":"<ul> <li>1.7.4 Ensure permissions on /etc/motd are configured</li> <li>1.7.5 Ensure permissions on /etc/issue are configured</li> <li>1.7.6 Ensure permissions on /etc/issue.net are configured</li> <li>6.1.1 Ensure permissions on /etc/passwd are configured</li> <li>6.1.10 Ensure no unowned files or directories exist</li> <li>6.1.11 Ensure no ungrouped files or directories exist</li> <li>6.1.2 Ensure permissions on /etc/passwd- are configured</li> <li>6.1.3 Ensure permissions on /etc/group are configured</li> <li>6.1.4 Ensure permissions on /etc/group- are configured</li> <li>6.1.5 Ensure permissions on /etc/shadow are configured</li> <li>6.1.6 Ensure permissions on /etc/shadow- are configured</li> <li>6.1.7 Ensure permissions on /etc/gshadow are configured</li> <li>E6.1.8 Ensure permissions on /etc/gshadow- are configured</li> <li>6.1.9 Ensure no world writable files exist</li> <li>6.2.12 Ensure local interactive users own their home directories</li> <li>6.2.13 Ensure local interactive user home directories are mode 750 or more restrictive</li> <li>6.2.17 Ensure local interactive user dot files are not group or world writable</li> <li>6.2.3 Ensure all groups in /etc/passwd exist in /etc/group</li> </ul>"},{"location":"tags/#t1222001","title":"T1222.001","text":"<ul> <li>6.2.17 Ensure local interactive user dot files are not group or world writable</li> </ul>"},{"location":"tags/#t1222002","title":"T1222.002","text":"<ul> <li>1.7.4 Ensure permissions on /etc/motd are configured</li> <li>1.7.5 Ensure permissions on /etc/issue are configured</li> <li>1.7.6 Ensure permissions on /etc/issue.net are configured</li> <li>6.1.1 Ensure permissions on /etc/passwd are configured</li> <li>6.1.10 Ensure no unowned files or directories exist</li> <li>6.1.11 Ensure no ungrouped files or directories exist</li> <li>6.1.2 Ensure permissions on /etc/passwd- are configured</li> <li>6.1.3 Ensure permissions on /etc/group are configured</li> <li>6.1.4 Ensure permissions on /etc/group- are configured</li> <li>6.1.5 Ensure permissions on /etc/shadow are configured</li> <li>6.1.6 Ensure permissions on /etc/shadow- are configured</li> <li>6.1.7 Ensure permissions on /etc/gshadow are configured</li> <li>E6.1.8 Ensure permissions on /etc/gshadow- are configured</li> <li>6.1.9 Ensure no world writable files exist</li> <li>6.2.12 Ensure local interactive users own their home directories</li> <li>6.2.13 Ensure local interactive user home directories are mode 750 or more restrictive</li> <li>6.2.17 Ensure local interactive user dot files are not group or world writable</li> <li>6.2.3 Ensure all groups in /etc/passwd exist in /etc/group</li> </ul>"},{"location":"tags/#t1498","title":"T1498","text":"<ul> <li>2.1.4.2 Ensure ntp is configured with authorized timeserver</li> <li>3.3.5 Ensure broadcast ICMP requests are ignored</li> <li>3.3.7 Ensure Reverse Path Filtering is enabled</li> </ul>"},{"location":"tags/#t1498001","title":"T1498.001","text":"<ul> <li>3.3.5 Ensure broadcast ICMP requests are ignored</li> <li>3.3.7 Ensure Reverse Path Filtering is enabled</li> </ul>"},{"location":"tags/#t1498002","title":"T1498.002","text":"<ul> <li>2.1.4.2 Ensure ntp is configured with authorized timeserver</li> </ul>"},{"location":"tags/#t1499","title":"T1499","text":"<ul> <li>1.1.2.1 Ensure /tmp is a separate partition</li> <li>1.1.3.1 Ensure separate partition exists for /var</li> <li>1.1.4.1 Ensure separate partition exists for /var/tmp</li> <li>1.1.6.1 Ensure separate partition exists for /var/log/audit</li> <li>1.1.7.1 Ensure separate partition exists for /home</li> <li>3.3.8 Ensure TCP SYN Cookies is enabled</li> <li>5.2.19 Ensure SSH MaxStartups is configured</li> <li>5.2.20 Ensure SSH MaxSessions is set to 10 or less</li> <li>5.2.21 Ensure SSH LoginGraceTime is set to one minute or less</li> </ul>"},{"location":"tags/#t1499001","title":"T1499.001","text":"<ul> <li>1.1.2.1 Ensure /tmp is a separate partition</li> <li>1.1.3.1 Ensure separate partition exists for /var</li> <li>1.1.4.1 Ensure separate partition exists for /var/tmp</li> <li>1.1.6.1 Ensure separate partition exists for /var/log/audit</li> <li>1.1.7.1 Ensure separate partition exists for /home</li> <li>3.3.8 Ensure TCP SYN Cookies is enabled</li> </ul>"},{"location":"tags/#t1499002","title":"T1499.002","text":"<ul> <li>5.2.19 Ensure SSH MaxStartups is configured</li> <li>5.2.20 Ensure SSH MaxSessions is set to 10 or less</li> <li>5.2.21 Ensure SSH LoginGraceTime is set to one minute or less</li> </ul>"},{"location":"tags/#t1542","title":"T1542","text":"<ul> <li>1.4.1 Ensure bootloader password is set</li> <li>1.4.2 Ensure permissions on bootloader config are configured</li> </ul>"},{"location":"tags/#t1543","title":"T1543","text":"<ul> <li>1.8.1 Ensure GNOME Display Manager is removed</li> <li>2.4 Ensure nonessential services are removed or masked</li> <li>2.2.1 Ensure X Window System is not installed</li> <li>2.2.10 Ensure IMAP and POP3 server are not installed</li> <li>2.2.11 Ensure Samba is not installed</li> <li>2.2.12 Ensure HTTP Proxy Server is not installed</li> <li>2.2.13 Ensure SNMP Server is not installed</li> <li>2.2.14 Ensure NIS Server is not installed</li> <li>2.2.16 Ensure rsync service is either not installed or masked</li> <li>2.2.2 Ensure Avahi Server is not installed</li> <li>2.2.3 Ensure CUPS is not installed</li> <li>2.2.4 Ensure DHCP Server is not installed</li> <li>2.2.5 Ensure LDAP server is not installed</li> <li>2.2.7 Ensure DNS Server is not installed</li> <li>2.2.8 Ensure FTP Server is not installed</li> <li>2.2.9 Ensure HTTP server is not installed</li> <li>2.3.1 Ensure NIS Client is not installed</li> <li>2.3.2 Ensure rsh client is not installed</li> <li>2.3.3 Ensure talk client is not installed</li> <li>2.3.4 Ensure telnet client is not installed</li> <li>2.3.5 Ensure LDAP client is not installed</li> <li>2.3.6 Ensure RPC is not installed</li> <li>5.2.1 Ensure permissions on /etc/ssh/sshd_config are configured</li> </ul>"},{"location":"tags/#t1543002","title":"T1543.002","text":"<ul> <li>1.8.1 Ensure GNOME Display Manager is removed</li> <li>2.4 Ensure nonessential services are removed or masked</li> <li>2.2.1 Ensure X Window System is not installed</li> <li>2.2.10 Ensure IMAP and POP3 server are not installed</li> <li>2.2.11 Ensure Samba is not installed</li> <li>2.2.12 Ensure HTTP Proxy Server is not installed</li> <li>2.2.13 Ensure SNMP Server is not installed</li> <li>2.2.14 Ensure NIS Server is not installed</li> <li>2.2.16 Ensure rsync service is either not installed or masked</li> <li>2.2.2 Ensure Avahi Server is not installed</li> <li>2.2.3 Ensure CUPS is not installed</li> <li>2.2.4 Ensure DHCP Server is not installed</li> <li>2.2.5 Ensure LDAP server is not installed</li> <li>2.2.7 Ensure DNS Server is not installed</li> <li>2.2.8 Ensure FTP Server is not installed</li> <li>2.2.9 Ensure HTTP server is not installed</li> <li>2.3.1 Ensure NIS Client is not installed</li> <li>2.3.2 Ensure rsh client is not installed</li> <li>2.3.3 Ensure talk client is not installed</li> <li>2.3.4 Ensure telnet client is not installed</li> <li>2.3.5 Ensure LDAP client is not installed</li> <li>2.3.6 Ensure RPC is not installed</li> <li>5.2.1 Ensure permissions on /etc/ssh/sshd_config are configured</li> </ul>"},{"location":"tags/#t1548","title":"T1548","text":"<ul> <li>1.1.2.4 Ensure nosuid option set on /tmp partition</li> <li>1.1.3.3 Ensure nosuid option set on /var partition</li> <li>1.1.4.3 Ensure nosuid option set on /var/tmp partition</li> <li>1.1.5.4 Ensure nosuid option set on /var/log partition</li> <li>1.1.6.4 Ensure nosuid option set on /var/log/audit partition</li> <li>1.1.7.3 Ensure nosuid option set on /home partition</li> <li>1.1.8.3 Ensure nosuid option set on /dev/shm partition</li> <li>1.4.3 Ensure authentication required for single user mode</li> <li>5.3.2 Ensure sudo commands use pty</li> <li>5.3.7 Ensure access to the su command is restricted</li> <li>5.5.3 Ensure default group for the root account is GID 0</li> <li>6.1.12 Audit SUID executables</li> <li>6.1.13 Audit SGID executables</li> <li>6.2.10 Ensure root is the only UID 0 account</li> </ul>"},{"location":"tags/#t1548001","title":"T1548.001","text":"<ul> <li>1.1.9 Disable Automounting</li> <li>1.1.2.4 Ensure nosuid option set on /tmp partition</li> <li>1.1.3.3 Ensure nosuid option set on /var partition</li> <li>1.1.4.3 Ensure nosuid option set on /var/tmp partition</li> <li>1.1.5.4 Ensure nosuid option set on /var/log partition</li> <li>1.1.6.4 Ensure nosuid option set on /var/log/audit partition</li> <li>1.1.7.3 Ensure nosuid option set on /home partition</li> <li>1.1.8.3 Ensure nosuid option set on /dev/shm partition</li> <li>6.1.12 Audit SUID executables</li> <li>6.1.13 Audit SGID executables</li> </ul>"},{"location":"tags/#t1548003","title":"T1548.003","text":"<ul> <li>5.3.2 Ensure sudo commands use pty</li> </ul>"},{"location":"tags/#t1552","title":"T1552","text":"<ul> <li>5.2.2 Ensure permissions on SSH private host key files are configured</li> </ul>"},{"location":"tags/#t1552004","title":"T1552.004","text":"<ul> <li>5.2.2 Ensure permissions on SSH private host key files are configured</li> </ul>"},{"location":"tags/#t1557","title":"T1557","text":"<ul> <li>1.8.10 Ensure XDCMP is not enabled</li> <li>3.1.1 Ensure system is checked to determine if IPv6 is enabled</li> <li>3.2.1 Ensure packet redirect sending is disabled</li> <li>3.2.2 Ensure IP forwarding is disabled</li> <li>3.3.2 Ensure ICMP redirects are not accepted</li> <li>3.3.3 Ensure secure ICMP redirects are not accepted</li> <li>3.3.9 Ensure IPv6 router advertisements are not accepted</li> <li>5.2.13 Ensure only strong Ciphers are used</li> <li>5.2.14 Ensure only strong MAC algorithms are used</li> <li>5.2.15 Ensure only strong Key Exchange algorithms are used</li> <li>5.2.3 Ensure permissions on SSH public host key files are configured</li> </ul>"},{"location":"tags/#t1562","title":"T1562","text":"<ul> <li>2.1.1.1 Ensure a single time synchronization daemon is in use</li> <li>2.1.2.1 Ensure chrony is configured with authorized timeserver</li> <li>2.1.3.1 Ensure systemd-timesyncd configured with authorized timeserver</li> <li>2.1.4.2 Ensure ntp is configured with authorized timeserver</li> <li>3.3.4 Ensure suspicious packets are logged</li> <li>3.3.6 Ensure bogus ICMP responses are ignored</li> <li>3.5.1.1 Ensure ufw is installed</li> <li>3.5.1.2 Ensure iptables-persistent is not installed with ufw</li> <li>3.5.1.3 Ensure ufw service is enabled</li> <li>3.5.1.4 Ensure ufw loopback traffic is configured</li> <li>3.5.1.6 Ensure ufw firewall rules exist for all open ports</li> <li>3.5.1.7 Ensure ufw default deny firewall policy</li> <li>3.5.2.1 Ensure nftables is installed</li> <li>3.5.2.10 Ensure nftables rules are permanent</li> <li>3.5.2.2 Ensure ufw is uninstalled or disabled with nftables</li> <li>3.5.2.3 Ensure iptables are flushed with nftables</li> <li>3.5.2.4 Ensure a nftables table exists</li> <li>3.5.2.5 Ensure nftables base chains exist</li> <li>3.5.2.6 Ensure nftables loopback traffic is configured</li> <li>3.5.2.7 Ensure nftables outbound and established connections are configured</li> <li>3.5.2.8 Ensure nftables default deny firewall policy</li> <li>3.5.2.9 Ensure nftables service is enabled</li> <li>3.5.3.1.1 Ensure iptables packages are installed</li> <li>3.5.3.1.2 Ensure nftables is not installed with iptables</li> <li>3.5.3.1.3 Ensure ufw is uninstalled or disabled with iptables</li> <li>3.5.3.2.1 Ensure iptables default deny firewall policy</li> <li>3.5.3.2.2 Ensure iptables loopback traffic is configured</li> <li>3.5.3.2.4 Ensure iptables firewall rules exist for all open ports</li> <li>3.5.3.3.1 Ensure ip6tables default deny firewall policy</li> <li>3.5.3.3.2 Ensure ip6tables loopback traffic is configured</li> <li>3.5.3.3.4 Ensure ip6tables firewall rules exist for all open ports</li> <li>4.1.1.1 Ensure auditd is installed</li> <li>4.1.1.2 Ensure auditd service is enabled and active</li> <li>4.1.1.3 Ensure auditing for processes that start prior to auditd is enabled</li> <li>4.1.1.4 Ensure audit_backlog_limit is sufficient</li> <li>4.1.2.1 Ensure audit log storage size is configured</li> <li>4.1.2.2 Ensure audit logs are not automatically deleted</li> <li>4.1.2.3 Ensure system is disabled when audit logs are full</li> <li>4.1.3.1 Ensure changes to system administration scope (sudoers) is collected</li> <li>4.1.3.10 Ensure successful file system mounts are collected</li> <li>4.1.3.11 Ensure session initiation information is collected</li> <li>4.1.3.12 Ensure login and logout events are collected</li> <li>4.1.3.13 Ensure file deletion events by users are collected</li> <li>4.1.3.14 Ensure events that modify the system's Mandatory Access Controls are collected</li> <li>4.1.3.19 Ensure kernel module loading unloading and modification is collected</li> <li>4.1.3.2 Ensure actions as another user are always logged</li> <li>4.1.3.20 Ensure the audit configuration is immutable</li> <li>4.1.3.4 Ensure events that modify date and time information are collected</li> <li>4.1.3.5 Ensure events that modify the system's network environment are collected</li> <li>4.1.3.6 Ensure use of privileged commands are collected</li> <li>4.1.3.7 Ensure unsuccessful file access attempts are collected</li> <li>4.1.3.8 Ensure events that modify user/group information are collected</li> <li>4.1.3.9 Ensure discretionary access control permission modification events are collected</li> <li>4.2.1.2 Ensure journald service is enabled</li> <li>4.2.1.3 Ensure journald is configured to compress large log files</li> <li>4.2.1.4 Ensure journald is configured to write logfiles to persistent disk</li> <li>4.2.1.5 Ensure journald is not configured to send logs to rsyslog</li> <li>4.2.1.1.1 Ensure systemd-journal-remote is installed</li> <li>4.2.1.1.2 Ensure systemd-journal-remote is configured</li> <li>4.2.1.1.3 Ensure systemd-journal-remote is enabled</li> <li>4.2.1.1.4 Ensure journald is not configured to recieve logs from a remote client</li> <li>4.2.2.2 Ensure rsyslog service is enabled</li> <li>4.2.2.6 Ensure rsyslog is configured to send logs to a remote log host</li> <li>4.2.2.7 Ensure rsyslog is not configured to receive logs from a remote client</li> <li>5.1.1 Ensure cron daemon is enabled and running</li> <li>5.2.5 Ensure SSH LogLevel is appropriate</li> <li>5.3.3 Ensure sudo log file exists</li> </ul>"},{"location":"tags/#t1562001","title":"T1562.001","text":"<ul> <li>2.1.1.1 Ensure a single time synchronization daemon is in use</li> <li>2.1.2.1 Ensure chrony is configured with authorized timeserver</li> <li>2.1.3.1 Ensure systemd-timesyncd configured with authorized timeserver</li> <li>2.1.4.2 Ensure ntp is configured with authorized timeserver</li> <li>4.1.1.1 Ensure auditd is installed</li> <li>4.1.1.2 Ensure auditd service is enabled and active</li> <li>4.1.1.3 Ensure auditing for processes that start prior to auditd is enabled</li> <li>4.1.1.4 Ensure audit_backlog_limit is sufficient</li> <li>4.1.3.20 Ensure the audit configuration is immutable</li> <li>4.2.1.2 Ensure journald service is enabled</li> <li>4.2.2.2 Ensure rsyslog service is enabled</li> <li>5.1.1 Ensure cron daemon is enabled and running</li> </ul>"},{"location":"tags/#t1562002","title":"T1562.002","text":"<ul> <li>4.2.1.3 Ensure journald is configured to compress large log files</li> </ul>"},{"location":"tags/#t1562004","title":"T1562.004","text":"<ul> <li>3.5.1.1 Ensure ufw is installed</li> <li>3.5.1.2 Ensure iptables-persistent is not installed with ufw</li> <li>3.5.1.3 Ensure ufw service is enabled</li> <li>3.5.1.4 Ensure ufw loopback traffic is configured</li> <li>3.5.1.6 Ensure ufw firewall rules exist for all open ports</li> <li>3.5.1.7 Ensure ufw default deny firewall policy</li> <li>3.5.2.1 Ensure nftables is installed</li> <li>3.5.2.10 Ensure nftables rules are permanent</li> <li>3.5.2.2 Ensure ufw is uninstalled or disabled with nftables</li> <li>3.5.2.3 Ensure iptables are flushed with nftables</li> <li>3.5.2.4 Ensure a nftables table exists</li> <li>3.5.2.5 Ensure nftables base chains exist</li> <li>3.5.2.6 Ensure nftables loopback traffic is configured</li> <li>3.5.2.8 Ensure nftables default deny firewall policy</li> <li>3.5.2.9 Ensure nftables service is enabled</li> <li>3.5.3.1.1 Ensure iptables packages are installed</li> <li>3.5.3.1.2 Ensure nftables is not installed with iptables</li> <li>3.5.3.1.3 Ensure ufw is uninstalled or disabled with iptables</li> <li>3.5.3.2.1 Ensure iptables default deny firewall policy</li> <li>3.5.3.2.2 Ensure iptables loopback traffic is configured</li> <li>3.5.3.2.4 Ensure iptables firewall rules exist for all open ports</li> <li>3.5.3.3.1 Ensure ip6tables default deny firewall policy</li> <li>3.5.3.3.2 Ensure ip6tables loopback traffic is configured</li> <li>3.5.3.3.4 Ensure ip6tables firewall rules exist for all open ports</li> </ul>"},{"location":"tags/#t1562006","title":"T1562.006","text":"<ul> <li>3.3.4 Ensure suspicious packets are logged</li> <li>3.3.6 Ensure bogus ICMP responses are ignored</li> <li>4.1.2.1 Ensure audit log storage size is configured</li> <li>4.1.2.2 Ensure audit logs are not automatically deleted</li> <li>4.1.2.3 Ensure system is disabled when audit logs are full</li> <li>4.1.3.1 Ensure changes to system administration scope (sudoers) is collected</li> <li>4.1.3.10 Ensure successful file system mounts are collected</li> <li>4.1.3.11 Ensure session initiation information is collected</li> <li>4.1.3.12 Ensure login and logout events are collected</li> <li>4.1.3.13 Ensure file deletion events by users are collected</li> <li>4.1.3.14 Ensure events that modify the system's Mandatory Access Controls are collected</li> <li>4.1.3.19 Ensure kernel module loading unloading and modification is collected</li> <li>4.1.3.2 Ensure actions as another user are always logged</li> <li>4.1.3.4 Ensure events that modify date and time information are collected</li> <li>4.1.3.5 Ensure events that modify the system's network environment are collected</li> <li>4.1.3.6 Ensure use of privileged commands are collected</li> <li>4.1.3.7 Ensure unsuccessful file access attempts are collected</li> <li>4.1.3.8 Ensure events that modify user/group information are collected</li> <li>4.1.3.9 Ensure discretionary access control permission modification events are collected</li> <li>4.2.1.4 Ensure journald is configured to write logfiles to persistent disk</li> <li>4.2.1.5 Ensure journald is not configured to send logs to rsyslog</li> <li>4.2.1.1.1 Ensure systemd-journal-remote is installed</li> <li>4.2.1.1.2 Ensure systemd-journal-remote is configured</li> <li>4.2.1.1.3 Ensure systemd-journal-remote is enabled</li> <li>4.2.1.1.4 Ensure journald is not configured to recieve logs from a remote client</li> <li>4.2.2.6 Ensure rsyslog is configured to send logs to a remote log host</li> <li>4.2.2.7 Ensure rsyslog is not configured to receive logs from a remote client</li> <li>5.2.5 Ensure SSH LogLevel is appropriate</li> <li>5.3.3 Ensure sudo log file exists</li> </ul>"},{"location":"tags/#t1565","title":"T1565","text":"<ul> <li>1.3.1 Ensure AIDE is installed</li> <li>1.3.2 Ensure filesystem integrity is regularly checked</li> <li>1.6.1.1 Ensure AppArmor is installed</li> <li>1.6.1.2 Ensure AppArmor is enabled in the bootloader configuration</li> <li>1.6.1.4 Ensure all AppArmor Profiles are enforcing</li> <li>5.5.4 Ensure default user umask is 027 or more restrictive</li> </ul>"},{"location":"tags/#t1565001","title":"T1565.001","text":"<ul> <li>1.3.1 Ensure AIDE is installed</li> <li>1.3.2 Ensure filesystem integrity is regularly checked</li> <li>1.6.1.1 Ensure AppArmor is installed</li> <li>1.6.1.2 Ensure AppArmor is enabled in the bootloader configuration</li> <li>1.6.1.4 Ensure all AppArmor Profiles are enforcing</li> <li>5.5.4 Ensure default user umask is 027 or more restrictive</li> </ul>"},{"location":"tags/#t1565003","title":"T1565.003","text":"<ul> <li>1.6.1.1 Ensure AppArmor is installed</li> <li>1.6.1.2 Ensure AppArmor is enabled in the bootloader configuration</li> <li>1.6.1.4 Ensure all AppArmor Profiles are enforcing</li> </ul>"},{"location":"tags/#t1570","title":"T1570","text":"<ul> <li>2.2.16 Ensure rsync service is either not installed or masked</li> <li>2.3.1 Ensure NIS Client is not installed</li> <li>2.3.2 Ensure rsh client is not installed</li> </ul>"},{"location":"tags/#t1572","title":"T1572","text":"<ul> <li>5.2.16 Ensure SSH AllowTcpForwarding is disabled</li> </ul>"},{"location":"tags/#t1590","title":"T1590","text":"<ul> <li>3.3.1 Ensure source routed packets are not accepted</li> </ul>"},{"location":"tags/#t1590005","title":"T1590.005","text":"<ul> <li>3.3.1 Ensure source routed packets are not accepted</li> </ul>"},{"location":"tags/#t1592","title":"T1592","text":"<ul> <li>1.7.1 Ensure message of the day is configured properly</li> <li>1.7.2 Ensure local login warning banner is configured properly</li> <li>1.7.3 Ensure remote login warning banner is configured properly</li> </ul>"},{"location":"tags/#t1592004","title":"T1592.004","text":"<ul> <li>1.7.1 Ensure message of the day is configured properly</li> <li>1.7.2 Ensure local login warning banner is configured properly</li> <li>1.7.3 Ensure remote login warning banner is configured properly</li> </ul>"},{"location":"tags/#t1595","title":"T1595","text":"<ul> <li>3.1.1 Ensure system is checked to determine if IPv6 is enabled</li> <li>3.1.2 Ensure wireless interfaces are disabled</li> </ul>"},{"location":"tags/#t1595001","title":"T1595.001","text":"<ul> <li>3.1.1 Ensure system is checked to determine if IPv6 is enabled</li> <li>3.1.2 Ensure wireless interfaces are disabled</li> </ul>"},{"location":"tags/#t1595002","title":"T1595.002","text":"<ul> <li>3.1.1 Ensure system is checked to determine if IPv6 is enabled</li> <li>3.1.2 Ensure wireless interfaces are disabled</li> </ul>"},{"location":"tags/#ta0001","title":"TA0001","text":"<ul> <li>1.2.1 Ensure package manager repositories are configured</li> <li>1.2.2 Ensure GPG keys are configured</li> <li>4.1.3.11 Ensure session initiation information is collected</li> <li>4.1.3.12 Ensure login and logout events are collected</li> <li>5.2.11 Ensure SSH IgnoreRhosts is enabled</li> <li>5.2.17 Ensure SSH warning banner is configured</li> <li>5.2.22 Ensure SSH Idle Timeout Interval is configured</li> <li>5.2.6 Ensure SSH PAM is enabled</li> <li>5.2.8 Ensure SSH HostbasedAuthentication is disabled</li> <li>5.3.1 Ensure sudo is installed</li> <li>5.5.1.4 Ensure inactive password lock is 30 days or less</li> <li>6.2.10 Ensure root is the only UID 0 account</li> </ul>"},{"location":"tags/#ta0002","title":"TA0002","text":"<ul> <li>1.5.1 Ensure address space layout randomization (ASLR) is enabled</li> <li>1.5.2 Ensure prelink is not installed</li> <li>1.8.1 Ensure GNOME Display Manager is removed</li> <li>1.8.10 Ensure XDCMP is not enabled</li> <li>2.1.4.2 Ensure ntp is configured with authorized timeserver</li> <li>4.1.3.6 Ensure use of privileged commands are collected</li> <li>5.1.2 Ensure permissions on /etc/crontab are configured</li> <li>5.1.3 Ensure permissions on /etc/cron.hourly are configured</li> <li>5.1.4 Ensure permissions on /etc/cron.daily are configured</li> <li>5.1.5 Ensure permissions on /etc/cron.weekly are configured</li> <li>5.1.6 Ensure permissions on /etc/cron.monthly are configured</li> <li>5.1.7 Ensure permissions on /etc/cron.d are configured</li> <li>5.1.8 Ensure cron is restricted to authorized users</li> <li>5.1.9 Ensure at is restricted to authorized users</li> </ul>"},{"location":"tags/#ta0003","title":"TA0003","text":"<ul> <li>1.4.1 Ensure bootloader password is set</li> <li>1.6.1.1 Ensure AppArmor is installed</li> <li>1.6.1.2 Ensure AppArmor is enabled in the bootloader configuration</li> <li>4.1.3.5 Ensure events that modify the system's network environment are collected</li> <li>5.2.2 Ensure permissions on SSH private host key files are configured</li> <li>5.2.3 Ensure permissions on SSH public host key files are configured</li> <li>5.3.2 Ensure sudo commands use pty</li> <li>6.2.1 Ensure accounts in /etc/passwd use shadowed passwords</li> <li>6.2.2 Ensure /etc/shadow password fields are not empty</li> <li>6.2.3 Ensure all groups in /etc/passwd exist in /etc/group</li> </ul>"},{"location":"tags/#ta0004","title":"TA0004","text":"<ul> <li>4.1.3.1 Ensure changes to system administration scope (sudoers) is collected</li> <li>4.1.3.14 Ensure events that modify the system's Mandatory Access Controls are collected</li> <li>4.1.3.19 Ensure kernel module loading unloading and modification is collected</li> <li>4.1.3.2 Ensure actions as another user are always logged</li> <li>4.1.3.8 Ensure events that modify user/group information are collected</li> <li>5.3.3 Ensure sudo log file exists</li> <li>6.1.12 Audit SUID executables</li> <li>6.1.13 Audit SGID executables</li> <li>6.2.7 Ensure no duplicate user names exist</li> <li>6.2.8 Ensure no duplicate group names exist</li> </ul>"},{"location":"tags/#ta0005","title":"TA0005","text":"<ul> <li>1.1.10 Disable USB Storage</li> <li>1.1.9 Disable Automounting</li> <li>1.1.1.1 Ensure mounting of cramfs filesystems is disabled</li> <li>1.1.1.2 Ensure mounting of squashfs filesystems is disabled</li> <li>1.1.1.3 Ensure mounting of udf filesystems is disabled</li> <li>1.1.2.1 Ensure /tmp is a separate partition</li> <li>1.1.2.2 Ensure nodev option set on /tmp partition</li> <li>1.1.2.3 Ensure noexec option set on /tmp partition</li> <li>1.1.2.4 Ensure nosuid option set on /tmp partition</li> <li>1.1.3.2 Ensure nodev option set on /var partition</li> <li>1.1.3.3 Ensure nosuid option set on /var partition</li> <li>1.1.4.1 Ensure separate partition exists for /var/tmp</li> <li>1.1.4.2 Ensure noexec option set on /var/tmp partition</li> <li>1.1.4.3 Ensure nosuid option set on /var/tmp partition</li> <li>1.1.4.4 Ensure nodev option set on /var/tmp partition</li> <li>1.1.5.1 Ensure separate partition exists for /var/log</li> <li>1.1.5.2 Ensure nodev option set on /var/log partition</li> <li>1.1.5.3 Ensure noexec option set on /var/log partition</li> <li>1.1.5.4 Ensure nosuid option set on /var/log partition</li> <li>1.1.6.1 Ensure separate partition exists for /var/log/audit</li> <li>1.1.6.2 Ensure noexec option set on /var/log/audit partition</li> <li>1.1.6.3 Ensure nodev option set on /var/log/audit partition</li> <li>1.1.6.4 Ensure nosuid option set on /var/log/audit partition</li> <li>1.1.7.1 Ensure separate partition exists for /home</li> <li>1.1.7.2 Ensure nodev option set on /home partition</li> <li>1.1.7.3 Ensure nosuid option set on /home partition</li> <li>1.1.8.1 Ensure nodev option set on /dev/shm partition</li> <li>1.1.8.2 Ensure noexec option set on /dev/shm partition</li> <li>1.1.8.3 Ensure nosuid option set on /dev/shm partition</li> <li>1.4.2 Ensure permissions on bootloader config are configured</li> <li>1.4.3 Ensure authentication required for single user mode</li> <li>1.6.1.3 Ensure all AppArmor Profiles are in enforce or complain mode</li> <li>1.6.1.4 Ensure all AppArmor Profiles are enforcing</li> <li>1.7.4 Ensure permissions on /etc/motd are configured</li> <li>1.7.5 Ensure permissions on /etc/issue are configured</li> <li>1.7.6 Ensure permissions on /etc/issue.net are configured</li> <li>2.1.1.1 Ensure a single time synchronization daemon is in use</li> <li>2.1.2.1 Ensure chrony is configured with authorized timeserver</li> <li>3.3.4 Ensure suspicious packets are logged</li> <li>3.5.1.2 Ensure iptables-persistent is not installed with ufw</li> <li>3.5.1.3 Ensure ufw service is enabled</li> <li>3.5.2.2 Ensure ufw is uninstalled or disabled with nftables</li> <li>3.5.2.3 Ensure iptables are flushed with nftables</li> <li>3.5.2.5 Ensure nftables base chains exist</li> <li>3.5.2.6 Ensure nftables loopback traffic is configured</li> <li>4.1.1.1 Ensure auditd is installed</li> <li>4.1.1.2 Ensure auditd service is enabled and active</li> <li>4.1.1.3 Ensure auditing for processes that start prior to auditd is enabled</li> <li>4.1.1.4 Ensure audit_backlog_limit is sufficient</li> <li>4.1.2.3 Ensure system is disabled when audit logs are full</li> <li>4.1.3.13 Ensure file deletion events by users are collected</li> <li>4.1.3.20 Ensure the audit configuration is immutable</li> <li>4.1.3.4 Ensure events that modify date and time information are collected</li> <li>4.1.3.9 Ensure discretionary access control permission modification events are collected</li> <li>4.2.1.2 Ensure journald service is enabled</li> <li>4.2.1.4 Ensure journald is configured to write logfiles to persistent disk</li> <li>4.2.2.1 Ensure rsyslog is installed</li> <li>4.2.2.2 Ensure rsyslog service is enabled</li> <li>4.2.2.5 Ensure logging is configured</li> <li>4.2.2.7 Ensure rsyslog is not configured to receive logs from a remote client</li> <li>5.1.1 Ensure cron daemon is enabled and running</li> <li>5.2.1 Ensure permissions on /etc/ssh/sshd_config are configured</li> <li>5.2.5 Ensure SSH LogLevel is appropriate</li> <li>5.3.7 Ensure access to the su command is restricted</li> <li>5.5.2 Ensure system accounts are secured</li> <li>5.5.3 Ensure default group for the root account is GID 0</li> <li>5.5.5 Ensure default user shell timeout is 900 seconds or less</li> <li>6.1.1 Ensure permissions on /etc/passwd are configured</li> <li>6.1.2 Ensure permissions on /etc/passwd- are configured</li> <li>6.1.3 Ensure permissions on /etc/group are configured</li> <li>6.1.4 Ensure permissions on /etc/group- are configured</li> <li>6.1.5 Ensure permissions on /etc/shadow are configured</li> <li>6.1.6 Ensure permissions on /etc/shadow- are configured</li> <li>6.1.7 Ensure permissions on /etc/gshadow are configured</li> <li>E6.1.8 Ensure permissions on /etc/gshadow- are configured</li> <li>6.1.9 Ensure no world writable files exist</li> <li>6.2.11 Ensure local interactive user home directories exist</li> <li>6.2.12 Ensure local interactive users own their home directories</li> <li>6.2.13 Ensure local interactive user home directories are mode 750 or more restrictive</li> <li>6.2.17 Ensure local interactive user dot files are not group or world writable</li> <li>6.2.4 Ensure shadow group is empty</li> <li>6.2.5 Ensure no duplicate UIDs exist</li> <li>6.2.6 Ensure no duplicate GIDs exist</li> </ul>"},{"location":"tags/#ta0006","title":"TA0006","text":"<ul> <li>1.1.3.1 Ensure separate partition exists for /var</li> <li>2.3.3 Ensure talk client is not installed</li> <li>2.3.4 Ensure telnet client is not installed</li> <li>3.2.1 Ensure packet redirect sending is disabled</li> <li>3.2.2 Ensure IP forwarding is disabled</li> <li>3.3.2 Ensure ICMP redirects are not accepted</li> <li>3.3.3 Ensure secure ICMP redirects are not accepted</li> <li>3.3.7 Ensure Reverse Path Filtering is enabled</li> <li>3.3.9 Ensure IPv6 router advertisements are not accepted</li> <li>5.2.13 Ensure only strong Ciphers are used</li> <li>5.2.14 Ensure only strong MAC algorithms are used</li> <li>5.2.15 Ensure only strong Key Exchange algorithms are used</li> <li>5.2.18 Ensure SSH MaxAuthTries is set to 4 or less</li> <li>5.2.2 Ensure permissions on SSH private host key files are configured</li> <li>5.2.21 Ensure SSH LoginGraceTime is set to one minute or less</li> <li>5.2.3 Ensure permissions on SSH public host key files are configured</li> <li>5.4.1 Ensure password creation requirements are configured</li> <li>5.4.2 Ensure lockout for failed password attempts is configured</li> <li>5.4.4 Ensure password hashing algorithm is up to date with the latest standards</li> <li>5.5.1.1 Ensure minimum days between password changes is configured</li> <li>5.5.1.3 Ensure password expiration warning days is 7 or more</li> <li>6.2.14 Ensure no local interactive user has .netrc files</li> <li>6.2.9 Ensure root PATH Integrity</li> </ul>"},{"location":"tags/#ta0007","title":"TA0007","text":"<ul> <li>1.4.2 Ensure permissions on bootloader config are configured</li> <li>1.5.4 Ensure core dumps are restricted</li> <li>1.7.1 Ensure message of the day is configured properly</li> <li>1.7.2 Ensure local login warning banner is configured properly</li> <li>1.7.3 Ensure remote login warning banner is configured properly</li> <li>1.8.2 Ensure GDM login banner is configured</li> <li>1.8.3 Ensure GDM disable-user-list option is enabled</li> <li>3.3.1 Ensure source routed packets are not accepted</li> <li>3.3.2 Ensure ICMP redirects are not accepted</li> <li>4.1.3.7 Ensure unsuccessful file access attempts are collected</li> <li>4.1.4.1 Ensure audit log files are mode 0640 or less permissive</li> <li>4.1.4.10 Ensure audit tools belong to group root</li> <li>4.1.4.11 Ensure cryptographic mechanisms are used to protect the integrity of audit tool</li> <li>4.1.4.2 Ensure only authorized users own audit log files</li> <li>4.1.4.3 Ensure only authorized groups are assigned ownership of audit log files</li> <li>4.1.4.4 Ensure the audit log directory is 0750 or more restrictive</li> <li>4.1.4.5 Ensure audit configuration files are 640 or more restrictive</li> <li>4.1.4.6 Ensure audit configuration files are owned by root</li> <li>4.1.4.7 Ensure audit configuration files belong to group root</li> <li>4.1.4.8 Ensure audit tools are 755 or more restrictive</li> <li>4.1.4.9 Ensure audit tools are owned by root</li> <li>4.2.3 Ensure all logfiles have appropriate permissions and ownership</li> <li>4.2.1.7 Ensure journald default file permissions configured</li> <li>4.2.2.4 Ensure rsyslog default file permissions are configured</li> <li>5.1.2 Ensure permissions on /etc/crontab are configured</li> <li>5.1.3 Ensure permissions on /etc/cron.hourly are configured</li> <li>5.1.4 Ensure permissions on /etc/cron.daily are configured</li> <li>5.1.5 Ensure permissions on /etc/cron.weekly are configured</li> <li>5.1.6 Ensure permissions on /etc/cron.monthly are configured</li> <li>5.1.7 Ensure permissions on /etc/cron.d are configured</li> <li>5.2.17 Ensure SSH warning banner is configured</li> <li>5.5.4 Ensure default user umask is 027 or more restrictive</li> <li>6.1.10 Ensure no unowned files or directories exist</li> <li>6.1.11 Ensure no ungrouped files or directories exist</li> <li>6.2.16 Ensue no local interactive user has .rhosts files</li> </ul>"},{"location":"tags/#ta0008","title":"TA0008","text":"<ul> <li>2.4 Ensure nonessential services are removed or masked</li> <li>2.2.1 Ensure X Window System is not installed</li> <li>2.2.10 Ensure IMAP and POP3 server are not installed</li> <li>2.2.11 Ensure Samba is not installed</li> <li>2.2.12 Ensure HTTP Proxy Server is not installed</li> <li>2.2.13 Ensure SNMP Server is not installed</li> <li>2.2.14 Ensure NIS Server is not installed</li> <li>2.2.15 Ensure mail transfer agent is configured for local-only mode</li> <li>2.2.16 Ensure rsync service is either not installed or masked</li> <li>2.2.2 Ensure Avahi Server is not installed</li> <li>2.2.3 Ensure CUPS is not installed</li> <li>2.2.4 Ensure DHCP Server is not installed</li> <li>2.2.5 Ensure LDAP server is not installed</li> <li>2.2.7 Ensure DNS Server is not installed</li> <li>2.2.8 Ensure FTP Server is not installed</li> <li>2.2.9 Ensure HTTP server is not installed</li> <li>2.3.1 Ensure NIS Client is not installed</li> <li>2.3.2 Ensure rsh client is not installed</li> <li>2.3.3 Ensure talk client is not installed</li> <li>2.3.4 Ensure telnet client is not installed</li> <li>2.3.5 Ensure LDAP client is not installed</li> <li>2.3.6 Ensure RPC is not installed</li> <li>3.1.1 Ensure system is checked to determine if IPv6 is enabled</li> <li>3.1.3 Ensure DCCP is disabled</li> <li>3.1.4 Ensure SCTP is disabled</li> <li>3.1.5 Ensure RDS is disabled</li> <li>3.1.6 Ensure TIPC is disabled</li> <li>5.2.10 Ensure SSH PermitUserEnvironment is disabled</li> <li>5.2.12 Ensure SSH X11 forwarding is disabled</li> <li>5.2.16 Ensure SSH AllowTcpForwarding is disabled</li> <li>5.2.4 Ensure SSH access is limited</li> <li>5.2.7 Ensure SSH root login is disabled</li> <li>5.2.9 Ensure SSH PermitEmptyPasswords is disabled</li> </ul>"},{"location":"tags/#ta0009","title":"TA0009","text":"<ul> <li>3.2.1 Ensure packet redirect sending is disabled</li> <li>3.2.2 Ensure IP forwarding is disabled</li> <li>3.3.3 Ensure secure ICMP redirects are not accepted</li> </ul>"},{"location":"tags/#ta0010","title":"TA0010","text":"<ul> <li>3.1.2 Ensure wireless interfaces are disabled</li> <li>4.1.3.10 Ensure successful file system mounts are collected</li> <li>6.2.15 Ensure no local interactive user has .forward files</li> </ul>"},{"location":"tags/#ta0011","title":"TA0011","text":"<ul> <li>3.5.1.1 Ensure ufw is installed</li> <li>3.5.1.4 Ensure ufw loopback traffic is configured</li> <li>3.5.1.5 Ensure ufw outbound connections are configured</li> <li>3.5.1.6 Ensure ufw firewall rules exist for all open ports</li> <li>3.5.1.7 Ensure ufw default deny firewall policy</li> <li>3.5.2.1 Ensure nftables is installed</li> <li>3.5.2.10 Ensure nftables rules are permanent</li> <li>3.5.2.4 Ensure a nftables table exists</li> <li>3.5.2.7 Ensure nftables outbound and established connections are configured</li> <li>3.5.2.8 Ensure nftables default deny firewall policy</li> <li>3.5.2.9 Ensure nftables service is enabled</li> <li>3.5.3.1.1 Ensure iptables packages are installed</li> <li>3.5.3.1.2 Ensure nftables is not installed with iptables</li> <li>3.5.3.1.3 Ensure ufw is uninstalled or disabled with iptables</li> <li>3.5.3.2.1 Ensure iptables default deny firewall policy</li> <li>3.5.3.2.2 Ensure iptables loopback traffic is configured</li> <li>3.5.3.2.4 Ensure iptables firewall rules exist for all open ports</li> <li>3.5.3.3.1 Ensure ip6tables default deny firewall policy</li> <li>3.5.3.3.2 Ensure ip6tables loopback traffic is configured</li> <li>3.5.3.3.3 Ensure ip6tables outbound and established connections are configured</li> <li>3.5.3.3.4 Ensure ip6tables firewall rules exist for all open ports</li> </ul>"},{"location":"tags/#ta0040","title":"TA0040","text":"<ul> <li>1.3.2 Ensure filesystem integrity is regularly checked</li> <li>3.3.5 Ensure broadcast ICMP requests are ignored</li> <li>3.3.6 Ensure bogus ICMP responses are ignored</li> <li>3.3.7 Ensure Reverse Path Filtering is enabled</li> <li>3.3.8 Ensure TCP SYN Cookies is enabled</li> <li>3.3.9 Ensure IPv6 router advertisements are not accepted</li> <li>4.1.2.1 Ensure audit log storage size is configured</li> <li>4.1.2.2 Ensure audit logs are not automatically deleted</li> <li>4.2.1.3 Ensure journald is configured to compress large log files</li> <li>4.2.1.5 Ensure journald is not configured to send logs to rsyslog</li> <li>4.2.1.6 Ensure journald log rotation is configured per site policy</li> <li>4.2.1.1.1 Ensure systemd-journal-remote is installed</li> <li>4.2.1.1.2 Ensure systemd-journal-remote is configured</li> <li>4.2.1.1.3 Ensure systemd-journal-remote is enabled</li> <li>4.2.1.1.4 Ensure journald is not configured to recieve logs from a remote client</li> <li>4.2.2.6 Ensure rsyslog is configured to send logs to a remote log host</li> <li>5.2.19 Ensure SSH MaxStartups is configured</li> <li>5.2.20 Ensure SSH MaxSessions is set to 10 or less</li> </ul>"},{"location":"tags/#user-accounts-and-environment","title":"User Accounts and Environment","text":"<ul> <li>5.5.2 Ensure system accounts are secured</li> <li>5.5.3 Ensure default group for the root account is GID 0</li> <li>5.5.4 Ensure default user umask is 027 or more restrictive</li> <li>5.5.5 Ensure default user shell timeout is 900 seconds or less</li> <li>5.5.1.1 Ensure minimum days between password changes is configured</li> <li>5.5.1.2 Ensure password expiration is 365 days or less</li> <li>5.5.1.3 Ensure password expiration warning days is 7 or more</li> <li>5.5.1.4 Ensure inactive password lock is 30 days or less</li> <li>5.5.1.5 Ensure all users last password change date is in the past</li> </ul>"},{"location":"tags/#workstation","title":"Workstation","text":"<ul> <li>1.9 Ensure updates, patches, and additional security software are installed</li> <li>1.1.10 Disable USB Storage</li> <li>1.1.9 Disable Automounting</li> <li>1.1.1.1 Ensure mounting of cramfs filesystems is disabled</li> <li>1.1.1.2 Ensure mounting of squashfs filesystems is disabled</li> <li>1.1.1.3 Ensure mounting of udf filesystems is disabled</li> <li>1.1.2.1 Ensure /tmp is a separate partition</li> <li>1.1.2.2 Ensure nodev option set on /tmp partition</li> <li>1.1.2.3 Ensure noexec option set on /tmp partition</li> <li>1.1.2.4 Ensure nosuid option set on /tmp partition</li> <li>1.1.3.1 Ensure separate partition exists for /var</li> <li>1.1.3.2 Ensure nodev option set on /var partition</li> <li>1.1.3.3 Ensure nosuid option set on /var partition</li> <li>1.1.4.1 Ensure separate partition exists for /var/tmp</li> <li>1.1.4.2 Ensure noexec option set on /var/tmp partition</li> <li>1.1.4.3 Ensure nosuid option set on /var/tmp partition</li> <li>1.1.4.4 Ensure nodev option set on /var/tmp partition</li> <li>1.1.5.1 Ensure separate partition exists for /var/log</li> <li>1.1.5.2 Ensure nodev option set on /var/log partition</li> <li>1.1.5.3 Ensure noexec option set on /var/log partition</li> <li>1.1.5.4 Ensure nosuid option set on /var/log partition</li> <li>1.1.6.1 Ensure separate partition exists for /var/log/audit</li> <li>1.1.6.2 Ensure noexec option set on /var/log/audit partition</li> <li>1.1.6.3 Ensure nodev option set on /var/log/audit partition</li> <li>1.1.6.4 Ensure nosuid option set on /var/log/audit partition</li> <li>1.1.7.1 Ensure separate partition exists for /home</li> <li>1.1.7.2 Ensure nodev option set on /home partition</li> <li>1.1.7.3 Ensure nosuid option set on /home partition</li> <li>1.1.8.1 Ensure nodev option set on /dev/shm partition</li> <li>1.1.8.2 Ensure noexec option set on /dev/shm partition</li> <li>1.1.8.3 Ensure nosuid option set on /dev/shm partition</li> <li>1.2.1 Ensure package manager repositories are configured</li> <li>1.2.2 Ensure GPG keys are configured</li> <li>1.3.1 Ensure AIDE is installed</li> <li>1.3.2 Ensure filesystem integrity is regularly checked</li> <li>1.4.1 Ensure bootloader password is set</li> <li>1.4.2 Ensure permissions on bootloader config are configured</li> <li>1.4.3 Ensure authentication required for single user mode</li> <li>1.5.1 Ensure address space layout randomization (ASLR) is enabled</li> <li>1.5.2 Ensure prelink is not installed</li> <li>1.5.3 Ensure Automatic Error Reporting is not enabled</li> <li>1.5.4 Ensure core dumps are restricted</li> <li>1.6.1.1 Ensure AppArmor is installed</li> <li>1.6.1.2 Ensure AppArmor is enabled in the bootloader configuration</li> <li>1.6.1.3 Ensure all AppArmor Profiles are in enforce or complain mode</li> <li>1.6.1.4 Ensure all AppArmor Profiles are enforcing</li> <li>1.7.1 Ensure message of the day is configured properly</li> <li>1.7.2 Ensure local login warning banner is configured properly</li> <li>1.7.3 Ensure remote login warning banner is configured properly</li> <li>1.7.4 Ensure permissions on /etc/motd are configured</li> <li>1.7.5 Ensure permissions on /etc/issue are configured</li> <li>1.7.6 Ensure permissions on /etc/issue.net are configured</li> <li>1.8.10 Ensure XDCMP is not enabled</li> <li>1.8.4 Ensure GDM screen locks when the user is idle</li> <li>1.8.5 Ensure GDM screen locks cannot be overridden</li> <li>1.8.6 Ensure GDM automatic mounting of removable media is disabled</li> <li>1.8.7 Ensure GDM disabling automatic mounting of removable media is not overridden</li> <li>1.8.8 Ensure GDM autorun-never is enabled</li> <li>1.8.9 Ensure GDM autorun-never is not overridden</li> <li>2.4 Ensure nonessential services are removed or masked</li> <li>2.1.1.1 Ensure a single time synchronization daemon is in use</li> <li>2.1.2.1 Ensure chrony is configured with authorized timeserver</li> <li>2.1.2.2 Ensure chrony is running as user _chrony</li> <li>2.1.2.3 Ensure chrony is enabled and running</li> <li>2.1.3.1 Ensure systemd-timesyncd configured with authorized timeserver</li> <li>2.1.3.2 Ensure systemd-timesyncd is enabled and running</li> <li>2.1.4.1 Ensure ntp access control is configured</li> <li>2.1.4.2 Ensure ntp is configured with authorized timeserver</li> <li>2.1.4.3 Ensure ntp is running as user ntp</li> <li>Ensure mounting of cramfs filesystems is disabled</li> <li>2.2.10 Ensure IMAP and POP3 server are not installed</li> <li>2.2.11 Ensure Samba is not installed</li> <li>2.2.12 Ensure HTTP Proxy Server is not installed</li> <li>2.2.13 Ensure SNMP Server is not installed</li> <li>2.2.14 Ensure NIS Server is not installed</li> <li>2.2.15 Ensure mail transfer agent is configured for local-only mode</li> <li>2.2.16 Ensure rsync service is either not installed or masked</li> <li>2.2.2 Ensure Avahi Server is not installed</li> <li>2.2.3 Ensure CUPS is not installed</li> <li>2.2.4 Ensure DHCP Server is not installed</li> <li>2.2.5 Ensure LDAP server is not installed</li> <li>2.2.6 Ensure NFS is not installed</li> <li>2.2.7 Ensure DNS Server is not installed</li> <li>2.2.8 Ensure FTP Server is not installed</li> <li>2.2.9 Ensure HTTP server is not installed</li> <li>2.3.1 Ensure NIS Client is not installed</li> <li>2.3.2 Ensure rsh client is not installed</li> <li>2.3.3 Ensure talk client is not installed</li> <li>2.3.4 Ensure telnet client is not installed</li> <li>2.3.5 Ensure LDAP client is not installed</li> <li>2.3.6 Ensure RPC is not installed</li> <li>3.1.1 Ensure system is checked to determine if IPv6 is enabled</li> <li>3.1.2 Ensure wireless interfaces are disabled</li> <li>3.1.3 Ensure DCCP is disabled</li> <li>3.1.4 Ensure SCTP is disabled</li> <li>3.1.5 Ensure RDS is disabled</li> <li>3.1.6 Ensure TIPC is disabled</li> <li>3.2.1 Ensure packet redirect sending is disabled</li> <li>3.2.2 Ensure IP forwarding is disabled</li> <li>3.3.1 Ensure source routed packets are not accepted</li> <li>3.3.2 Ensure ICMP redirects are not accepted</li> <li>3.3.3 Ensure secure ICMP redirects are not accepted</li> <li>3.3.4 Ensure suspicious packets are logged</li> <li>3.3.5 Ensure broadcast ICMP requests are ignored</li> <li>3.3.6 Ensure bogus ICMP responses are ignored</li> <li>3.3.7 Ensure Reverse Path Filtering is enabled</li> <li>3.3.8 Ensure TCP SYN Cookies is enabled</li> <li>3.3.9 Ensure IPv6 router advertisements are not accepted</li> <li>3.5.1.1 Ensure ufw is installed</li> <li>3.5.1.2 Ensure iptables-persistent is not installed with ufw</li> <li>3.5.1.3 Ensure ufw service is enabled</li> <li>3.5.1.4 Ensure ufw loopback traffic is configured</li> <li>3.5.1.5 Ensure ufw outbound connections are configured</li> <li>3.5.1.6 Ensure ufw firewall rules exist for all open ports</li> <li>3.5.1.7 Ensure ufw default deny firewall policy</li> <li>3.5.2.1 Ensure nftables is installed</li> <li>3.5.2.10 Ensure nftables rules are permanent</li> <li>3.5.2.2 Ensure ufw is uninstalled or disabled with nftables</li> <li>3.5.2.3 Ensure iptables are flushed with nftables</li> <li>3.5.2.4 Ensure a nftables table exists</li> <li>3.5.2.5 Ensure nftables base chains exist</li> <li>3.5.2.6 Ensure nftables loopback traffic is configured</li> <li>3.5.2.7 Ensure nftables outbound and established connections are configured</li> <li>3.5.2.8 Ensure nftables default deny firewall policy</li> <li>3.5.2.9 Ensure nftables service is enabled</li> <li>3.5.3.1.1 Ensure iptables packages are installed</li> <li>3.5.3.1.2 Ensure nftables is not installed with iptables</li> <li>3.5.3.1.3 Ensure ufw is uninstalled or disabled with iptables</li> <li>3.5.3.2.1 Ensure iptables default deny firewall policy</li> <li>3.5.3.2.2 Ensure iptables loopback traffic is configured</li> <li>3.5.3.2.4 Ensure iptables firewall rules exist for all open ports</li> <li>3.5.3.3.1 Ensure ip6tables default deny firewall policy</li> <li>3.5.3.3.2 Ensure ip6tables loopback traffic is configured</li> <li>3.5.3.3.3 Ensure ip6tables outbound and established connections are configured</li> <li>3.5.3.3.4 Ensure ip6tables firewall rules exist for all open ports</li> <li>4.1.1.1 Ensure auditd is installed</li> <li>4.1.1.2 Ensure auditd service is enabled and active</li> <li>4.1.1.3 Ensure auditing for processes that start prior to auditd is enabled</li> <li>4.1.1.4 Ensure audit_backlog_limit is sufficient</li> <li>4.1.2.1 Ensure audit log storage size is configured</li> <li>4.1.2.2 Ensure audit logs are not automatically deleted</li> <li>4.1.2.3 Ensure system is disabled when audit logs are full</li> <li>4.1.3.1 Ensure changes to system administration scope (sudoers) is collected</li> <li>4.1.3.10 Ensure successful file system mounts are collected</li> <li>4.1.3.11 Ensure session initiation information is collected</li> <li>4.1.3.12 Ensure login and logout events are collected</li> <li>4.1.3.13 Ensure file deletion events by users are collected</li> <li>4.1.3.14 Ensure events that modify the system's Mandatory Access Controls are collected</li> <li>4.1.3.15 Ensure successful and unsuccessful attempts to use the chcon command are recorded</li> <li>4.1.3.16 Ensure successful and unsuccessful attempts to use the setfacl command are recorded</li> <li>4.1.3.17 Ensure successful and unsuccessful attempts to use the chacl command are recorde</li> <li>4.1.3.18 Ensure successful and unsuccessful attempts to use the usermod command are recorded</li> <li>4.1.3.19 Ensure kernel module loading unloading and modification is collected</li> <li>4.1.3.2 Ensure actions as another user are always logged</li> <li>4.1.3.20 Ensure the audit configuration is immutable</li> <li>4.1.3.21 Ensure the running and on disk configuration is the same</li> <li>4.1.3.3 Ensure events that modify the sudo log file are collected</li> <li>4.1.3.4 Ensure events that modify date and time information are collected</li> <li>4.1.3.5 Ensure events that modify the system's network environment are collected</li> <li>4.1.3.6 Ensure use of privileged commands are collected</li> <li>4.1.3.7 Ensure unsuccessful file access attempts are collected</li> <li>4.1.3.8 Ensure events that modify user/group information are collected</li> <li>4.1.3.9 Ensure discretionary access control permission modification events are collected</li> <li>4.1.4.1 Ensure audit log files are mode 0640 or less permissive</li> <li>4.1.4.10 Ensure audit tools belong to group root</li> <li>4.1.4.11 Ensure cryptographic mechanisms are used to protect the integrity of audit tool</li> <li>4.1.4.2 Ensure only authorized users own audit log files</li> <li>4.1.4.3 Ensure only authorized groups are assigned ownership of audit log files</li> <li>4.1.4.4 Ensure the audit log directory is 0750 or more restrictive</li> <li>4.1.4.5 Ensure audit configuration files are 640 or more restrictive</li> <li>4.1.4.6 Ensure audit configuration files are owned by root</li> <li>4.1.4.7 Ensure audit configuration files belong to group root</li> <li>4.1.4.8 Ensure audit tools are 755 or more restrictive</li> <li>4.1.4.9 Ensure audit tools are owned by root</li> <li>4.2.3 Ensure all logfiles have appropriate permissions and ownership</li> <li>4.2.1.2 Ensure journald service is enabled</li> <li>4.2.1.3 Ensure journald is configured to compress large log files</li> <li>4.2.1.4 Ensure journald is configured to write logfiles to persistent disk</li> <li>4.2.1.5 Ensure journald is not configured to send logs to rsyslog</li> <li>4.2.1.6 Ensure journald log rotation is configured per site policy</li> <li>4.2.1.7 Ensure journald default file permissions configured</li> <li>4.2.1.1.1 Ensure systemd-journal-remote is installed</li> <li>4.2.1.1.2 Ensure systemd-journal-remote is configured</li> <li>4.2.1.1.3 Ensure systemd-journal-remote is enabled</li> <li>4.2.1.1.4 Ensure journald is not configured to recieve logs from a remote client</li> <li>4.2.2.1 Ensure rsyslog is installed</li> <li>4.2.2.2 Ensure rsyslog service is enabled</li> <li>4.2.2.3 Ensure journald is configured to send logs to rsyslog</li> <li>4.2.2.4 Ensure rsyslog default file permissions are configured</li> <li>4.2.2.5 Ensure logging is configured</li> <li>4.2.2.6 Ensure rsyslog is configured to send logs to a remote log host</li> <li>4.2.2.7 Ensure rsyslog is not configured to receive logs from a remote client</li> <li>5.1.1 Ensure cron daemon is enabled and running</li> <li>5.1.2 Ensure permissions on /etc/crontab are configured</li> <li>5.1.3 Ensure permissions on /etc/cron.hourly are configured</li> <li>5.1.4 Ensure permissions on /etc/cron.daily are configured</li> <li>5.1.5 Ensure permissions on /etc/cron.weekly are configured</li> <li>5.1.6 Ensure permissions on /etc/cron.monthly are configured</li> <li>5.1.7 Ensure permissions on /etc/cron.d are configured</li> <li>5.1.8 Ensure cron is restricted to authorized users</li> <li>5.1.9 Ensure at is restricted to authorized users</li> <li>5.2.1 Ensure permissions on /etc/ssh/sshd_config are configured</li> <li>5.2.10 Ensure SSH PermitUserEnvironment is disabled</li> <li>5.2.11 Ensure SSH IgnoreRhosts is enabled</li> <li>5.2.12 Ensure SSH X11 forwarding is disabled</li> <li>5.2.13 Ensure only strong Ciphers are used</li> <li>5.2.14 Ensure only strong MAC algorithms are used</li> <li>5.2.15 Ensure only strong Key Exchange algorithms are used</li> <li>5.2.16 Ensure SSH AllowTcpForwarding is disabled</li> <li>5.2.17 Ensure SSH warning banner is configured</li> <li>5.2.18 Ensure SSH MaxAuthTries is set to 4 or less</li> <li>5.2.19 Ensure SSH MaxStartups is configured</li> <li>5.2.2 Ensure permissions on SSH private host key files are configured</li> <li>5.2.20 Ensure SSH MaxSessions is set to 10 or less</li> <li>5.2.21 Ensure SSH LoginGraceTime is set to one minute or less</li> <li>5.2.22 Ensure SSH Idle Timeout Interval is configured</li> <li>5.2.3 Ensure permissions on SSH public host key files are configured</li> <li>5.2.4 Ensure SSH access is limited</li> <li>5.2.5 Ensure SSH LogLevel is appropriate</li> <li>5.2.6 Ensure SSH PAM is enabled</li> <li>5.2.7 Ensure SSH root login is disabled</li> <li>5.2.8 Ensure SSH HostbasedAuthentication is disabled</li> <li>5.2.9 Ensure SSH PermitEmptyPasswords is disabled</li> <li>5.3.1 Ensure sudo is installed</li> <li>5.3.2 Ensure sudo commands use pty</li> <li>5.3.3 Ensure sudo log file exists</li> <li>5.3.4 Ensure users must provide password for privilege escalation</li> <li>5.3.5 Ensure re-authentication for privilege escalation is not disabled globally</li> <li>5.3.6 Ensure sudo authentication timeout is configured correctly</li> <li>5.3.7 Ensure access to the su command is restricted</li> <li>5.4.1 Ensure password creation requirements are configured</li> <li>5.4.2 Ensure lockout for failed password attempts is configured</li> <li>5.4.3 Ensure password reuse is limited</li> <li>5.4.4 Ensure password hashing algorithm is up to date with the latest standards</li> <li>5.5.2 Ensure system accounts are secured</li> <li>5.5.3 Ensure default group for the root account is GID 0</li> <li>5.5.4 Ensure default user umask is 027 or more restrictive</li> <li>5.5.5 Ensure default user shell timeout is 900 seconds or less</li> <li>5.5.1.1 Ensure minimum days between password changes is configured</li> <li>5.5.1.2 Ensure password expiration is 365 days or less</li> <li>5.5.1.3 Ensure password expiration warning days is 7 or more</li> <li>5.5.1.4 Ensure inactive password lock is 30 days or less</li> <li>5.5.1.5 Ensure all users last password change date is in the past</li> <li>6.1.1 Ensure permissions on /etc/passwd are configured</li> <li>6.1.10 Ensure no unowned files or directories exist</li> <li>6.1.11 Ensure no ungrouped files or directories exist</li> <li>6.1.12 Audit SUID executables</li> <li>6.1.13 Audit SGID executables</li> <li>6.1.2 Ensure permissions on /etc/passwd- are configured</li> <li>6.1.3 Ensure permissions on /etc/group are configured</li> <li>6.1.4 Ensure permissions on /etc/group- are configured</li> <li>6.1.5 Ensure permissions on /etc/shadow are configured</li> <li>6.1.6 Ensure permissions on /etc/shadow- are configured</li> <li>6.1.7 Ensure permissions on /etc/gshadow are configured</li> <li>E6.1.8 Ensure permissions on /etc/gshadow- are configured</li> <li>6.1.9 Ensure no world writable files exist</li> <li>6.2.1 Ensure accounts in /etc/passwd use shadowed passwords</li> <li>6.2.10 Ensure root is the only UID 0 account</li> <li>6.2.11 Ensure local interactive user home directories exist</li> <li>6.2.12 Ensure local interactive users own their home directories</li> <li>6.2.13 Ensure local interactive user home directories are mode 750 or more restrictive</li> <li>6.2.14 Ensure no local interactive user has .netrc files</li> <li>6.2.15 Ensure no local interactive user has .forward files</li> <li>6.2.16 Ensue no local interactive user has .rhosts files</li> <li>6.2.17 Ensure local interactive user dot files are not group or world writable</li> <li>6.2.2 Ensure /etc/shadow password fields are not empty</li> <li>6.2.3 Ensure all groups in /etc/passwd exist in /etc/group</li> <li>6.2.4 Ensure shadow group is empty</li> <li>6.2.5 Ensure no duplicate UIDs exist</li> <li>6.2.6 Ensure no duplicate GIDs exist</li> <li>6.2.7 Ensure no duplicate user names exist</li> <li>6.2.8 Ensure no duplicate group names exist</li> <li>6.2.9 Ensure root PATH Integrity</li> </ul>"}]}